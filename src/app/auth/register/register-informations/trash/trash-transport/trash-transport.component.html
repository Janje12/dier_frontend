<div class="row my-2">
  <div class="col-8">
    <form #updateForm (ngSubmit)="updateVehiclesForm()">
      <div class="row">
        <div class="col-6">
          <label class="col-12" for="input-vehiclesNo">Broj vozila:</label>
          <input name="vehiclesNo" [ngModelOptions]="{standalone: true}"
                 [(ngModel)]="vehiclesNo"
                 fullWidth nbInput id="input-vehiclesNo"
                 placeholder="0" step="1" type="number" min="1">
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <button nbButton status="primary" type="submit" fullWidth>Odaberi</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div *ngIf="vehiclesNo > 0" class="row pt-4">
  <div *ngFor="let vehicle of vehicles$ | async; let i = index" class="col-6">
    <form #transportForm="ngForm">

      <nb-card accent="danger">
        <nb-card-body>

          <div class="col-12 mb-2">
            <label class="label" for="input-licensePlate">Registarski broj tablice:</label>
            <input #licensePlate="ngModel"
                   [(ngModel)]="vehicle.licensePlate"
                   [attr.aria-invalid]="licensePlate.invalid && licensePlate.touched ? true : null"
                   [maxlength]="getConfigValue('forms.validation.licensePlate.maxLength')"
                   [minLength]="getConfigValue('forms.validation.licensePlate.minLength')"
                   [ngModelOptions]="{standalone: true}"
                   [pattern]="getConfigValue('forms.validation.licensePlate.pattern')"
                   [required]="getConfigValue('forms.validation.licensePlate.required')"
                   [status]="licensePlate.dirty ? (licensePlate.invalid  ? 'danger' : 'success') : 'basic'"
                   fullWidth
                   id="input-licensePlate"
                   name="licensePlate"
                   nbInput
                   oninput="this.value = this.value.toUpperCase()"
                   placeholder="NS-234-DS">
            <ng-container *ngIf="(licensePlate.invalid && licensePlate.touched) || checkIssues">
              <p class="error-message mt-1 mb-0" *ngIf="licensePlate.errors?.required">
                Registarski broj tablica je obavezan!
              </p>
              <p class="error-message mt-1 mb-0" *ngIf="licensePlate.errors?.pattern || licensePlate.errors?.minLength">
                Registarski broj tablica mora biti validan (npr. BG-234-AA)!
              </p>
            </ng-container>
          </div>

          <div class="col-12 mb-2">
            <label class="label" for="input-vehicleType">Vrsta vozila:</label>
            <nb-select
              #vehicleType="ngModel"
              [(ngModel)]="vehicle.type"
              [attr.aria-invalid]="vehicleType.invalid && vehicleType.touched ? true : null"
              [ngModelOptions]="{standalone: true}"
              [required]="getConfigValue('forms.validation.vehicleType.required')"
              [status]="vehicleType.dirty ? (vehicleType.invalid  ? 'danger' : 'success') : 'basic'"
              fullWidth
              id="input-vehicleType"
              name="vehicleType"
              placeholder="Odaberi">
              <nb-option value="kamion">Kamion</nb-option>
              <nb-option value="kombi">Kombi</nb-option>
              <nb-option value="automobil">Automobil</nb-option>
            </nb-select>
            <ng-container *ngIf="(vehicleType.invalid && vehicleType.touched) || checkIssues">
              <p class="error-message mt-1 mb-0" *ngIf="!vehicleType.value">
                Vrsta vozila je obavezna!
              </p>
            </ng-container>
          </div>

        </nb-card-body>
      </nb-card>
    </form>
  </div>
</div>

<register-trash-permit #permitRef [permitType]="'transport'"></register-trash-permit>
