(function(){var e,t,n,r,o,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,C,S,k,O,_,T,E,A,R,N,B,D,P,M,I,L,F,z,H,V,j,U,W,q,G,$,X=[].slice,K={}.hasOwnProperty,Y=function(e,t){function n(){this.constructor=e}for(var r in t)K.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},J=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};for(x={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},E=function(){var e;return null!=(e="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?e:+new Date},R=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,y=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==R&&(R=function(e){return setTimeout(e,50)},y=function(e){return clearTimeout(e)}),B=function(e){var t,n;return t=E(),(n=function(){var r;return(r=E()-t)>=33?(t=E(),e(r,function(){return R(n)})):setTimeout(n,33-r)})()},N=function(){var e,t,n;return n=arguments[0],t=arguments[1],e=3<=arguments.length?X.call(arguments,2):[],"function"==typeof n[t]?n[t].apply(n,e):n[t]},w=function(){var e,t,n,r,o,i,u;for(t=arguments[0],i=0,u=(r=2<=arguments.length?X.call(arguments,1):[]).length;u>i;i++)if(n=r[i])for(e in n)K.call(n,e)&&(o=n[e],null!=t[e]&&"object"==typeof t[e]&&null!=o&&"object"==typeof o?w(t[e],o):t[e]=o);return t},h=function(e){var t,n,r,o;for(n=t=0,r=0,o=e.length;o>r;r++)n+=Math.abs(e[r]),t++;return n/t},S=function(e,t){var n,r;if(null==e&&(e="options"),null==t&&(t=!0),r=document.querySelector("[data-pace-"+e+"]")){if(n=r.getAttribute("data-pace-"+e),!t)return n;try{return JSON.parse(n)}catch(i){return"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",i):void 0}}},u=function(){function e(){}return e.prototype.on=function(e,t,n,r){var o;return null==r&&(r=!1),null==this.bindings&&(this.bindings={}),null==(o=this.bindings)[e]&&(o[e]=[]),this.bindings[e].push({handler:t,ctx:n,once:r})},e.prototype.once=function(e,t,n){return this.on(e,t,n,!0)},e.prototype.off=function(e,t){var n,r,o;if(null!=(null!=(r=this.bindings)?r[e]:void 0)){if(null==t)return delete this.bindings[e];for(n=0,o=[];n<this.bindings[e].length;)o.push(this.bindings[e][n].handler===t?this.bindings[e].splice(n,1):n++);return o}},e.prototype.trigger=function(){var e,t,n,r,o,i,u,a;if(n=arguments[0],e=2<=arguments.length?X.call(arguments,1):[],null!=(i=this.bindings)?i[n]:void 0){for(r=0,a=[];r<this.bindings[n].length;)o=(u=this.bindings[n][r]).once,u.handler.apply(null!=(t=u.ctx)?t:this,e),a.push(o?this.bindings[n].splice(r,1):r++);return a}},e}(),s=window.Pace||{},window.Pace=s,w(s,u.prototype),A=s.options=w({},x,window.paceOptions,S()),j=0,W=(G=["ajax","document","eventLag","elements"]).length;W>j;j++)!0===A[I=G[j]]&&(A[I]=x[I]);c=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Y(t,e),t}(Error),t=function(){function e(){this.progress=0}return e.prototype.getElement=function(){var e;if(null==this.el){if(!(e=document.querySelector(A.target)))throw new c;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/pace-done/g,""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=e.firstChild?e.insertBefore(this.el,e.firstChild):e.appendChild(this.el)}return this.el},e.prototype.finish=function(){var e;return(e=this.getElement()).className=e.className.replace("pace-active",""),e.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},e.prototype.update=function(e){return this.progress=e,this.render()},e.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(e){c=e}return this.el=void 0},e.prototype.render=function(){var e,t,n,r,o,i;if(null==document.querySelector(A.target))return!1;for(e=this.getElement(),n="translate3d("+this.progress+"%, 0, 0)",r=0,o=(i=["webkitTransform","msTransform","transform"]).length;o>r;r++)e.children[0].style[i[r]]=n;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(e.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),this.progress>=100?t="99":(t=this.progress<10?"0":"",t+=0|this.progress),e.children[0].setAttribute("data-progress",""+t)),this.lastRenderedProgress=this.progress},e.prototype.done=function(){return this.progress>=100},e}(),a=function(){function e(){this.bindings={}}return e.prototype.trigger=function(e,t){var n,r,o,i;if(null!=this.bindings[e]){for(i=[],n=0,r=(o=this.bindings[e]).length;r>n;n++)i.push(o[n].call(this,t));return i}},e.prototype.on=function(e,t){var n;return null==(n=this.bindings)[e]&&(n[e]=[]),this.bindings[e].push(t)},e}(),V=window.XMLHttpRequest,H=window.XDomainRequest,z=window.WebSocket,C=function(e,t){var n,r;for(n in r=[],t.prototype)try{r.push(null==e[n]&&"function"!=typeof t[n]?"function"==typeof Object.defineProperty?Object.defineProperty(e,n,{get:function(){return t.prototype[n]},configurable:!0,enumerable:!0}):e[n]=t.prototype[n]:void 0)}catch(i){}return r},_=[],s.ignore=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?X.call(arguments,1):[],_.unshift("ignore"),n=t.apply(null,e),_.shift(),n},s.track=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?X.call(arguments,1):[],_.unshift("track"),n=t.apply(null,e),_.shift(),n},M=function(e){var t;if(null==e&&(e="GET"),"track"===_[0])return"force";if(!_.length&&A.ajax){if("socket"===e&&A.ajax.trackWebSockets)return!0;if(t=e.toUpperCase(),J.call(A.ajax.trackMethods,t)>=0)return!0}return!1},l=function(e){function t(){var e,n=this;t.__super__.constructor.apply(this,arguments),e=function(e){var t;return t=e.open,e.open=function(r,o,i){return M(r)&&n.trigger("request",{type:r,url:o,request:e}),t.apply(e,arguments)}},window.XMLHttpRequest=function(t){var n;return n=new V(t),e(n),n};try{C(window.XMLHttpRequest,V)}catch(r){}if(null!=H){window.XDomainRequest=function(){var t;return t=new H,e(t),t};try{C(window.XDomainRequest,H)}catch(r){}}if(null!=z&&A.ajax.trackWebSockets){window.WebSocket=function(e,t){var r;return r=null!=t?new z(e,t):new z(e),M("socket")&&n.trigger("request",{type:"socket",url:e,protocols:t,request:r}),r};try{C(window.WebSocket,z)}catch(r){}}}return Y(t,e),t}(a),U=null,P=function(e){var t,n,r,o;for(n=0,r=(o=A.ajax.ignoreURLs).length;r>n;n++)if("string"==typeof(t=o[n])){if(-1!==e.indexOf(t))return!0}else if(t.test(e))return!0;return!1},(k=function(){return null==U&&(U=new l),U})().on("request",function(t){var n,r,o,i;return i=t.type,o=t.request,P(t.url)||s.running||!1===A.restartOnRequestAfter&&"force"!==M(i)?void 0:(r=arguments,"boolean"==typeof(n=A.restartOnRequestAfter||0)&&(n=0),setTimeout(function(){var t,n,u,a,c;if("socket"===i?o.readyState<2:0<(u=o.readyState)&&4>u){for(s.restart(),c=[],t=0,n=(a=s.sources).length;n>t;t++){if((I=a[t])instanceof e){I.watch.apply(I,r);break}c.push(void 0)}return c}},n))}),e=function(){function e(){var e=this;this.elements=[],k().on("request",function(){return e.watch.apply(e,arguments)})}return e.prototype.watch=function(e){var t,n,r;return r=e.type,t=e.request,P(e.url)?void 0:(n="socket"===r?new m(t):new g(t),this.elements.push(n))},e}(),g=function(e){var t,n,r,o,i=this;if(this.progress=0,null!=window.ProgressEvent)for(e.addEventListener("progress",function(e){return i.progress=e.lengthComputable?100*e.loaded/e.total:i.progress+(100-i.progress)/2},!1),t=0,n=(o=["load","abort","timeout","error"]).length;n>t;t++)e.addEventListener(o[t],function(){return i.progress=100},!1);else r=e.onreadystatechange,e.onreadystatechange=function(){var t;return 0===(t=e.readyState)||4===t?i.progress=100:3===e.readyState&&(i.progress=50),"function"==typeof r?r.apply(null,arguments):void 0}},m=function(e){var t,n,r,o=this;for(this.progress=0,t=0,n=(r=["error","open"]).length;n>t;t++)e.addEventListener(r[t],function(){return o.progress=100},!1)},r=function(e){var t,n,r;for(null==e&&(e={}),this.elements=[],null==e.selectors&&(e.selectors=[]),t=0,n=(r=e.selectors).length;n>t;t++)this.elements.push(new o(r[t]))},o=function(){function e(e){this.selector=e,this.progress=0,this.check()}return e.prototype.check=function(){var e=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return e.check()},A.elements.checkInterval)},e.prototype.done=function(){return this.progress=100},e}(),n=function(){function e(){var e,t,n=this;this.progress=null!=(t=this.states[document.readyState])?t:100,e=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof e?e.apply(null,arguments):void 0}}return e.prototype.states={loading:0,interactive:50,complete:100},e}(),i=function(){var e,t,n,r,o,i=this;this.progress=0,e=0,o=[],r=0,n=E(),t=setInterval(function(){var u;return u=E()-n-50,n=E(),o.push(u),o.length>A.eventLag.sampleCount&&o.shift(),e=h(o),++r>=A.eventLag.minSamples&&e<A.eventLag.lagThreshold?(i.progress=100,clearInterval(t)):i.progress=3/(e+3)*100},50)},d=function(){function e(e){this.source=e,this.last=this.sinceLastUpdate=0,this.rate=A.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=N(this.source,"progress"))}return e.prototype.tick=function(e,t){var n;return null==t&&(t=N(this.source,"progress")),t>=100&&(this.done=!0),t===this.last?this.sinceLastUpdate+=e:(this.sinceLastUpdate&&(this.rate=(t-this.last)/this.sinceLastUpdate),this.catchup=(t-this.progress)/A.catchupTime,this.sinceLastUpdate=0,this.last=t),t>this.progress&&(this.progress+=this.catchup*e),n=1-Math.pow(this.progress/100,A.easeFactor),this.progress+=n*this.rate*e,this.progress=Math.min(this.lastProgress+A.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},e}(),L=null,D=null,v=null,F=null,p=null,b=null,s.running=!1,O=function(){return A.restartOnPushState?s.restart():void 0},null!=window.history.pushState&&(q=window.history.pushState,window.history.pushState=function(){return O(),q.apply(window.history,arguments)}),null!=window.history.replaceState&&($=window.history.replaceState,window.history.replaceState=function(){return O(),$.apply(window.history,arguments)}),f={ajax:e,elements:r,document:n,eventLag:i},(T=function(){var e,n,r,o,i,u,a,c;for(s.sources=L=[],n=0,o=(u=["ajax","elements","document","eventLag"]).length;o>n;n++)!1!==A[e=u[n]]&&L.push(new f[e](A[e]));for(r=0,i=(c=null!=(a=A.extraSources)?a:[]).length;i>r;r++)L.push(new(I=c[r])(A));return s.bar=v=new t,D=[],F=new d})(),s.stop=function(){return s.trigger("stop"),s.running=!1,v.destroy(),b=!0,null!=p&&("function"==typeof y&&y(p),p=null),T()},s.restart=function(){return s.trigger("restart"),s.stop(),s.start()},s.go=function(){var e;return s.running=!0,v.render(),e=E(),b=!1,p=B(function(t,n){var r,o,i,u,a,c,l,f,m,g,p,h,y;for(r=f=0,o=!0,u=m=0,p=L.length;p>m;u=++m)for(I=L[u],l=null!=D[u]?D[u]:D[u]=[],a=g=0,h=(i=null!=(y=I.elements)?y:[I]).length;h>g;a=++g)o&=(c=null!=l[a]?l[a]:l[a]=new d(i[a])).done,c.done||(r++,f+=c.tick(t));return v.update(F.tick(t,f/r)),v.done()||o||b?(v.update(100),s.trigger("done"),setTimeout(function(){return v.finish(),s.running=!1,s.trigger("hide")},Math.max(A.ghostTime,Math.max(A.minTime-(E()-e),0)))):n()})},s.start=function(e){w(A,e),s.running=!0;try{v.render()}catch(t){c=t}return document.querySelector(".pace")?(s.trigger("start"),s.go()):setTimeout(s.start,50)},"function"==typeof define&&define.amd?define(["pace"],function(){return s}):"object"==typeof exports?module.exports=s:A.startOnPageLoad&&s.start()}).call(this),function(){"use strict";var e=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},t=function(e){return{eq:e}},n=t(function(e,t){return e===t}),r=function(e){return t(function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},o=function(e,n){return o=r(e),i=function(e){return t=n,Array.prototype.slice.call(e).sort(t);var t},t(function(e,t){return o.eq(i(e),i(t))});var o,i},i=function(e){return t(function(t,r){var i=Object.keys(t),u=Object.keys(r);if(!o(n).eq(i,u))return!1;for(var a=i.length,c=0;c<a;c++){var s=i[c];if(!e.eq(t[s],r[s]))return!1}return!0})},u=t(function(t,n){if(t===n)return!0;var o=e(t);return o===e(n)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(o)?t===n:"array"===o?r(u).eq(t,n):"object"===o&&i(u).eq(t,n))}),a=function(){},c=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},s=function(e){return function(){return e}},l=function(e){return e};function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var d,m,g,p=function(e){return function(t){return!e(t)}},h=function(e){return function(){throw new Error(e)}},v=function(e){return e()},b=function(e){e()},y=s(!1),x=s(!0),w=function(){return C},C=(d=function(e){return e.isNone()},{fold:function(e,t){return e()},is:y,isSome:y,isNone:x,getOr:g=function(e){return e},getOrThunk:m=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:g,orThunk:m,map:w,each:a,bind:w,exists:y,forall:x,filter:w,equals:d,equals_:d,toArray:function(){return[]},toString:s("none()")}),S=function(e){var t=s(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:x,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return S(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(y,function(t){return n(e,t)})}};return o},k={some:S,none:w,from:function(e){return null==e?C:S(e)}},O=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},_=function(e){return function(t){return typeof t===e}},T=function(e){return function(t){return e===t}},E=O("string"),A=O("object"),R=O("array"),N=T(null),B=_("boolean"),D=T(void 0),P=function(e){return null==e},M=function(e){return!P(e)},I=_("function"),L=_("number"),F=Array.prototype.slice,z=Array.prototype.indexOf,H=Array.prototype.push,V=function(e,t){return z.call(e,t)},j=function(e,t){return-1<V(e,t)},U=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},W=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o],o);return r},q=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},G=function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)},$=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},X=function(e,t,n){return G(e,function(e){n=t(n,e)}),n},K=function(e,t,n){return q(e,function(e){n=t(n,e)}),n},Y=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return k.some(i);if(n(i,r))break}return k.none()}(e,t,y)},J=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return k.some(n);return k.none()},Q=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!R(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);H.apply(t,e[n])}return t}(W(e,t))},Z=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0},ee=function(e){var t=F.call(e,0);return t.reverse(),t},te=function(e,t){return $(e,function(e){return!j(t,e)})},ne=function(e,t){return 0<=t&&t<e.length?k.some(e[t]):k.none()},re=function(e){return ne(e,0)},oe=function(e){return ne(e,e.length-1)},ie=I(Array.from)?Array.from:function(e){return F.call(e)},ue=Object.keys,ae=Object.hasOwnProperty,ce=function(e,t){for(var n=ue(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},se=function(e,t){return le(e,function(e,n){return{k:n,v:t(e,n)}})},le=function(e,t){var n={};return ce(e,function(e,r){var o=t(e,r);n[o.k]=o.v}),n},fe=function(e){return function(t,n){e[n]=t}},de=function(e,t,n,r){return ce(e,function(e,o){(t(e,o)?n:r)(e,o)}),{}},me=function(e,t){var n={},r={};return de(e,t,fe(n),fe(r)),{t:n,f:r}},ge=function(e,t){var n={};return de(e,t,fe(n),a),n},pe=function(e,t){return he(e,t)?k.from(e[t]):k.none()},he=function(e,t){return ae.call(e,t)},ve=function(e,t){return he(e,t)&&null!=e[t]},be=Array.isArray,ye=function(e,t,n){var r,o;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return!1;return!0},xe=function(e,t){var n=[];return ye(e,function(r,o){n.push(t(r,o,e))}),n},we=function(e,t){var n=[];return ye(e,function(r,o){t&&!t(r,o,e)||n.push(r)}),n},Ce=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Se=function(e,t,n,r){for(var o=D(n)?e[0]:n,i=0;i<e.length;i++)o=t.call(r,o,e[i],i);return o},ke=function(e,t,n){for(var r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},Oe=function(e){return e[e.length-1]},_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Te(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var Ee,Ae,Re,Ne,Be,De=function(){return Pe(0,0)},Pe=function(e,t){return{major:e,minor:t}},Me=function(e,t){var n=String(t).toLowerCase();return 0===e.length?De():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Pe(r(1),r(2))}(e,n)},Ie=De,Le=function(e,t){var n=String(t).toLowerCase();return Y(e,function(e){return e.search(n)})},Fe=function(e,t){return-1!==e.indexOf(t)},ze=function(e,t){return n=e,""===(r=t)||n.length>=r.length&&n.substr(0,0+r.length)===r;var n,r},He=function(e){return function(t){return t.replace(e,"")}},Ve=He(/^\s+|\s+$/g),je=He(/^\s+/g),Ue=He(/\s+$/g),We=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qe=function(e){return function(t){return Fe(t,e)}},Ge=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Fe(e,"edge/")&&Fe(e,"chrome")&&Fe(e,"safari")&&Fe(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,We],search:function(e){return Fe(e,"chrome")&&!Fe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Fe(e,"msie")||Fe(e,"trident")}},{name:"Opera",versionRegexes:[We,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qe("firefox")},{name:"Safari",versionRegexes:[We,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Fe(e,"safari")||Fe(e,"mobile/"))&&Fe(e,"applewebkit")}}],$e=[{name:"Windows",search:qe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Fe(e,"iphone")||Fe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qe("linux"),versionRegexes:[]},{name:"Solaris",search:qe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:qe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Xe={browsers:s(Ge),oses:s($e)},Ke="Firefox",Ye=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Ke),isSafari:n("Safari")}},Je=function(){return Ye({current:void 0,version:Ie()})},Qe=Ye,Ze=(s("Edge"),s("Chrome"),s("IE"),s("Opera"),s(Ke),s("Safari"),"Windows"),et="Android",tt="Solaris",nt="FreeBSD",rt="ChromeOS",ot=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(Ze),isiOS:n("iOS"),isAndroid:n(et),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(tt),isFreeBSD:n(nt),isChromeOS:n(rt)}},it=function(){return ot({current:void 0,version:Ie()})},ut=ot,at=(s(Ze),s("iOS"),s(et),s("Linux"),s("OSX"),s(tt),s(nt),s(rt),function(e,t){var n,r,o,i,u,a,c,l,f,d,m,g,p=Xe.browsers(),h=Xe.oses(),v=function(e,t){return Le(e,t).map(function(e){var n=Me(e.versionRegexes,t);return{current:e.name,version:n}})}(p,e).fold(Je,Qe),b=function(e,t){return Le(e,t).map(function(e){var n=Me(e.versionRegexes,t);return{current:e.name,version:n}})}(h,e).fold(it,ut);return{browser:v,os:b,deviceType:(r=v,o=e,i=t,u=(n=b).isiOS()&&!0===/ipad/i.test(o),a=n.isiOS()&&!u,c=n.isiOS()||n.isAndroid(),l=c||i("(pointer:coarse)"),f=u||!a&&c&&i("(min-device-width:768px)"),d=a||c&&!f,m=r.isSafari()&&n.isiOS()&&!1===/safari/i.test(o),g=!d&&!f&&!m,{isiPad:s(u),isiPhone:s(a),isTablet:s(f),isPhone:s(d),isTouch:s(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:s(m),isDesktop:s(g)})}}),ct=function(e){return window.matchMedia(e).matches},st=(Re=!(Ee=function(){return at(navigator.userAgent,ct)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Re||(Re=!0,Ae=Ee.apply(null,e)),Ae}),lt=function(){return st()},ft=navigator.userAgent,dt=lt(),mt=dt.browser,gt=dt.os,pt=dt.deviceType,ht=/WebKit/.test(ft)&&!mt.isEdge(),vt="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,bt=-1!==ft.indexOf("Windows Phone"),yt={opera:mt.isOpera(),webkit:ht,ie:!(!mt.isIE()&&!mt.isEdge())&&mt.version.major,gecko:mt.isFirefox(),mac:gt.isOSX()||gt.isiOS(),iOS:pt.isiPad()||pt.isiPhone(),android:gt.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:mt.isIE()?document.documentMode||7:10,fileApi:vt,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!mt.isIE(),desktop:pt.isDesktop(),windowsPhone:bt,browser:{current:mt.current,version:mt.version,isChrome:mt.isChrome,isEdge:mt.isEdge,isFirefox:mt.isFirefox,isIE:mt.isIE,isOpera:mt.isOpera,isSafari:mt.isSafari},os:{current:gt.current,version:gt.version,isAndroid:gt.isAndroid,isChromeOS:gt.isChromeOS,isFreeBSD:gt.isFreeBSD,isiOS:gt.isiOS,isLinux:gt.isLinux,isOSX:gt.isOSX,isSolaris:gt.isSolaris,isWindows:gt.isWindows},deviceType:{isDesktop:pt.isDesktop,isiPad:pt.isiPad,isiPhone:pt.isiPhone,isPhone:pt.isPhone,isTablet:pt.isTablet,isTouch:pt.isTouch,isWebView:pt.isWebView}},xt=/^\s*|\s*$/g,wt=function(e){return null==e?"":(""+e).replace(xt,"")},Ct=function(e,t){return t?!("array"!==t||!be(e))||typeof e===t:void 0!==e},St=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),ye(e,function(e,o){return!1!==t.call(r,e,o,n)&&void St(e,t,n,r)}))},kt={trim:wt,isArray:be,is:Ct,toArray:function(e){if(be(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:ye,map:xe,grep:we,inArray:Ce,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o,i=t[r];for(var u in i)!i.hasOwnProperty(u)||void 0!==(o=i[u])&&(e[u]=o)}return e},create:function(e,t,n){var r,o,i,u=this,c=0,s=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],l=u.createNS(e[3].replace(/\.\w+$/,""),n);if(!l[s]){if("static"===e[2])return l[s]=t,void(this.onCreate&&this.onCreate(e[2],e[3],l[s]));t[s]||(t[s]=a,c=1),l[s]=t[s],u.extend(l[s].prototype,t),e[5]&&(r=u.resolve(e[5]).prototype,o=e[5].match(/\.(\w+)$/i)[1],i=l[s],l[s]=c?function(){return r[o].apply(this,arguments)}:function(){return this.parent=r[o],i.apply(this,arguments)},l[s].prototype[s]=l[s],u.each(r,function(e,t){l[s].prototype[t]=r[t]}),u.each(t,function(e,t){r[t]?l[s].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==s&&(l[s].prototype[t]=e)})),u.each(t.static,function(e,t){l[s][t]=e})}},walk:St,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||Ct(e,"array")?e:xe(e.split(t||","),wt)},_addCacheSuffix:function(e){var t=yt.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},Ot=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},_t=function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Ot(n.childNodes[0])},Tt=function(e,t){var n=(t||document).createElement(e);return Ot(n)},Et=function(e,t){var n=(t||document).createTextNode(e);return Ot(n)},At=Ot,Rt=function(e,t){for(var n=[],r=function(e){return n.push(e),t(e)},o=t(e);(o=o.bind(r)).isSome(););return n},Nt=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Bt=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Dt=function(e,t){return e.dom===t.dom},Pt=function(e,t){return lt().browser.isIE()?function(e,t){return n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.dom.compareDocumentPosition(t.dom)&n);var n}(e,t):(n=e.dom)!==(r=t.dom)&&n.contains(r);var n,r},Mt=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),It=function(e){return e.dom.nodeType},Lt=function(e){return function(t){return It(t)===e}},Ft=Lt(1),zt=Lt(3),Ht=Lt(9),Vt=Lt(11),jt=function(e){return At(e.dom.ownerDocument)},Ut=function(e){return Ht(e)?e:jt(e)},Wt=function(e){return k.from(e.dom.parentNode).map(At)},qt=function(e){return k.from(e.dom.previousSibling).map(At)},Gt=function(e){return k.from(e.dom.nextSibling).map(At)},$t=function(e){return ee(Rt(e,qt))},Xt=function(e){return Rt(e,Gt)},Kt=function(e){return W(e.dom.childNodes,At)},Yt=function(e,t){return k.from(e.dom.childNodes[t]).map(At)},Jt=function(e){return Yt(e,0)},Qt=function(e){return Yt(e,e.dom.childNodes.length-1)},Zt=function(e){return Vt(e)&&M(e.dom.host)},en=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode),tn=s(en),nn=en?function(e){return At(e.dom.getRootNode())}:Ut,rn=function(e){return Zt(e)?e:function(e){var t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return At(t)}(Ut(e))},on=function(e){return At(e.dom.host)},un=function(e,t){Wt(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},an=function(e,t){Gt(e).fold(function(){Wt(e).each(function(e){sn(e,t)})},function(e){un(e,t)})},cn=function(e,t){Jt(e).fold(function(){sn(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},sn=function(e,t){e.dom.appendChild(t.dom)},ln=function(e,t){q(t,function(t){sn(e,t)})},fn=function(e){e.dom.textContent="",q(Kt(e),function(e){dn(e)})},dn=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},mn=function(e){var t,n=Kt(e);0<n.length&&(t=e,q(n,function(e){un(t,e)})),dn(e)},gn=function(e){var t=zt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o,i,u=t.ownerDocument;return o=At(t),i=nn(o),(Zt(i)?k.some(i):k.none()).fold(function(){return u.body.contains(t)},(n=gn,r=on,function(e){return n(r(e))}))},pn=function(e,t){return{left:e,top:t,translate:function(n,r){return pn(e+n,t+r)}}},hn=pn,vn=function(e,t){return void 0!==e?e:void 0!==t?t:0},bn=function(e){var t,n=e.dom,r=n.ownerDocument.body;return r===n?hn(r.offsetLeft,r.offsetTop):gn(e)?(t=n.getBoundingClientRect(),hn(t.left,t.top)):hn(0,0)},yn=function(e){var t=void 0!==e?e.dom:document;return hn(t.body.scrollLeft||t.documentElement.scrollLeft,t.body.scrollTop||t.documentElement.scrollTop)},xn=function(e,t){lt().browser.isSafari()&&I(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},wn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},Cn=function(e){var t,n,r=void 0===e?window:e,o=yn(At(r.document));return n=void 0===(t=r)?window:t,k.from(n.visualViewport).fold(function(){var e=r.document.documentElement;return wn(o.left,o.top,e.clientWidth,e.clientHeight)},function(e){return wn(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)})},Sn=function(e){return function(t){return!!t&&t.nodeType===e}},kn=function(e){return!!e&&!Object.getPrototypeOf(e)},On=Sn(1),_n=function(e){var t=e.map(function(e){return e.toLowerCase()});return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return j(t,n)}return!1}},Tn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){var r;if(On(t))for(r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},En=function(e){return function(t){return On(t)&&t.hasAttribute(e)}},An=function(e){return On(e)&&e.hasAttribute("data-mce-bogus")},Rn=function(e){return On(e)&&"TABLE"===e.tagName},Nn=function(e){return function(t){if(On(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},Bn=_n(["textarea","input"]),Dn=Sn(3),Pn=Sn(8),Mn=Sn(9),In=Sn(11),Ln=_n(["br"]),Fn=_n(["img"]),zn=Nn("true"),Hn=Nn("false"),Vn=_n(["td","th"]),jn=_n(["video","audio","object","embed"]),Un=function(e){return void 0!==e.style&&I(e.style.getPropertyValue)},Wn=function(e,t,n){if(!(E(n)||B(n)||L(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},qn=function(e,t,n){Wn(e.dom,t,n)},Gn=function(e,t){var n=e.dom;ce(t,function(e,t){Wn(n,t,e)})},$n=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Xn=function(e,t){return k.from($n(e,t))},Kn=function(e,t){e.dom.removeAttribute(t)},Yn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||gn(e)?r:Jn(n,t)},Jn=function(e,t){return Un(e)?e.style.getPropertyValue(t):""},Qn=function(e,t){var n=Jn(e.dom,t);return k.from(n).filter(function(e){return 0<e.length})},Zn=function(e){var t={},n=e.dom;if(Un(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},er=lt().browser,tr=function(e){return Y(e,Ft)},nr=function(e,t){return e.children&&j(e.children,t)},rr={},or={exports:rr};Ne=rr,Be=or,function(e){"object"==typeof Ne&&void 0!==Be?Be.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[u]={exports:{}};t[u][0].call(s.exports,function(e){return o(t[u][1][e]||e)},s,s.exports,e,t,n,r)}return n[u].exports}for(var i=!1,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var e=c(m);f=!0;for(var t=l.length;t;){for(s=l,l=[];++d<t;)s&&s[d].run();d=-1,t=l.length}s=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){function n(){}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(l){return void u(t.promise,l)}i(t.promise,n)}else(1===e._state?i:u)(t.promise,e._value)})):e._deferreds.push(t)}function i(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void a(e);if("function"==typeof n)return void s((o=n,c=t,function(){o.apply(c,arguments)}),e)}e._state=1,e._value=t,a(e)}catch(i){u(e,i)}var o,c}function u(e,t){e._state=2,e._value=t,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function s(e,t){var r=!1;try{e(function(e){r||(r=!0,i(t,e))},function(e){r||(r=!0,u(t,e))})}catch(n){if(r)return;r=!0,u(t,n)}}var l;l=setTimeout,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new c(e,t,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,r){if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)!function i(u,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(e){i(u,e)},r)}t[u]=a,0==--o&&e(t)}catch(n){r(n)}}(i,t[i])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},r._immediateFn="function"==typeof e?function(t){e(t)}:function(e){l(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=r:this.Promise||(this.Promise=r)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){var o=e("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,o(function(){a[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete a[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var ir=or.exports.boltExport,ur=function(e){var t=k.none(),n=[],r=function(e){o()?i(e):n.push(e)},o=function(){return t.isSome()},i=function(e){t.each(function(t){setTimeout(function(){e(t)},0)})};return e(function(e){o()||(t=k.some(e),function(e){q(e,i)}(n),n=[])}),{get:r,map:function(e){return ur(function(t){r(function(n){t(e(n))})})},isReady:o}},ar={nu:ur,pure:function(e){return ur(function(t){t(e)})}},cr=function(e){setTimeout(function(){throw e},0)},sr=function(e){var t=function(t){e().then(t,cr)};return{map:function(t){return sr(function(){return e().then(t)})},bind:function(t){return sr(function(){return e().then(function(e){return t(e).toPromise()})})},anonBind:function(t){return sr(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return ar.nu(t)},toCached:function(){var t=null;return sr(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},lr=function(e){return sr(function(){return new ir(e)})},fr=function(e){return{is:function(t){return e===t},isValue:x,isError:y,getOr:s(e),getOrThunk:s(e),getOrDie:s(e),or:function(t){return fr(e)},orThunk:function(t){return fr(e)},fold:function(t,n){return n(e)},map:function(t){return fr(t(e))},mapError:function(t){return fr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return k.some(e)}}},dr=function(e){return{is:y,isValue:y,isError:x,getOr:l,getOrThunk:function(e){return e()},getOrDie:function(){return h(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return dr(e)},mapError:function(t){return dr(t(e))},each:a,bind:function(t){return dr(e)},exists:y,forall:x,toOptional:k.none}},mr={value:fr,error:dr,fromOption:function(e,t){return e.fold(function(){return dr(t)},fr)}},gr=function(e){if(!R(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return q(e,function(r,o){var i=ue(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!R(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:function(e){var r=ue(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!Z(t,function(e){return j(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:u,params:n})}}}}),n},pr=(gr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e){return e.fold(l,l)});function hr(e,t,n,r,o){return e(n,r)?k.some(n):I(o)&&o(n)?k.none():t(n,r,o)}var vr,br,yr,xr,wr,Cr,Sr=function(e,t,n){for(var r=e.dom,o=I(n)?n:y;r.parentNode;){var i=At(r=r.parentNode);if(t(i))return k.some(i);if(o(i))break}return k.none()},kr=function(e,t,n){return hr(function(e,t){return t(e)},Sr,e,t,n)},Or=function(e,t,n){return Sr(e,function(e){return Nt(e,t)},n)},_r=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Bt(o)?k.none():k.from(o.querySelector(n)).map(At);var n,r,o},Tr=function(e,t,n){return hr(Nt,Or,e,t,n)},Er=window.Promise?window.Promise:(vr=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.apply(t,n)}},br=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},xr=(yr=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],wr(e,vr(Rr,this),vr(Nr,this))}).immediateFn||"function"==typeof setImmediate&&setImmediate||function(e){return setTimeout(e,1)},wr=function(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(l){if(r)return;r=!0,n(l)}},yr.prototype.catch=function(e){return this.then(null,e)},yr.prototype.then=function(e,t){var n=this;return new yr(function(r,o){Ar.call(n,new Dr(e,t,r,o))})},yr.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Array.prototype.slice.call(1===t.length&&br(t[0])?t[0]:t);return new yr(function(t,n){if(0===r.length)return t([]);for(var o=r.length,i=function(u,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(e){i(u,e)},n)}r[u]=a,0==--o&&t(r)}catch(e){n(e)}},u=0;u<r.length;u++)i(u,r[u])})},yr.resolve=function(e){return e&&"object"==typeof e&&e.constructor===yr?e:new yr(function(t){t(e)})},yr.reject=function(e){return new yr(function(t,n){n(e)})},yr.race=function(e){return new yr(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},yr);function Ar(e){var t=this;null!==this._state?xr(function(){var n,r=t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(m){return void e.reject(m)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)}):this._deferreds.push(e)}function Rr(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void wr(vr(t,e),vr(Rr,this),vr(Nr,this))}this._state=!0,this._value=e,Br.call(this)}catch(m){Nr.call(this,m)}}function Nr(e){this._state=!1,this._value=e,Br.call(this)}function Br(){for(var e=0,t=this._deferreds.length;e<t;e++)Ar.call(this,this._deferreds[e]);this._deferreds=null}function Dr(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}var Pr,Mr=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},Ir=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},Lr=function(e,t){var n,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=Mr(function(){e.apply(this,r)},t)};return r.stop=function(){clearTimeout(n)},r},Fr={requestAnimationFrame:function(e,t){Cr?Cr.then(e):Cr=new Er(function(e){!function(e,t){for(var n=window.requestAnimationFrame,r=["ms","moz","webkit"],o=0;o<r.length&&!n;o++)n=window[r[o]+"RequestAnimationFrame"];(n=n||function(e){window.setTimeout(e,0)})(e,t)}(e,t=t||document.body)}).then(e)},setTimeout:Mr,setInterval:Ir,setEditorTimeout:function(e,t,n){return Mr(function(){e.removed||t()},n)},setEditorInterval:function(e,t,n){var r=Ir(function(){e.removed?clearInterval(r):t()},n);return r},debounce:Lr,throttle:Lr,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}},zr=function(e,t){void 0===t&&(t={});var n=0,r={},o=At(e),i=Ut(o),u=t.maxLoadTime||5e3,a=function(a,c,s){var l,f=kt._addCacheSuffix(a),d=pe(r,f).getOrThunk(function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}});(r[f]=d).count++;var m,g,p,h=function(e,t){for(var n=e.length;n--;)e[n]();d.status=t,d.passed=[],d.failed=[],l&&(l.onload=null,l.onerror=null,l=null)},v=function(){return h(d.passed,2)},b=function(){return h(d.failed,3)},y=function(){var t;t=y,function(){for(var t=e.styleSheets,n=t.length;n--;){var r=t[n].ownerNode;if(r&&r.id===l.id)return v(),1}}()||(Date.now()-g<u?Fr.setTimeout(t):b())};c&&d.passed.push(c),s&&d.failed.push(s),1!==d.status&&(2!==d.status?3!==d.status?(d.status=1,m=Tt("link",i.dom),Gn(m,{rel:"stylesheet",type:"text/css",id:d.id}),g=Date.now(),t.contentCssCors&&qn(m,"crossOrigin","anonymous"),t.referrerPolicy&&qn(m,"referrerpolicy",t.referrerPolicy),(l=m.dom).onload=y,l.onerror=b,p=m,sn(rn(o),p),qn(m,"href",f)):b():v())},l=function(e){return lr(function(t){a(e,c(t,s(mr.value(e))),c(t,s(mr.error(e))))})},f=function(e){var t=kt._addCacheSuffix(e);pe(r,t).each(function(e){var n,i;0==--e.count&&(delete r[t],n=e.id,i=rn(o),_r(i,"#"+n).each(dn))})};return{load:a,loadAll:function(e,t,n){(function(e,t){return t(function(t){var n=[],r=0;0===e.length?t([]):q(e,function(o,i){var u;o.get((u=i,function(o){n[u]=o,++r>=e.length&&t(n)}))})})})(W(e,l),lr).get(function(e){var r=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u)?n:r).push(u)}return{pass:n,fail:r}}(e,function(e){return e.isValue()});0<r.fail.length?n(r.fail.map(pr)):t(r.pass.map(pr))})},unload:f,unloadAll:function(e){q(e,function(e){f(e)})},_setReferrerPolicy:function(e){t.referrerPolicy=e}}},Hr=(Pr=new WeakMap,{forElement:function(e,t){var n=nn(e).dom;return k.from(Pr.get(n)).getOrThunk(function(){var e=zr(n,t);return Pr.set(n,e),e})}}),Vr=(jr.prototype.current=function(){return this.node},jr.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},jr.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},jr.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},jr.prototype.findSibling=function(e,t,n,r){var o,i;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(o=e[n])return o;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(o=i[n])return o}}},jr.prototype.findPreviousNode=function(e,t,n,r){var o,i,u;if(e){if(o=e[n],this.rootNode&&o===this.rootNode)return;if(o){if(!r)for(u=o[t];u;u=u[t])if(!u[t])return u;return o}if((i=e.parentNode)&&i!==this.rootNode)return i}},jr);function jr(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}var Ur=function(e){var t;return function(n){return(t=t||function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,x)).hasOwnProperty(Mt(n))}},Wr=Ur(["h1","h2","h3","h4","h5","h6"]),qr=Ur(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Gr=function(e){return Ft(e)&&!qr(e)},$r=function(e){return Ft(e)&&"br"===Mt(e)},Xr=Ur(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Kr=Ur(["ul","ol","dl"]),Yr=Ur(["li","dd","dt"]),Jr=Ur(["thead","tbody","tfoot"]),Qr=Ur(["td","th"]),Zr=Ur(["pre","script","textarea","style"]),eo=" ",to="\ufeff",no=function(e){return"\ufeff"===e},ro=function(e){return e.replace(/\uFEFF/g,"")},oo=On,io=Dn,uo=function(e){return io(e)&&(e=e.parentNode),oo(e)&&e.hasAttribute("data-mce-caret")},ao=function(e){return io(e)&&no(e.data)},co=function(e){return uo(e)||ao(e)},so=function(e){return e.firstChild!==e.lastChild||!Ln(e.firstChild)},lo=function(e){var t=e.container();return!!Dn(t)&&(t.data.charAt(e.offset())===to||e.isAtStart()&&ao(t.previousSibling))},fo=function(e){var t=e.container();return!!Dn(t)&&(t.data.charAt(e.offset()-1)===to||e.isAtEnd()&&ao(t.nextSibling))},mo=function(e){return io(e)&&e.data[0]===to},go=function(e){return io(e)&&e.data[e.data.length-1]===to},po=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),An(n=t[t.length-1])&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},ho=zn,vo=Hn,bo=Ln,yo=Dn,xo=_n(["script","style","textarea"]),wo=_n(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Co=_n(["table"]),So=co,ko=function(e){return!So(e)&&(yo(e)?!xo(e.parentNode):wo(e)||bo(e)||Co(e)||Oo(e))},Oo=function(e){return!1===(On(t=e)&&"true"===t.getAttribute("unselectable"))&&vo(e);var t},_o=function(e,t){return ko(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Oo(e))return!1;if(ho(e))return!0}return!0}(e,t)},To=/^[ \t\r\n]*$/,Eo=function(e){return To.test(e)},Ao=function(e,t){return ko(e)&&!1===(o=t,Dn(r=e)&&Eo(r.data)&&!1===function(e,t){var n,r,o=At(t);return n=At(e),r=f(Dt,o),Or(n,"pre,code",r).isSome()}(r,o))||On(n=e)&&"A"===n.nodeName&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id"))||Ro(e);var n,r,o},Ro=En("data-mce-bookmark"),No=En("data-mce-bogus"),Bo=function(e){return On(e)&&"all"===e.getAttribute("data-mce-bogus")},Do=function(e,t){return void 0===t&&(t=!0),function(e,t){var n,r=0;if(Ao(e,e))return!1;if(!(n=e.firstChild))return!0;var o=new Vr(n,e);do{if(t){if(Bo(n)){n=o.next(!0);continue}if(No(n)){n=o.next();continue}}if(Ln(n))r++,n=o.next();else{if(Ao(n,e))return!1;n=o.next()}}while(n);return r<=1}(e.dom,t)},Po=function(e,t){return M(e)&&(Ao(e,t)||Gr(At(e)))},Mo=function(e){return"span"===e.nodeName.toLowerCase()&&"bookmark"===e.getAttribute("data-mce-type")},Io=function(e,t,n){var r=n||t;if(On(t)&&Mo(t))return t;for(var o,i,u,a=t.childNodes,c=a.length-1;0<=c;c--)Io(e,a[c],r);return!On(t)||1===(o=t.childNodes).length&&Mo(o[0])&&t.parentNode.insertBefore(o[0],t),In(u=t)||Mn(u)||Ao(t,r)||On(i=t)&&0<i.childNodes.length||function(e,t){return Dn(e)&&0<e.data.length&&(o=new Vr(n=e,r=t).prev(!1),i=new Vr(n,r).next(!1),u=D(o)||Po(o,r),a=D(i)||Po(i,r),u&&a);var n,r,o,i,u,a}(t,r)||e.remove(t),t},Lo=kt.makeMap,Fo=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,zo=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ho=/[<>&\"\']/g,Vo=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,jo={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},Uo={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Wo={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},qo=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),Uo[r]||(i[r]=o="&"+e[n+1]+";",i[o]=r);return i}},Go=qo("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),$o=function(e,t){return e.replace(t?Fo:zo,function(e){return Uo[e]||e})},Xo=function(e,t){return e.replace(t?Fo:zo,function(e){return 1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":Uo[e]||"&#"+e.charCodeAt(0)+";"})},Ko=function(e,t,n){return n=n||Go,e.replace(t?Fo:zo,function(e){return Uo[e]||n[e]||e})},Yo={encodeRaw:$o,encodeAllRaw:function(e){return(""+e).replace(Ho,function(e){return Uo[e]||e})},encodeNumeric:Xo,encodeNamed:Ko,getEncodeFunc:function(e,t){var n=qo(t)||Go,r=Lo(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?Fo:zo,function(e){return void 0!==Uo[e]?Uo[e]:void 0!==n[e]?n[e]:1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"})}:r.named?t?function(e,t){return Ko(e,t,n)}:Ko:r.numeric?Xo:$o},decode:function(e){return e.replace(Vo,function(e,t){return t?65535<(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):jo[t]||String.fromCharCode(t):Wo[e]||Go[e]||(n=e,(r=Tt("div").dom).innerHTML=n,r.textContent||r.innerText||n);var n,r})}},Jo={},Qo={},Zo=kt.makeMap,ei=kt.each,ti=kt.extend,ni=kt.explode,ri=kt.inArray,oi=function(e,t){return(e=kt.trim(e))?e.split(t||" "):[]},ii=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),ei(e,function(e,r){n[r]=n[r.toUpperCase()]=("map"===t?Zo:ni)(e,/[, ]/)})),n},ui=function(e){var t,n,r,o,i,u,a,c,s,l,f={},d={},m=[],g={},p={},h=function(t,n,r){var o=e[t];return o?o=Zo(o,/[, ]/,Zo(o.toUpperCase(),/[, ]/)):(o=Jo[t])||(o=Zo(n," ",Zo(n.toUpperCase()," ")),o=ti(o,r),Jo[t]=o),o},v=(t=(e=e||{}).schema,c={},s=function(e,t,r){var o,i,u=function(e,t){for(var n={},r=0,o=e.length;r<o;r++)n[e[r]]=t||{};return n};t=t||"","string"==typeof(r=r||[])&&(r=oi(r));for(var a=oi(e),s=a.length;s--;)i={attributes:u(o=oi([n,t].join(" "))),attributesOrder:o,children:u(r,Qo)},c[a[s]]=i},l=function(e,t){for(var n,r,o,i=oi(e),u=i.length,a=oi(t);u--;)for(n=c[i[u]],r=0,o=a.length;r<o;r++)n.attributes[a[r]]={},n.attributesOrder.push(a[r])},Jo[t]?Jo[t]:(n="id accesskey class dir lang style tabindex title role",r="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==t&&(n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",r+=" article aside details dialog figure main header footer hgroup section nav",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==t&&(n+=" xml:lang",o=[o,a="acronym applet basefont big font strike tt"].join(" "),ei(oi(a),function(e){s(e,"",o)}),r=[r,u="center dir isindex noframes"].join(" "),i=[r,o].join(" "),ei(oi(u),function(e){s(e,"",i)})),i=i||[r,o].join(" "),s("html","manifest","head body"),s("head","","base command link meta noscript script style title"),s("title hr noscript br"),s("base","href target"),s("link","href rel media hreflang type sizes hreflang"),s("meta","name http-equiv content charset"),s("style","media type scoped"),s("script","src async defer type charset"),s("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",i),s("address dt dd div caption","",i),s("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),s("blockquote","cite",i),s("ol","reversed start type","li"),s("ul","","li"),s("li","value",i),s("dl","","dt dd"),s("a","href target rel media hreflang type",o),s("q","cite",o),s("ins del","cite datetime",i),s("img","src sizes srcset alt usemap ismap width height"),s("iframe","src name width height",i),s("embed","src type width height"),s("object","data type typemustmatch name usemap form width height",[i,"param"].join(" ")),s("param","name value"),s("map","name",[i,"area"].join(" ")),s("area","alt coords shape href target rel media hreflang type"),s("table","border","caption colgroup thead tfoot tbody tr"+("html4"===t?" col":"")),s("colgroup","span","col"),s("col","span"),s("tbody thead tfoot","","tr"),s("tr","","td th"),s("td","colspan rowspan headers",i),s("th","colspan rowspan headers scope abbr",i),s("form","accept-charset action autocomplete enctype method name novalidate target",i),s("fieldset","disabled form name",[i,"legend"].join(" ")),s("label","form for",o),s("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),s("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===t?i:o),s("select","disabled form multiple name required size","option optgroup"),s("optgroup","disabled label","option"),s("option","disabled label selected value"),s("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),s("menu","type label",[i,"li"].join(" ")),s("noscript","",i),"html4"!==t&&(s("wbr"),s("ruby","",[o,"rt rp"].join(" ")),s("figcaption","",i),s("mark rt rp summary bdi","",o),s("canvas","width height",i),s("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[i,"track source"].join(" ")),s("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[i,"track source"].join(" ")),s("picture","","img source"),s("source","src srcset type media sizes"),s("track","kind src srclang label default"),s("datalist","",[o,"option"].join(" ")),s("article section nav aside main header footer","",i),s("hgroup","","h1 h2 h3 h4 h5 h6"),s("figure","",[i,"figcaption"].join(" ")),s("time","datetime",o),s("dialog","open",i),s("command","type label icon disabled checked radiogroup command"),s("output","for form name",o),s("progress","value max",o),s("meter","value min max low high optimum",o),s("details","open",[i,"summary"].join(" ")),s("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==t&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==t&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("img","loading"),l("iframe","sandbox seamless allowfullscreen loading")),ei(oi("a form meter progress dfn"),function(e){c[e]&&delete c[e].children[e]}),delete c.caption.children.table,delete c.script,Jo[t]=c));!1===e.verify_html&&(e.valid_elements="*[*]");var b=ii(e.valid_styles),y=ii(e.invalid_styles,"map"),x=ii(e.valid_classes,"map"),w=h("whitespace_elements","pre script noscript style textarea video audio iframe object code"),C=h("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),S=h("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),k=h("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),O="td th iframe video audio object script code",_=h("non_empty_elements",O+" pre",S),T=h("move_caret_before_on_enter_elements",O+" table",S),E=h("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),A=h("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",E),R=h("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");ei((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),function(e){p[e]=new RegExp("</"+e+"[^>]*>","gi")});var N=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},B=function(e){var t,n,r,o,i,u,a,c,s,l,d,g,p,h,v,b,y,x,w=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,C=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,S=/[*?+]/;if(e){var k=oi(e,",");for(f["@"]&&(b=f["@"].attributes,y=f["@"].attributesOrder),t=0,n=k.length;t<n;t++)if(i=w.exec(k[t])){if(s=i[2],v=i[3],c=i[5],u={attributes:g={},attributesOrder:p=[]},"#"===(h=i[1])&&(u.paddEmpty=!0),"-"===h&&(u.removeEmpty=!0),"!"===i[4]&&(u.removeEmptyAttrs=!0),b&&(ce(b,function(e,t){g[t]=e}),p.push.apply(p,y)),c)for(r=0,o=(c=oi(c,"|")).length;r<o;r++)if(i=C.exec(c[r])){if(a={},d=i[1],l=i[2].replace(/[\\:]:/g,":"),h=i[3],x=i[4],"!"===d&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(l),a.required=!0),"-"===d){delete g[l],p.splice(ri(p,l),1);continue}h&&("="===h&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:l,value:x}),a.defaultValue=x),":"===h&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:l,value:x}),a.forcedValue=x),"<"===h&&(a.validValues=Zo(x,"?"))),S.test(l)?(u.attributePatterns=u.attributePatterns||[],a.pattern=N(l),u.attributePatterns.push(a)):(g[l]||p.push(l),g[l]=a)}b||"@"!==s||(b=g,y=p),v&&(u.outputName=s,f[v]=u),S.test(s)?(u.pattern=N(s),m.push(u)):f[s]=u}}},D=function(e){f={},m=[],B(e),ei(v,function(e,t){d[t]=e.children})},P=function(e){var t=/^(~)?(.+)$/;e&&(Jo.text_block_elements=Jo.block_elements=null,ei(oi(e,","),function(e){var n,r=t.exec(e),o="~"===r[1],i=o?"span":"div",u=r[2];d[u]=d[i],g[u]=i,o||(A[u.toUpperCase()]={},A[u]={}),f[u]||(delete(n=ti({},n=f[i])).removeEmptyAttrs,delete n.removeEmpty,f[u]=n),ei(d,function(e,t){e[i]&&(d[t]=e=ti({},d[t]),e[u]=e[i])})}))},M=function(t){var n=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Jo[e.schema]=null,t&&ei(oi(t,","),function(e){var t,r,o=n.exec(e);o&&(t=(r=o[1])?d[o[2]]:d[o[2]]={"#comment":{}},t=d[o[2]],ei(oi(o[3],"|"),function(e){"-"===r?delete t[e]:t[e]={}}))})},I=function(e){var t,n=f[e];if(n)return n;for(t=m.length;t--;)if((n=m[t]).pattern.test(e))return n};return e.valid_elements?D(e.valid_elements):(ei(v,function(e,t){f[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},d[t]=e.children}),"html5"!==e.schema&&ei(oi("strong/b em/i"),function(e){var t=oi(e,"/");f[t[1]].outputName=t[0]}),ei(oi("ol ul sub sup blockquote span font a table tbody strong em b i"),function(e){f[e]&&(f[e].removeEmpty=!0)}),ei(oi("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(e){f[e].paddEmpty=!0}),ei(oi("span"),function(e){f[e].removeEmptyAttrs=!0})),P(e.custom_elements),M(e.valid_children),B(e.extended_valid_elements),M("+ol[ul|ol],+ul[ul|ol]"),ei({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(e,t){f[t]&&(f[t].parentsRequired=oi(e))}),e.invalid_elements&&ei(ni(e.invalid_elements),function(e){f[e]&&delete f[e]}),I("span")||B("span[!data-mce-type|*]"),{children:d,elements:f,getValidStyles:function(){return b},getValidClasses:function(){return x},getBlockElements:function(){return A},getInvalidStyles:function(){return y},getShortEndedElements:function(){return S},getTextBlockElements:function(){return E},getTextInlineElements:function(){return R},getBoolAttrs:function(){return k},getElementRule:I,getSelfClosingElements:function(){return C},getNonEmptyElements:function(){return _},getMoveCaretBeforeOnEnterElements:function(){return T},getWhiteSpaceElements:function(){return w},getSpecialElements:function(){return p},isValidChild:function(e,t){var n=d[e.toLowerCase()];return!(!n||!n[t.toLowerCase()])},isValid:function(e,t){var n,r,o=I(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:function(){return g},addValidElements:B,setValidElements:D,addCustomElements:P,addValidChildren:M}},ai=function(e,t,n,r){var o=function(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e};return"#"+o(t)+o(n)+o(r)},ci=function(e,t){var n,r,o=this,i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,u=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,a=/\s*([^:]+):\s*([^;]+);?/g,c=/\s+$/,s={};e=e||{},t&&(n=t.getValidStyles(),r=t.getInvalidStyles());for(var l="\\\" \\' \\; \\: ; : \ufeff".split(" "),f=0;f<l.length;f++)s[l[f]]="\ufeff"+f,s["\ufeff"+f]=l[f];return{toHex:function(e){return e.replace(i,ai)},parse:function(t){var n,r,l,d,m,g,p,h={},v=e.url_converter,b=e.url_converter_scope||o,y=function(e,t,n){var r=h[e+"-top"+t];if(r){var o=h[e+"-right"+t];if(o){var i=h[e+"-bottom"+t];if(i){var u=h[e+"-left"+t];if(u){var a=[r,o,i,u];for(f=a.length-1;f--&&a[f]===a[f+1];);-1<f&&n||(h[e+t]=-1===f?a[0]:a.join(" "),delete h[e+"-top"+t],delete h[e+"-right"+t],delete h[e+"-bottom"+t],delete h[e+"-left"+t])}}}}},x=function(e){var t,n=h[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return h[e]=n[0],!0}},w=function(e){return d=!0,s[e]},C=function(e,t){return d&&(e=e.replace(/\uFEFF[0-9]/g,function(e){return s[e]})),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},S=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},k=function(e){return e.replace(/\\[0-9a-f]+/gi,S)},O=function(t,n,r,o,i,u){if(i=i||u)return"'"+(i=C(i)).replace(/\'/g,"\\'")+"'";if(n=C(n||r||o),!e.allow_script_urls){var a=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(a))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(a))return""}return v&&(n=v.call(b,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,w).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(e){return e.replace(/[;:]/g,w)});n=a.exec(t);)if(a.lastIndex=n.index+n[0].length,r=n[1].replace(c,"").toLowerCase(),l=n[2].replace(c,""),r&&l){if(r=k(r),l=k(l),-1!==r.indexOf("\ufeff")||-1!==r.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===r||/expression\s*\(|\/\*|\*\//.test(l)))continue;"font-weight"===r&&"700"===l?l="bold":"color"!==r&&"background-color"!==r||(l=l.toLowerCase()),l=(l=l.replace(i,ai)).replace(u,O),h[r]=d?C(l,!0):l}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),g="border-style",p="border-color",x(m="border-width")&&x(g)&&x(p)&&(h.border=h[m]+" "+h[g]+" "+h[p],delete h[m],delete h[g],delete h[p]),"medium none"===h.border&&delete h.border,"none"===h["border-image"]&&delete h["border-image"]}return h},serialize:function(e,t){var o="",i=function(t){var r,i=n[t];if(i)for(var u=0,a=i.length;u<a;u++)(r=e[t=i[u]])&&(o+=(0<o.length?" ":"")+t+": "+r+";")};return t&&n?(i("*"),i(t)):ce(e,function(e,n){var i,u;!e||r&&(i=n,(u=r["*"])&&u[i]||(u=r[t])&&u[i])||(o+=(0<o.length?" ":"")+n+": "+e+";")}),o}}},si=/^(?:mouse|contextmenu)|click/,li={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},fi=y,di=x,mi=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},gi=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},pi=function(e,t){var n,r,o,i,u,a=t||{};for(n in e)li[n]||(a[n]=e[n]);return a.target||(a.target=a.srcElement||document),a.composedPath&&(a.composedPath=function(){return e.composedPath()}),e&&si.test(e.type)&&void 0===e.pageX&&void 0!==e.clientX&&(o=(r=a.target.ownerDocument||document).documentElement,i=r.body,a.pageX=e.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),a.preventDefault=function(){a.defaultPrevented=!0,a.isDefaultPrevented=di,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},a.stopPropagation=function(){a.cancelBubble=!0,a.isPropagationStopped=di,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},!(a.stopImmediatePropagation=function(){a.isImmediatePropagationStopped=di,a.stopPropagation()})==((u=a).isDefaultPrevented===di||u.isDefaultPrevented===fi)&&(a.isDefaultPrevented=!0===a.defaultPrevented?di:fi,a.isPropagationStopped=!0===a.cancelBubble?di:fi,a.isImmediatePropagationStopped=fi),void 0===a.metaKey&&(a.metaKey=!1),a},hi=(vi.prototype.bind=function(e,t,n,r){var o,i,u,a,c,s,l=this,f=window,d=function(e){l.executeHandlers(pi(e||f.event),o)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[l.expando]?o=e[l.expando]:(o=l.count++,e[l.expando]=o,l.events[o]={}),r=r||e;for(var m=t.split(" "),g=m.length;g--;)c=d,a=s=!1,"DOMContentLoaded"===(u=m[g])&&(u="ready"),l.domLoaded&&"ready"===u&&"complete"===e.readyState?n.call(r,pi({type:u})):(l.hasMouseEnterLeave||(a=l.mouseEnterLeave[u])&&(c=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=pi(e||f.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,l.executeHandlers(e,o))}),l.hasFocusIn||"focusin"!==u&&"focusout"!==u||(s=!0,a="focusin"===u?"focus":"blur",c=function(e){(e=pi(e||f.event)).type="focus"===e.type?"focusin":"focusout",l.executeHandlers(e,o)}),(i=l.events[o][u])?"ready"===u&&l.domLoaded?n(pi({type:u})):i.push({func:n,scope:r}):(l.events[o][u]=i=[{func:n,scope:r}],i.fakeName=a,i.capture=s,i.nativeHandler=c,"ready"===u?function(e,t,n){var r,o=e.document,i={type:"ready"};n.domLoaded?t(i):(r=function(){gi(e,"DOMContentLoaded",r),gi(e,"load",r),n.domLoaded||(n.domLoaded=!0,t(i)),e=null},"complete"===o.readyState||"interactive"===o.readyState&&o.body?r():mi(e,"DOMContentLoaded",r),n.domLoaded||mi(e,"load",r))}(e,c,l):mi(e,a||u,c,s)));return e=i=null,n}},vi.prototype.unbind=function(e,t,n){var r,o,i;if(!e||3===e.nodeType||8===e.nodeType)return this;var u=e[this.expando];if(u){if(i=this.events[u],t){for(var a,c,s,l,f=t.split(" "),d=f.length;d--;)if(l=i[o=f[d]]){if(n)for(r=l.length;r--;)l[r].func===n&&(a=l.nativeHandler,c=l.fakeName,s=l.capture,(l=l.slice(0,r).concat(l.slice(r+1))).nativeHandler=a,l.fakeName=c,l.capture=s,i[o]=l);n&&0!==l.length||(delete i[o],gi(e,l.fakeName||o,l.nativeHandler,l.capture))}}else ce(i,function(t,n){gi(e,t.fakeName||n,t.nativeHandler,t.capture)}),i={};for(o in i)if(he(i,o))return this;delete this.events[u];try{delete e[this.expando]}catch(h){e[this.expando]=null}}return this},vi.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var o=pi(null,n);for(o.type=t,o.target=e;(r=e[this.expando])&&this.executeHandlers(o,r),(e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow)&&!o.isPropagationStopped(););return this},vi.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},vi.prototype.destroy=function(){this.events={}},vi.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},vi.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var o=0,i=r.length;o<i;o++){var u=r[o];if(u&&!1===u.func.call(u.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},vi.Event=new vi,vi);function vi(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}var bi,yi,xi,wi,Ci,Si,ki,Oi,_i,Ti,Ei,Ai,Ri,Ni,Bi,Di,Pi,Mi="sizzle"+-new Date,Ii=window.document,Li=0,Fi=0,zi=vu(),Hi=vu(),Vi=vu(),ji=function(e,t){return e===t&&(Ti=!0),0},Ui="undefined",Wi={}.hasOwnProperty,qi=[],Gi=qi.pop,$i=qi.push,Xi=qi.push,Ki=qi.slice,Yi=qi.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Ji="[\\x20\\t\\r\\n\\f]",Qi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Zi="\\["+Ji+"*("+Qi+")(?:"+Ji+"*([*^$|!~]?=)"+Ji+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Qi+"))|)"+Ji+"*\\]",eu=":("+Qi+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Zi+")*)|.*)\\)|)",tu=new RegExp("^"+Ji+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ji+"+$","g"),nu=new RegExp("^"+Ji+"*,"+Ji+"*"),ru=new RegExp("^"+Ji+"*([>+~]|"+Ji+")"+Ji+"*"),ou=new RegExp("="+Ji+"*([^\\]'\"]*?)"+Ji+"*\\]","g"),iu=new RegExp(eu),uu=new RegExp("^"+Qi+"$"),au={ID:new RegExp("^#("+Qi+")"),CLASS:new RegExp("^\\.("+Qi+")"),TAG:new RegExp("^("+Qi+"|[*])"),ATTR:new RegExp("^"+Zi),PSEUDO:new RegExp("^"+eu),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ji+"*(even|odd|(([+-]|)(\\d*)n|)"+Ji+"*(?:([+-]|)"+Ji+"*(\\d+)|))"+Ji+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Ji+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ji+"*((?:-\\d)?\\d*)"+Ji+"*\\)|)(?=[^-]|$)","i")},cu=/^(?:input|select|textarea|button)$/i,su=/^h\d$/i,lu=/^[^{]+\{\s*\[native \w/,fu=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,du=/[+~]/,mu=/'|\\/g,gu=new RegExp("\\\\([\\da-f]{1,6}"+Ji+"?|("+Ji+")|.)","ig"),pu=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)};try{Xi.apply(qi=Ki.call(Ii.childNodes),Ii.childNodes)}catch(rS){Xi={apply:qi.length?function(e,t){$i.apply(e,Ki.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var hu=function(e,t,n,r){var o,i,u,a,c,s,l,f,d,m;if((t?t.ownerDocument||t:Ii)!==Ai&&Ei(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=(t=t||Ai).nodeType)&&9!==a)return[];if(Ni&&!r){if(o=fu.exec(e))if(u=o[1]){if(9===a){if(!(i=t.getElementById(u))||!i.parentNode)return n;if(i.id===u)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(u))&&Pi(t,i)&&i.id===u)return n.push(i),n}else{if(o[2])return Xi.apply(n,t.getElementsByTagName(e)),n;if((u=o[3])&&bi.getElementsByClassName)return Xi.apply(n,t.getElementsByClassName(u)),n}if(bi.qsa&&(!Bi||!Bi.test(e))){if(f=l=Mi,d=t,m=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(s=Ci(e),(l=t.getAttribute("id"))?f=l.replace(mu,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",c=s.length;c--;)s[c]=f+Su(s[c]);d=du.test(e)&&wu(t.parentNode)||t,m=s.join(",")}if(m)try{return Xi.apply(n,d.querySelectorAll(m)),n}catch(v){}finally{l||t.removeAttribute("id")}}}return ki(e.replace(tu,"$1"),t,n,r)};function vu(){var e=[];return function t(n,r){return e.push(n+" ")>yi.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function bu(e){return e[Mi]=!0,e}function yu(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function xu(e){return bu(function(t){return t=+t,bu(function(n,r){for(var o,i=e([],n.length,t),u=i.length;u--;)n[o=i[u]]&&(n[o]=!(r[o]=n[o]))})})}function wu(e){return e&&typeof e.getElementsByTagName!=Ui&&e}function Cu(){}function Su(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ku(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=Fi++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,u){var a,c,s=[Li,i];if(u){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((a=(c=t[Mi]||(t[Mi]={}))[r])&&a[0]===Li&&a[1]===i)return s[2]=a[2];if((c[r]=s)[2]=e(t,n,u))return!0}}}function Ou(e){return 1<e.length?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function _u(e,t,n,r,o){for(var i,u=[],a=0,c=e.length,s=null!=t;a<c;a++)(i=e[a])&&(n&&!n(i,r,o)||(u.push(i),s&&t.push(a)));return u}function Tu(e,t,n,r,o,i){return r&&!r[Mi]&&(r=Tu(r)),o&&!o[Mi]&&(o=Tu(o,i)),bu(function(i,u,a,c){var s,l,f,d=[],m=[],g=u.length,p=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)hu(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),h=!e||!i&&t?p:_u(p,d,e,a,c),v=n?o||(i?e:g||r)?[]:u:h;if(n&&n(h,v,a,c),r)for(s=_u(v,m),r(s,[],a,c),l=s.length;l--;)(f=s[l])&&(v[m[l]]=!(h[m[l]]=f));if(i){if(o||e){if(o){for(s=[],l=v.length;l--;)(f=v[l])&&s.push(h[l]=f);o(null,v=[],s,c)}for(l=v.length;l--;)(f=v[l])&&-1<(s=o?Yi.call(i,f):d[l])&&(i[s]=!(u[s]=f))}}else v=_u(v===u?v.splice(g,v.length):v),o?o(null,u,v,c):Xi.apply(u,v)})}bi=hu.support={},wi=hu.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},Ei=hu.setDocument=function(e){var t,n=e?e.ownerDocument||e:Ii,r=n.defaultView;return n!==Ai&&9===n.nodeType&&n.documentElement?(Ri=(Ai=n).documentElement,Ni=!wi(n),r&&r!==function(e){try{return e.top}catch(t){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",function(){Ei()},!1):r.attachEvent&&r.attachEvent("onunload",function(){Ei()})),bi.attributes=!0,bi.getElementsByTagName=!0,bi.getElementsByClassName=lu.test(n.getElementsByClassName),bi.getById=!0,yi.find.ID=function(e,t){if(typeof t.getElementById!=Ui&&Ni){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},yi.filter.ID=function(e){var t=e.replace(gu,pu);return function(e){return e.getAttribute("id")===t}},yi.find.TAG=bi.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=Ui)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"!==e)return i;for(;n=i[o++];)1===n.nodeType&&r.push(n);return r},yi.find.CLASS=bi.getElementsByClassName&&function(e,t){if(Ni)return t.getElementsByClassName(e)},Di=[],Bi=[],bi.disconnectedMatch=!0,Bi=Bi.length&&new RegExp(Bi.join("|")),Di=Di.length&&new RegExp(Di.join("|")),t=lu.test(Ri.compareDocumentPosition),Pi=t||lu.test(Ri.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},ji=t?function(e,t){if(e===t)return Ti=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!bi.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===Ii&&Pi(Ii,e)?-1:t===n||t.ownerDocument===Ii&&Pi(Ii,t)?1:_i?Yi.call(_i,e)-Yi.call(_i,t):0:4&r?-1:1)}:function(e,t){if(e===t)return Ti=!0,0;var r,o=0,i=e.parentNode,u=t.parentNode,a=[e],c=[t];if(!i||!u)return e===n?-1:t===n?1:i?-1:u?1:_i?Yi.call(_i,e)-Yi.call(_i,t):0;if(i===u)return yu(e,t);for(r=e;r=r.parentNode;)a.unshift(r);for(r=t;r=r.parentNode;)c.unshift(r);for(;a[o]===c[o];)o++;return o?yu(a[o],c[o]):a[o]===Ii?-1:c[o]===Ii?1:0},n):Ai},hu.matches=function(e,t){return hu(e,null,null,t)},hu.matchesSelector=function(e,t){if((e.ownerDocument||e)!==Ai&&Ei(e),t=t.replace(ou,"='$1']"),bi.matchesSelector&&Ni&&(!Di||!Di.test(t))&&(!Bi||!Bi.test(t)))try{var n=(void 0).call(e,t);if(n||bi.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(rS){}return 0<hu(t,Ai,null,[e]).length},hu.contains=function(e,t){return(e.ownerDocument||e)!==Ai&&Ei(e),Pi(e,t)},hu.attr=function(e,t){(e.ownerDocument||e)!==Ai&&Ei(e);var n=yi.attrHandle[t.toLowerCase()],r=n&&Wi.call(yi.attrHandle,t.toLowerCase())?n(e,t,!Ni):void 0;return void 0!==r?r:bi.attributes||!Ni?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},hu.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},hu.uniqueSort=function(e){var t,n=[],r=0,o=0;if(Ti=!bi.detectDuplicates,_i=!bi.sortStable&&e.slice(0),e.sort(ji),Ti){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return _i=null,e},xi=hu.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=xi(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=xi(t);return n},(yi=hu.selectors={cacheLength:50,createPseudo:bu,match:au,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(gu,pu),e[3]=(e[3]||e[4]||e[5]||"").replace(gu,pu),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||hu.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&hu.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return au.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&iu.test(n)&&(t=Ci(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(gu,pu).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=zi[e+" "];return t||(t=new RegExp("(^|"+Ji+")"+e+"("+Ji+"|$)"))&&zi(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!=Ui&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var o=hu.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&-1<o.indexOf(n):"$="===t?n&&o.slice(-n.length)===n:"~="===t?-1<(" "+o+" ").indexOf(n):"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),u="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,c){var s,l,f,d,m,g,p=i!=u?"nextSibling":"previousSibling",h=t.parentNode,v=a&&t.nodeName.toLowerCase(),b=!c&&!a;if(h){if(i){for(;p;){for(f=t;f=f[p];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;g=p="only"===e&&!g&&"nextSibling"}return!0}if(g=[u?h.firstChild:h.lastChild],u&&b){for(m=(s=(l=h[Mi]||(h[Mi]={}))[e]||[])[0]===Li&&s[1],d=s[0]===Li&&s[2],f=m&&h.childNodes[m];f=++m&&f&&f[p]||(d=m=0)||g.pop();)if(1===f.nodeType&&++d&&f===t){l[e]=[Li,m,d];break}}else if(b&&(s=(t[Mi]||(t[Mi]={}))[e])&&s[0]===Li)d=s[1];else for(;(f=++m&&f&&f[p]||(d=m=0)||g.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++d||(b&&((f[Mi]||(f[Mi]={}))[e]=[Li,d]),f!==t)););return(d-=o)===r||d%r==0&&0<=d/r}}},PSEUDO:function(e,t){var n,r=yi.pseudos[e]||yi.setFilters[e.toLowerCase()]||hu.error("unsupported pseudo: "+e);return r[Mi]?r(t):1<r.length?(n=[e,e,"",t],yi.setFilters.hasOwnProperty(e.toLowerCase())?bu(function(e,n){for(var o,i=r(e,t),u=i.length;u--;)e[o=Yi.call(e,i[u])]=!(n[o]=i[u])}):function(e){return r(e,0,n)}):r}},pseudos:{not:bu(function(e){var t=[],n=[],r=Si(e.replace(tu,"$1"));return r[Mi]?bu(function(e,t,n,o){for(var i,u=r(e,null,o,[]),a=e.length;a--;)(i=u[a])&&(e[a]=!(t[a]=i))}):function(e,o,i){return t[0]=e,r(t,null,i,n),t[0]=null,!n.pop()}}),has:bu(function(e){return function(t){return 0<hu(e,t).length}}),contains:bu(function(e){return e=e.replace(gu,pu),function(t){return-1<(t.textContent||t.innerText||xi(t)).indexOf(e)}}),lang:bu(function(e){return uu.test(e||"")||hu.error("unsupported lang: "+e),e=e.replace(gu,pu).toLowerCase(),function(t){var n;do{if(n=Ni?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===Ri},focus:function(e){return e===Ai.activeElement&&(!Ai.hasFocus||Ai.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!yi.pseudos.empty(e)},header:function(e){return su.test(e.nodeName)},input:function(e){return cu.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:xu(function(){return[0]}),last:xu(function(e,t){return[t-1]}),eq:xu(function(e,t,n){return[n<0?n+t:n]}),even:xu(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:xu(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:xu(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:xu(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=yi.pseudos.eq,q(["radio","checkbox","file","password","image"],function(e){var t;yi.pseudos[e]=(t=e,function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t})}),q(["submit","reset"],function(e){var t;yi.pseudos[e]=(t=e,function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t})}),Cu.prototype=yi.filters=yi.pseudos,yi.setFilters=new Cu,Ci=hu.tokenize=function(e,t){var n,r,o,i,u,a,c,s=Hi[e+" "];if(s)return t?0:s.slice(0);for(u=e,a=[],c=yi.preFilter;u;){for(i in n&&!(r=nu.exec(u))||(r&&(u=u.slice(r[0].length)||u),a.push(o=[])),n=!1,(r=ru.exec(u))&&(n=r.shift(),o.push({value:n,type:r[0].replace(tu," ")}),u=u.slice(n.length)),yi.filter)yi.filter.hasOwnProperty(i)&&(!(r=au[i].exec(u))||c[i]&&!(r=c[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),u=u.slice(n.length)));if(!n)break}return t?u.length:u?hu.error(e):Hi(e,a).slice(0)},Si=hu.compile=function(e,t){var n,r,o,i,u,a,c=[],s=[],l=Vi[e+" "];if(!l){for(n=(t=t||Ci(e)).length;n--;)(l=function e(t){for(var n,r,o,i=t.length,u=yi.relative[t[0].type],a=u||yi.relative[" "],c=u?1:0,s=ku(function(e){return e===n},a,!0),l=ku(function(e){return-1<Yi.call(n,e)},a,!0),f=[function(e,t,r){var o=!u&&(r||t!==Oi)||((n=t).nodeType?s:l)(e,t,r);return n=null,o}];c<i;c++)if(r=yi.relative[t[c].type])f=[ku(Ou(f),r)];else{if((r=yi.filter[t[c].type].apply(null,t[c].matches))[Mi]){for(o=++c;o<i&&!yi.relative[t[o].type];o++);return Tu(1<c&&Ou(f),1<c&&Su(t.slice(0,c-1).concat({value:" "===t[c-2].type?"*":""})).replace(tu,"$1"),r,c<o&&e(t.slice(c,o)),o<i&&e(t=t.slice(o)),o<i&&Su(t))}f.push(r)}return Ou(f)}(t[n]))[Mi]?c.push(l):s.push(l);(l=Vi(e,(r=s,i=0<(o=c).length,u=0<r.length,a=function(e,t,n,a,c){var s,l,f,d=0,m="0",g=e&&[],p=[],h=Oi,v=e||u&&yi.find.TAG("*",c),b=Li+=null==h?1:Math.random()||.1,y=v.length;for(c&&(Oi=t!==Ai&&t);m!==y&&null!=(s=v[m]);m++){if(u&&s){for(l=0;f=r[l++];)if(f(s,t,n)){a.push(s);break}c&&(Li=b)}i&&((s=!f&&s)&&d--,e&&g.push(s))}if(d+=m,i&&m!==d){for(l=0;f=o[l++];)f(g,p,t,n);if(e){if(0<d)for(;m--;)g[m]||p[m]||(p[m]=Gi.call(a));p=_u(p)}Xi.apply(a,p),c&&!e&&0<p.length&&1<d+o.length&&hu.uniqueSort(a)}return c&&(Li=b,Oi=h),g},i?bu(a):a))).selector=e}return l},ki=hu.select=function(e,t,n,r){var o,i,u,a,c,s="function"==typeof e&&e,l=!r&&Ci(e=s.selector||e);if(n=n||[],1===l.length){if(2<(i=l[0]=l[0].slice(0)).length&&"ID"===(u=i[0]).type&&bi.getById&&9===t.nodeType&&Ni&&yi.relative[i[1].type]){if(!(t=(yi.find.ID(u.matches[0].replace(gu,pu),t)||[])[0]))return n;s&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=au.needsContext.test(e)?0:i.length;o--&&!yi.relative[a=(u=i[o]).type];)if((c=yi.find[a])&&(r=c(u.matches[0].replace(gu,pu),du.test(i[0].type)&&wu(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&Su(i)))return Xi.apply(n,r),n;break}}return(s||Si(e,l))(r,t,!Ni,n,du.test(e)&&wu(t.parentNode)||t),n},bi.sortStable=Mi.split("").sort(ji).join("")===Mi,bi.detectDuplicates=!!Ti,Ei(),bi.sortDetached=!0;var Eu=document,Au=Array.prototype.push,Ru=Array.prototype.slice,Nu=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Bu=hi.Event,Du=kt.makeMap("children,contents,next,prev"),Pu=function(e){return void 0!==e},Mu=function(e){return"string"==typeof e},Iu=function(e,t){var n,r=(t=t||Eu).createElement("div"),o=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)o.appendChild(n);return o},Lu=function(e,t,n,r){var o;if(Mu(t))t=Iu(t,Ju(e[0]));else if(t.length&&!t.nodeType){if(t=ta.makeArray(t),r)for(o=t.length-1;0<=o;o--)Lu(e,t[o],n,r);else for(o=0;o<t.length;o++)Lu(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},Fu=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},zu=function(e,t,n){var r,o;return t=ta(t)[0],e.each(function(){n&&r===this.parentNode||(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this)),o.appendChild(this)}),e},Hu=kt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Vu=kt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),ju={for:"htmlFor",class:"className",readonly:"readOnly"},Uu={float:"cssFloat"},Wu={},qu={},Gu=function(e,t){return new ta.fn.init(e,t)},$u=/^\s*|\s*$/g,Xu=function(e){return null==e?"":(""+e).replace($u,"")},Ku=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(i=e[r],r,i))break}else for(o=0;o<n&&!1!==t.call(i=e[o],o,i);o++);return e},Yu=function(e,t){var n=[];return Ku(e,function(e,r){t(r,e)&&n.push(r)}),n},Ju=function(e){return e?9===e.nodeType?e:e.ownerDocument:Eu};Gu.fn=Gu.prototype={constructor:Gu,selector:"",context:null,length:0,init:function(e,t){var n,r,o=this;if(!e)return o;if(e.nodeType)return o.context=o[0]=e,o.length=1,o;if(t&&t.nodeType)o.context=t;else{if(t)return ta(e).attr(t);o.context=t=document}if(Mu(e)){if(!(n="<"===(o.selector=e).charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:Nu.exec(e)))return ta(t).find(e);if(n[1])for(r=Iu(e,Ju(t)).firstChild;r;)Au.call(o,r),r=r.nextSibling;else{if(!(r=Ju(t).getElementById(n[2])))return o;if(r.id!==n[2])return o.find(e);o.length=1,o[0]=r}}else this.add(e,!1);return o},toArray:function(){return kt.toArray(this)},add:function(e,t){var n,r;if(Mu(e))return this.add(ta(e));if(!1!==t)for(n=ta.unique(this.toArray().concat(ta.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else Au.apply(this,ta.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)Ku(e,function(e,t){r.attr(e,t)});else{if(!Pu(t)){if(r[0]&&1===r[0].nodeType){if((n=Wu[e])&&n.get)return n.get(r[0],e);if(Vu[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each(function(){var n;if(1===this.nodeType){if((n=Wu[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}})}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=ju[e]||e))Ku(e,function(e,t){n.prop(e,t)});else{if(!Pu(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each(function(){1===this.nodeType&&(this[e]=t)})}return n},css:function(e,t){var n,r,o=this,u=function(e){return e.replace(/-(\D)/g,function(e,t){return t.toUpperCase()})},a=function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e})};if("object"==typeof e)Ku(e,function(e,t){o.css(e,t)});else if(Pu(t))e=u(e),"number"!=typeof t||Hu[e]||(t=t.toString()+"px"),o.each(function(){var n=this.style;if((r=qu[e])&&r.set)r.set(this,t);else{try{this.style[Uu[e]||e]=t}catch(u){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}});else{if(n=o[0],(r=qu[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[u(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(i){return}}return o},remove:function(){for(var e,t=this.length;t--;)Bu.clean(e=this[t]),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(Pu(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(m){ta(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(Pu(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Lu(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)})},prepend:function(){return Lu(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)},!0)},before:function(){return this[0]&&this[0].parentNode?Lu(this,arguments,function(e){this.parentNode.insertBefore(e,this)}):this},after:function(){return this[0]&&this[0].parentNode?Lu(this,arguments,function(e){this.parentNode.insertBefore(e,this.nextSibling)},!0):this},appendTo:function(e){return ta(e).append(this),this},prependTo:function(e){return ta(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return zu(this,e)},wrapAll:function(e){return zu(this,e,!0)},wrapInner:function(e){return this.each(function(){ta(this).contents().wrapAll(e)}),this},unwrap:function(){return this.parent().each(function(){ta(this).replaceWith(this.childNodes)})},clone:function(){var e=[];return this.each(function(){e.push(this.cloneNode(!0))}),ta(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?Ku(e.split(" "),function(){n.toggleClass(this,t)}):n.each(function(n,r){var o,i=Fu(r,e);i!==t&&(o=r.className,i?r.className=Xu((" "+o+" ").replace(" "+e+" "," ")):r.className+=o?" "+e:e)})),n},hasClass:function(e){return Fu(this[0],e)},each:function(e){return Ku(this,e)},on:function(e,t){return this.each(function(){Bu.bind(this,e,t)})},off:function(e,t){return this.each(function(){Bu.unbind(this,e,t)})},trigger:function(e){return this.each(function(){"object"==typeof e?Bu.fire(this,e.type,e):Bu.fire(this,e)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return ta(Ru.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){for(var t=[],n=0,r=this.length;n<r;n++)ta.find(e,this[n],t);return ta(t)},filter:function(e){return ta("function"==typeof e?Yu(this.toArray(),function(t,n){return e(n,t)}):ta.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof ta&&(e=e[0]),this.each(function(n,r){for(;r;){if("string"==typeof e&&ta(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}}),ta(t)},offset:function(e){var t,n,r,o,i=0,u=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,u=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:u})},push:Au,sort:Array.prototype.sort,splice:Array.prototype.splice},kt.extend(Gu,{extend:kt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:kt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:kt.isArray,each:Ku,trim:Xu,grep:Yu,find:hu,expr:hu.selectors,unique:hu.uniqueSort,text:hu.getText,contains:hu.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return 1===t.length?ta.find.matchesSelector(t[0],e)?[t[0]]:[]:ta.find.matches(e,t)}});var Qu=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof ta&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&ta(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},Zu=function(e,t,n,r){var o=[];for(r instanceof ta&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&ta(e).is(r))break}o.push(e)}return o},ea=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Ku({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Qu(e,"parentNode")},next:function(e){return ea(e,"nextSibling",1)},prev:function(e){return ea(e,"previousSibling",1)},children:function(e){return Zu(e.firstChild,"nextSibling",1)},contents:function(e){return kt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},function(e,t){Gu.fn[e]=function(n){var r=[];this.each(function(){var e=t.call(r,this,n,r);e&&(ta.isArray(e)?r.push.apply(r,e):r.push(e))}),1<this.length&&(Du[e]||(r=ta.unique(r)),0===e.indexOf("parents")&&(r=r.reverse()));var o=ta(r);return n?o.filter(n):o}}),Ku({parentsUntil:function(e,t){return Qu(e,"parentNode",t)},nextUntil:function(e,t){return Zu(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return Zu(e,"previousSibling",1,t).slice(1)}},function(e,t){Gu.fn[e]=function(n,r){var o=[];this.each(function(){var e=t.call(o,this,n,o);e&&(ta.isArray(e)?o.push.apply(o,e):o.push(e))}),1<this.length&&(o=ta.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var i=ta(o);return r?i.filter(r):i}}),Gu.fn.is=function(e){return!!e&&0<this.filter(e).length},Gu.fn.init.prototype=Gu.fn,Gu.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),new n.fn.init(r,o=o||t.context)};return ta.extend(n,this),n},Gu.attrHooks=Wu,Gu.cssHooks=qu;var ta=Gu,na=kt.each,ra=kt.grep,oa=yt.ie,ia=/^([a-z0-9],?)+$/i,ua=function(e,t){var n=t.attr("style"),r=(r=e.serialize(e.parse(n),t[0].nodeName))||null;t.attr("data-mce-style",r)},aa=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o},ca=function(e,t){void 0===t&&(t={});var n,r,o,i,u,c,s={},l=window,f={},d=0,m=Hr.forElement(At(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),g=[],p=t.schema?t.schema:ui({}),h=ci({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),v=t.ownEvents?new hi:hi.Event,b=p.getBlockElements(),y=ta.overrideDefaults(function(){return{context:e,element:K.getRoot()}}),x=function(t){return t&&e&&E(t)?e.getElementById(t):t},w=function(e){return y("string"==typeof e?x(e):e)},C=function(e,t,n){var r,o,i=w(e);return i.length&&(o=(r=Y[t])&&r.get?r.get(i,t):i.attr(t)),void 0===o&&(o=n||""),o},S=function(e){var t=x(e);return t?t.attributes:[]},k=function(e,n,r){""===r&&(r=null);var o,i=w(e),u=i.attr(n);i.length&&((o=Y[n])&&o.set?o.set(i,r,n):i.attr(n,r),u!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:i,attrName:n,attrValue:r}))},O=function(){return t.root_element||e.body},_=function(t,n){return function(e,t,n){var r,o,i,u=0,a=0,c=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Yn(At(e),"position"))return{x:u=(o=t.getBoundingClientRect()).left+(c.documentElement.scrollLeft||e.scrollLeft)-c.documentElement.clientLeft,y:a=o.top+(c.documentElement.scrollTop||e.scrollTop)-c.documentElement.clientTop};for(r=t;r&&r!==n&&r.nodeType&&!nr(r,n);)u+=r.offsetLeft||0,a+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!==n&&r.nodeType&&!nr(r,n);)u-=r.scrollLeft||0,a-=r.scrollTop||0,r=r.parentNode;a+=(i=At(t),er.isFirefox()&&"table"===Mt(i)?tr(Kt(i)).filter(function(e){return"caption"===Mt(e)}).bind(function(e){return tr(Xt(e)).map(function(t){return t.dom.offsetTop<=e.dom.offsetTop?-e.dom.offsetHeight:0})}).getOr(0):0)}return{x:u,y:a}}(e.body,x(t),n)},T=function(e,t,n){var r=w(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}))&&(t=yt.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},A=function(e){var t,n;return e=x(e),t=T(e,"width"),n=T(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},R=function(e,t){if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(ia.test(t)){for(var n=t.toLowerCase().split(/,/),r=e.nodeName.toLowerCase(),o=n.length-1;0<=o;o--)if(n[o]===r)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return 0<hu(t,i[0].ownerDocument||i[0],null,i).length},N=function(e,t,n,r){var o,i=[],u=x(e);for(r=void 0===r,n=n||("BODY"!==O().nodeName?O().parentNode:null),kt.is(t,"string")&&(t="*"===(o=t)?function(e){return 1===e.nodeType}:function(e){return R(e,o)});u&&!(u===n||P(u.nodeType)||Mn(u)||In(u));){if(!t||"function"==typeof t&&t(u)){if(!r)return[u];i.push(u)}u=u.parentNode}return r?i:null},B=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return R(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},D=function(e,t,n){var r,o="string"==typeof e?x(e):e;return!!o&&(kt.isArray(o)&&(o.length||0===o.length)?(r=[],na(o,function(e,o){e&&r.push(t.call(n,"string"==typeof e?x(e):e,o))}),r):t.call(n||this,o))},M=function(e,t){w(e).each(function(e,n){na(t,function(e,t){k(n,t,e)})})},I=function(e,t){var r=w(e);oa?r.each(function(e,r){if(!1!==r.canHaveHTML){for(;r.firstChild;)r.removeChild(r.firstChild);try{r.innerHTML="<br>"+t,r.removeChild(r.firstChild)}catch(n){ta("<div></div>").html("<br>"+t).contents().slice(1).appendTo(r)}return t}}):r.html(t)},L=function(t,n,r,o,i){return D(t,function(t){var u="string"==typeof n?e.createElement(n):n;return M(u,r),o&&("string"!=typeof o&&o.nodeType?u.appendChild(o):"string"==typeof o&&I(u,o)),i?u:t.appendChild(u)})},F=function(t,n,r){return L(e.createElement(t),t,n,r,!0)},z=Yo.encodeAllRaw,H=function(e,t){var n=w(e);return t?n.each(function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)}).remove():n.remove(),1<n.length?n.toArray():n[0]},V=function(e,t,n){w(e).toggleClass(t,n).each(function(){""===this.className&&ta(this).attr("class",null)})},j=function(e,t,n){return D(t,function(t){return kt.is(t,"array")&&(e=e.cloneNode(!0)),n&&na(ra(t.childNodes),function(t){e.appendChild(t)}),t.parentNode.replaceChild(e,t)})},U=function(e){if(On(e)){var t="a"===e.nodeName.toLowerCase()&&!C(e,"href")&&C(e,"id");if(C(e,"name")||C(e,"data-mce-bookmark")||t)return!0}return!1},W=function(){return e.createRange()},G=function(n,r,o,i){if(kt.isArray(n)){for(var u=n.length,a=[];u--;)a[u]=G(n[u],r,o,i);return a}return!t.collect||n!==e&&n!==l||g.push([n,r,o,i]),v.bind(n,r,o,i||K)},$=function(t,n,r){if(kt.isArray(t)){for(var o=t.length,i=[];o--;)i[o]=$(t[o],n,r);return i}if(0<g.length&&(t===e||t===l))for(o=g.length;o--;){var u=g[o];t!==u[0]||n&&n!==u[1]||r&&r!==u[2]||v.unbind(u[0],u[1],u[2])}return v.unbind(t,n,r)},X=function(e){if(e&&On(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},K={doc:e,settings:t,win:l,files:f,stdMode:!0,boxModel:!0,styleSheetLoader:m,boundEvents:g,styles:h,schema:p,events:v,isBlock:function(e){if("string"==typeof e)return!!b[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!b[e.nodeName])}return!1},$:y,$$:w,root:null,clone:function(t,n){if(!oa||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return na(S(t),function(e){k(r,e.nodeName,C(t,e.nodeName))}),r},getRoot:O,getViewPort:function(e){var t=Cn(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=x(e);var t=_(e),n=A(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:A,getParent:function(e,t,n){var r=N(e,t,n,!1);return r&&0<r.length?r[0]:null},getParents:N,get:x,getNext:function(e,t){return B(e,t,"nextSibling")},getPrev:function(e,t){return B(e,t,"previousSibling")},select:function(n,r){return hu(n,x(r)||t.root_element||e,[])},is:R,add:L,create:F,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)t.hasOwnProperty(r)&&null!=t[r]&&(o+=" "+r+'="'+z(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(r),t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o.removeChild(r),o},remove:H,setStyle:function(e,n,r){var o=E(n)?w(e).css(n,r):w(e).css(n);t.update_styles&&ua(h,o)},getStyle:T,setStyles:function(e,n){var r=w(e).css(n);t.update_styles&&ua(h,r)},removeAllAttribs:function(e){return D(e,function(e){for(var t=e.attributes,n=t.length-1;0<=n;n--)e.removeAttributeNode(t.item(n))})},setAttrib:k,setAttribs:M,getAttrib:C,getPos:_,parseStyle:function(e){return h.parse(e)},serializeStyle:function(e,t){return h.serialize(e,t)},addStyle:function(t){var n,r;if(K!==ca.DOM&&e===document){if(s[t])return;s[t]=!0}(r=e.getElementById("mceDefaultStyles"))||((r=e.createElement("style")).id="mceDefaultStyles",r.type="text/css",(n=e.getElementsByTagName("head")[0]).firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r)),r.styleSheet?r.styleSheet.cssText+=t:r.appendChild(e.createTextNode(t))},loadCSS:function(e){q((e=e||"").split(","),function(e){f[e]=!0,m.load(e,a)})},addClass:function(e,t){w(e).addClass(t)},removeClass:function(e,t){V(e,t,!1)},hasClass:function(e,t){return w(e).hasClass(t)},toggleClass:V,show:function(e){w(e).show()},hide:function(e){w(e).hide()},isHidden:function(e){return"none"===w(e).css("display")},uniqueId:function(e){return(e||"mce_")+d++},setHTML:I,getOuterHTML:function(e){var t="string"==typeof e?x(e):e;return On(t)?t.outerHTML:ta("<div></div>").append(ta(t).clone()).html()},setOuterHTML:function(e,t){w(e).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}H(ta(this).html(t),!0)})},decode:Yo.decode,encode:z,insertAfter:function(e,t){var n=x(t);return D(e,function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e})},replace:j,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=F(t),na(S(e),function(t){k(n,t.nodeName,C(e,t.nodeName))}),j(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return h.toHex(kt.trim(e))},run:D,getAttribs:S,isEmpty:function(e,t){var n,r,o=0;if(U(e))return!1;if(e=e.firstChild){var i=new Vr(e,e.parentNode),u=p?p.getWhiteSpaceElements():{};t=t||(p?p.getNonEmptyElements():null);do{if(n=e.nodeType,On(e)){var a=e.getAttribute("data-mce-bogus");if(a){e=i.next("all"===a);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"!==r)return!1;o++,e=i.next();continue}if(U(e))return!1}if(8===n)return!1;if(3===n&&!Eo(e.nodeValue))return!1;if(3===n&&e.parentNode&&u[e.parentNode.nodeName]&&Eo(e.nodeValue))return!1;e=i.next()}while(e)}return o<=1},createRng:W,nodeIndex:aa,split:function(e,t,n){var r,o,i,u=W();if(e&&t)return u.setStart(e.parentNode,aa(e)),u.setEnd(t.parentNode,aa(t)),r=u.extractContents(),(u=W()).setStart(t.parentNode,aa(t)+1),u.setEnd(e.parentNode,aa(e)+1),o=u.extractContents(),(i=e.parentNode).insertBefore(Io(K,r),e),i.insertBefore(n||t,e),i.insertBefore(Io(K,o),e),H(e),n||t},bind:G,unbind:$,fire:function(e,t,n){return v.fire(e,t,n)},getContentEditable:X,getContentEditableParent:function(e){for(var t=O(),n=null;e&&e!==t&&null===(n=X(e));e=e.parentNode);return n},destroy:function(){if(0<g.length)for(var e=g.length;e--;){var t=g[e];v.unbind(t[0],t[1],t[2])}ce(f,function(e,t){m.unload(t),delete f[t]}),hu.setDocument&&hu.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},Y=(n=h,o=function(){return K},u={set:function(e,t,n){r.url_converter&&(t=r.url_converter.call(r.url_converter_scope||o(),t,n,e[0])),e.attr("data-mce-"+n,t).attr(n,t)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},c={style:{set:function(e,t){null===t||"object"!=typeof t?(i&&e.attr("data-mce-style",t),null!==t&&"string"==typeof t?(e.removeAttr("style"),e.css(n.parse(t))):e.attr("style",t)):e.css(t)},get:function(e){var t=e.attr("data-mce-style")||e.attr("style");return n.serialize(n.parse(t),e[0].nodeName)}}},(i=(r=t).keep_values)&&(c.href=c.src=u),c);return K};ca.DOM=ca(document),ca.nodeIndex=aa;var sa=ca.DOM,la=kt.each,fa=kt.grep,da=(ma.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},ma.prototype.loadScript=function(e,t,n){var r=sa,o=function(){r.remove(i),u&&(u.onerror=u.onload=u=null)},i=r.uniqueId(),u=document.createElement("script");u.id=i,u.type="text/javascript",u.src=kt._addCacheSuffix(e),this.settings.referrerPolicy&&r.setAttrib(u,"referrerpolicy",this.settings.referrerPolicy),u.onload=function(){o(),t()},u.onerror=function(){o(),I(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(u)},ma.prototype.isDone=function(e){return 2===this.states[e]},ma.prototype.markDone=function(e){this.states[e]=2},ma.prototype.add=function(e,t,n,r){var o=this.states[e];this.queue.push(e),void 0===o&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},ma.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},ma.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},ma.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},ma.prototype.loadScripts=function(e,t,n,r){var o=this,i=[],u=function(e,t){la(o.scriptLoadedCallbacks[t],function(t){I(t[e])&&t[e].call(t.scope)}),o.scriptLoadedCallbacks[t]=void 0};o.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var a=function(){var t,n=fa(e);e.length=0,la(n,function(e){2!==o.states[e]?3!==o.states[e]?1!==o.states[e]&&(o.states[e]=1,o.loading++,o.loadScript(e,function(){o.states[e]=2,o.loading--,u("success",e),a()},function(){o.states[e]=3,o.loading--,i.push(e),u("failure",e),a()})):u("failure",e):u("success",e)}),o.loading||(t=o.queueLoadedCallbacks.slice(0),o.queueLoadedCallbacks.length=0,la(t,function(e){0===i.length?I(e.success)&&e.success.call(e.scope):I(e.failure)&&e.failure.call(e.scope,i)}))};a()},ma.ScriptLoader=new ma,ma);function ma(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}var ga=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},pa={},ha=ga("en"),va=function(){return pe(pa,ha.get())},ba={getData:function(){return se(pa,function(e){return _e({},e)})},setCode:function(e){e&&ha.set(e)},getCode:function(){return ha.get()},add:function(e,t){var n=pa[e];n||(pa[e]=n={}),ce(t,function(e,t){n[t.toLowerCase()]=e})},translate:function(e){var t,n,r=va().getOr({}),o=function(e){return I(e)?Object.prototype.toString.call(e):i(e)?"":""+e},i=function(e){return""===e||null==e},u=function(e){var t=o(e);return pe(r,t.toLowerCase()).map(o).getOr(t)},a=function(e){return e.replace(/{context:\w+}$/,"")};if(i(e))return"";if(A(t=e)&&he(t,"raw"))return o(e.raw);if(R(n=e)&&1<n.length){var c=e.slice(1);return a(u(e[0]).replace(/\{([0-9]+)\}/g,function(e,t){return he(c,t)?o(c[t]):e}))}return a(u(e))},isRtl:function(){return va().bind(function(e){return pe(e,"_dir")}).exists(function(e){return"rtl"===e})},hasCode:function(e){return he(pa,e)}},ya=function(){var e=[],t={},n={},r=[],o=function(e,t){var n=$(r,function(n){return n.name===e&&n.state===t});q(n,function(e){return e.callback()})},i=function(e){var t;return n[e]&&(t=n[e].dependencies),t||[]},u=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},a=function(e,r,c,s,l){var f,d;t[e]||(0!==(f="string"==typeof r?r:r.prefix+r.resource+r.suffix).indexOf("/")&&-1===f.indexOf("://")&&(f=ya.baseURL+"/"+f),t[e]=f.substring(0,f.lastIndexOf("/")),d=function(){var t,n,l,f;o(e,"loaded"),t=r,n=c,l=s,f=i(e),q(f,function(e){var n=u(t,e);a(n.resource,n,void 0,void 0)}),n&&n.call(l||da)},n[e]?d():da.ScriptLoader.add(f,d,s,l))},c=function(e,o,i){void 0===i&&(i="added"),he(n,e)&&"added"===i||he(t,e)&&"loaded"===i?o():r.push({name:e,state:i,callback:o})};return{items:e,urls:t,lookup:n,_listeners:r,get:function(e){return n[e]?n[e].instance:void 0},dependencies:i,requireLangPack:function(e,n){!1!==ya.languageLoad&&c(e,function(){var r=ba.getCode();!r||n&&-1===(","+(n||"")+",").indexOf(","+r+",")||da.ScriptLoader.add(t[e]+"/langs/"+r+".js")},"loaded")},add:function(t,r,i){var u=r;return e.push(u),n[t]={instance:u,dependencies:i},o(t,"added"),u},remove:function(e){delete t[e],delete n[e]},createUrl:u,addComponents:function(e,n){var r=t[e];q(n,function(e){da.ScriptLoader.add(r+"/"+e)})},load:a,waitFor:c}};ya.languageLoad=!0,ya.baseURL="",ya.PluginManager=ya(),ya.ThemeManager=ya();var xa=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null===n&&(n=setTimeout(function(){e.apply(null,r),n=null},t))}}},wa=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}},Ca=function(e,t){var n=$n(e,t);return void 0===n||""===n?[]:n.split(" ")},Sa=function(e){return void 0!==e.dom.classList},ka=function(e,t){Sa(e)?e.dom.classList.add(t):function(e,t){return r=t,o=Ca(n=e,"class").concat([r]),qn(n,"class",o.join(" ")),!0;var n,r,o}(e,t)},Oa=function(e,t){return Sa(e)&&e.dom.classList.contains(t)},_a=function(e,t){var n=[];return q(Kt(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(_a(e,t))}),n},Ta=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Bt(o)?[]:W(o.querySelectorAll(n),At);var n,r,o},Ea=s("mce-annotation"),Aa=s("data-mce-annotation"),Ra=s("data-mce-annotation-uid"),Na=function(e,t){var n=e.selection.getRng(),r=At(n.startContainer),o=At(e.getBody()),i=t.fold(function(){return"."+Ea()},function(e){return"["+Aa()+'="'+e+'"]'}),u=Yt(r,n.startOffset).getOr(r),a=Tr(u,i,function(e){return Dt(e,o)}),c=function(e,t){return(n=e.dom)&&n.hasAttribute&&n.hasAttribute(t)?k.some($n(e,t)):k.none();var n};return a.bind(function(t){return c(t,""+Ra()).bind(function(n){return c(t,""+Aa()).map(function(t){var r=Ba(e,n);return{uid:n,name:t,elements:r}})})})},Ba=function(e,t){var n=At(e.getBody());return Ta(n,"["+Ra()+'="'+t+'"]')},Da=0,Pa=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Da+String(t)},Ma=function(e,t){var n,r,o=jt(e).dom,i=At(o.createDocumentFragment()),u=(n=t,(r=(o||document).createElement("div")).innerHTML=n,Kt(At(r)));ln(i,u),fn(e),sn(e,i)},Ia=function(e,t){return At(e.dom.cloneNode(t))},La=function(e){return Ia(e,!1)},Fa=function(e){return Ia(e,!0)},za=function(e,t,n){void 0===n&&(n=y);var r=new Vr(e,t),o=function(e){for(var t;(t=r[e]())&&!Dn(t)&&!n(t););return k.from(t).filter(Dn)};return{current:function(){return k.from(r.current()).filter(Dn)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}},Ha=function(e,t){var n=t||function(t){return e.isBlock(t)||Ln(t)||Hn(t)},r=function(e,t,n,o){if(Dn(e)){var i=o(e,t,e.data);if(-1!==i)return k.some({container:e,offset:i})}return n().bind(function(e){return r(e.container,e.offset,n,o)})};return{backwards:function(e,t,o,i){var u=za(e,i,n);return r(e,t,function(){return u.prev().map(function(e){return{container:e,offset:e.length}})},o).getOrNull()},forwards:function(e,t,o,i){var u=za(e,i,n);return r(e,t,function(){return u.next().map(function(e){return{container:e,offset:0}})},o).getOrNull()}}},Va=function(e,t,n){return e.isSome()&&t.isSome()?k.some(n(e.getOrDie(),t.getOrDie())):k.none()},ja=Math.round,Ua=function(e){return e?{left:ja(e.left),top:ja(e.top),bottom:ja(e.bottom),right:ja(e.right),width:ja(e.width),height:ja(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Wa=function(e,t){return e=Ua(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},qa=function(e,t,n){return 0<=e&&e<=Math.min(t.height,n.height)/2},Ga=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&qa(t.top-e.bottom,e,t)},$a=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&qa(t.bottom-e.top,e,t)},Xa=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Ka=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Ya=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Ja=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Qa=function(e){return"string"==typeof e&&768<=e.charCodeAt(0)&&Ja.test(e)},Za=On,ec=ko,tc=Tn("display","block table"),nc=Tn("float","left right"),rc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(Za,ec,p(nc)),oc=p(Tn("white-space","pre pre-line pre-wrap")),ic=Dn,uc=Ln,ac=ca.nodeIndex,cc=Ya,sc=function(e){return"createRange"in e?e.createRange():ca.DOM.createRng()},lc=function(e){return e&&/[\r\n\t ]/.test(e)},fc=function(e){return!!e.setStart&&!!e.setEnd},dc=function(e){var t,n=e.startContainer,r=e.startOffset;return!!(lc(e.toString())&&oc(n.parentNode)&&Dn(n)&&(t=n.data,lc(t[r-1])||lc(t[r+1])))},mc=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},gc=function(e){var t=e.getClientRects(),n=Ua(0<t.length?t[0]:e.getBoundingClientRect());return!fc(e)&&uc(e)&&mc(n)?function(e){var t=e.ownerDocument,n=sc(t),r=t.createTextNode(eo),o=e.parentNode;o.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var i=Ua(n.getBoundingClientRect());return o.removeChild(r),i}(e):mc(n)&&fc(e)?function(e){var t=e.endContainer,n=e.startOffset,r=e.endOffset;if(e.startContainer===t&&Dn(t)&&0===n&&1===r){var o=e.cloneRange();return o.setEndAfter(t),gc(o)}return null}(e):n},pc=function(e,t){var n=Wa(e,t);return n.width=1,n.right=n.left+1,n},hc=function(e,t,n){var r=function(){return n=n||function(e){var t,n,r=[],o=function(e){var t,n;0!==e.height&&(0<r.length&&(t=e).left===(n=r[r.length-1]).left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right||r.push(e))},i=function(e,t){var n=sc(e.ownerDocument);if(t<e.data.length){if(Qa(e.data[t]))return r;if(Qa(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!dc(n)))return o(pc(gc(n),!1)),r}0<t&&(n.setStart(e,t-1),n.setEnd(e,t),dc(n)||o(pc(gc(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),dc(n)||o(pc(gc(n),!0)))};if(ic(e.container()))return i(e.container(),e.offset()),r;if(Za(e.container()))if(e.isAtEnd())n=cc(e.container(),e.offset()),ic(n)&&i(n,n.data.length),rc(n)&&!uc(n)&&o(pc(gc(n),!1));else{if(n=cc(e.container(),e.offset()),ic(n)&&i(n,0),rc(n)&&e.isAtEnd())return o(pc(gc(n),!1)),r;t=cc(e.container(),e.offset()-1),rc(t)&&!uc(t)&&(!tc(t)&&!tc(n)&&rc(n)||o(pc(gc(t),!1))),rc(n)&&o(pc(gc(n),!0))}return r}(hc(e,t))};return{container:s(e),offset:s(t),toRange:function(){var n=sc(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return 0<r().length},isAtStart:function(){return ic(e),0===t},isAtEnd:function(){return ic(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return cc(e,n?t-1:t)}}};hc.fromRangeStart=function(e){return hc(e.startContainer,e.startOffset)},hc.fromRangeEnd=function(e){return hc(e.endContainer,e.endOffset)},hc.after=function(e){return hc(e.parentNode,ac(e)+1)},hc.before=function(e){return hc(e.parentNode,ac(e))},hc.isAbove=function(e,t){return Va(re(t.getClientRects()),oe(e.getClientRects()),Ga).getOr(!1)},hc.isBelow=function(e,t){return Va(oe(t.getClientRects()),re(e.getClientRects()),$a).getOr(!1)},hc.isAtStart=function(e){return!!e&&e.isAtStart()},hc.isAtEnd=function(e){return!!e&&e.isAtEnd()},hc.isTextPosition=function(e){return!!e&&Dn(e.container())},hc.isElementPosition=function(e){return!1===hc.isTextPosition(e)};var vc,bc,yc=function(e,t){Dn(t)&&0===t.data.length&&e.remove(t)},xc=function(e,t,n){var r,o,i,u,a,c,s;In(n)?(i=e,u=t,c=k.from((a=n).firstChild),s=k.from(a.lastChild),u.insertNode(a),c.each(function(e){return yc(i,e.previousSibling)}),s.each(function(e){return yc(i,e.nextSibling)})):(r=e,t.insertNode(o=n),yc(r,o.previousSibling),yc(r,o.nextSibling))},wc=Dn,Cc=An,Sc=ca.nodeIndex,kc=function(e){var t=e.parentNode;return Cc(t)?kc(t):t},Oc=function(e){return e?Se(e.childNodes,function(e,t){return Cc(t)&&"BR"!==t.nodeName?e=e.concat(Oc(t)):e.push(t),e},[]):[]},_c=function(e){return function(t){return e===t}},Tc=function(e){return(wc(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t=Oc(kc(e)),n=ke(t,_c(e),e);t=t.slice(0,n+1);var r=Se(t,function(e,n,r){return wc(n)&&wc(t[r-1])&&e++,e},0);return t=we(t,_n([e.nodeName])),(n=ke(t,_c(e),e))-r}(e)+"]"},Ec=function(e,t){var n,r,o,i=[],u=t.container(),a=t.offset();return wc(u)?n=function(e,t){for(;(e=e.previousSibling)&&wc(e);)t+=e.data.length;return t}(u,a):(a>=(r=u.childNodes).length?(n="after",a=r.length-1):n="before",u=r[a]),i.push(Tc(u)),o=function(e,t,n){var r=[];for(t=t.parentNode;t!==e;t=t.parentNode)r.push(t);return r}(e,u),o=we(o,p(An)),(i=i.concat(xe(o,Tc))).reverse().join("/")+","+n},Ac=function(e,t){if(!t)return null;var n=t.split(","),r=n[0].split("/"),o=1<n.length?n[1]:"before",i=Se(r,function(e,t){var n,r,o,i,u=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return u?("text()"===u[1]&&(u[1]="#text"),n=e,r=u[1],o=parseInt(u[2],10),i=Oc(n),i=we(i,function(e,t){return!wc(e)||!wc(i[t-1])}),(i=we(i,_n([r])))[o]):null},e);return i?wc(i)?function(e,t){for(var n,r=e,o=0;wc(r);){if(n=r.data.length,o<=t&&t<=o+n){e=r,t-=o;break}if(!wc(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return wc(e)&&t>e.data.length&&(t=e.data.length),hc(e,t)}(i,parseInt(o,10)):(o="after"===o?Sc(i)+1:Sc(i),hc(i.parentNode,o)):null},Rc=Hn,Nc=function(e,t,n,r,o){var i,u=r[o?"startContainer":"endContainer"],a=r[o?"startOffset":"endOffset"],c=[],s=0,l=e.getRoot();for(Dn(u)?c.push(n?function(e,t,n){for(var r=e(t.data.slice(0,n)).length,o=t.previousSibling;o&&Dn(o);o=o.previousSibling)r+=e(o.data).length;return r}(t,u,a):a):(a>=(i=u.childNodes).length&&i.length&&(s=1,a=Math.max(0,i.length-1)),c.push(e.nodeIndex(i[a],n)+s));u&&u!==l;u=u.parentNode)c.push(e.nodeIndex(u,n));return c},Bc=function(e,t,n){var r=0;return kt.each(e.select(t),function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++}),r},Dc=function(e,t){var n,r=t?"start":"end",o=e[r+"Container"],i=e[r+"Offset"];On(o)&&"TR"===o.nodeName&&(o=(n=o.childNodes)[Math.min(t?i:i-1,n.length-1)])&&e["set"+(t?"Start":"End")](o,i=t?0:o.childNodes.length)},Pc=function(e){return Dc(e,!0),Dc(e,!1),e},Mc=function(e,t){var n;if(On(e)&&(e=Ya(e,t),Rc(e)))return e;if(co(e)){if(Dn(e)&&uo(e)&&(e=e.parentNode),Rc(n=e.previousSibling))return n;if(Rc(n=e.nextSibling))return n}},Ic=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(Rc(r)||"IMG"===o)return{name:o,index:Bc(n.dom,o,r)};var u,a,c,s,l,f,d,m=Mc((u=i).startContainer,u.startOffset)||Mc(u.endContainer,u.endOffset);return m?{name:o=m.tagName,index:Bc(n.dom,o,m)}:(f=(c=n).dom,(d={}).start=Nc(f,a=e,s=t,l=i,!0),c.isCollapsed()||(d.end=Nc(f,a,s,l,!1)),d)},Lc=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},Fc=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),u=e.getNode(),a=u.nodeName;if("IMG"===a)return{name:a,index:Bc(n,a,u)};var c,s=Pc(r.cloneRange());i||(s.collapse(!1),c=Lc(n,o+"_end",t),xc(n,s,c)),(r=Pc(r)).collapse(!0);var l=Lc(n,o+"_start",t);return xc(n,r,l),e.moveToBookmark({id:o,keep:!0}),{id:o}},zc=f(Ic,l,!0),Hc=ca.DOM,Vc=function(e,t,n){var r=e.getParam(t,n);if(-1===r.indexOf("="))return r;var o=e.getParam(t,"","hash");return o.hasOwnProperty(e.id)?o[e.id]:n},jc=function(e){return e.getParam("content_security_policy","")},Uc=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Wc=function(e){return e.getParam("forced_root_block_attrs",{})},qc=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Gc=function(e){return e.getParam("icons","","string")},$c=function(e){return e.getParam("referrer_policy","","string")},Xc=function(e){return e.getParam("language","en","string")},Kc=function(e){return e.getParam("indent_use_margin",!1)},Yc=function(e){var t=e.getParam("font_css",[]);return R(t)?t:W(t.split(","),Ve)},Jc=function(e){var t=e.getParam("object_resizing");return!1!==t&&!yt.iOS&&(E(t)?t:"table,img,figure.image,div,video,iframe")},Qc=function(e){return e.getParam("event_root")},Zc=function(e){return e.getParam("theme")},es=function(e){return!1!==e.getParam("inline_boundaries")},ts=function(e){return e.getParam("plugins","","string")},ns=On,rs=Dn,os=function(e){var t=e.parentNode;t&&t.removeChild(e)},is=function(e){var t=ro(e);return{count:e.length-t.length,text:t}},us=function(e){for(var t;-1!==(t=e.data.lastIndexOf(to));)e.deleteData(t,1)},as=function(e,t){return ls(e),t},cs=function(e,t){var n,r,o=t.container(),i=(n=ie(o.childNodes),(-1===(r=V(n,e))?k.none():k.some(r)).map(function(e){return e<t.offset()?hc(o,t.offset()-1):t}).getOr(t));return ls(e),i},ss=function(e,t){return hc.isTextPosition(t)?function(e,t){return rs(e)&&t.container()===e?(o=is((n=e).data.substr(0,(r=t).offset())),i=is(n.data.substr(r.offset())),0<(o.text+i.text).length?(us(n),hc(n,r.offset()-o.count)):r):as(e,t);var n,r,o,i}(e,t):(n=e,((r=t).container()===n.parentNode?cs:as)(n,r));var n,r},ls=function(e){ns(e)&&co(e)&&(so(e)?e.removeAttribute("data-mce-caret"):os(e)),rs(e)&&(us(e),0===e.data.length&&os(e))},fs=lt().browser,ds=Hn,ms=jn,gs=Vn,ps=function(e,t,n){var r,o,i,u,a=Wa(t.getBoundingClientRect(),n),c="BODY"===e.tagName?(r=e.ownerDocument.documentElement,o=e.scrollLeft||r.scrollLeft,e.scrollTop||r.scrollTop):(u=e.getBoundingClientRect(),o=e.scrollLeft-u.left,e.scrollTop-u.top);return a.left+=o,a.right+=o,a.top+=c,a.bottom+=c,a.width=1,0<(i=t.offsetWidth-t.clientWidth)&&(n&&(i*=-1),a.left+=i,a.right+=i),a},hs=function(){return fs.isIE()||fs.isEdge()||fs.isFirefox()},vs=function(e){return ds(e)||ms(e)},bs=function(e){return vs(e)||Rn(e)&&hs()},ys=Hn,xs=jn,ws=Tn("display","block table table-cell table-caption list-item"),Cs=co,Ss=uo,ks=On,Os=ko,_s=function(e,t){for(var n;n=e(t);)if(!Ss(n))return n;return null},Ts=function(e,t,n,r,o){var i=new Vr(e,r),u=ys(e)||Ss(e);if(t<0){if(u&&n(e=_s(i.prev.bind(i),!0)))return e;for(;e=_s(i.prev.bind(i),o);)if(n(e))return e}if(0<t){if(u&&n(e=_s(i.next.bind(i),!0)))return e;for(;e=_s(i.next.bind(i),o);)if(n(e))return e}return null},Es=function(e,t){for(;e&&e!==t;){if(ws(e))return e;e=e.parentNode}return null},As=function(e,t,n){return Es(e.container(),n)===Es(t.container(),n)},Rs=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return ks(n)?n.childNodes[r+e]:null},Ns=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},Bs=function(e,t,n){for(var r,o,i,u=e?"previousSibling":"nextSibling";n&&n!==t;){if(Cs(r=n[u])&&(r=r[u]),ys(r)||xs(r)){if(i=n,Es(r,o=t)===Es(i,o))return r;break}if(Os(r))break;n=n.parentNode}return null},Ds=f(Ns,!0),Ps=f(Ns,!1),Ms=function(e,t,n){var r,o,i=f(Bs,!0,t),u=f(Bs,!1,t),a=n.startContainer,c=n.startOffset;if(uo(a)){if(ks(a)||(a=a.parentNode),"before"===(o=a.getAttribute("data-mce-caret"))&&bs(r=a.nextSibling))return Ds(r);if("after"===o&&bs(r=a.previousSibling))return Ps(r)}if(!n.collapsed)return n;if(Dn(a)){if(Cs(a)){if(1===e){if(r=u(a))return Ds(r);if(r=i(a))return Ps(r)}if(-1===e){if(r=i(a))return Ps(r);if(r=u(a))return Ds(r)}return n}if(go(a)&&c>=a.data.length-1)return 1===e&&(r=u(a))?Ds(r):n;if(mo(a)&&c<=1)return-1===e&&(r=i(a))?Ps(r):n;if(c===a.data.length)return(r=u(a))?Ds(r):n;if(0===c)return(r=i(a))?Ps(r):n}return n},Is=function(e,t){return k.from(Rs(e?0:-1,t)).filter(ys)},Ls=function(e,t,n){var r=Ms(e,t,n);return-1===e?hc.fromRangeStart(r):hc.fromRangeEnd(r)},Fs=function(e){return k.from(e.getNode()).map(At)},zs=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},Hs=function(e,t){var n=As(e,t);return!(n||!Ln(e.getNode()))||n};(bc=vc=vc||{})[bc.Backwards=-1]="Backwards",bc[bc.Forwards=1]="Forwards";var Vs,js,Us=Hn,Ws=Dn,qs=On,Gs=Ln,$s=ko,Xs=function(e){return wo(e)||!!Oo(t=e)&&!0!==K(ie(t.getElementsByTagName("*")),function(e,t){return e||ho(t)},!1);var t},Ks=_o,Ys=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},Js=function(e,t){if(0<e){if($s(t.previousSibling)&&!Ws(t.previousSibling))return hc.before(t);if(Ws(t))return hc(t,0)}if(e<0){if($s(t.nextSibling)&&!Ws(t.nextSibling))return hc.after(t);if(Ws(t))return hc(t,t.data.length)}return e<0&&!Gs(t)?hc.after(t):hc.before(t)},Qs=function(e,t,n){var r,o,i,u;if(!qs(n)||!t)return null;if(t.isEqual(hc.after(n))&&n.lastChild){if(u=hc.after(n.lastChild),e<0&&$s(n.lastChild)&&qs(n.lastChild))return Gs(n.lastChild)?hc.before(n.lastChild):u}else u=t;var a,c,s,l=u.container(),f=u.offset();if(Ws(l)){if(e<0&&0<f)return hc(l,--f);if(0<e&&f<l.length)return hc(l,++f);r=l}else{if(e<0&&0<f&&(o=Ys(l,f-1),$s(o)))return!Xs(o)&&(i=Ts(o,e,Ks,o))?Ws(i)?hc(i,i.data.length):hc.after(i):Ws(o)?hc(o,o.data.length):hc.before(o);if(0<e&&f<l.childNodes.length&&(o=Ys(l,f),$s(o)))return Gs(o)?(a=n,(s=(c=o).nextSibling)&&$s(s)?Ws(s)?hc(s,0):hc.before(s):Qs(vc.Forwards,hc.after(c),a)):!Xs(o)&&(i=Ts(o,e,Ks,o))?Ws(i)?hc(i,0):hc.before(i):Ws(o)?hc(o,0):hc.after(o);r=o||u.getNode()}if((0<e&&u.isAtEnd()||e<0&&u.isAtStart())&&(r=Ts(r,e,x,n,!0),Ks(r,n)))return Js(e,r);o=Ts(r,e,Ks,n);var d=Oe($(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(l,n),Us));return!d||o&&d.contains(o)?o?Js(e,o):null:u=0<e?hc.after(d):hc.before(d)},Zs=function(e){return{next:function(t){return Qs(vc.Forwards,t,e)},prev:function(t){return Qs(vc.Backwards,t,e)}}},el=function(e){return hc.isTextPosition(e)?0===e.offset():ko(e.getNode())},tl=function(e){if(hc.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return ko(e.getNode(!0))},nl=function(e,t){return!hc.isTextPosition(e)&&!hc.isTextPosition(t)&&e.getNode()===t.getNode(!0)},rl=function(e,t,n){var r=Zs(t);return k.from(e?r.next(n):r.prev(n))},ol=function(e,t,n){return rl(e,t,n).bind(function(r){return As(n,r,t)&&function(e,t,n){return e?!nl(t,n)&&!(!hc.isTextPosition(r=t)&&Ln(r.getNode()))&&tl(t)&&el(n):!nl(n,t)&&el(t)&&tl(n);var r}(e,n,r)?rl(e,t,r):k.some(r)})},il=function(e,t,n,r){return ol(e,t,n).bind(function(n){return r(n)?il(e,t,n,r):k.some(n)})},ul=function(e,t){var n,r,o,i,u,a=e?t.firstChild:t.lastChild;return Dn(a)?k.some(hc(a,e?0:a.data.length)):a?ko(a)?k.some(e?hc.before(a):Ln(u=a)?hc.before(u):hc.after(u)):(r=t,o=a,i=(n=e)?hc.before(o):hc.after(o),rl(n,r,i)):k.none()},al=f(rl,!0),cl=f(rl,!1),sl=f(ul,!0),ll=f(ul,!1),fl="_mce_caret",dl=function(e){return On(e)&&e.id===fl},ml=function(e,t){for(;t&&t!==e;){if(t.id===fl)return t;t=t.parentNode}return null},gl=function(e,t){return On(t)&&e.isBlock(t)&&!t.innerHTML&&!yt.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},pl=function(e,t,n){return!(!1!==t.hasChildNodes()||!ml(e,t)||(o=n,i=(r=t).ownerDocument.createTextNode(to),r.appendChild(i),o.setStart(i,0),o.setEnd(i,0),0));var r,o,i},hl=function(e,t,n,r){var o,i,u,a,c=n[t?"start":"end"],s=e.getRoot();if(c){for(u=c[0],i=s,o=c.length-1;1<=o;o--){if(a=i.childNodes,pl(s,i,r))return!0;if(c[o]>a.length-1)return!!pl(s,i,r)||function(e,t){return ll(e).fold(y,function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0})}(i,r);i=a[c[o]]}3===i.nodeType&&(u=Math.min(c[0],i.nodeValue.length)),1===i.nodeType&&(u=Math.min(c[0],i.childNodes.length)),t?r.setStart(i,u):r.setEnd(i,u)}return!0},vl=function(e){return Dn(e)&&0<e.data.length},bl=function(e,t,n){var r,o,i,u,a,c,s=e.get(n.id+"_"+t),l=n.keep;if(s){if(r=s.parentNode,o="start"===t?l?s.hasChildNodes()?(r=s.firstChild,1):vl(s.nextSibling)?(r=s.nextSibling,0):vl(s.previousSibling)?(r=s.previousSibling,s.previousSibling.data.length):(r=s.parentNode,e.nodeIndex(s)+1):e.nodeIndex(s):l?s.hasChildNodes()?(r=s.firstChild,1):vl(s.previousSibling)?(r=s.previousSibling,s.previousSibling.data.length):(r=s.parentNode,e.nodeIndex(s)):e.nodeIndex(s),a=r,c=o,!l){for(u=s.previousSibling,i=s.nextSibling,kt.each(kt.grep(s.childNodes),function(e){Dn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))});s=e.get(n.id+"_"+t);)e.remove(s,!0);u&&i&&u.nodeType===i.nodeType&&Dn(u)&&!yt.opera&&(o=u.nodeValue.length,u.appendData(i.nodeValue),e.remove(i),a=u,c=o)}return k.some(hc(a,c))}return k.none()},yl=function(e,t,n){return 2===t?Ic(ro,n,e):3===t?(o=(r=e).getRng(),{start:Ec(r.dom.getRoot(),hc.fromRangeStart(o)),end:Ec(r.dom.getRoot(),hc.fromRangeEnd(o))}):t?{rng:e.getRng()}:Fc(e,!1);var r,o},xl=function(e,t){(function(e,t){var n,r,o,i,u,a,c,s,l,f,d,m,g,p=e.dom;if(t){if(kt.isArray(t.start))return m=t,g=(d=p).createRng(),hl(d,!0,m,g)&&hl(d,!1,m,g)?k.some(g):k.none();if(E(t.start))return k.some((s=t,l=(c=p).createRng(),f=Ac(c.getRoot(),s.start),l.setStart(f.container(),f.offset()),f=Ac(c.getRoot(),s.end),l.setEnd(f.container(),f.offset()),l));if(t.hasOwnProperty("id"))return u=bl(o=p,"start",i=t),a=bl(o,"end",i),Va(u,a.or(u),function(e,t){var n=o.createRng();return n.setStart(gl(o,e.container()),e.offset()),n.setEnd(gl(o,t.container()),t.offset()),n});if(t.hasOwnProperty("name"))return k.from((n=p).select((r=t).name)[r.index]).map(function(e){var t=n.createRng();return t.selectNode(e),t});if(t.hasOwnProperty("rng"))return k.some(t.rng)}return k.none()})(e,t).each(function(t){e.setRng(t)})},wl=function(e){return On(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},Cl=function(e){return" "===e},Sl=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},kl=function(e){return!Sl(e)&&!Cl(e)},Ol=function(e){return!!e.nodeType},_l=function(e,t,n){var r,o,i,u,a=n.startOffset,c=n.startContainer;if(!(n.startContainer===n.endContainer&&(u=n.startContainer.childNodes[n.startOffset])&&/^(IMG)$/.test(u.nodeName)||1!==c.nodeType))for(a<(i=c.childNodes).length?r=new Vr(c=i[a],e.getParent(c,e.isBlock)):(r=new Vr(c=i[i.length-1],e.getParent(c,e.isBlock))).next(!0),o=r.current();o;o=r.next())if(3===o.nodeType&&!Rl(o))return n.setStart(o,0),void t.setRng(n)},Tl=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(1===e.nodeType||!Rl(e))return e}},El=function(e,t){return Ol(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},Al=function(e,t,n){return e.schema.isValidChild(t,n)},Rl=function(e,t){if(void 0===t&&(t=!1),M(e)&&Dn(e)){var n=t?e.data.replace(/ /g," "):e.data;return Eo(n)}return!1},Nl=function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,function(e,n){return t[n]||e})),e},Bl=function(e,t){return e=""+((e=e||"").nodeName||e),t=""+((t=t||"").nodeName||t),e.toLowerCase()===t.toLowerCase()},Dl=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},Pl=function(e,t,n){return Dl(e,e.getStyle(t,n),n)},Ml=function(e,t){var n;return e.getParent(t,function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n}),n},Il=function(e,t,n){return e.getParents(t,n,e.getRoot())},Ll=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],o=function(e){return ge(e,function(e,t){return U(r,function(e){return e===t})})};return U(e.formatter.get(t),function(t){var r=o(t);return U(e.formatter.get(n),function(e){var t,n,a,c=o(e);return t=r,n=c,void 0===a&&(a=u),i(a).eq(t,n)})})},Fl=function(e){return ve(e,"block")},zl=function(e){return ve(e,"selector")},Hl=function(e){return ve(e,"inline")},Vl=wl,jl=Il,Ul=Rl,Wl=El,ql=function(e,t){for(var n=t;n;){if(On(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},Gl=function(e,t,n,r){for(var o=t.data,i=n;e?0<=i:i<o.length;e?i--:i++)if(r(o.charAt(i)))return e?i+1:i;return-1},$l=function(e,t,n){return Gl(e,t,n,function(e){return Cl(e)||Sl(e)})},Xl=function(e,t,n){return Gl(e,t,n,kl)},Kl=function(e,t,n,r,o,i){var u,a=e.getParent(n,e.isBlock)||t,c=function(t,n,r){var i=Ha(e);return k.from((o?i.backwards:i.forwards)(t,n,function(e,t){return Vl(e.parentNode)?-1:r(o,u=e,t)},a))};return c(n,r,$l).bind(function(e){return i?c(e.container,e.offset+(o?-1:0),Xl):k.some(e)}).orThunk(function(){return u?k.some({container:u,offset:o?0:u.length}):k.none()})},Yl=function(e,t,n,r,o){Dn(r)&&0===r.nodeValue.length&&r[o]&&(r=r[o]);for(var i=jl(e,r),u=0;u<i.length;u++)for(var a=0;a<t.length;a++){var c=t[a];if((!("collapsed"in c)||c.collapsed===n.collapsed)&&e.is(i[u],c.selector))return i[u]}return r},Jl=function(e,t,n,r){var o,i,u=e.dom,a=u.getRoot();if(t[0].wrapper||(i=u.getParent(n,t[0].block,a)),i||(o=u.getParent(n,"LI,TD,TH"),i=u.getParent(Dn(n)?n.parentNode:n,function(t){return t!==a&&Wl(e,t)},o)),i&&t[0].wrapper&&(i=jl(u,i,"ul,ol").reverse()[0]||i),!i)for(i=n;i[r]&&!u.isBlock(i[r])&&!Bl(i=i[r],"br"););return i||n},Ql=function(e,t,n,r){var o=n.parentNode;return!M(n[r])&&(!(o!==t&&!P(o)&&!e.isBlock(o))||Ql(e,t,o,r))},Zl=function(e,t,n,r,o){var i,u,a=n,c=o?"previousSibling":"nextSibling",s=e.getRoot();if(Dn(n)&&!Ul(n)&&(o?0<r:r<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(a))return a;for(i=a[c];i;i=i[c]){var l=Dn(i)&&!Ql(e,s,i,c);if(!Vl(i)&&(!Ln(u=i)||!u.getAttribute("data-mce-bogus")||u.nextSibling)&&!Ul(i,l))return a}if(a===s||a.parentNode===s){n=a;break}a=a.parentNode}return n},ef=function(e){return Vl(e.parentNode)||Vl(e)},tf=function(e,t,n,r){void 0===r&&(r=!1);var o=t.startContainer,i=t.startOffset,u=t.endContainer,a=t.endOffset,c=e.dom;return On(o)&&o.hasChildNodes()&&(o=Ya(o,i),Dn(o)&&(i=0)),On(u)&&u.hasChildNodes()&&(u=Ya(u,t.collapsed?a:a-1),Dn(u)&&(a=u.nodeValue.length)),o=ql(c,o),u=ql(c,u),ef(o)&&(o=Vl(o)?o:o.parentNode,Dn(o=t.collapsed?o.previousSibling||o:o.nextSibling||o)&&(i=t.collapsed?o.length:0)),ef(u)&&(u=Vl(u)?u:u.parentNode,Dn(u=t.collapsed?u.nextSibling||u:u.previousSibling||u)&&(a=t.collapsed?0:u.length)),t.collapsed&&(Kl(c,e.getBody(),o,i,!0,r).each(function(e){o=e.container,i=e.offset}),Kl(c,e.getBody(),u,a,!1,r).each(function(e){u=e.container,a=e.offset})),(n[0].inline||n[0].block_expand)&&(n[0].inline&&Dn(o)&&0!==i||(o=Zl(c,n,o,i,!0)),n[0].inline&&Dn(u)&&a!==u.nodeValue.length||(u=Zl(c,n,u,a,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(o=Yl(c,n,t,o,"previousSibling"),u=Yl(c,n,t,u,"nextSibling")),(n[0].block||n[0].selector)&&(o=Jl(e,n,o,"previousSibling"),u=Jl(e,n,u,"nextSibling"),n[0].block&&(c.isBlock(o)||(o=Zl(c,n,o,i,!0)),c.isBlock(u)||(u=Zl(c,n,u,a,!1)))),On(o)&&(i=c.nodeIndex(o),o=o.parentNode),On(u)&&(a=c.nodeIndex(u)+1,u=u.parentNode),{startContainer:o,startOffset:i,endContainer:u,endOffset:a}},nf=function(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e},rf=function(e,t,n){var r=t.startContainer,o=t.startOffset,i=t.endContainer,u=t.endOffset,a=function(e){var t=e[0];return 3===t.nodeType&&t===r&&o>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===u&&0<e.length&&t===i&&3===t.nodeType&&e.splice(e.length-1,1),e},c=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},s=function(e,t){do{if(e.parentNode===t)return e;e=e.parentNode}while(e)},l=function(e,t,r){for(var o=r?"nextSibling":"previousSibling",i=e,u=i.parentNode;i&&i!==t;i=u){u=i.parentNode;var s=c(i===e?i:i[o],o);s.length&&(r||s.reverse(),n(a(s)))}};if(1===r.nodeType&&r.hasChildNodes()&&(r=nf(r,o)),1===i.nodeType&&i.hasChildNodes()&&(i=nf(i,u-1)),r===i)return n(a([r]));for(var f=e.findCommonAncestor(r,i),d=r;d;d=d.parentNode){if(d===i)return l(r,f,!0);if(d===f)break}for(d=i;d;d=d.parentNode){if(d===r)return l(i,f);if(d===f)break}var m=s(r,f)||r,g=s(i,f)||i;l(r,m,!0);var p=c(m===r?m:m.nextSibling,"nextSibling",g===i?g.nextSibling:g);p.length&&n(a(p)),l(i,g)},of=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},uf=function(e,t){var n=Ta(t,"td[data-mce-selected],th[data-mce-selected]");return 0<n.length?n:function(e){return $(Q(e,function(e){var t=Ka(e);return t?[At(t)]:[]}),Qr)}(e)},af=function(e){return uf(of(e.selection.getSel()),At(e.getBody()))},cf=function(e){return Jt(e).fold(s([e]),function(t){return[e].concat(cf(t))})},sf=function(e){return Qt(e).fold(s([e]),function(t){return"br"===Mt(t)?qt(t).map(function(t){return[e].concat(sf(t))}).getOr([]):[e].concat(sf(t))})},lf=function(e,t){return Va((u=(i=t).startContainer,a=i.startOffset,Dn(u)?0===a?k.some(At(u)):k.none():k.from(u.childNodes[a]).map(At)),(r=(n=t).endContainer,o=n.endOffset,Dn(r)?o===r.data.length?k.some(At(r)):k.none():k.from(r.childNodes[o-1]).map(At)),function(t,n){var r=Y(cf(e),f(Dt,t)),o=Y(sf(e),f(Dt,n));return r.isSome()&&o.isSome()}).getOr(!1);var n,r,o,i,u,a},ff=function(e,t,n,r){var o=n,i=new Vr(n,o),u=ge(e.schema.getMoveCaretBeforeOnEnterElements(),function(e,t){return!j(["td","th","table"],t.toLowerCase())});do{if(Dn(n)&&0!==kt.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(u[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},df=function(e){var t=e.selection.getSel();return t&&0<t.rangeCount},mf=function(e,t){var n=af(e);0<n.length?q(n,function(n){var r=n.dom,o=e.dom.createRng();o.setStartBefore(r),o.setEndAfter(r),t(o,!0)}):t(e.selection.getRng(),!1)},gf=function(e,t,n){var r=Fc(e,t);n(r),e.moveToBookmark(r)},pf=(Vs=zt,{get:function(e){if(!Vs(e))throw new Error("Can only get text value of a text node");return js(e).getOr("")},getOption:js=function(e){return Vs(e)?k.from(e.dom.nodeValue):k.none()},set:function(e,t){if(!Vs(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),hf=function(e){return pf.get(e)},vf=function(e,t,n,r){var o=t.uid,i=void 0===o?Pa("mce-annotation"):o,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["uid"]),a=Tt("span",e);ka(a,Ea()),qn(a,""+Ra(),i),qn(a,""+Aa(),n);var c,s=r(i,u),l=s.attributes,f=s.classes,d=void 0===f?[]:f;return Gn(a,void 0===l?{}:l),c=a,q(d,function(e){ka(c,e)}),a},bf=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return t.hasOwnProperty(e)?k.from(t[e]).map(function(e){return e.settings}):k.none()}});!function(e,t){e.on("init",function(){e.serializer.addNodeFilter("span",function(e){q(e,function(e){k.from(e.attr(Aa())).bind(t.lookup).each(function(t){!1===t.persistent&&e.unwrap()})})})})}(e,n);var r=function(e,t){var n=ga({}),r=function(e,t){o(e,function(e){return t(e),e})},o=function(e,t){var r=n.get(),o=t(r.hasOwnProperty(e)?r[e]:{listeners:[],previous:ga(k.none())});r[e]=o,n.set(r)},i=wa(function(){var t,i,u=n.get(),a=(t=ue(u),(i=F.call(t,0)).sort(void 0),i);q(a,function(t){o(t,function(n){var o=n.previous.get();return Na(e,k.some(t)).fold(function(){var e;o.isSome()&&(r(e=t,function(t){q(t.listeners,function(t){return t(!1,e)})}),n.previous.set(k.none()))},function(e){var t,i,u,a=e.uid,c=e.name,s=e.elements;o.is(a)||(i=a,u=s,r(t=c,function(e){q(e.listeners,function(e){return e(!0,t,{uid:i,nodes:W(u,function(e){return e.dom})})})}),n.previous.set(k.some(a)))}),{previous:n.previous,listeners:n.listeners}})})},30);return e.on("remove",function(){i.cancel()}),e.on("NodeChange",function(){i.throttle()}),{addListener:function(e,t){o(e,function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}})}}}(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,r){n.lookup(t).each(function(n){!function(e,t,n,r){e.undoManager.transact(function(){var o,i,u,a,c=e.selection,s=c.getRng(),l=0<af(e).length;s.collapsed&&!l&&(u=tf(o=e,i=s,[{inline:!0}]),i.setStart(u.startContainer,u.startOffset),i.setEnd(u.endContainer,u.endOffset),o.selection.setRng(i)),c.getRng().collapsed&&!l?(a=vf(e.getDoc(),r,t,n.decorate),Ma(a,eo),c.getRng().insertNode(a.dom),c.select(a.dom)):gf(c,!1,function(){mf(e,function(o){!function(e,t,n,r,o){var i=[],u=vf(e.getDoc(),o,n,r),a=ga(k.none()),c=function(){a.set(k.none())},s=function(e){q(e,l)},l=function(t){var n,r;switch(function(e,t,n,r){return Wt(t).fold(function(){return"skipping"},function(o){return"br"===r||zt(u=t)&&hf(u)===to?"valid":Ft(i=t)&&Oa(i,Ea())?"existing":dl(t.dom)?"caret":Al(e,n,r)&&Al(e,Mt(o),n)?"valid":"invalid-child";var i,u})}(e,t,"span",Mt(t))){case"invalid-child":c();var o=Kt(t);s(o),c();break;case"valid":var l=a.get().getOrThunk(function(){var e=La(u);return i.push(e),a.set(k.some(e)),e});un(n=t,r=l),sn(r,n)}};rf(e.dom,t,function(e){var t;c(),t=W(e,At),s(t)})}(e,o,t,n.decorate,r)})})})}(e,t,n,r)})},annotationChanged:function(e,t){r.addListener(e,t)},remove:function(t){Na(e,k.some(t)).each(function(e){q(e.elements,mn)})},getAll:function(t){var n,r,o,i,u=(n=t,r=At(e.getBody()),o=Ta(r,"["+Aa()+'="'+n+'"]'),i={},q(o,function(e){var t=$n(e,Ra()),n=i.hasOwnProperty(t)?i[t]:[];i[t]=n.concat([e])}),i);return se(u,function(e){return W(e,function(e){return e.dom})})}}},yf=function(e){return{getBookmark:f(yl,e),moveToBookmark:f(xl,e)}};yf.isBookmarkNode=wl;var xf=function(e,t){for(;t&&t!==e;){if(zn(t)||Hn(t))return t;t=t.parentNode}return null},wf=function(e,t,n){if(n.collapsed)return!1;if(yt.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(On(r))return U(r.getClientRects(),function(n){return Xa(n,e,t)})}return U(n.getClientRects(),function(n){return Xa(n,e,t)})},Cf=function(e,t,n){return e.fire(t,n)},Sf={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||Sf.metaKeyPressed(e)},metaKeyPressed:function(e){return yt.mac?e.metaKey:e.ctrlKey&&!e.altKey}},kf=Hn,Of=function(e,t){var n,r,o,i,u,a,c,s,l,f,m,g,p,h,v,b="data-mce-selected",y=t.dom,x=kt.each,w=t.getDoc(),C=document,S=Math.abs,k=Math.round,O=t.getBody(),_={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},T=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},E=function(e){return jn(e)||y.hasClass(e,"mce-preview-object")},A=function(e){var n=e.target;!function(e,t){if("longpress"!==e.type&&0!==e.type.indexOf("touch"))return T(e.target)&&!wf(e.clientX,e.clientY,t);var n=e.touches[0];return T(e.target)&&!wf(n.clientX,n.clientY,t)}(e,t.selection.getRng())||e.isDefaultPrevented()||t.selection.select(n)},R=function(e){return y.is(e,"figure.image")?[e.querySelector("img")]:y.hasClass(e,"mce-preview-object")&&M(e.firstElementChild)?[e,e.firstElementChild]:[e]},N=function(e){var n=Jc(t);return!!n&&"false"!==e.getAttribute("data-mce-resize")&&e!==t.getBody()&&(y.hasClass(e,"mce-preview-object")?Nt(At(e.firstElementChild),n):Nt(At(e),n))},B=function(e,n,r){var o;M(r)&&(o=R(e),q(o,function(e){e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?y.setStyle(e,n,r):y.setAttrib(e,n,""+r)}))},D=function(e,t,n){B(e,"width",t),B(e,"height",n)},P=function(e){var u,d,b=e.screenX-a,x=e.screenY-c;g=(g=b*i[2]+s)<5?5:g,p=(p=x*i[3]+l)<5?5:p,((T(n)||E(n))&&!1!==t.getParam("resize_img_proportional",!0,"boolean")?!Sf.modifierPressed(e):Sf.modifierPressed(e))&&(S(b)>S(x)?(p=k(g*f),g=k(p/f)):(g=k(p/f),p=k(g*f))),D(r,g,p),u=0<(u=i.startPos.x+b)?u:0,d=0<(d=i.startPos.y+x)?d:0,y.setStyles(o,{left:u,top:d,display:"block"}),o.innerHTML=g+" &times; "+p,i[2]<0&&r.clientWidth<=g&&y.setStyle(r,"left",void 0+(s-g)),i[3]<0&&r.clientHeight<=p&&y.setStyle(r,"top",void 0+(l-p)),(b=O.scrollWidth-h)+(x=O.scrollHeight-v)!=0&&y.setStyles(o,{left:u-b,top:d-x}),m||(t.fire("ObjectResizeStart",{target:n,width:s,height:l,origin:"corner-"+i.name}),m=!0)},I=function(){var e=m;m=!1,e&&(B(n,"width",g),B(n,"height",p)),y.unbind(w,"mousemove",P),y.unbind(w,"mouseup",I),C!==w&&(y.unbind(C,"mousemove",P),y.unbind(C,"mouseup",I)),y.remove(r),y.remove(o),y.remove(u),L(n),e&&(t.fire("ObjectResized",{target:n,width:g,height:p,origin:"corner-"+i.name}),y.setAttrib(n,"style",y.getAttrib(n,"style"))),t.nodeChanged()},L=function(e){V();var d=y.getPos(e,O),m=d.x,S=d.y,k=e.getBoundingClientRect(),T=k.width||k.right-k.left,A=k.height||k.bottom-k.top;n!==e&&(F(),n=e,g=p=0);var B=t.fire("ObjectSelected",{target:e}),M=y.getAttrib(n,b,"1");N(e)&&!B.isDefaultPrevented()?x(_,function(e,t){var d=y.get("mceResizeHandle"+t);d&&y.remove(d),d=y.add(O,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===yt.ie&&(d.contentEditable=!1),y.bind(d,"mousedown",function(d){d.stopImmediatePropagation(),d.preventDefault(),function(d){var g,p=R(n)[0];a=d.screenX,c=d.screenY,f=(l=p.clientHeight)/(s=p.clientWidth),(i=e).name=t,i.startPos={x:T*e[0]+m,y:A*e[1]+S},h=O.scrollWidth,v=O.scrollHeight,u=y.add(O,"div",{class:"mce-resize-backdrop"}),y.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),r=E(g=n)?y.create("img",{src:yt.transparentSrc}):g.cloneNode(!0),y.addClass(r,"mce-clonedresizable"),y.setAttrib(r,"data-mce-bogus","all"),r.contentEditable="false",y.setStyles(r,{left:m,top:S,margin:0}),D(r,T,A),r.removeAttribute(b),O.appendChild(r),y.bind(w,"mousemove",P),y.bind(w,"mouseup",I),C!==w&&(y.bind(C,"mousemove",P),y.bind(C,"mouseup",I)),o=y.add(O,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},s+" &times; "+l)}(d)}),e.elm=d,y.setStyles(d,{left:T*e[0]+m-d.offsetWidth/2,top:A*e[1]+S-d.offsetHeight/2})}):F(),y.getAttrib(n,b)||n.setAttribute(b,M)},F=function(){V(),n&&n.removeAttribute(b),ce(_,function(e,t){var n=y.get("mceResizeHandle"+t);n&&(y.unbind(n),y.remove(n))})},z=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};m||t.removed||(x(y.select("img[data-mce-selected],hr[data-mce-selected]"),function(e){e.removeAttribute(b)}),r="mousedown"===n.type?n.target:e.getNode(),o(r=y.$(r).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0],O)&&(j(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?L(r):F())},H=function(e){return kf(xf(t.getBody(),e))},V=function(){ce(_,function(e){e.elm&&(y.unbind(e.elm),delete e.elm)})},j=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(d){}};return t.on("init",function(){var e;j(),(yt.browser.isIE()||yt.browser.isEdge())&&(t.on("mousedown click",function(e){var n=e.target,r=n.nodeName;m||!/^(TABLE|IMG|HR)$/.test(r)||H(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}),y.bind(O,"mscontrolselect",e=function(e){var n=function(e){Fr.setEditorTimeout(t,function(){return t.selection.select(e)})};if(H(e.target)||jn(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))}),t.on("remove",function(){return y.unbind(O,"mscontrolselect",e)}));var r=Fr.throttle(function(e){t.composing||z(e)});t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),t.on("keyup compositionend",function(e){n&&"TABLE"===n.nodeName&&r(e)}),t.on("hide blur",F),t.on("contextmenu longpress",A,!0)}),t.on("remove",V),{isResizable:N,showResizeRect:L,hideResizeRect:F,updateResizeRect:z,destroy:function(){n=r=u=null}}},_f=function(e){return zn(e)||Hn(e)},Tf=function(e,t,n){var r,i,u,a,c,s=n;if(s.caretPositionFromPoint)(i=s.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(i.offsetNode,i.offset),r.collapse(!0));else if(n.caretRangeFromPoint)r=n.caretRangeFromPoint(e,t);else if(s.body.createTextRange){r=s.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o=n.elementFromPoint(e,t),i=n.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=n.body),i.moveToElementText(o),0<(r=(r=kt.toArray(i.getClientRects())).sort(function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-Math.abs(Math.max(n.top-t,n.bottom-t))})).length){t=(r[0].bottom+r[0].top)/2;try{return i.moveToPoint(e,t),i.collapse(!0),i}catch(a){}}return null}(e,t,n)}return a=n.body,c=(u=r)&&u.parentElement?u.parentElement():null,Hn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(c,a,_f))?null:u}return r},Ef=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Af=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},Rf=function(e){return e&&"TABLE"===e.nodeName},Nf=function(e,t,n){for(var r=new Vr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(Ln(t))return!0},Bf=function(e,t,n,r,o){var i,u,a=e.getRoot(),c=e.schema.getNonEmptyElements(),s=e.getParent(o.parentNode,e.isBlock)||a;if(r&&Ln(o)&&t&&e.isEmpty(s))return k.some(hc(o.parentNode,e.nodeIndex(o)));for(var l,f,d=new Vr(o,s);u=d[r?"prev":"next"]();){if("false"===e.getContentEditableParent(u)||(f=a,co(l=u)&&!1===Af(l,f,dl)))return k.none();if(Dn(u)&&0<u.nodeValue.length)return!1===function(e,t,n){return Af(e,t,function(e){return"A"===e.nodeName})}(u,a)?k.some(hc(u,r?u.nodeValue.length:0)):k.none();if(e.isBlock(u)||c[u.nodeName.toLowerCase()])return k.none();i=u}return n&&i?k.some(hc(i,0)):k.none()},Df=function(e,t,n,r){var o,i,u,a=e.getRoot(),c=!1,s=r[(n?"start":"end")+"Container"],l=r[(n?"start":"end")+"Offset"],f=On(s)&&l===s.childNodes.length,d=e.schema.getNonEmptyElements(),m=n;if(co(s))return k.none();if(On(s)&&l>s.childNodes.length-1&&(m=!1),Mn(s)&&(s=a,l=0),s===a){if(m&&(o=s.childNodes[0<l?l-1:0])){if(co(o))return k.none();if(d[o.nodeName]||Rf(o))return k.none()}if(s.hasChildNodes()){if(l=Math.min(!m&&0<l?l-1:l,s.childNodes.length-1),l=Dn(s=s.childNodes[l])&&f?s.data.length:0,!t&&s===a.lastChild&&Rf(s))return k.none();if(function(e,t){for(;t&&t!==e;){if(Hn(t))return!0;t=t.parentNode}return!1}(a,s)||co(s))return k.none();if(s.hasChildNodes()&&!1===Rf(s)){var g=new Vr(o=s,a);do{if(Hn(o)||co(o)){c=!1;break}if(Dn(o)&&0<o.nodeValue.length){l=m?0:o.nodeValue.length,s=o,c=!0;break}if(d[o.nodeName.toLowerCase()]&&(!(i=o)||!/^(TD|TH|CAPTION)$/.test(i.nodeName))){l=e.nodeIndex(o),s=o.parentNode,m||l++,c=!0;break}}while(o=m?g.next():g.prev())}}}return t&&(Dn(s)&&0===l&&Bf(e,f,t,!0,s).each(function(e){s=e.container(),l=e.offset(),c=!0}),On(s)&&(!(o=(o=s.childNodes[l])||s.childNodes[l-1])||!Ln(o)||(u=o).previousSibling&&"A"===u.previousSibling.nodeName||Nf(e,o,!1)||Nf(e,o,!0)||Bf(e,f,t,!0,o).each(function(e){s=e.container(),l=e.offset(),c=!0}))),m&&!t&&Dn(s)&&l===s.nodeValue.length&&Bf(e,f,t,!1,s).each(function(e){s=e.container(),l=e.offset(),c=!0}),c?k.some(hc(s,l)):k.none()},Pf=function(e,t){var n=t.collapsed,r=t.cloneRange(),o=hc.fromRangeStart(t);return Df(e,n,!0,r).each(function(e){n&&hc.isAbove(o,e)||r.setStart(e.container(),e.offset())}),n||Df(e,n,!1,r).each(function(e){r.setEnd(e.container(),e.offset())}),n&&r.collapse(!0),Ef(t,r)?k.none():k.some(r)},Mf=function(e,t){return e.splitText(t)},If=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&Dn(t)?0<n&&n<t.nodeValue.length&&(t=(r=Mf(t,n)).previousSibling,n<o?(t=r=Mf(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(Dn(t)&&0<n&&n<t.nodeValue.length&&(t=Mf(t,n),n=0),Dn(r)&&0<o&&o<r.nodeValue.length&&(o=(r=Mf(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}},Lf=function(e){return{walk:function(t,n){return rf(e,t,n)},split:If,normalize:function(t){return Pf(e,t).fold(y,function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0})}}};Lf.compareRanges=Ef,Lf.getCaretRangeFromPoint=Tf,Lf.getSelectedNode=Ka,Lf.getNode=Ya;var Ff,zf,Hf,Vf,jf,Uf=(Ff="height",zf=function(e){var t=e.dom;return gn(e)?t.getBoundingClientRect().height:t.offsetHeight},{set:function(e,t){if(!L(t)&&!t.match(/^[0-9]+$/))throw new Error(Ff+".set accepts only positive integer values. Value was "+t);var n=e.dom;Un(n)&&(n.style[Ff]=t+"px")},get:Hf=function(e){var t=zf(e);if(t<=0||null===t){var n=Yn(e,Ff);return parseFloat(n)||0}return t},getOuter:Hf,aggregate:Vf=function(e,t){return K(t,function(t,n){var r=Yn(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)},max:function(e,t,n){var r=Vf(e,n);return r<t?t-r:0}}),Wf=function(e,t){return e.view(t).fold(s([]),function(t){var n=e.owner(t),r=Wf(e,n);return[t].concat(r)})},qf=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?k.none():k.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(At)},owner:Ut}),Gf=function(e){return"textarea"===Mt(e)},$f=function(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return hn(n.offsetLeft,n.offsetTop);var i=vn(null==r?void 0:r.pageYOffset,o.scrollTop),u=vn(null==r?void 0:r.pageXOffset,o.scrollLeft),a=vn(o.clientTop,n.clientTop),c=vn(o.clientLeft,n.clientLeft);return bn(e).translate(u-c,i-a)}(e),r=Uf.get(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},Xf=function(e,t,n,r){Qf(e,function(o,i){return Yf(e,t,n,r)},n)},Kf=function(e,t,n,r,o){var i={elm:r.element.dom,alignToTop:o};e.fire("ScrollIntoView",i).isDefaultPrevented()||(n(t,yn(t).top,r,o),e.fire("AfterScrollIntoView",i))},Yf=function(e,t,n,r){At(e.getBody());var o=At(e.getDoc()),i=function(e,t){var n=function(e,t){var n=Kt(e);if(0===n.length||Gf(e))return{element:e,offset:t};if(t<n.length&&!Gf(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return Gf(r)?{element:e,offset:t}:"img"===Mt(r)?{element:r,offset:1}:zt(r)?{element:r,offset:hf(r).length}:{element:r,offset:Kt(r).length}}(e,t),r=_t('<span data-mce-bogus="all">\ufeff</span>');return un(n.element,r),$f(r,function(){return dn(r)})}(At(n.startContainer),n.startOffset);Kf(e,o,t,i,r),i.cleanup()},Jf=function(e,t,n,r){var o=At(e.getDoc());Kf(e,o,n,$f(At(t),a),r)},Qf=function(e,t,n){var r=n.startContainer,o=n.startOffset,i=n.endContainer,u=n.endOffset;t(At(r),At(i));var a=e.dom.createRng();a.setStart(r,o),a.setEnd(i,u),e.selection.setRng(n)},Zf=function(e,t,n,r){var o=e.pos;!function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)}(o.left,n?o.top:o.top-t+e.height,r)},ed=function(e,t,n,r,o){var i=n+t,u=r.pos.top,a=r.bottom,c=n<=a-u;u<t?Zf(r,n,!1!==o,e):i<u?Zf(r,n,c?!1!==o:!0===o,e):i<a&&!c&&Zf(r,n,!0===o,e)},td=function(e,t,n,r){ed(e,t,e.dom.defaultView.innerHeight,n,r)},nd=function(e,t,n,r){ed(e,t,e.dom.defaultView.innerHeight,n,r);var o=function(e){var t,n,r=At(document),o=yn(r),i=(n=(t=qf).owner(e),Wf(t,n)),u=bn(e),a=X(i,function(e,t){var n=bn(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return hn(a.left+u.left+o.left,a.top+u.top+o.top)}(n.element),i=Cn(window);o.top<i.y?xn(n.element,!1!==r):o.top>i.bottom&&xn(n.element,!0===r)},rd=function(e,t,n){return Xf(e,td,t,n)},od=function(e,t,n){return Jf(e,t,td,n)},id=function(e,t,n){return Xf(e,nd,t,n)},ud=function(e,t,n){return Jf(e,t,nd,n)},ad=function(e,t,n){(e.inline?rd:id)(e,t,n)},cd=function(e){var t=nn(e).dom;return e.dom===t.activeElement},sd=function(e){return void 0===e&&(e=At(document)),k.from(e.dom.activeElement).map(At)},ld=(gr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}}),fd=lt().browser,dd=function(e,t){var n=zt(t)?hf(t).length:Kt(t).length+1;return n<e?n:e<0?0:e},md=function(e){return ld(e.start,dd(e.soffset,e.start),e.finish,dd(e.foffset,e.finish))},gd=function(e,t){return!kn(t.dom)&&(Pt(e,t)||Dt(e,t))},pd=function(e){return function(t){return gd(e,t.start)&&gd(e,t.finish)}},hd=function(e){return!0===e.inline||fd.isIE()},vd=function(e){return ld(At(e.startContainer),e.startOffset,At(e.endContainer),e.endOffset)},bd=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),k.some(t)}catch(m){return k.none()}},yd=function(e){var t=hd(e)?function(e){var t;return((t=function(e){return At(Ut(e).dom.defaultView)}(e).dom.getSelection())&&0!==t.rangeCount?k.from(t.getRangeAt(0)):k.none()).map(vd).filter(pd(e))}(At(e.getBody())):k.none();e.bookmark=t.isSome()?t:e.bookmark},xd=function(e){return(e.bookmark?e.bookmark:k.none()).bind(function(t){return n=At(e.getBody()),k.from(t).filter(pd(n)).map(md);var n}).bind(bd)},wd={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Cd=ca.DOM,Sd=function(e,t){var n=e.getParam("custom_ui_selector","","string");return null!==Cd.getParent(t,function(t){return wd.isEditorUIElement(t)||!!n&&e.dom.is(t,n)})},kd=function(e,t){var n=t.editor;(function(e){var t=xa(function(){yd(e)},0);e.on("init",function(){var n,r,o;e.inline&&(n=e,r=t,o=function(){r.throttle()},ca.DOM.bind(document,"mouseup",o),n.on("remove",function(){ca.DOM.unbind(document,"mouseup",o)})),function(e,t){var n,r;lt().browser.isIE()?(r=e).on("focusout",function(){yd(r)}):(n=t,e.on("mouseup touchend",function(e){n.throttle()})),e.on("keyup NodeChange",function(t){var n;"nodechange"===(n=t).type&&n.selectionChange||yd(e)})}(e,t)}),e.on("remove",function(){t.cancel()})})(n),n.on("focusin",function(){var t=e.focusedEditor;t!==n&&(t&&t.fire("blur",{focusedEditor:n}),e.setActive(n),(e.focusedEditor=n).fire("focus",{blurredEditor:t}),n.focus(!0))}),n.on("focusout",function(){Fr.setEditorTimeout(n,function(){var t=e.focusedEditor;Sd(n,function(t){try{var n=nn(At(t.getElement()));return sd(n).fold(function(){return document.body},function(e){return e.dom})}catch(e){return document.body}}(n))||t!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null)})}),jf||(jf=function(t){var n=e.activeEditor;n&&function(e){if(tn()&&M(e.target)){var t=At(e.target);if(Ft(t)&&function(e){return M(e.dom.shadowRoot)}(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return re(n)}}return k.from(e.target)}(t).each(function(t){t.ownerDocument===document&&(t===document.body||Sd(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))})},Cd.bind(document,"focusin",jf))},Od=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Cd.unbind(document,"focusin",jf),jf=null)},_d=function(e,t){(function(e,t){return((n=t).collapsed?k.from(Ya(n.startContainer,n.startOffset)).map(At):k.none()).bind(function(t){return Jr(t)?k.some(t):!1===Pt(e,t)?k.some(e):k.none()});var n})(At(e.getBody()),t).bind(function(e){return sl(e.dom)}).fold(function(){e.selection.normalize()},function(t){return e.selection.setRng(t.toRange())})},Td=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},Ed=function(e){return e.inline?(n=e.getBody())&&function(e){return cd(e)||sd(nn(t=e)).filter(function(e){return t.dom.contains(e.dom)}).isSome();var t}(At(n)):(t=e).iframeElement&&cd(At(t.iframeElement));var t,n},Ad=function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===Ed(e)&&xd(e).each(function(t){e.selection.setRng(t),r=t});var o,i,u=(o=e,i=t.getNode(),o.dom.getParent(i,function(e){return"true"===o.dom.getContentEditable(e)}));if(e.$.contains(n,u))return Td(u),_d(e,r),void Rd(e);e.inline||(yt.opera||Td(n),e.getWin().focus()),(yt.gecko||e.inline)&&(Td(n),_d(e,r)),Rd(e)},Rd=function(e){return e.editorManager.setActive(e)},Nd=function(e,t,n,r,o){var i=n?t.startOffset:t.endOffset;return k.from(n?t.startContainer:t.endContainer).map(At).map(function(e){return r&&t.collapsed?e:Yt(e,o(e,i)).getOr(e)}).bind(function(e){return Ft(e)?k.some(e):Wt(e).filter(Ft)}).map(function(e){return e.dom}).getOr(e)},Bd=function(e,t,n){return Nd(e,t,!0,n,function(e,t){return Math.min(e.dom.childNodes.length,t)})},Dd=function(e,t,n){return Nd(e,t,!1,n,function(e,t){return 0<t?t-1:t})},Pd=function(e,t){for(var n=e;e&&Dn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},Md=function(e,t){return W(t,function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t})},Id={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Ld=function(e,t,n){var r=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[r])return e[r];if(e!==t){var i=e[o];if(i)return i;for(var u=e.parent;u&&u!==t;u=u.parent)if(i=u[o])return i}},Fd=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},zd=(Hd.create=function(e,t){var n=new Hd(e,Id[e]||1);return t&&ce(t,function(e,t){n.attr(t,e)}),n},Hd.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},Hd.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&ce(e,function(e,t){r.attr(t,e)}),r;if(n=r.attributes){if(void 0===t)return n.map[e];if(null===t){if(e in n.map){delete n.map[e];for(var o=n.length;o--;)if(n[o].name===e)return n.splice(o,1),r}return r}if(e in n.map){for(o=n.length;o--;)if(n[o].name===e){n[o].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}},Hd.prototype.clone=function(){var e,t=new Hd(this.name,this.type);if(e=this.attributes){var n=[];n.map={};for(var r=0,o=e.length;r<o;r++){var i=e[r];"id"!==i.name&&(n[n.length]={name:i.name,value:i.value},n.map[i.name]=i.value)}t.attributes=n}return t.value=this.value,t.shortEnded=this.shortEnded,t},Hd.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},Hd.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},Hd.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t)&&(t.prev=null):n.next=t,e.lastChild===this?(e.lastChild=n)&&(n.next=null):t.prev=n,this.parent=this.next=this.prev=null),this},Hd.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?((t.next=e).prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},Hd.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,(e.next=t).prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,(e.prev=t).next=e),e.parent=r,e},Hd.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=Ld(n,this))n.name===e&&t.push(n);return t},Hd.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=Ld(t,this))e.push(t);for(var n=e.length;n--;)(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}return this.firstChild=this.lastChild=null,this},Hd.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(Fd(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(Fd(r))return!1}if(8===r.type)return!1;if(3===r.type&&!function(e){if(Eo(e.value)){var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)}}(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&Eo(r.value))return!1;if(n&&n(r))return!1}while(r=Ld(r,this));return!0},Hd.prototype.walk=function(e){return Ld(this,null,e)},Hd);function Hd(e,t){this.name=e,1===(this.type=t)&&(this.attributes=[],this.attributes.map={})}var Vd=function(e,t){return e.replace(t.re,function(e){return pe(t.uris,e).getOr(e)})},jd=["img","video"],Ud=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?(o=n,!(P(r=e.allow_svg_data_urls)?j(jd,o):r)&&/^data:image\/svg\+xml/i.test(t)):/^data:/i.test(t));var r,o},Wd=function(e,t,n){var r,o,i=1,u=e.getShortEndedElements(),a=/<([!?\/])?([A-Za-z0-9\-_:.]+)(\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g;for(a.lastIndex=r=n;o=a.exec(t);){if(r=a.lastIndex,"/"===o[1])i--;else if(!o[1]){if(o[2]in u)continue;i++}if(0===i)break}return r},qd=function(e,t){void 0===t&&(t=ui()),!1!==(e=e||{}).fix_self_closing&&(e.fix_self_closing=!0);var n=e.comment?e.comment:a,r=e.cdata?e.cdata:a,o=e.text?e.text:a,i=e.start?e.start:a,u=e.end?e.end:a,c=e.pi?e.pi:a,s=e.doctype?e.doctype:a;return{parse:function(a,l){void 0===l&&(l="html"),function(a,l){void 0===l&&(l="html");for(var f,d,m,g,p,h,v,b,y,x,w,C,S,k,O,_,T,E,A,R=a.html,N=0,B=[],D=0,P=Yo.decode,M=kt.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),I=/((java|vb)script|mhtml):/i,L="html"===l?0:1,F=function(e){for(var t,n=B.length;n--&&B[n].name!==e;);if(0<=n){for(t=B.length-1;n<=t;t--)(e=B[t]).valid&&u(e.name);B.length=n}},z=function(e,t){return o(Vd(e,a),t)},H=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),n(Vd(t,a)))},V=function(e,t){var n=e||"",r=!ze(n,"--"),o=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(r.substr(n))){var o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(t){var i=r.indexOf(">",n);return-1!==i?i:r.length}var u=/--!?>/g;u.lastIndex=n;var a=u.exec(e);return a?a.index+a[0].length:r.length}(R,r,t);return e=R.substr(t,o-t),H(r?n+e:e),o+1},j=function(t,n,r,o,i){var u,c,s,l;if(s=(n=n.toLowerCase())in $?n:P(r||o||i||""),r=Vd(s,a),X&&!b&&0==(0===(l=n).indexOf("data-")||0===l.indexOf("aria-"))){if(!(u=k[n])&&O){for(c=O.length;c--&&!(u=O[c]).pattern.test(n););-1===c&&(u=null)}if(!u)return;if(u.validValues&&!(r in u.validValues))return}if(M[n]&&!e.allow_script_urls){var f=r.replace(/[\s\u0000-\u001F]+/g,"");try{f=decodeURIComponent(f)}catch(C){f=unescape(f)}if(I.test(f))return;if(Ud(e,f,t))return}b&&(n in M||0===n.indexOf("on"))||(g.map[n]=r,g.push({name:n,value:r}))},U=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g"),W=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,q=t.getShortEndedElements(),G=e.self_closing_elements||t.getSelfClosingElements(),$=t.getBoolAttrs(),X=e.validate,K=e.remove_internals,Y=e.fix_self_closing,J=t.getSpecialElements(),Q=R+">";f=U.exec(Q);){var Z=f[0];if(N<f.index&&z(P(R.substr(N,f.index-N))),d=f[7])":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),F(d);else if(d=f[8]){if(f.index+Z.length>R.length){z(P(R.substr(f.index))),N=f.index+Z.length;continue}":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),y=d in q,Y&&G[d]&&0<B.length&&B[B.length-1].name===d&&F(d);var ee=function(e,t){var n=e.exec(t);if(n){var r=n[1],o=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?o:null}return null}(W,f[9]);if(null!==ee){if("all"===ee){N=Wd(t,R,U.lastIndex),U.lastIndex=N;continue}w=!1}if(!X||(x=t.getElementRule(d))){if(w=!0,X&&(k=x.attributes,O=x.attributePatterns),(S=f[9])?((b=-1!==S.indexOf("data-mce-type"))&&K&&(w=!1),(g=[]).map={},S.replace(W,function(e,t,n,r,o){return j(d,t,n,r,o),""})):(g=[]).map={},X&&!b){if(_=x.attributesRequired,T=x.attributesDefault,x.removeEmptyAttrs&&!g.length&&(w=!1),E=x.attributesForced)for(p=E.length;p--;)v=(C=E[p]).name,"{$uid}"===(A=C.value)&&(A="mce_"+D++),g.map[v]=A,g.push({name:v,value:A});if(T)for(p=T.length;p--;)(v=(C=T[p]).name)in g.map||("{$uid}"===(A=C.value)&&(A="mce_"+D++),g.map[v]=A,g.push({name:v,value:A}));if(_){for(p=_.length;p--&&!(_[p]in g.map););-1===p&&(w=!1)}if(C=g.map["data-mce-bogus"]){if("all"===C){N=Wd(t,R,U.lastIndex),U.lastIndex=N;continue}w=!1}}w&&i(d,g,y)}else w=!1;if(m=J[d]){m.lastIndex=N=f.index+Z.length,N=(f=m.exec(R))?(w&&(h=R.substr(N,f.index-N)),f.index+f[0].length):(h=R.substr(N),R.length),w&&(0<h.length&&z(h,!0),u(d)),U.lastIndex=N;continue}y||(S&&S.indexOf("/")===S.length-1?w&&u(d):B.push({name:d,valid:w}))}else if(d=f[1])H(d);else if(d=f[2]){if(!(1==L||e.preserve_cdata||0<B.length&&t.isValidChild(B[B.length-1].name,"#cdata"))){N=V("",f.index+2),U.lastIndex=N;continue}r(d)}else if(d=f[3])s(d);else{if((d=f[4])||"<!"===Z){N=V(d,f.index+Z.length),U.lastIndex=N;continue}if(d=f[5]){if(1!=L){N=V("?",f.index+2),U.lastIndex=N;continue}c(d,f[6])}}N=f.index+Z.length}for(N<R.length&&z(P(R.substr(N))),p=B.length-1;0<=p;p--)(d=B[p]).valid&&u(d.name)}(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,r=[],o={},i=Pa("img"),u=0,a=0;t=n.exec(e);){var c=t[0],s=i+"_"+a++;o[s]=c,u<t.index&&r.push(e.substr(u,t.index-u)),r.push(s),u=t.index+c.length}var l=new RegExp(i+"_[0-9]+","g");return 0===u?{prefix:i,uris:o,html:e,re:l}:(u<e.length&&r.push(e.substr(u)),{prefix:i,uris:o,html:r.join(""),re:l})}(a),l)}}};qd.findEndTag=Wd;var Gd,$d=function(e,t){var n,r,o,i,u,a,c,s=t,l=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,f=e.schema;u=e.getTempAttrs(),a=s,c=new RegExp(["\\s?("+u.join("|")+')="[^"]+"'].join("|"),"gi"),s=a.replace(c,"");for(var d=f.getShortEndedElements();i=l.exec(s);)r=l.lastIndex,o=i[0].length,n=d[i[1]]?r:qd.findEndTag(f,s,r),s=s.substring(0,r-o)+s.substring(n),l.lastIndex=r-o;return ro(s)},Xd=$d,Kd=kt.each,Yd=function(e){return{compare:function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Kd(e.getAttribs(t),function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))}),n},o=function(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return!1;return!0};return!(!o(r(t),r(n))||!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))||wl(t)||wl(n))}}},Jd=kt.makeMap,Qd=function(e){var t=[],n=(e=e||{}).indent,r=Jd(e.indent_before||""),o=Jd(e.indent_after||""),i=Yo.getEncodeFunc(e.entity_encoding||"raw",e.entities),u="html"===e.element_format;return{start:function(e,a,c){var s,l,f,d;if(n&&r[e]&&0<t.length&&0<(d=t[t.length-1]).length&&"\n"!==d&&t.push("\n"),t.push("<",e),a)for(s=0,l=a.length;s<l;s++)t.push(" ",(f=a[s]).name,'="',i(f.value,!0),'"');t[t.length]=!c||u?">":" />",c&&n&&o[e]&&0<t.length&&0<(d=t[t.length-1]).length&&"\n"!==d&&t.push("\n")},end:function(e){var r;t.push("</",e,">"),n&&o[e]&&0<t.length&&0<(r=t[t.length-1]).length&&"\n"!==r&&t.push("\n")},text:function(e,n){0<e.length&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",i(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},Zd=function(e,t){void 0===t&&(t=ui());var n=Qd(e);return(e=e||{}).validate=!("validate"in e)||e.validate,{serialize:function(r){var o=e.validate,i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)for(;u(e),e=e.next;);}};n.reset();var u=function(e){var r,a,c,s,l,f,d,m,g,p=i[e.type];if(p)p(e);else{if(r=e.name,a=e.shortEnded,c=e.attributes,o&&c&&1<c.length&&((f=[]).map={},g=t.getElementRule(e.name))){for(d=0,m=g.attributesOrder.length;d<m;d++)(s=g.attributesOrder[d])in c.map&&(f.map[s]=l=c.map[s],f.push({name:s,value:l}));for(d=0,m=c.length;d<m;d++)(s=c[d].name)in f.map||(f.map[s]=l=c.map[s],f.push({name:s,value:l}));c=f}if(n.start(e.name,c,a),!a){if(e=e.firstChild)for(;u(e),e=e.next;);n.end(r)}}};return 1!==r.type||e.inner?i[11](r):u(r),n.getContent()}}},em=function(e,t,n){return k.from(n.container()).filter(Dn).exists(function(r){var o=e?0:-1;return t(r.data.charAt(n.offset()+o))})},tm=f(em,!0,Sl),nm=f(em,!1,Sl),rm=function(e){var t=e.container();return Dn(t)&&(0===t.data.length||no(t.data)&&yf.isBookmarkNode(t.parentNode))},om=function(e,t){return function(n){return k.from(Rs(e?0:-1,n)).filter(t).isSome()}},im=function(e){return Fn(e)&&"block"===Yn(At(e),"display")},um=function(e){return Hn(e)&&!(On(t=e)&&"all"===t.getAttribute("data-mce-bogus"));var t},am=om(!0,im),cm=om(!1,im),sm=om(!0,jn),lm=om(!1,jn),fm=om(!0,Rn),dm=om(!1,Rn),mm=om(!0,um),gm=om(!1,um),pm=function(e){fn(e),sn(e,_t('<br data-mce-bogus="1">'))},hm=function(e){Qt(e).each(function(t){qt(t).each(function(n){qr(e)&&$r(t)&&qr(n)&&dn(t)})})},vm=function(e,t){return function(e,t,n){return Pt(t,e)?function(e,t){for(var n=I(t)?t:y,r=e.dom,o=[];null!=r.parentNode;){var i=r.parentNode,u=At(i);if(o.push(u),!0===n(u))break;r=i}return o}(e,function(e){return n(e)||Dt(e,t)}).slice(0,-1):[]}(e,t,y)},bm=function(e,t){return[e].concat(vm(e,t))},ym=function(e,t,n){return il(e,t,n,rm)},xm=function(e,t){return Y(bm(At(t.container()),e),qr)},wm=function(e,t,n){return ym(e,t.dom,n).forall(function(e){return xm(t,n).fold(function(){return!1===As(e,n,t.dom)},function(r){return!1===As(e,n,t.dom)&&Pt(r,At(e.container()))})})},Cm=function(e,t,n){return xm(t,n).fold(function(){return ym(e,t.dom,n).forall(function(e){return!1===As(e,n,t.dom)})},function(t){return ym(e,t.dom,n).isNone()})},Sm=f(Cm,!1),km=f(Cm,!0),Om=f(wm,!1),_m=f(wm,!0),Tm=function(e){return Fs(e).exists($r)},Em=function(e,t,n){var r=$(bm(At(n.container()),t),qr),o=re(r).getOr(t);return rl(e,o.dom,n).filter(Tm)},Am=function(e,t){return Fs(t).exists($r)||Em(!0,e,t).isSome()},Rm=function(e,t){return k.from(t.getNode(!0)).map(At).exists($r)||Em(!1,e,t).isSome()},Nm=f(Em,!1),Bm=f(Em,!0),Dm=function(e){return hc.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},Pm=function(e,t){var n=$(bm(At(t.container()),e),qr);return re(n).getOr(e)},Mm=function(e,t){return Dm(t)?nm(t):nm(t)||cl(Pm(e,t).dom,t).exists(nm)},Im=function(e,t){return Dm(t)?tm(t):tm(t)||al(Pm(e,t).dom,t).exists(tm)},Lm=function(e){return Fs(e).bind(function(e){return kr(e,Ft)}).exists(function(e){return t=Yn(e,"white-space"),j(["pre","pre-wrap"],t);var t})},Fm=function(e,t){return!Lm(t)&&(Sm(e,t)||Om(e,t)||Rm(e,t)||Mm(e,t))},zm=function(e,t){return!Lm(t)&&(km(e,t)||_m(e,t)||Am(e,t)||Im(e,t))},Hm=function(e,t){return Fm(e,t)||zm(e,(r=(n=t).container(),o=n.offset(),Dn(r)&&o<r.data.length?hc(r,o+1):n));var n,r,o},Vm=function(e,t){return Cl(e.charAt(t))},jm=function(e){var t=e.container();return Dn(t)&&Fe(t.data,eo)},Um=function(e){var t=At(e.getBody());e.selection.isCollapsed()&&function(e,t){return k.some(t).filter(jm).bind(function(t){var n,r,o,i,u,a,c,s,l=t.container();return u=e,c=(a=l).data,s=hc(a,0),Vm(c,0)&&!Hm(u,s)&&(a.data=" "+c.slice(1),1)||function(e){var t,n=e.data,r=(t=n.split(""),W(t,function(e,n){return Cl(e)&&0<n&&n<t.length-1&&kl(t[n-1])&&kl(t[n+1])?" ":e}).join(""));return r!==n&&(e.data=r,!0)}(l)||(n=e,o=(r=l).data,i=hc(r,o.length-1),Vm(o,o.length-1)&&!Hm(n,i)&&(r.data=o.slice(0,-1)+" ",1))?k.some(t):k.none()})}(t,hc.fromRangeStart(e.selection.getRng())).each(function(t){e.selection.setRng(t.toRange())})},Wm=function(e,t,n){var r,o,i,u,a,c,s,l;0!==n&&(r=At(e),o=Sr(r,qr).getOr(r),i=e.data.slice(t,t+n),u=t+n>=e.data.length&&zm(o,hc(e,e.data.length)),a=0===t&&Fm(o,hc(e,0)),e.replaceData(t,n,(s=a,l=u,K(c=i,function(e,t){return Sl(t)||Cl(t)?e.previousCharIsSpace||""===e.str&&s||e.str.length===c.length-1&&l?{previousCharIsSpace:!1,str:e.str+eo}:{previousCharIsSpace:!0,str:e.str+" "}:{previousCharIsSpace:!1,str:e.str+t}},{previousCharIsSpace:!1,str:""}).str)))},qm=function(e,t){var n=e.data.slice(t),r=n.length-je(n).length;return Wm(e,t,r)},Gm=function(e,t){var n=e.data.slice(0,t),r=n.length-Ue(n).length;return Wm(e,t-r,r)},$m=function(e,t,n,r){void 0===r&&(r=!0);var o=Ue(e.data).length,i=r?e:t,u=r?t:e;return r?i.appendData(u.data):i.insertData(0,u.data),dn(At(u)),n&&qm(i,o),i},Xm=function(e,t){return r=e,o=(n=t).container(),i=n.offset(),!1===hc.isTextPosition(n)&&o===r.parentNode&&i>hc.before(r).offset()?hc(t.container(),t.offset()-1):t;var n,r,o,i},Km=function(e){return ko(e.previousSibling)?k.some(Dn(t=e.previousSibling)?hc(t,t.data.length):hc.after(t)):e.previousSibling?ll(e.previousSibling):k.none();var t},Ym=function(e){return ko(e.nextSibling)?k.some(Dn(t=e.nextSibling)?hc(t,0):hc.before(t)):e.nextSibling?sl(e.nextSibling):k.none();var t},Jm=function(e,t){return Km(t).orThunk(function(){return Ym(t)}).orThunk(function(){return n=e,o=hc.before((r=t).previousSibling?r.previousSibling:r.parentNode),cl(n,o).fold(function(){return al(n,hc.after(r))},k.some);var n,r,o})},Qm=function(e,t){return Ym(t).orThunk(function(){return Km(t)}).orThunk(function(){return al(n=e,hc.after(r=t)).fold(function(){return cl(n,hc.before(r))},k.some);var n,r})},Zm=function(e,t,n){return(e?Qm:Jm)(t,n).map(f(Xm,n))},eg=function(e,t,n){n.fold(function(){e.focus()},function(n){e.selection.setRng(n.toRange(),t)})},tg=function(e,t){return t&&he(e.schema.getBlockElements(),Mt(t))},ng=function(e){if(Do(e)){var t=_t('<br data-mce-bogus="1">');return fn(e),sn(e,t),k.some(hc.before(t.dom))}return k.none()},rg=function(e,t,n,r){void 0===r&&(r=!0);var o,i,u=Zm(t,e.getBody(),n.dom),a=Sr(n,f(tg,e),(o=e.getBody(),function(e){return e.dom===o})),c=function(e,t,n){var r,o,i,u,a=qt(e).filter(zt),c=Gt(e).filter(zt);return dn(e),o=c,i=t,u=function(e,t,r){var o=e.dom,i=t.dom,u=o.data.length;return $m(o,i,n),r.container()===i?hc(o,u):r},((r=a).isSome()&&o.isSome()&&i.isSome()?k.some(u(r.getOrDie(),o.getOrDie(),i.getOrDie())):k.none()).orThunk(function(){return n&&(a.each(function(e){return Gm(e.dom,e.dom.length)}),c.each(function(e){return qm(e.dom,0)})),t})}(n,u,(i=n,he(e.schema.getTextInlineElements(),Mt(i))));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(ng).fold(function(){r&&eg(e,t,c)},function(n){r&&eg(e,t,k.some(n))})},og=function(e,t){return{start:e,end:t}},ig=gr([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),ug=function(e,t){return Tr(At(e),"td,th",t)},ag=function(e,t){return Or(e,"table",t)},cg=function(e){return!Dt(e.start,e.end)},sg=function(e,t){return ag(e.start,t).bind(function(n){return ag(e.end,t).bind(function(e){return Dt(n,e)?k.some(n):k.none()})})},lg=function(e){return Ta(e,"td,th")},fg=function(e,t){return sg(t,e).isSome()},dg=function(e,t){return J(e,function(e){return Dt(e,t)})},mg=function(e){return Va(dg((t=e).cells,t.rng.start),dg(t.cells,t.rng.end),function(e,n){return t.cells.slice(e,n+1)}).map(function(t){return t.length===e.cells.length?ig.removeTable(e.table):ig.emptyCells(t)});var t},gg=function(e){var t;return(8===It(t=e)||"#comment"===Mt(t)?qt:Qt)(e).bind(gg).orThunk(function(){return k.some(e)})},pg=function(e,t){return q(t,pm),e.selection.setCursorLocation(t[0].dom,0),!0},hg=function(e,t,n){t.deleteContents();var r,o,i=gg(n).getOr(n),u=At(e.dom.getParent(i.dom,e.dom.isBlock));return Do(u)&&(pm(u),e.selection.setCursorLocation(u.dom,0)),Dt(n,u)||(r=Wt(u).is(n)?[]:Wt(o=u).map(Kt).map(function(e){return $(e,function(e){return!Dt(o,e)})}).getOr([]),q(r.concat(Kt(n)),function(e){Dt(e,u)||Pt(e,u)||dn(e)})),!0},vg=function(e,t){return rg(e,!1,t),!0},bg=function(e,t){return Y(bm(t,e),Qr)},yg=function(e,t){return Y(bm(t,e),function(e){return"caption"===Mt(e)})},xg=function(e,t){return pm(t),e.selection.setCursorLocation(t.dom,0),k.some(!0)},wg=function(e,t){return(e?fm:dm)(t)},Cg=function(e,t){var n,r,o,i,u,a=At(e.selection.getStart(!0)),c=af(e);return e.selection.isCollapsed()&&0===c.length?function(e,t,n){var r=At(e.getBody());return yg(r,n).fold(function(){return function(e,t,n,r){var o=hc.fromRangeStart(e.selection.getRng());return bg(n,r).bind(function(r){return Do(r)?xg(e,r):(i=n,u=r,a=o,ol(t,e.getBody(),a).bind(function(e){return bg(i,At(e.getNode())).map(function(e){return!1===Dt(e,u)})}));var i,u,a}).getOr(!1)}(e,t,r,n)||(i=t,u=hc.fromRangeStart((o=e).selection.getRng()),wg(i,u)||rl(i,o.getBody(),u).exists(function(e){return wg(i,e)}));var o,i,u},function(n){return i=t,u=r,a=n,c=hc.fromRangeStart((o=e).selection.getRng()),(Do(a)?xg(o,a):function(e,t,n,r,o){return ol(n,e.getBody(),o).bind(function(i){return c=n,s=o,l=i,sl((a=r).dom).bind(function(e){return ll(a.dom).map(function(t){return c?s.isEqual(e)&&l.isEqual(t):s.isEqual(t)&&l.isEqual(e)})}).getOr(!0)?xg(e,r):(u=r,yg(t,At(i.getNode())).map(function(e){return!1===Dt(e,u)}));var u,a,c,s,l}).or(k.some(!0))}(o,u,i,a,c)).getOr(!1);var o,i,u,a,c})}(e,t,a):(r=a,o=At((n=e).getBody()),i=n.selection.getRng(),0!==(u=af(n)).length?pg(n,u):function(e,t,n,r){return yg(t,r).fold(function(){return r=e,function(e,t){var n,r,o,i,u,a=(n=e,function(e){return Dt(n,e)}),c=(i=ug((r=t).startContainer,o=a),u=ug(r.endContainer,o),Va(i,u,og));return function(e,t,n){return e.filter(function(e){return o=n,!cg(r=e)&&sg(r,o).exists(function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length})&&lf(e.start,t);var r,o}).map(function(e){return e.start})}(c,t,a).map(function(e){return ig.deleteCellSelection(t,e)}).orThunk(function(){return function(e,t,n){return e.filter(function(e){return cg(e)&&fg(n,e)}).orThunk(function(){return function(e,t){var n=ug(t.startContainer,e),r=ug(t.endContainer,e);return t.collapsed?k.none():Va(n,r,og).fold(function(){return n.fold(function(){return r.bind(function(t){return ag(t,e).bind(function(e){return re(lg(e)).map(function(e){return og(e,t)})})})},function(t){return ag(t,e).bind(function(e){return oe(lg(e)).map(function(e){return og(t,e)})})})},function(t){return fg(e,t)?k.none():ag((n=t).start,e).bind(function(e){return oe(lg(e)).map(function(e){return og(n.start,e)})});var n})}(n,t)}).bind(function(e){return sg(t=e,n).map(function(e){return{rng:t,table:e,cells:lg(e)}});var t})}(c,t,a).bind(mg)})}(t,n).map(function(e){return e.fold(f(vg,r),f(pg,r),f(hg,r))});var r},function(t){return xg(e,t)}).getOr(!1)}(n,o,i,r))},Sg=function(e){return e.collapsed?e:function(e){var t=hc.fromRangeStart(e),n=hc.fromRangeEnd(e),r=e.commonAncestorContainer;return rl(!1,r,n).map(function(o){return!As(t,n,r)&&As(t,o,r)?(i=t.container(),u=t.offset(),a=o.container(),c=o.offset(),(s=document.createRange()).setStart(i,u),s.setEnd(a,c),s):e;var i,u,a,c,s}).getOr(e)}(e)},kg=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},Og=function(e,t){var n=hc.after(e),r=Zs(t).prev(n);return r?r.toRange():null},_g=Vn,Tg=function(e,t,n){var r,o,i,u,a,c,s,l,f,d=e.selection,m=e.dom;/^ | $/.test(t)&&(c=m,s=d.getRng(),l=t,f=At(c.getRoot()),l=Fm(f,hc.fromRangeStart(s))?l.replace(/^ /,"&nbsp;"):l.replace(/^&nbsp;/," "),t=l=zm(f,hc.fromRangeEnd(s))?l.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):l.replace(/&nbsp;(<br( \/)?>)?$/," "));var g=e.parser,p=n.merge,h=Zd({validate:e.getParam("validate")},e.schema),v='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',b={content:t,format:"html",selection:!0,paste:n.paste};if((b=e.fire("BeforeSetContent",b)).isDefaultPrevented())e.fire("SetContent",{content:b.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=b.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,v);var y,x=(u=d.getRng()).startContainer||(u.parentElement?u.parentElement():null),w=e.getBody();x===w&&d.isCollapsed()&&m.isBlock(w.firstChild)&&(y=w.firstChild)&&!e.schema.getShortEndedElements()[y.nodeName]&&m.isEmpty(w.firstChild)&&((u=m.createRng()).setStart(w.firstChild,0),u.setEnd(w.firstChild,0),d.setRng(u)),d.isCollapsed()||function(e){var t=e.dom,n=Sg(e.selection.getRng());e.selection.setRng(n);var r,o,i=t.getParent(n.startContainer,_g);r=n,null!==(o=i)&&o===t.getParent(r.endContainer,_g)&&lf(At(o),r)?hg(e,n,At(i)):e.getDoc().execCommand("Delete",!1,null)}(e);var C,S,O,_,T,E,A,R,N,B,D,P,M,I={context:(r=d.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},L=g.parse(t,I);if(!0===n.paste&&function(e,t){var n,r,o,i=t.firstChild,u=t.lastChild;return i&&"meta"===i.name&&(i=i.next),u&&"mce_marker"===u.attr("id")&&(u=u.prev),r=u,o=(n=e).getNonEmptyElements(),r&&(r.isEmpty(o)||function(e,t){var n,r;return e.getBlockElements()[t.name]&&(r=t).firstChild&&r.firstChild===r.lastChild&&("br"===(n=t.firstChild).name||n.value===eo)}(n,r))&&(u=u.prev),!(!i||i!==u||"ul"!==i.name&&"ol"!==i.name)}(e.schema,L)&&kg(m,r))return u=function(e,t,n,r){var o,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w=(o=t,c=e.serialize(r),u=(i=o.createFragment(c)).firstChild,a=i.lastChild,u&&"META"===u.nodeName&&u.parentNode.removeChild(u),a&&"mce_marker"===a.id&&a.parentNode.removeChild(a),i),C=kg(t,n.startContainer),S=function(e){return 0<e.length&&(!(t=e[e.length-1]).firstChild||function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&((t=e.firstChild).data===eo||Ln(t));var t}(t))?e.slice(0,-1):e;var t}(kt.grep(w.firstChild.childNodes,function(e){return"LI"===e.nodeName})),k=t.getRoot(),O=function(e){var r=hc.fromRangeStart(n),o=Zs(t.getRoot()),i=1===e?o.prev(r):o.next(r);return!i||kg(t,i.getNode())!==C};return O(1)?function(e,t,n){var r,o,i,u=e.parentNode;return kt.each(t,function(t){u.insertBefore(t,e)}),r=n,o=hc.before(e),(i=Zs(r).next(o))?i.toRange():null}(C,S,k):O(2)?(s=C,f=k,t.insertAfter((l=S).reverse(),s),Og(l[0],f)):(m=S,g=k,p=d=C,v=(h=n).cloneRange(),b=h.cloneRange(),v.setStartBefore(p),b.setEndAfter(p),y=[v.cloneContents(),b.cloneContents()],(x=d.parentNode).insertBefore(y[0],d),kt.each(m,function(e){x.insertBefore(e,d)}),x.insertBefore(y[1],d),x.removeChild(d),Og(m[m.length-1],g))}(h,m,d.getRng(),L),d.setRng(u),void e.fire("SetContent",b);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(L),"mce_marker"===(a=L.lastChild).attr("id"))for(a=(i=a).prev;a;a=a.walk(!0))if(3===a.type||!m.isBlock(a.name)){e.schema.isValidChild(a.parent.name,"span")&&a.parent.insert(i,a,"br"===a.name);break}if(e._selectionOverrides.showBlockCaretContainer(r),I.invalid){for(e.selection.setContent(v),r=d.getNode(),o=e.getBody(),9===r.nodeType?r=a=o:a=r;a!==o;)a=(r=a).parentNode;t=r===o?o.innerHTML:m.getOuterHTML(r),t=h.serialize(g.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return h.serialize(L)}))),r===o?m.setHTML(o,t):m.setOuterHTML(r,t)}else C=e,S=t=h.serialize(L),"all"===(O=r).getAttribute("data-mce-bogus")?O.parentNode.insertBefore(C.dom.createFragment(S),O):!(_=O.firstChild)||_===O.lastChild&&"BR"===_.nodeName?C.dom.setHTML(O,S):C.selection.setContent(S);E=p,N=(T=e).schema.getTextInlineElements(),B=T.dom,E&&(A=T.getBody(),R=Yd(B),kt.each(B.select("*[data-mce-fragment]"),function(e){for(var t=e.parentNode;t&&t!==A;t=t.parentNode)N[e.nodeName.toLowerCase()]&&R.compare(t,e)&&B.remove(e,!0)})),function(e,t){var n,r,o=e.dom,i=e.selection;if(t){i.scrollIntoView(t);var u=function(t){for(var n=e.getBody();t&&t!==n;t=t.parentNode)if("false"===o.getContentEditable(t))return t;return null}(t);if(u)return o.remove(t),i.select(u);var a=o.createRng(),c=t.previousSibling;c&&3===c.nodeType?(a.setStart(c,c.nodeValue.length),yt.ie||(r=t.nextSibling)&&3===r.nodeType&&(c.appendData(r.data),r.parentNode.removeChild(r))):(a.setStartBefore(t),a.setEndBefore(t));var s=o.getParent(t,o.isBlock);o.remove(t),s&&o.isEmpty(s)&&(e.$(s).empty(),a.setStart(s,0),a.setEnd(s,0),_g(s)||s.getAttribute("data-mce-fragment")||!(n=function(t){var n=hc.fromRangeStart(t);if(n=Zs(e.getBody()).next(n))return n.toRange()}(a))?o.add(s,o.create("br",{"data-mce-bogus":"1"})):(a=n,o.remove(s))),i.setRng(a)}}(e,m.get("mce_marker")),D=e.getBody(),kt.each(D.getElementsByTagName("*"),function(e){e.removeAttribute("data-mce-fragment")}),P=m,M=d.getStart(),k.from(P.getParent(M,"td,th")).map(At).each(hm),e.fire("SetContent",b),e.addVisual()}},Eg=function(e,t){t(e),e.firstChild&&Eg(e.firstChild,t),e.next&&Eg(e.next,t)},Ag=function(e){return e instanceof zd},Rg=function(e,t){var n;e.dom.setHTML(e.getBody(),t),Ed(n=e)&&sl(n.getBody()).each(function(e){var t=e.getNode(),r=Rn(t)?sl(t).getOr(e):e;n.selection.setRng(r.toRange())})},Ng=function(e){return I(e)?e:y},Bg=function(e,t,n){var r=t(e),o=Ng(n);return r.orThunk(function(){return o(e)?k.none():function(e,t,n){for(var r=e.dom,o=Ng(n);r.parentNode;){var i=At(r=r.parentNode),u=t(i);if(u.isSome())return u;if(o(i))break}return k.none()}(e,t,o)})},Dg=Bl,Pg=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++)if(!1===r[o].inherit&&e.dom.is(t,r[o].selector))return!0;return!1},Mg=function(e,t,n,r){var o=e.dom.getRoot();return t!==o&&(t=e.dom.getParent(t,function(t){return!!Pg(e,t,n)||t.parentNode===o||!!Fg(e,t,n,r,!0)}),Fg(e,t,n,r))},Ig=function(e,t,n){return!!Dg(t,n.inline)||!!Dg(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0)},Lg=function(e,t,n,r,o,i){var u,a,c,s=n[r];if(n.onmatch)return n.onmatch(t,n,r);if(s)if(void 0===s.length){for(u in s)if(s.hasOwnProperty(u)){if(a="attributes"===r?e.getAttrib(t,u):Pl(e,t,u),o&&!a&&!n.exact)return;if((!o||n.exact)&&!Dg(a,Dl(e,Nl(s[u],i),u)))return}}else for(c=0;c<s.length;c++)if("attributes"===r?e.getAttrib(t,s[c]):Pl(e,t,s[c]))return n;return n},Fg=function(e,t,n,r,o){var i,u,a,c,s=e.formatter.get(n),l=e.dom;if(s&&t)for(u=0;u<s.length;u++)if(Ig(e.dom,t,i=s[u])&&Lg(l,t,i,"attributes",o,r)&&Lg(l,t,i,"styles",o,r)){if(c=i.classes)for(a=0;a<c.length;a++)if(!e.dom.hasClass(t,c[a]))return;return i}},zg=function(e,t,n,r){if(r)return Mg(e,r,t,n);if(r=e.selection.getNode(),Mg(e,r,t,n))return!0;var o=e.selection.getStart();return!(o===r||!Mg(e,o,t,n))},Hg=to,Vg="_mce_caret",jg=function(e){return 0<function(e){for(var t=[];e;){if(3===e.nodeType&&e.nodeValue!==Hg||1<e.childNodes.length)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length},Ug=function(e){if(e){var t=new Vr(e,e);for(e=t.current();e;e=t.next())if(Dn(e))return e}return null},Wg=function(e){var t=Tt("span");return Gn(t,{id:Vg,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&sn(t,Et(Hg)),t},qg=function(e,t,n){void 0===n&&(n=!0);var r,o,i,u,a,c,s,l,f=e.dom,d=e.selection;jg(t)?rg(e,!1,At(t),n):(r=d.getRng(),o=f.getParent(t,f.isBlock),i=r.startContainer,u=r.startOffset,a=r.endContainer,c=r.endOffset,(l=Ug(t))&&l.nodeValue.charAt(0)===Hg&&l.deleteData(0,1),s=l,f.remove(t,!0),i===s&&0<u&&r.setStart(s,u-1),a===s&&0<c&&r.setEnd(s,c-1),o&&f.isEmpty(o)&&pm(At(o)),d.setRng(r))},Gg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(t)qg(e,t,n);else if(!(t=ml(e.getBody(),o.getStart())))for(;t=r.get(Vg);)qg(e,t,!1)},$g=function(e,t){return e.appendChild(t),t},Xg=function(e,t){var n=X(e,function(e,t){return $g(e,t.cloneNode(!1))},t);return $g(n,n.ownerDocument.createTextNode(Hg))},Kg=function(e,t){return e.schema.getTextInlineElements().hasOwnProperty(Mt(t))&&!dl(t.dom)&&!An(t.dom)},Yg={},Jg=we,Qg=ye;Gd=function(e){var t,n=e.selection.getRng(),r=_n(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),Qg(Jg(Jg(t,r),function(e){return r(e.previousSibling)&&-1!==Ce(t,e.previousSibling)}),function(e){var t,n;t=e.previousSibling,ta(n=e).remove(),ta(t).append("<br><br>").append(n.childNodes)}))},Yg.pre||(Yg.pre=[]),Yg.pre.push(Gd);var Zg,ep,tp,np,rp=kt.each,op=function(e){return On(e)&&!wl(e)&&!dl(e)&&!An(e)},ip=function(e,t){for(var n=e;n;n=n[t]){if(Dn(n)&&0!==n.nodeValue.length)return e;if(On(n)&&!wl(n))return n}return e},up=function(e,t,n){var r,o,i=Yd(e);if(t&&n&&(t=ip(t,"previousSibling"),n=ip(n,"nextSibling"),i.compare(t,n))){for(r=t.nextSibling;r&&r!==n;)r=(o=r).nextSibling,t.appendChild(o);return e.remove(n),kt.each(kt.grep(n.childNodes),function(e){t.appendChild(e)}),t}return n},ap=function(e,t,n,r){var o;r&&!1!==t.merge_siblings&&(o=up(e,Tl(r),r),up(e,o,Tl(o,!0)))},cp=function(e,t,n){rp(e.childNodes,function(e){op(e)&&(t(e)&&n(e),e.hasChildNodes()&&cp(e,t,n))})},sp=function(e,t){return function(n){return!(!n||!Pl(e,n,t))}},lp=function(e,t,n){return function(r){var o,i;e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),o=e,"SPAN"===(i=r).nodeName&&0===o.getAttribs(i).length&&o.remove(i,!0)}},fp=gr([{keep:[]},{rename:["name"]},{removed:[]}]),dp=/^(src|href|style)$/,mp=kt.each,gp=Bl,pp=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},hp=function(e,t,n){var r,o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];return On(o)&&(!n&&i&&i--,o=o.childNodes[(r=o.childNodes.length-1)<i?r:i]),Dn(o)&&n&&i>=o.nodeValue.length&&(o=new Vr(o,e.getBody()).next()||o),Dn(o)&&!n&&0===i&&(o=new Vr(o,e.getBody()).prev()||o),o},vp=function(e,t){var n=t?"firstChild":"lastChild";if(/^(TR|TH|TD)$/.test(e.nodeName)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},bp=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},yp=function(e,t,n,r,o){var i=At(t),u=At(e.create(r,o)),a=(n?Xt:$t)(i);return ln(u,a),n?(un(i,u),cn(u,i)):(an(i,u),sn(u,i)),u.dom},xp=function(e,t,n,r){return!(t=Tl(t,n,r))||"BR"===t.nodeName||e.isBlock(t)},wp=function(e,t,n,r,o){var i,u,a,c,s,l=e.dom;if(a=l,!(gp(c=r,(s=t).inline)||gp(c,s.block)||s.selector&&On(c)&&a.is(c,s.selector)||(u=r,t.links&&"A"===u.nodeName)))return fp.keep();var f,d,m,g,p,h,v,b=r;if(t.inline&&"all"===t.remove&&R(t.preserve_attributes)){var y=$(l.getAttribs(b),function(e){return j(t.preserve_attributes,e.name.toLowerCase())});if(l.removeAllAttribs(b),q(y,function(e){return l.setAttrib(b,e.name,e.value)}),0<y.length)return fp.rename("span")}if("all"!==t.remove){mp(t.styles,function(e,r){e=Dl(l,Nl(e,n),r+""),L(r)&&(r=e,o=null),!t.remove_similar&&o&&!gp(Pl(l,o,r),e)||l.setStyle(b,r,""),i=!0}),i&&""===l.getAttrib(b,"style")&&(b.removeAttribute("style"),b.removeAttribute("data-mce-style")),mp(t.attributes,function(e,r){var i;if(e=Nl(e,n),L(r)&&(r=e,o=null),t.remove_similar||!o||gp(l.getAttrib(o,r),e)){if("class"===r&&(e=l.getAttrib(b,r))&&(i="",q(e.split(/\s+/),function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)}),i))return void l.setAttrib(b,r,i);"class"===r&&b.removeAttribute("className"),dp.test(r)&&b.removeAttribute("data-mce-"+r),b.removeAttribute(r)}}),mp(t.classes,function(e){e=Nl(e,n),o&&!l.hasClass(o,e)||l.removeClass(b,e)});for(var x=l.getAttribs(b),w=0;w<x.length;w++){var C=x[w].nodeName;if(0!==C.indexOf("_")&&0!==C.indexOf("data-"))return fp.keep()}}return"none"!==t.remove?(m=t,p=(d=b).parentNode,h=(f=e).dom,v=Uc(f),m.block&&(v?p===h.getRoot()&&(m.list_block&&gp(d,m.list_block)||q(ie(d.childNodes),function(e){Al(f,v,e.nodeName.toLowerCase())?g?g.appendChild(e):(g=bp(h,e,v),h.setAttribs(g,f.settings.forced_root_block_attrs)):g=0})):h.isBlock(d)&&!h.isBlock(p)&&(xp(h,d,!1)||xp(h,d.firstChild,!0,!0)||d.insertBefore(h.create("br"),d.firstChild),xp(h,d,!0)||xp(h,d.lastChild,!1,!0)||d.appendChild(h.create("br")))),m.selector&&m.inline&&!gp(m.inline,d)||h.remove(d,!0),fp.removed()):fp.keep()},Cp=function(e,t,n,r,o){return wp(e,t,n,r,o).fold(y,function(t){return e.dom.rename(r,t),!0},x)},Sp=function(e,t,n,r,o){var i,u=e.formatter.get(t),a=u[0],c=!0,l=e.dom,d=e.selection,m=function(r){var i,c,l,f,d,m=(c=t,l=n,f=o,q(Il((i=e).dom,r.parentNode).reverse(),function(e){var t;d||"_start"===e.id||"_end"===e.id||(t=Fg(i,e,c,l,f))&&!1!==t.split&&(d=e)}),d);return function(e,t,n,r,o,i,u,a){var c,l,f,d=e.dom;if(n){for(var m=n.parentNode,g=r.parentNode;g&&g!==m;g=g.parentNode){c=d.clone(g,!1);for(var p=0;p<t.length&&null!==(c=function(e,t,n,r){return wp(e,t,n,r,r).fold(s(r),function(t){return e.dom.createFragment().appendChild(r),e.dom.rename(r,t)},s(null))}(e,t[p],a,c));p++);c&&(l&&c.appendChild(l),f=f||c,l=c)}u.mixed&&d.isBlock(n)||(r=d.split(n,r)),l&&(o.parentNode.insertBefore(l,o),f.appendChild(o),u.inline&&ap(d,u,0,l))}return r}(e,u,m,r,r,0,a,n)},g=function(t){var r,o;On(t)&&l.getContentEditable(t)&&(r=c,c="true"===l.getContentEditable(t),o=!0);var i=ie(t.childNodes);if(c&&!o)for(var s=0;s<u.length&&!Cp(e,u[s],n,t,t);s++);if(a.deep&&i.length){for(s=0;s<i.length;s++)g(i[s]);o&&(c=r)}},p=function(e){var t,n=l.get(e?"_start":"_end"),r=n[e?"firstChild":"lastChild"];return wl(t=r)&&On(t)&&("_start"===t.id||"_end"===t.id)&&(r=r[e?"firstChild":"lastChild"]),Dn(r)&&0===r.data.length&&(r=e?n.previousSibling||n.nextSibling:n.nextSibling||n.previousSibling),l.remove(n,!0),r},h=function(t){var n,r,o=tf(e,t,u,t.collapsed);if(a.split){if(o=If(o),(n=hp(e,o,!0))!==(r=hp(e,o))){if(n=vp(n,!0),r=vp(r,!1),pp(l,n,r)){var i=k.from(n.firstChild).getOr(n);return m(yp(l,i,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void p(!0)}if(pp(l,r,n))return i=k.from(r.lastChild).getOr(r),m(yp(l,i,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void p(!1);n=bp(l,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=bp(l,r,"span",{id:"_end","data-mce-type":"bookmark"});var c=l.createRng();c.setStartAfter(n),c.setEndBefore(r),rf(l,c,function(e){q(e,function(e){wl(e)||wl(e.parentNode)||m(e)})}),m(n),m(r),n=p(!0),r=p()}else n=r=m(n);o.startContainer=n.parentNode?n.parentNode:n,o.startOffset=l.nodeIndex(n),o.endContainer=r.parentNode?r.parentNode:r,o.endOffset=l.nodeIndex(r)+1}rf(l,o,function(t){q(t,function(t){g(t),q(["underline","line-through","overline"],function(n){On(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&Ml(l,t.parentNode)===n&&Cp(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)})})})};if(r)Ol(r)?((i=l.createRng()).setStartBefore(r),i.setEndAfter(r),h(i)):h(r);else if("false"!==l.getContentEditable(d.getNode()))d.isCollapsed()&&a.inline&&!af(e).length?function(e,t,n,r){var o,i,u,a,c,s,l,d,m,g,p,h,v,b=e.dom,y=e.selection,x=[],w=y.getRng(),C=w.startContainer,S=C;for(3===C.nodeType&&(w.startOffset!==C.nodeValue.length&&(o=!0),S=S.parentNode);S;){if(Fg(e,S,t,n,r)){i=S;break}S.nextSibling&&(o=!0),x.push(S),S=S.parentNode}i&&(o?(u=y.getBookmark(),w.collapse(!0),a=tf(e,w,e.formatter.get(t),!0),a=If(a),e.formatter.remove(t,n,a,r),y.moveToBookmark(u)):(c=ml(e.getBody(),i),g=s=Wg(!1).dom,(v=(h=(m=e).dom).getParent(p=null!==c?c:i,f(El,m)))&&h.isEmpty(v)?p.parentNode.replaceChild(g,p):(function(e){var t=Ta(e,"br"),n=$(function(e){for(var t=[],n=e.dom;n;)t.push(At(n)),n=n.lastChild;return t}(e).slice(-1),$r);t.length===n.length&&q(n,dn)}(At(p)),h.isEmpty(p)?p.parentNode.replaceChild(g,p):h.insertAfter(g,p)),l=function(e,t,n,r,o,i){var u=e.formatter,a=e.dom,c=$(ue(u.get()),function(e){return e!==r&&!Fe(e,"removeformat")}),s=function(e,t,n){return K(n,function(n,r){var o=U(e.formatter.get(r),function(e){var t=function(e){return 1<e.length&&"%"===e.charAt(0)};return U(["styles","attributes"],function(n){return pe(e,n).exists(function(e){var n=R(e)?e:function(e){return t=[],ce(e,function(e,n){t.push(e)}),t;var t}(e);return U(n,t)})})});return e.formatter.matchNode(t,r,{},o)?n.concat([r]):n},[])}(e,n,c);if(0<$(s,function(t){return!Ll(e,t,r)}).length){var l=n.cloneNode(!1);return a.add(t,l),u.remove(r,o,l,i),a.remove(l),k.some(l)}return k.none()}(e,s,i,t,n,r),d=Xg(x.concat(l.toArray()),s),qg(e,c,!1),y.setCursorLocation(d,1),b.isEmpty(i)&&b.remove(i)))}(e,t,n,o):(gf(d,!0,function(){mf(e,h)}),a.inline&&zg(e,t,n,d.getStart())&&_l(l,d,d.getRng()),e.nodeChanged());else{r=d.getNode();for(var v=0;v<u.length&&(!u[v].ceFalseOverride||!Cp(e,u[v],n,r,r));v++);}},kp=kt.each,Op=kt.each,_p=ve,Tp=function(e,t,n,r){var o,i,u,a,c=e.formatter.get(t),s=c[0],l=!r&&e.selection.isCollapsed(),f=e.dom,d=e.selection,m=function(e,t){var o;t=t||s,e&&(t.onformat&&t.onformat(e,t,n,r),Op(t.styles,function(t,r){f.setStyle(e,r,Nl(t,n))}),!t.styles||(o=f.getAttrib(e,"style"))&&f.setAttrib(e,"data-mce-style",o),Op(t.attributes,function(t,r){f.setAttrib(e,r,Nl(t,n))}),Op(t.classes,function(t){t=Nl(t,n),f.hasClass(e,t)||f.addClass(e,t)}))},g=function(e,t){var n=!1;return!!zl(s)&&(Op(e,function(e){if(!("collapsed"in e)||e.collapsed===l)return f.is(t,e.selector)&&!dl(t)?(m(t,e),!(n=!0)):void 0}),n)},p=function(r,o,i,u){var a=[],l=!0,f=s.inline||s.block,d=r.create(f);m(d),rf(r,o,function(o){var i,p=function(o){var h=!1,v=l,b=o.nodeName.toLowerCase(),y=o.parentNode.nodeName.toLowerCase();if(On(o)&&r.getContentEditable(o)&&(v=l,l="true"===r.getContentEditable(o),h=!0),Ln(o)&&!function(e,t,n,r){if(e.getParam("format_empty_lines",!1,"boolean")&&Hl(t)){var o=_e(_e({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),i=function(e,t){return r=t,((o=(n=e).dom).parentNode?function(e,t){return Y(e.dom.childNodes,function(e){return function(e){return!Dt(n,e)&&r(e)}(At(e))}).map(At)}(At(o.parentNode)):k.none()).isSome();var n,r,o}(At(n),function(e){return dl(e.dom)});return ve(o,r)&&Do(At(n.parentNode),!1)&&!i}return!1}(e,s,o,y))return i=null,void(Fl(s)&&r.remove(o));if(s.wrapper&&Fg(e,o,t,n))i=null;else{if(l&&!h&&Fl(s)&&!s.wrapper&&El(e,b)&&Al(e,y,f)){var x=r.rename(o,f);return m(x),a.push(x),void(i=null)}if(zl(s)){var w=g(c,o);if(!_p(s,"inline")||w)return void(i=null)}!l||h||!Al(e,f,b)||!Al(e,y,f)||!u&&3===o.nodeType&&1===o.nodeValue.length&&65279===o.nodeValue.charCodeAt(0)||dl(o)||_p(s,"inline")&&r.isBlock(o)?(i=null,Op(kt.grep(o.childNodes),p),h&&(l=v),i=null):(i||(i=r.clone(d,!1),o.parentNode.insertBefore(i,o),a.push(i)),i.appendChild(o))}};Op(o,p)}),!0===s.links&&Op(a,function(e){var t=function(e){"A"===e.nodeName&&m(e,s),Op(kt.grep(e.childNodes),t)};t(e)}),Op(a,function(o){var i,u,l,f,d,g,p,h,v,b,y,x,w,C,S,k,O,_,T,E=(i=0,Op(o.childNodes,function(e){var t;M(t=e)&&Dn(t)&&0===t.length||wl(e)||i++}),i);!(1<a.length)&&r.isBlock(o)||0!==E?(Hl(s)||s.wrapper)&&(s.exact||1!==E||((T=function(e){var t=!1;return Op(e.childNodes,function(e){if((n=e)&&1===n.nodeType&&!wl(n)&&!dl(n)&&!An(n))return t=e,!1;var n}),t}(O=o))&&!wl(T)&&Ig(r,T,s)&&(_=r.clone(T,!1),m(_),r.replace(_,O,!0),r.remove(T,!0)),o=_||O),function(e,t,n,r){kp(t,function(t){var o,i;kp(e.dom.select(t.inline,r),function(r){op(r)&&Cp(e,t,n,r,t.exact?r:null)}),o=e.dom,(i=t).clear_child_styles&&rp(o.select(i.links?"*:not(a)":"*",r),function(e){op(e)&&rp(i.styles,function(t,n){o.setStyle(e,n,"")})})})}(e,c,n,o),w=s,Fg(x=e,(k=o).parentNode,C=t,S=n)&&Cp(x,w,S,k)||w.merge_with_parents&&x.dom.getParent(k.parentNode,function(e){if(Fg(x,e,C,S))return Cp(x,w,S,k),!0}),v=r,y=n,(b=s).styles&&b.styles.backgroundColor&&cp(o,sp(v,"fontSize"),lp(v,"backgroundColor",Nl(b.styles.backgroundColor,y))),d=r,p=o,h=function(e){var t;1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType&&(t=Ml(d,e.parentNode),d.getStyle(e,"color")&&t?d.setStyle(e,"text-decoration",t):d.getStyle(e,"text-decoration")===t&&d.setStyle(e,"text-decoration",null))},(g=s).styles&&(g.styles.color||g.styles.textDecoration)&&(kt.walk(p,h,"childNodes"),h(p)),u=r,f=o,"sub"!==(l=s).inline&&"sup"!==l.inline||(cp(f,sp(u,"fontSize"),lp(u,"fontSize","")),u.remove(u.select("sup"===l.inline?"sub":"sup",f),!0)),ap(r,s,0,o)):r.remove(o,!0)})};if("false"!==f.getContentEditable(d.getNode()))s&&(r?Ol(r)?g(c,r)||((o=f.createRng()).setStartBefore(r),o.setEndAfter(r),p(f,tf(e,o,c),0,!0)):p(f,r,0,!0):l&&Hl(s)&&!af(e).length?function(e,t,n){var r,o=e.selection,i=o.getRng(),u=i.startOffset,a=i.startContainer.nodeValue,c=ml(e.getBody(),o.getStart());c&&(r=Ug(c));var s,l,f,d,m=/[^\s\u00a0\u00ad\u200b\ufeff]/;a&&0<u&&u<a.length&&m.test(a.charAt(u))&&m.test(a.charAt(u-1))?(s=o.getBookmark(),i.collapse(!0),l=tf(e,i,e.formatter.get(t)),l=If(l),e.formatter.apply(t,n,l),o.moveToBookmark(s)):(c&&r.nodeValue===Hg||(f=e.getDoc(),d=Wg(!0).dom,r=(c=f.importNode(d,!0)).firstChild,i.insertNode(c),u=1),e.formatter.apply(t,n,c),o.setCursorLocation(r,u))}(e,t,n):(i=d.getNode(),u=c[0],e.settings.forced_root_block||!u.defaultBlock||f.getParent(i,f.isBlock)||Tp(e,u.defaultBlock),d.setRng(Sg(d.getRng())),gf(d,!0,function(t){mf(e,function(t,n){var r=n?t:tf(e,t,c);p(f,r)})}),_l(f,d,d.getRng()),e.nodeChanged()),a=e,Qg(Yg[t],function(e){e(a)}));else{r=d.getNode();for(var h=0,v=c.length;h<v;h++){var b=c[h];if(b.ceFalseOverride&&zl(b)&&f.is(r,b.selector))return void m(r,b)}}},Ep=function(e,t){var n=(t||document).createDocumentFragment();return q(e,function(e){n.appendChild(e.dom)}),At(n)},Ap=function(e,t,n){return{element:e,width:t,rows:n}},Rp=function(e,t){return{element:e,cells:t}},Np=function(e,t){var n=parseInt($n(e,t),10);return isNaN(n)?1:n},Bp=function(e){return K(e,function(e,t){return t.cells.length>e?t.cells.length:e},0)},Dp=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var o=n[r].cells,i=0;i<o.length;i++)if(Dt(o[i],t))return k.some({x:i,y:r});return k.none()},Pp=function(e,t,n,r,o){for(var i=[],u=e.rows,a=n;a<=o;a++){var c=u[a].cells,s=t<r?c.slice(t,r+1):c.slice(r,t+1);i.push(Rp(u[a].element,s))}return i},Mp=function(e){return n=W((t=e).rows,function(e){var t=W(e.cells,function(e){var t=Fa(e);return Kn(t,"colspan"),Kn(t,"rowspan"),t}),n=La(e.element);return ln(n,t),n}),r=La(t.element),o=Tt("tbody"),ln(o,n),sn(r,o),r;var t,n,r,o},Ip=function(){return Ep([])},Lp=function(e,t){return 0<=t&&t<e.length&&Sl(e.charAt(t))},Fp=function(e,t){var n=ro(e.innerText);return t?n.replace(/^[ \f\n\r\t\v]+/,""):n},zp=function(e,t,n){if(void 0===n&&(n={}),n.get=!0,n.format=t,n.selection=!0,(n=e.fire("BeforeGetContent",n)).isDefaultPrevented())return e.fire("GetContent",n),n.content;if("text"===n.format)return function(e){return k.from(e.selection.getRng()).map(function(t){var n=k.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),o=n.map(function(e){return e.nodeName}).getOr("div").toLowerCase(),i=yt.browser.isIE()&&"pre"!==o,u=e.dom.add(r,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),a=Fp(u,i),c=ro(u.textContent);if(e.dom.remove(u),Lp(c,0)||Lp(c,c.length-1)){var s=n.getOr(r),l=Fp(s,i),f=l.indexOf(a);return-1===f?a:(Lp(l,f-1)?" ":"")+a+(Lp(l,f+a.length)?" ":"")}return a}).getOr("")}(e);n.getInner=!0;var r,o,i,u,a,c,l,d=(o=n,i=(r=e).selection.getRng(),u=r.dom.create("body"),a=r.selection.getSel(),c=Md(r,of(a)),(l=o.contextual?function(e,t){var n,r,o=uf(t,e);return 0<o.length?function(e,t){return Or(t[0],"table",f(Dt,e)).bind(function(e){var n=t[0],r=t[t.length-1];return function(e,t,n){return Dp(e,t).bind(function(t){return Dp(e,n).map(function(n){return r=e,u=(o=t).x,c=(i=n).x,l=(a=o.y)<(s=i.y)?Pp(r,u,a,c,s):Pp(r,u,s,c,a),Ap(r.element,Bp(l),l);var r,o,i,u,a,c,s,l})})}(function(e){var t=Ap(La(e),0,[]);return q(Ta(e,"tr"),function(e,n){q(Ta(e,"td,th"),function(r,o){!function(e,t,n,r,o){for(var i=Np(o,"rowspan"),u=Np(o,"colspan"),a=e.rows,c=n;c<n+i;c++){a[c]||(a[c]=Rp(Fa(r),[]));for(var s=t;s<t+u;s++)a[c].cells[s]=c===n&&s===t?o:La(o)}}(t,function(e,t,n){for(;((o=e.rows)[r=n]?o[r].cells:[])[t];)t++;var r,o;return t}(t,o,n),n,e,r)})}),Ap(t.element,Bp(t.rows),t.rows)}(e),n,r).map(function(e){return Ep([Mp(e)])})}).getOrThunk(Ip)}(e,o):(n=e,0<(r=t).length&&r[0].collapsed?Ip():function(e,t){return n=At(t.cloneContents()),r=function(e,t){var n,r=At(t.commonAncestorContainer),o=bm(r,e),i=$(o,function(e){return Gr(e)||Wr(e)}),u=function(e,t){return Y(e,function(e){return"li"===Mt(e)&&lf(e,t)}).fold(s([]),function(t){return Y(e,function(e){return"ul"===Mt(e)||"ol"===Mt(e)}).map(function(e){var t=Tt(Mt(e));return function(e,t){var n=e.dom;ce(t,function(e,t){!function(e,t,n){if(!E(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Un(e)&&e.style.setProperty(t,n)}(n,t,e)})}(t,ge(Zn(e),function(e,t){return ze(t,"list-style")})),[Tt("li"),t]}).getOr([])})}(o,t),a=i.concat(u.length?u:Yr(n=r)?Wt(n).filter(Kr).fold(s([]),function(e){return[n,e]}):Kr(n)?[n]:[]);return W(a,La)}(e,t),o=K(r,function(e,t){return sn(t,e),t},n),0<r.length?Ep([o]):o;var n,r,o}(n,r[0]))}(At(r.getBody()),c).dom:i.cloneContents())&&u.appendChild(l),r.selection.serializer.serialize(u,o));return"tree"===n.format?d:(n.content=e.selection.isCollapsed()?"":d,e.fire("GetContent",n),n.content)},Hp=function(e){return On(e)?e.outerHTML:Dn(e)?Yo.encodeRaw(e.data,!1):Pn(e)?"\x3c!--"+e.data+"--\x3e":""},Vp=ga(k.none()),jp=function(e){var t,n=(t=e.getBody(),$(W(ie(t.childNodes),Hp),function(e){return 0<e.length})),r=Q(n,function(t){var n=$d(e.serializer,t);return 0<n.length?[n]:[]}),o=r.join("");return-1!==o.indexOf("</iframe>")?{type:"fragmented",fragments:r,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:o,bookmark:null,beforeBookmark:null}},Up=function(e,t,n){"fragmented"===t.type?function(e,t){var n,r,o,i,u,a,c,s,l,f=W(ie(t.childNodes),Hp);!function(e,t){var n=0;q(e,function(e){var r,o,i;0===e[0]?n++:1===e[0]?(function(e,t,n){var r,o=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(t);e.hasChildNodes()&&n<e.childNodes.length?(r=e.childNodes[n]).parentNode.insertBefore(o,r):e.appendChild(o)}(t,e[1],n),n++):2===e[0]&&(o=n,(r=t).hasChildNodes()&&o<r.childNodes.length&&(i=r.childNodes[o]).parentNode.removeChild(i))})}((o=(n=f).length+(r=e).length+2,i=new Array(o),u=new Array(o),a=function(e,t,o,i,u){var c=s(e,t,o,i);if(null===c||c.start===t&&c.diag===t-i||c.end===e&&c.diag===e-o)for(var l=e,f=o;l<t||f<i;)l<t&&f<i&&n[l]===r[f]?(u.push([0,n[l]]),++l,++f):i-o<t-e?(u.push([2,n[l]]),++l):(u.push([1,r[f]]),++f);else{a(e,c.start,o,c.start-c.diag,u);for(var d=c.start;d<c.end;++d)u.push([0,n[d]]);a(c.end,t,c.end-c.diag,i,u)}},c=function(e,t,o,i){for(var u=e;u-t<i&&u<o&&n[u]===r[u-t];)++u;return{start:e,end:u,diag:t}},s=function(e,t,o,a){var s=t-e,l=a-o;if(0==s||0==l)return null;var f,d,m,g,p,h=s-l,v=l+s,b=(v%2==0?v:1+v)/2;for(i[1+b]=e,u[1+b]=t+1,f=0;f<=b;++f){for(d=-f;d<=f;d+=2){for(i[m=d+b]=d===-f||d!==f&&i[m-1]<i[m+1]?i[m+1]:i[m-1]+1,p=(g=i[m])-e+o-d;g<t&&p<a&&n[g]===r[p];)i[m]=++g,++p;if(h%2!=0&&h-f<=d&&d<=h+f&&u[m-h]<=i[m])return c(u[m-h],d+e-o,t,a)}for(d=h-f;d<=h+f;d+=2){for(u[m=d+b-h]=d===h-f||d!==h+f&&u[m+1]<=u[m-1]?u[m+1]-1:u[m-1],p=(g=u[m]-1)-e+o-d;e<=g&&o<=p&&n[g]===r[p];)u[m]=g--,p--;if(h%2==0&&-f<=d&&d<=f&&u[m]<=i[m+h])return c(u[m],d+e-o,t,a)}}},a(0,n.length,0,r.length,l=[]),l),t)}(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)},Wp=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},qp=function(e){var t=Tt("body",Vp.get().getOrThunk(function(){var e=document.implementation.createHTMLDocument("undo");return Vp.set(k.some(e)),e}));return Ma(t,Wp(e)),q(Ta(t,"*[data-mce-bogus]"),mn),t.dom.innerHTML},Gp=function(e,t){return!(!e||!t)&&(r=t,Wp(e)===Wp(r)||(n=t,qp(e)===qp(n)));var n,r},$p=function(e){return 0===e.get()},Xp=function(e,t,n){$p(n)&&(e.typing=t)},Kp=function(e,t){e.typing&&(Xp(e,!1,t),e.add())},Yp=function(e){return{undoManager:{beforeChange:function(t,n){return r=e,o=n,void($p(t)&&o.set(k.some(zc(r.selection))));var r,o},addUndoLevel:function(t,n,r,o,i,u){return function(e,t,n,r,o,i,u){var a=jp(e);if(i=kt.extend(i=i||{},a),!1===$p(r)||e.removed)return null;var c=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:c,originalEvent:u}).isDefaultPrevented())return null;if(c&&Gp(c,i))return null;t.data[n.get()]&&o.get().each(function(e){t.data[n.get()].beforeBookmark=e});var s=e.getParam("custom_undo_redo_levels",0,"number");if(s&&t.data.length>s){for(var l=0;l<t.data.length-1;l++)t.data[l]=t.data[l+1];t.data.length--,n.set(t.data.length)}i.bookmark=zc(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);var f={level:i,lastLevel:c,originalEvent:u};return 0<n.get()?(e.setDirty(!0),e.fire("AddUndo",f),e.fire("change",f)):e.fire("AddUndo",f),i}(e,t,n,r,o,i,u)},undo:function(t,n,r){return o=e,u=n,a=r,(i=t).typing&&(i.add(),i.typing=!1,Xp(i,!1,u)),0<a.get()&&(a.set(a.get()-1),c=i.data[a.get()],Up(o,c,!0),o.setDirty(!0),o.fire("Undo",{level:c})),c;var o,i,u,a,c},redo:function(t,n){return r=e,i=n,(o=t).get()<i.length-1&&(o.set(o.get()+1),u=i[o.get()],Up(r,u,!1),r.setDirty(!0),r.fire("Redo",{level:u})),u;var r,o,i,u},clear:function(t,n){return r=e,i=n,(o=t).data=[],i.set(0),o.typing=!1,void r.fire("ClearUndos");var r,o,i},reset:function(e){return(t=e).clear(),void t.add();var t},hasUndo:function(t,n){return r=e,o=t,0<n.get()||o.typing&&o.data[0]&&!Gp(jp(r),o.data[0]);var r,o},hasRedo:function(e,t){return n=e,t.get()<n.data.length-1&&!n.typing;var n},transact:function(e,t,n){return o=n,Kp(r=e,t),r.beforeChange(),r.ignore(o),r.add();var r,o},ignore:function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},extra:function(t,n,r,o){return i=e,a=n,c=o,void((u=t).transact(r)&&(s=u.data[a.get()].bookmark,l=u.data[a.get()-1],Up(i,l,!0),u.transact(c)&&(u.data[a.get()-1].beforeBookmark=s)));var i,u,a,c,s,l}},formatter:{match:function(t,n,r){return zg(e,t,n,r)},matchAll:function(t,n){return o=t,i=n,u=[],a={},c=(r=e).selection.getStart(),r.dom.getParent(c,function(e){for(var t=0;t<o.length;t++){var n=o[t];!a[n]&&Fg(r,e,n,i)&&(a[n]=!0,u.push(n))}},r.dom.getRoot()),u;var r,o,i,u,a,c},matchNode:function(t,n,r,o){return Fg(e,t,n,r,o)},canApply:function(t){return function(e,t){var n,r,o,i,u,a=e.formatter.get(t),c=e.dom;if(a)for(n=e.selection.getStart(),r=Il(c,n),i=a.length-1;0<=i;i--){if(!(u=a[i].selector)||a[i].defaultBlock)return!0;for(o=r.length-1;0<=o;o--)if(c.is(r[o],u))return!0}return!1}(e,t)},closest:function(t){return function(e,t){var n=function(t){return Dt(t,At(e.getBody()))};return k.from(e.selection.getStart(!0)).bind(function(r){return Bg(At(r),function(n){return function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n]);if(r.isSome())return r}return k.none()}(t,function(t){return Fg(e,n.dom,r=t)?k.some(r):k.none();var r})},n)}).getOrNull()}(e,t)},apply:function(t,n,r){return Tp(e,t,n,r)},remove:function(t,n,r,o){return Sp(e,t,n,r,o)},toggle:function(t,n,r){return u=n,a=r,c=(o=e).formatter.get(i=t),void(!zg(o,i,u,a)||"toggle"in c[0]&&!c[0].toggle?Tp:Sp)(o,i,u,a);var o,i,u,a,c},formatChanged:function(t,n,r,o){return function(e,t,n,r,o){var i,u,a,c,s,l,f,d;return null===t.get()&&(u=e,a=ga({}),(i=t).set({}),u.on("NodeChange",function(e){!function(e,t,n,r){var o=ue(n.get()),i={},u={},a=$(Il(e.dom,t),function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")});ce(r,function(t,n){kt.each(a,function(r){return e.formatter.matchNode(r,n,{},t.similar)?(-1===o.indexOf(n)&&(q(t.callbacks,function(e){e(!0,{node:r,format:n,parents:a})}),i[n]=t.callbacks),u[n]=t.callbacks,!1):!Pg(e,r,n)&&void 0})});var c=function(e,t,n,r){return me(e,function(e,o){return!!he(t,o)||(q(e,function(e){e(!1,{node:n,format:o,parents:r})}),!1)}).t}(n.get(),u,t,a);n.set(_e(_e({},i),c))}(u,e.element,a,i.get())})),s=n,l=r,f=o,d=(c=t).get(),q(s.split(","),function(e){d[e]||(d[e]={similar:f,callbacks:[]}),d[e].callbacks.push(l)}),c.set(d),{unbind:function(){return o=n,i=r,u=(e=t).get(),q(o.split(","),function(e){u[e].callbacks=$(u[e].callbacks,function(e){return e!==i}),0===u[e].callbacks.length&&delete u[e]}),void e.set(u);var e,o,i,u}}}(e,t,n,r,o)}},editor:{getContent:function(t,n){return o=t,i=n,k.from((r=e).getBody()).fold(s("tree"===o.format?new zd("body",11):""),function(e){return function(e,t,n,r){var o,i,u,a,c;return t.format=n,t.get=!0,t.getInner=!0,t.no_events||e.fire("BeforeGetContent",t),o="raw"===t.format?kt.trim(Xd(e.serializer,r.innerHTML)):"text"===t.format?e.dom.isEmpty(r)?"":ro(r.innerText||r.textContent):"tree"===t.format?e.serializer.serialize(r,t):(u=(i=e).serializer.serialize(r,t),a=Uc(i),c=new RegExp("^(<"+a+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+a+">[\r\n]*|<br \\/>[\r\n]*)$"),u.replace(c,"")),t.content=j(["text","tree"],t.format)||Zr(At(r))?o:kt.trim(o),t.no_events||e.fire("GetContent",t),t.content}(r,o,i,e)});var r,o,i},setContent:function(t,n){return function(e,t,n){return n.format=n.format?n.format:"html",n.set=!0,n.content=Ag(t)?"":t,n.no_events||e.fire("BeforeSetContent",n),Ag(t)||(t=n.content),k.from(e.getBody()).fold(s(t),function(r){return Ag(t)?function(e,t,n,r){!function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var u in n.firstChild&&Eg(n.firstChild,function(n){q(e,function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})}),q(t,function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})})}),r)r.hasOwnProperty(u)&&i.push(r[u]);for(var a in o)o.hasOwnProperty(a)&&i.push(o[a]);return i}(e,t,n);q(r,function(e){q(e.filter.callbacks,function(t){t(e.nodes,e.filter.name,{})})})}(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=Zd({validate:e.validate},e.schema).serialize(n);return r.content=Zr(At(t))?o:kt.trim(o),Rg(e,r.content),r.no_events||e.fire("SetContent",r),n}(e,r,t,n):(o=e,i=r,a=n,0===(u=t).length||/^\s+$/.test(u)?(s='<br data-mce-bogus="1">',"TABLE"===i.nodeName?u="<tr><td>"+s+"</td></tr>":/^(UL|OL)$/.test(i.nodeName)&&(u="<li>"+s+"</li>"),u=(c=Uc(o))&&o.schema.isValidChild(i.nodeName.toLowerCase(),c.toLowerCase())?(u=s,o.dom.createHTML(c,Wc(o),u)):u||'<br data-mce-bogus="1">',Rg(o,u),o.fire("SetContent",a)):("raw"!==a.format&&(u=Zd({validate:o.validate},o.schema).serialize(o.parser.parse(u,{isRootContent:!0,insert:!0}))),a.content=Zr(At(i))?u:kt.trim(u),Rg(o,a.content),a.no_events||o.fire("SetContent",a)),a.content);var o,i,u,a,c,s})}(e,t,n)},insertContent:function(t,n){return Tg(e,t,n)},addVisual:function(t){return o=(n=e).dom,i=M(r=t)?r:n.getBody(),D(n.hasVisual)&&(n.hasVisual=n.getParam("visual",!0,"boolean")),q(o.select("table,a",i),function(e){switch(e.nodeName){case"TABLE":var t=n.getParam("visual_table_class","mce-item-table","string"),r=o.getAttrib(e,"border");r&&"0"!==r||!n.hasVisual?o.removeClass(e,t):o.addClass(e,t);break;case"A":var i,u;o.getAttrib(e,"href")||(i=o.getAttrib(e,"name")||e.id,u=n.getParam("visual_anchor_class","mce-item-anchor","string"),i&&n.hasVisual?o.addClass(e,u):o.removeClass(e,u))}}),void n.fire("VisualAid",{element:r,hasVisual:n.hasVisual});var n,r,o,i}},selection:{getContent:function(t,n){return zp(e,t,n)}},raw:{getModel:function(){return k.none()}}}},Jp=function(e){return he(e.plugins,"rtc")},Qp=function(e){return e.rtcInstance?e.rtcInstance:Yp(e)},Zp=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},eh=function(e){return 0===e.dom.length?(dn(e),k.none()):k.some(e)},th=function(e,t,n,r){e.bind(function(e){return(r?Gm:qm)(e.dom,r?e.dom.length:0),t.filter(zt).map(function(t){return o=n,u=e.dom,a=t.dom,c=(i=r)?u.length:a.length,void(i?($m(u,a,!1,!i),o.setStart(a,c)):($m(a,u,!1,!i),o.setEnd(a,c)));var o,i,u,a,c})}).orThunk(function(){var e;return(e=r,t.filter(function(e){return yf.isBookmarkNode(e.dom)}).bind(e?Gt:qt).or(t).filter(zt)).map(function(e){return n=r,void Wt(t=e).each(function(e){var r=t.dom;n&&Fm(e,hc(r,0))?qm(r,0):!n&&zm(e,hc(r,r.length))&&Gm(r,r.length)});var t,n})})},nh=function(e,t,n){var r;e&&e.hasOwnProperty(t)&&(0===(r=$(e[t],function(e){return e!==n})).length?delete e[t]:e[t]=r)},rh=function(e){return!!e.select},oh=function(e){return!(!e||!e.ownerDocument)&&Pt(At(e.ownerDocument),At(e))},ih=function(e,t,n,r){var o,i,u,a,c,s,l=function(e,t){return c||(c={},s={},a.on("NodeChange",function(e){var t=e.element,n=u.getParents(t,null,u.getRoot()),r={};kt.each(c,function(e,t){kt.each(n,function(o){if(u.is(o,t))return s[t]||(kt.each(e,function(e){e(!0,{node:o,selector:t,parents:n})}),s[t]=e),r[t]=e,!1})}),kt.each(s,function(e,o){r[o]||(delete s[o],kt.each(e,function(e){e(!1,{node:t,selector:o,parents:n})}))})})),c[e]||(c[e]=[]),c[e].push(t),{unbind:function(){nh(c,e,t),nh(s,e,t)}}},f=function(e,t){return function(e,t,n){void 0===n&&(n={});var r,o,i=(r=t,_e(_e({format:"html"},n),{set:!0,selection:!0,content:r}));i.no_events||!(i=e.fire("BeforeSetContent",i)).isDefaultPrevented()?(n.content=function(e,t){if("raw"===t.format)return t.content;var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=r?{context:r.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,_e(_e({isRootContent:!0,forced_root_block:!1},o),t));return Zd({validate:e.validate},e.schema).serialize(i)}(e,i),function(e,t){var n=k.from(t.firstChild).map(At),r=k.from(t.lastChild).map(At);e.deleteContents(),e.insertNode(t);var o=n.bind(qt).filter(zt).bind(eh),i=r.bind(Gt).filter(zt).bind(eh);th(o,n,e,!0),th(i,r,e,!1),e.collapse(!1)}(o=e.selection.getRng(),o.createContextualFragment(n.content)),e.selection.setRng(o),ad(e,o),i.no_events||e.fire("SetContent",i)):e.fire("SetContent",i)}(r,e,t)},d=function(e){var t=g();t.collapse(!!e),p(t)},m=function(){return t.getSelection?t.getSelection():t.document.selection},g=function(){var n,u,a,s=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(s){return-1}},l=t.document;if(void 0!==r.bookmark&&!1===Ed(r)){var f=xd(r);if(f.isSome())return f.map(function(e){return Md(r,[e])[0]}).getOr(l.createRange())}try{(n=m())&&!kn(n.anchorNode)&&(u=0<n.rangeCount?n.getRangeAt(0):n.createRange?n.createRange():l.createRange(),u=Md(r,[u])[0])}catch(c){}return(u=u||(l.createRange?l.createRange():l.body.createTextRange())).setStart&&9===u.startContainer.nodeType&&u.collapsed&&(a=e.getRoot(),u.setStart(a,0),u.setEnd(a,0)),o&&i&&(0===s(u.START_TO_START,u,o)&&0===s(u.END_TO_END,u,o)?u=i:i=o=null),u},p=function(e,t){var n;if((u=e)&&(rh(u)||oh(u.startContainer)&&oh(u.endContainer))){var u,a=rh(e)?e:null;if(a){i=null;try{a.select()}catch(c){}}else{var s=m();if(e=r.fire("SetSelectionRange",{range:e,forward:t}).range,s){i=e;try{s.removeAllRanges(),s.addRange(e)}catch(c){}!1===t&&s.extend&&(s.collapse(e.endContainer,e.endOffset),s.extend(e.startContainer,e.startOffset)),o=0<s.rangeCount?s.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!s.setBaseAndExtent||yt.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(s.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),s.anchorNode===e.startContainer&&s.focusNode===e.endContainer||s.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},h=function(){var t=m(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;if(!t||!n||!r||kn(n)||kn(r))return!0;var o=e.createRng();o.setStart(n,t.anchorOffset),o.collapse(!0);var i=e.createRng();return i.setStart(r,t.focusOffset),i.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,i)<=0},v={bookmarkManager:null,controlSelection:null,dom:u=e,win:t,serializer:n,editor:a=r,collapse:d,setCursorLocation:function(t,n){var o=e.createRng();M(t)&&M(n)?(o.setStart(t,n),o.setEnd(t,n),p(o),d(!1)):(ff(e,o,r.getBody(),!0),p(o))},getContent:function(e){return function(e,t){var n,r;return void 0===t&&(t={}),n=t.format?t.format:"html",r=t,Zp(e).selection.getContent(n,r)}(r,e)},setContent:f,getBookmark:function(e,t){return b.getBookmark(e,t)},moveToBookmark:function(e){return b.moveToBookmark(e)},select:function(t,n){var r,o;return r=e,o=n,k.from(t).map(function(e){var t=r.nodeIndex(e),n=r.createRng();return n.setStart(e.parentNode,t),n.setEnd(e.parentNode,t+1),o&&(ff(r,n,e,!0),ff(r,n,e,!1)),n}).each(p),t},isCollapsed:function(){var e=g(),t=m();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:h,setNode:function(t){return f(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,r;if(!t)return e;n=t.startContainer,r=t.endContainer;var o=t.startOffset,i=t.endOffset,u=t.commonAncestorContainer;return!t.collapsed&&(n===r&&i-o<2&&n.hasChildNodes()&&(u=n.childNodes[o]),3===n.nodeType&&3===r.nodeType&&(n=n.length===o?Pd(n.nextSibling,!0):n.parentNode,r=0===i?Pd(r.previousSibling,!1):r.parentNode,n&&n===r))?n:u&&3===u.nodeType?u.parentNode:u}(r.getBody(),g())},getSel:m,setRng:p,getRng:g,getStart:function(e){return Bd(r.getBody(),g(),e)},getEnd:function(e){return Dd(r.getBody(),g(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i=[],u=e.getRoot();if(n=e.getParent(n||Bd(u,t,t.collapsed),e.isBlock),r=e.getParent(r||Dd(u,t,t.collapsed),e.isBlock),n&&n!==u&&i.push(n),n&&r&&n!==r)for(var a=new Vr(o=n,u);(o=a.next())&&o!==r;)e.isBlock(o)&&i.push(o);return r&&n!==r&&r!==u&&i.push(r),i}(e,g(),t,n)},normalize:function(){var t=g(),n=m();if(1<of(n).length||!df(r))return t;var o=Pf(e,t);return o.each(function(e){p(e,h())}),o.getOr(t)},selectorChanged:function(e,t){return l(e,t),v},selectorChangedWithUnbind:l,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){var n;((n=r).inline?od:ud)(n,e,t)},placeCaretAt:function(e,t){return p(Tf(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=g();return e.collapsed?hc.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=o=i=null,y.destroy()}},b=yf(v),y=Of(v,r);return v.bookmarkManager=b,v.controlSelection=y,v},uh=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},ah=function(e,t){var n;try{n=atob(t)}catch(rS){return k.none()}for(var r=new Uint8Array(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);return k.some(new Blob([r],{type:e}))},ch=function(e){return 0===e.indexOf("blob:")?(t=e,new Er(function(e,r){var o=function(){r("Cannot convert "+t+" to Blob. Resource might not exist or is inaccessible.")};try{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onload=function(){200===i.status?e(i.response):o()},i.onerror=o,i.send()}catch(n){o()}})):0===e.indexOf("data:")?(n=e,new Er(function(e){var t=uh(n);ah(t.type,t.data).fold(function(){return e(new Blob([]))},e)})):null;var t,n},sh=0,lh=function(e){return(e||"blobid")+sh++},fh=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new zd("br",1)).shortEnded=!0:r.empty().append(new zd("#text",3)).value=eo},dh=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},mh=function(e,t,n,r){return r.isEmpty(t,n,function(t){return(n=e.getElementRule(t.name))&&n.paddEmpty;var n})},gh=kt.makeMap,ph=kt.each,hh=kt.explode,vh=kt.extend,bh=function(e,t){void 0===t&&(t=ui());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var u,a=function(e){var t,u,a=e.name;a in n&&((u=o[a])?u.push(e):o[a]=[e]),t=r.length;for(;t--;)(a=r[t].name)in e.attributes.map&&((u=i[a])?u.push(e):i[a]=[e]);return e},c={schema:t,addAttributeFilter:function(e,t){ph(hh(e),function(e){for(var n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})})},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){ph(hh(e),function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)})},getNodeFilters:function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:a,parse:function(u,c){var s,l,f,d,m,g,p,h,v=[];c=c||{},o={},i={};var b,y=vh(gh("script,style,head,html,body,title,meta,param"),t.getBlockElements()),x=t.getNonEmptyElements(),w=t.children,C=e.validate,S=!1===(b="forced_root_block"in c?c.forced_root_block:e.forced_root_block)?"":!0===b?"p":b,k=t.getWhiteSpaceElements(),O=/^[ \t\r\n]+/,_=/[ \t\r\n]+$/,T=/[ \t\r\n]+/g,E=/^[ \t\r\n]+$/,A=k.hasOwnProperty(c.context)||k.hasOwnProperty(e.root_name),R=function(e,t){var r,i=new zd(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},N=function(e){for(var n,r,o,i=t.getBlockElements(),u=e.prev;u&&3===u.type;){if(0<(r=u.value.replace(_,"")).length)return void(u.value=r);if(n=u.next){if(3===n.type&&n.value.length){u=u.prev;continue}if(!i[n.name]&&"script"!==n.name&&"style"!==n.name){u=u.prev;continue}}o=u.prev,u.remove(),u=o}},B=qd({validate:C,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(t.getSelfClosingElements()),cdata:function(e){h.append(R("#cdata",4)).value=e},text:function(e,t){var n,r;A||(e=e.replace(T," "),(r=h.lastChild)&&(y[r.name]||"br"===r.name)&&(e=e.replace(O,""))),0!==e.length&&((n=R("#text",3)).raw=!!t,h.append(n).value=e)},comment:function(e){h.append(R("#comment",8)).value=e},pi:function(e,t){h.append(R(e,7)).value=t,N(h)},doctype:function(e){h.append(R("#doctype",10)).value=e,N(h)},start:function(e,n,o){var u,a,c,s,l=C?t.getElementRule(e):{};if(l){for((u=R(l.outputName||e,1)).attributes=n,u.shortEnded=o,h.append(u),(s=w[h.name])&&w[u.name]&&!s[u.name]&&v.push(u),a=r.length;a--;)(c=r[a].name)in n.map&&((g=i[c])?g.push(u):i[c]=[u]);y[e]&&N(u),o||(h=u),!A&&k[e]&&(A=!0)}},end:function(n){var r,o,i,u,a,s=C?t.getElementRule(n):{};if(s){if(y[n]&&!A){if((r=h.firstChild)&&3===r.type)if(0<(o=r.value.replace(O,"")).length)r.value=o,r=r.next;else for(i=r.next,r.remove(),r=i;r&&3===r.type;)i=r.next,0!==(o=r.value).length&&!E.test(o)||(r.remove(),r=i),r=i;if((r=h.lastChild)&&3===r.type)if(0<(o=r.value.replace(_,"")).length)r.value=o,r=r.prev;else for(i=r.prev,r.remove(),r=i;r&&3===r.type;)i=r.prev,0!==(o=r.value).length&&!E.test(o)||(r.remove(),r=i),r=i}if(A&&k[n]&&(A=!1),s.removeEmpty&&mh(t,x,k,h))return u=h.parent,y[h.name]?h.empty().remove():h.unwrap(),void(h=u);s.paddEmpty&&(dh(a=h,"#text")&&a.firstChild.value===eo||mh(t,x,k,h))&&fh(e,c,y,h),h=h.parent}}},t),D=h=new zd(c.context||e.root_name,11);if(B.parse(u,c.format),C&&v.length&&(c.context?c.invalid=!0:function(e){for(var n,r,o,i,u,c,s,l,f,d,m=gh("tr,td,th,tbody,thead,tfoot,table"),g=t.getNonEmptyElements(),p=t.getWhiteSpaceElements(),h=t.getTextBlockElements(),v=t.getSpecialElements(),b=0;b<e.length;b++)if((n=e[b]).parent&&!n.fixed)if(h[n.name]&&"li"===n.parent.name){for(f=n.next;f&&h[f.name];)f.name="li",f.fixed=!0,n.parent.insert(f,n.parent),f=f.next;n.unwrap(n)}else{for(o=[n],r=n.parent;r&&!t.isValidChild(r.name,n.name)&&!m[r.name];r=r.parent)o.push(r);if(r&&1<o.length){for(o.reverse(),i=u=a(o[0].clone()),l=0;l<o.length-1;l++){for(t.isValidChild(u.name,o[l].name)?(c=a(o[l].clone()),u.append(c)):c=u,s=o[l].firstChild;s&&s!==o[l+1];)d=s.next,c.append(s),s=d;u=c}mh(t,g,p,i)?r.insert(n,o[0],!0):(r.insert(i,o[0],!0),r.insert(n,i)),(mh(t,g,p,r=o[0])||dh(r,"br"))&&r.empty().remove()}else if(n.parent){if("li"===n.name){if((f=n.prev)&&("ul"===f.name||"ol"===f.name)){f.append(n);continue}if((f=n.next)&&("ul"===f.name||"ol"===f.name)){f.insert(n,f.firstChild,!0);continue}n.wrap(a(new zd("ul",1)));continue}t.isValidChild(n.parent.name,"div")&&t.isValidChild("div",n.name)?n.wrap(a(new zd("div",1))):v[n.name]?n.empty().remove():n.unwrap()}}}(v)),S&&("body"===D.name||c.isRootContent)&&function(){var n,r,o=D.firstChild,i=function(e){e&&((o=e.firstChild)&&3===o.type&&(o.value=o.value.replace(O,"")),(o=e.lastChild)&&3===o.type&&(o.value=o.value.replace(_,"")))};if(t.isValidChild(D.name,S.toLowerCase())){for(;o;)n=o.next,3===o.type||1===o.type&&"p"!==o.name&&!y[o.name]&&!o.attr("data-mce-type")?(r||((r=R(S,1)).attr(e.forced_root_block_attrs),D.insert(r,o)),r.append(o)):(i(r),r=null),o=n;i(r)}}(),!c.invalid){for(p in o)if(o.hasOwnProperty(p)){for(g=n[p],d=(s=o[p]).length;d--;)s[d].parent||s.splice(d,1);for(l=0,f=g.length;l<f;l++)g[l](s,p,c)}for(l=0,f=r.length;l<f;l++)if((g=r[l]).name in i){for(d=(s=i[g.name]).length;d--;)s[d].parent||s.splice(d,1);for(d=0,m=g.callbacks.length;d<m;d++)g.callbacks[d](s,g.name,c)}}return D}};return function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",function(e,r,o){var i,u,a,c,s,l,f,d,m=e.length,g=kt.extend({},n.getBlockElements()),p=n.getNonEmptyElements(),h=n.getWhiteSpaceElements();for(g.body=1,i=0;i<m;i++)if(a=(u=e[i]).parent,g[u.parent.name]&&u===a.lastChild){for(s=u.prev;s;){if("span"!==(l=s.name)||"bookmark"!==s.attr("data-mce-type")){"br"===l&&(u=null);break}s=s.prev}u&&(u.remove(),mh(n,p,h,a)&&(f=n.getElementRule(a.name))&&(f.removeEmpty?a.remove():f.paddEmpty&&fh(t,o,g,a)))}else{for(c=u;a&&a.firstChild===c&&a.lastChild===c&&!g[(c=a).name];)a=a.parent;c===a&&!0!==t.padd_empty_with_br&&((d=new zd("#text",3)).value=eo,u.replace(d))}}),e.addAttributeFilter("href",function(e){var n,r,o=e.length;if(!t.allow_unsafe_link_target)for(;o--;){var i=e[o];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",(r=(n=i.attr("rel"))?kt.trim(n):"",/\b(noopener)\b/g.test(r)?r:r.split(" ").filter(function(e){return 0<e.length}).concat(["noopener"]).sort().join(" ")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href"))for(r=o.parent,t=o.lastChild;n=t.prev,r.insert(t,o),t=n;);}),t.fix_list_elements&&e.addNodeFilter("ul,ol",function(e){for(var t,n,r,o=e.length;o--;)"ul"!==(r=(n=e[o]).parent).name&&"ol"!==r.name||(n.prev&&"li"===n.prev.name?n.prev.append(n):((t=new zd("li",1)).attr("style","list-style-type: none"),n.wrap(t)))}),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",function(e){for(var t,r,o,i,u,a,c,s=e.length,l=n.getValidClasses();s--;){for(r=(t=e[s]).attr("class").split(" "),u="",o=0;o<r.length;o++)i=r[o],c=!1,(a=l["*"])&&a[i]&&(c=!0),a=l[t.name],!c&&a&&a[i]&&(c=!0),c&&(u&&(u+=" "),u+=i);u.length||(u=null),t.attr("class",u)}}),function(e,t){var n=t.blob_cache,r=function(e){var r,o,i=e.attr("src");(r=e).attr("src")===yt.transparentSrc||r.attr("data-mce-placeholder")||e.attr("data-mce-bogus")||((o=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(i))?k.some({type:o[1],data:decodeURIComponent(o[2])}):k.none()).filter(function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),ce(e.attributes.map,function(e,t){n.setAttribute(t,e)}),t.images_dataimg_filter(n)}return!0}(e,t)}).bind(function(e){var t=e.type,r=e.data;return k.from(n.getByData(r,t)).orThunk(function(){return ah(t,r).map(function(e){var t=n.create(lh(),e,r);return n.add(t),t})})}).each(function(t){e.attr("src",t.blobUri())})};n&&e.addAttributeFilter("src",function(e){return q(e,r)})}(e,t)}(c,e),(u=e).inline_styles&&function(e,t){var n,r=ci();t.convert_fonts_to_spans&&function(e,t,n){e.addNodeFilter("font",function(e){q(e,function(e){var r,o=t.parse(e.attr("style")),i=e.attr("color"),u=e.attr("face"),a=e.attr("size");i&&(o.color=i),u&&(o["font-family"]=u),a&&(o["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(o)),r=e,q(["color","face","size"],function(e){r.attr(e,null)})})})}(e,r,kt.explode(t.font_size_legacy_values)),n=r,e.addNodeFilter("strike",function(e){q(e,function(e){var t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))})})}(c,u),c},yh=function(e,t,n){-1===kt.inArray(t,n)&&(e.addAttributeFilter(n,function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),t.push(n))},xh=function(e,t){var n=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:ca.DOM,o=t&&t.schema?t.schema:ui(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i,u,a,c=bh(e,o);return u=e,a=r,(i=c).addAttributeFilter("data-mce-tabindex",function(e,t){for(var n,r=e.length;r--;)(n=e[r]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)}),i.addAttributeFilter("src,href,style",function(e,t){for(var n,r,o=e.length,i="data-mce-"+t,c=u.url_converter,s=u.url_converter_scope;o--;)void 0!==(r=(n=e[o]).attr(i))?(n.attr(t,0<r.length?r:null),n.attr(i,null)):(r=n.attr(t),"style"===t?r=a.serializeStyle(a.parseStyle(r),n.name):c&&(r=c.call(s,r,t,n.name)),n.attr(t,0<r.length?r:null))}),i.addAttributeFilter("class",function(e){for(var t,n,r=e.length;r--;)(n=(t=e[r]).attr("class"))&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",0<n.length?n:null))}),i.addAttributeFilter("data-mce-type",function(e,t,n){for(var r,o=e.length;o--;)"bookmark"!==(r=e[o]).attr("data-mce-type")||n.cleanup||(k.from(r.firstChild).exists(function(e){return!no(e.value)})?r.unwrap():r.remove())}),i.addNodeFilter("noscript",function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=Yo.decode(t.value))}),i.addNodeFilter("script,style",function(e,t){for(var n,r,o,i=e.length,a=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};i--;)r=(n=e[i]).firstChild?n.firstChild.value:"","script"===t?((o=n.attr("type"))&&n.attr("type","mce-no/type"===o?null:o.replace(/^mce\-/,"")),"xhtml"===u.element_format&&0<r.length&&(n.firstChild.value="// <![CDATA[\n"+a(r)+"\n// ]]>")):"xhtml"===u.element_format&&0<r.length&&(n.firstChild.value="\x3c!--\n"+a(r)+"\n--\x3e")}),i.addNodeFilter("#comment",function(e){for(var t,n=e.length;n--;)t=e[n],u.preserve_cdata&&0===t.value.indexOf("[CDATA[")?(t.name="#cdata",t.type=4,t.value=a.decode(t.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===t.value.indexOf("mce:protected ")&&(t.name="#text",t.type=3,t.raw=!0,t.value=unescape(t.value).substr(14))}),i.addNodeFilter("xml:namespace,input",function(e,t){for(var n,r=e.length;r--;)7===(n=e[r]).type?n.remove():1===n.type&&("input"!==t||n.attr("type")||n.attr("type","text"))}),i.addAttributeFilter("data-mce-type",function(e){q(e,function(e){"format-caret"===e.attr("data-mce-type")&&(e.isEmpty(i.schema.getNonEmptyElements())?e.remove():e.unwrap())})}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),{schema:o,addNodeFilter:c.addNodeFilter,addAttributeFilter:c.addAttributeFilter,serialize:function(n,i){void 0===i&&(i={});var u,a,s,l,f,d,m,g,p,h,v,b=_e({format:"html"},i),y=function(e,t,n){return o=n,(r=e)&&r.hasEventListeners("PreProcess")&&!o.no_events?function(e,t,n){var r,o,i=e.dom;t=t.cloneNode(!0);var u,a,c=document.implementation;return c.createHTMLDocument&&(r=c.createHTMLDocument(""),kt.each("BODY"===t.nodeName?t.childNodes:[t],function(e){r.body.appendChild(r.importNode(e,!0))}),t="BODY"!==t.nodeName?r.body.firstChild:r.body,o=i.doc,i.doc=r),u=e,a=_e(_e({},n),{node:t}),u.fire("PreProcess",a),o&&(i.doc=o),t}(e,t,n):t;var r,o}(t,n,b),x=(u=y,s=ro((a=b).getInner?u.innerHTML:r.getOuterHTML(u)),a.selection||Zr(At(u))?s:kt.trim(s)),w=(l=c,f=x,h=(d=b).selection?_e({forced_root_block:!1},d):d,!(g=function(e){return e&&"br"===e.name})(p=(v=l.parse(f,h)).lastChild)||g(m=p.prev)&&(p.remove(),m.remove()),v);return"tree"===b.format?w:function(e,t,n,r,o){var i,u,a,c,s,l;return u=e,i=r,c=Zd(t,n).serialize(i),(a=o).no_events||!u?c:(s=u,l=_e(_e({},a),{content:c}),s.fire("PostProcess",l).content)}(t,e,o,w,b)},addRules:function(e){o.addValidElements(e)},setRules:function(e){o.setValidElements(e)},addTempAttr:f(yh,c,n),getTempAttrs:s(n),getNodeFilters:c.getNodeFilters,getAttributeFilters:c.getAttributeFilters}}(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},wh=function(e,t,n){return void 0===n&&(n={}),r=t,o=n,Qp(e).editor.setContent(r,o);var r,o},Ch=ca.DOM,Sh=function(e){return k.from(e).each(function(e){return e.destroy()})},kh=Object.prototype.hasOwnProperty,Oh=(Zg=function(e,t){return A(e)&&A(t)?Oh(e,t):t},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)kh.call(o,i)&&(n[i]=Zg(n[i],o[i]))}return n}),_h=lt().deviceType,Th=_h.isTouch(),Eh=_h.isPhone(),Ah=_h.isTablet(),Rh=["lists","autolink","autosave"],Nh={table_grid:!1,object_resizing:!1,resize:!1},Bh=function(e){var t=R(e)?e.join(" "):e,n=W(E(t)?t.split(" "):[],Ve);return $(n,function(e){return 0<e.length})},Dh=function(e,t){return e.sections().hasOwnProperty(t)},Ph=function(e,t){return pe(e,"toolbar_mode").orThunk(function(){return pe(e,"toolbar_drawer").map(function(e){return!1===e?"wrap":e})}).getOr(t)},Mh=function(e,t,n){return k.from(t.settings[n]).filter(e)},Ih=(ep={},{add:function(e,t){ep[e]=t},get:function(e){return ep[e]?ep[e]:{icons:{}}},has:function(e){return he(ep,e)}}),Lh=function(e,t){return t.dom[e]},Fh=function(e,t){return parseInt(Yn(t,e),10)},zh=f(Lh,"clientWidth"),Hh=f(Lh,"clientHeight"),Vh=f(Fh,"margin-top"),jh=f(Fh,"margin-left"),Uh=function(e,t,n){var r,o,i,u,a,c,s,l,f,d,m=At(e.getBody()),g=e.inline?m:At(Ut(m).dom.documentElement),p=(r=e.inline,i=t,u=n,a=(o=g).dom.getBoundingClientRect(),{x:i-(r?a.left+o.dom.clientLeft+jh(o):0),y:u-(r?a.top+o.dom.clientTop+Vh(o):0)});return s=p.x,l=p.y,f=zh(c=g),d=Hh(c),0<=s&&0<=l&&s<=f&&l<=d},Wh=function(e){var t,n=[],r=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},o=function(){return k.from(n[0])},i=function(){0<n.length&&r().reposition(n)},u=function(e){J(n,function(t){return t===e}).each(function(e){n.splice(e,1)})},a=function(t,a){if(void 0===a&&(a=!0),!e.removed&&function(e){var t=e.inline?e.getBody():e.getContentAreaContainer();return k.from(t).map(At).map(gn).getOr(!1)}(e))return a&&e.fire("BeforeOpenNotification",{notification:t}),Y(n,function(e){return!((n=r().getArgs(e)).type!==(o=t).type||n.text!==o.text||n.progressBar||n.timeout||o.progressBar||o.timeout);var n,o}).getOrThunk(function(){e.editorManager.setActive(e);var a=r().open(t,function(){u(a),i(),o().fold(function(){return e.focus()},function(e){return At(e.getEl()).dom.focus()})});return n.push(a),i(),e.fire("OpenNotification",_e({},a)),a})};return(t=e).on("SkinLoaded",function(){var e=t.getParam("service_message");e&&a({text:e,type:"warning",timeout:0},!1)}),t.on("ResizeEditor ResizeWindow NodeChange",function(){Fr.requestAnimationFrame(i)}),t.on("remove",function(){q(n.slice(),function(e){r().close(e)})}),{open:a,close:function(){o().each(function(e){r().close(e),u(e),i()})},getNotifications:function(){return n}}},qh=ya.PluginManager,Gh=ya.ThemeManager,$h=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t?t.apply(e,n):void 0}},o=function(n){e.fire("CloseWindow",{dialog:n}),0===(t=$(t,function(e){return e!==n})).length&&e.focus()},i=function(n){e.editorManager.setActive(e),yd(e);var r=n();return function(n){t.push(n),e.fire("OpenWindow",{dialog:n})}(r),r};return e.on("remove",function(){q(t,function(e){n().close(e)})}),{open:function(e,t){return i(function(){return n().open(e,t,o)})},openUrl:function(e){return i(function(){return n().openUrl(e,o)})},alert:function(e,t,o){var i=n();i.alert(e,r(o||i,t))},confirm:function(e,t,o){var i=n();i.confirm(e,r(o||i,t))},close:function(){k.from(t[t.length-1]).each(function(e){n().close(e),o(e)})}}},Xh=function(e,t){e.notificationManager.open({type:"error",text:t})},Kh=function(e,t){e._skinLoaded?Xh(e,t):e.on("SkinLoaded",function(){Xh(e,t)})},Yh=function(e,t,n){Cf(e,t,{message:n}),console.error(n)},Jh=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},Qh=function(e,t,n){Yh(e,"PluginLoadError",Jh("plugin",t,n))},Zh=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,Te([e],t)):r.log.apply(r,Te([e],t)))},ev=function(e,t){var n=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",o=!0===e.inline;return W(t,function(t){return/^[a-z0-9\-]+$/i.test(t)&&!o?n+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)})},tv=function(){var e={},t=function(e,t){return{status:e,resultUri:t}},n=function(t){return t in e};return{hasBlobUri:n,getResultUri:function(t){var n=e[t];return n?n.resultUri:null},isPending:function(t){return!!n(t)&&1===e[t].status},isUploaded:function(t){return!!n(t)&&2===e[t].status},markPending:function(n){e[n]=t(1,null)},markUploaded:function(n,r){e[n]=t(2,r)},removeFailed:function(t){delete e[t]},destroy:function(){e={}}}},nv=0,rv=function(e){return e+nv+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},ov=function(e){return function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}},iv=function(e,t){return function(e,t){var n={},r=function(e,n,r,o){var i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){var e,o,u;i.status<200||300<=i.status?r("HTTP Error: "+i.status):(e=JSON.parse(i.responseText))&&"string"==typeof e.location?n((u=e.location,(o=t.basePath)?o.replace(/\/$/,"")+"/"+u.replace(/^\//,""):u)):r("Invalid JSON: "+i.responseText)};var u=new FormData;u.append("file",e.blob(),e.filename()),i.send(u)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},u=function(e,t){kt.each(n[e],function(e){e(t)}),delete n[e]};return!1===I(t.handler)&&(t.handler=r),{upload:function(a,c){return t.url||t.handler!==r?function(r,a){return r=kt.grep(r,function(t){return!e.isUploaded(t.blobUri())}),Er.all(kt.map(r,function(r){return e.isPending(r.blobUri())?(f=r.blobUri(),new Er(function(e){n[f]=n[f]||[],n[f].push(e)})):(s=t.handler,l=a,e.markPending((c=r).blobUri()),new Er(function(t){var n;try{var a=function(){n&&n.close()};s(c,function(n){a(),e.markUploaded(c.blobUri(),n),u(c.blobUri(),o(c,n)),t(o(c,n))},function(n,r){var o=r||{};a(),e.removeFailed(c.blobUri()),u(c.blobUri(),i(c,n,o)),t(i(c,n,o))},function(e){e<0||100<e||k.from(n).orThunk(function(){return k.from(l).map(v)}).each(function(t){(n=t).progressBar.value(e)})})}catch(r){t(i(c,r.message,{}))}}));var c,s,l,f}))}(a,c):new Er(function(e){e([])})}}}(t,{url:e.getParam("images_upload_url","","string"),basePath:e.getParam("images_upload_base_path","","string"),credentials:e.getParam("images_upload_credentials",!1,"boolean"),handler:e.getParam("images_upload_handler",null,"function")})},uv=kt.each,av=ca.DOM,cv=function(e,t){var n,r,o,i=t&&t.schema||ui({}),u=function(e){var t,n,o=av.create((r="string"==typeof e?{name:e,classes:[],attrs:{}}:e).name);return t=o,(n=r).classes.length&&av.addClass(t,n.classes.join(" ")),av.setAttribs(t,n.attrs),o},a=function(e,t,n){var r,o,c,s,l,f,d,m=0<t.length&&t[0],g=m&&m.name,p=(s=g,l="string"!=typeof(c=e)?c.nodeName.toLowerCase():c,!(!(d=(f=i.getElementRule(l))&&f.parentsRequired)||!d.length)&&(s&&-1!==kt.inArray(d,s)?s:d[0]));if(p)g===p?(o=t[0],t=t.slice(1)):o=p;else if(m)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=u(o)).appendChild(e),n&&(r||(r=av.create("div")).appendChild(e),kt.each(n,function(t){var n=u(t);r.insertBefore(n,e)})),a(r,t,o&&o.siblings)};return e&&e.length?(n=u(r=e[0]),(o=av.create("div")).appendChild(a(n,e.slice(1),r.siblings)),o):""},sv=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=kt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==kt.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}var u;return"["!==o||(u=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/))&&(n.attrs[u[1]]=u[2]),""})),n.name=t||"div",n},lv=function(e,t){var n,r,o,i="",u=(o=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),E(o)?o:"");if(""===u)return"";var a=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var c=pe(t,"preview");if(c.is(!1))return"";u=c.getOr(u)}n=t.block||t.inline||"span";var s,l=(s=t.selector)&&"string"==typeof s?(s=(s=s.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),kt.map(s.split(/(?:>|\s+(?![^\[\]]+\]))/),function(e){var t=kt.map(e.split(/(?:~\+|~|\+)/),sv),n=t.pop();return t.length&&(n.siblings=t),n}).reverse()):[],f=l.length?(l[0].name||(l[0].name=n),n=t.selector,cv(l,e)):cv([n],e),d=av.select(n,f)[0]||f.firstChild;return uv(t.styles,function(e,t){var n=a(e);n&&av.setStyle(d,t,n)}),uv(t.attributes,function(e,t){var n=a(e);n&&av.setAttrib(d,t,n)}),uv(t.classes,function(e){var t=a(e);av.hasClass(d,t)||av.addClass(d,t)}),e.fire("PreviewFormats"),av.setStyles(f,{position:"absolute",left:-65535}),e.getBody().appendChild(f),r=av.getStyle(e.getBody(),"fontSize",!0),r=/px$/.test(r)?parseInt(r,10):0,uv(u.split(" "),function(t){var n=av.getStyle(d,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=av.getStyle(e.getBody(),t,!0),"#ffffff"===av.toHex(n).toLowerCase())||"color"===t&&"#000000"===av.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===r)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*r+"px"}"border"===t&&n&&(i+="padding:0 2px;"),i+=t+":"+n+";"}}),e.fire("AfterPreviewFormats"),av.remove(f),i},fv=function(e){var t=function(e){var t,n,r={},o=function(e,t){e&&("string"!=typeof e?kt.each(e,function(e,t){o(t,e)}):(R(t)||(t=[t]),kt.each(t,function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))}),r[e]=t))};return o((t=e.dom,n={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return On(e)&&e.hasAttribute("href")},onformat:function(e,n,r){kt.each(r,function(n,r){t.setAttrib(e,r,n)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},kt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(e){n[e]={block:e,remove:"all"}}),n)),o(e.getParam("formats")),{get:function(e){return e?r[e]:r},has:function(e){return he(r,e)},register:o,unregister:function(e){return e&&r[e]&&delete r[e],r}}}(e),n=ga(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),function(e){e.on("mouseup keydown",function(t){var n,r,o,i;r=t.keyCode,o=(n=e).selection,i=n.getBody(),Gg(n,null,!1),8!==r&&46!==r||!o.isCollapsed()||o.getStart().innerHTML!==Hg||Gg(n,ml(i,o.getStart())),37!==r&&39!==r||Gg(n,ml(i,o.getStart()))})}(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){var o,i,u;o=t,i=n,u=r,Zp(e).formatter.apply(o,i,u)},remove:function(t,n,r,o){var i,u,a,c;i=t,u=n,a=r,c=o,Zp(e).formatter.remove(i,u,a,c)},toggle:function(t,n,r){var o,i,u;o=t,i=n,u=r,Zp(e).formatter.toggle(o,i,u)},match:function(t,n,r){return o=t,i=n,u=r,Zp(e).formatter.match(o,i,u);var o,i,u},closest:function(t){return n=t,Zp(e).formatter.closest(n);var n},matchAll:function(t,n){return r=t,o=n,Zp(e).formatter.matchAll(r,o);var r,o},matchNode:function(t,n,r,o){return i=t,u=n,a=r,c=o,Zp(e).formatter.matchNode(i,u,a,c);var i,u,a,c},canApply:function(t){return n=t,Zp(e).formatter.canApply(n);var n},formatChanged:function(t,r,o){return i=n,u=t,a=r,void 0===(c=o)&&(c=!1),Zp(e).formatter.formatChanged(i,u,a,c);var i,u,a,c},getCssText:f(lv,e)}},dv=function(e){var t,n=ga(k.none()),r=ga(0),o=ga(0),i={data:[],typing:!1,beforeChange:function(){var t,o;t=r,o=n,Zp(e).undoManager.beforeChange(t,o)},add:function(t,u){return a=i,c=o,s=r,l=n,f=t,d=u,Zp(e).undoManager.addUndoLevel(a,c,s,l,f,d);var a,c,s,l,f,d},undo:function(){return t=i,n=r,u=o,Zp(e).undoManager.undo(t,n,u);var t,n,u},redo:function(){return t=o,n=i.data,Zp(e).undoManager.redo(t,n);var t,n},clear:function(){var t,n;t=i,n=o,Zp(e).undoManager.clear(t,n)},reset:function(){var t;t=i,Zp(e).undoManager.reset(t)},hasUndo:function(){return t=i,n=o,Zp(e).undoManager.hasUndo(t,n);var t,n},hasRedo:function(){return t=i,n=o,Zp(e).undoManager.hasRedo(t,n);var t,n},transact:function(t){return n=i,o=r,u=t,Zp(e).undoManager.transact(n,o,u);var n,o,u},ignore:function(t){var n,o;n=r,o=t,Zp(e).undoManager.ignore(n,o)},extra:function(t,n){var r,u,a,c;r=i,u=o,a=t,c=n,Zp(e).undoManager.extra(r,u,a,c)}};return Jp(e)||function(e,t,n){var r=ga(!1),o=function(e){Xp(t,!1,n),t.add({},e)};e.on("init",function(){t.add()}),e.on("BeforeExecCommand",function(e){var r=e.command.toLowerCase();"undo"!==r&&"redo"!==r&&"mcerepaint"!==r&&(Kp(t,n),t.beforeChange())}),e.on("ExecCommand",function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&o(e)}),e.on("ObjectResizeStart cut",function(){t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",function(n){var i=n.keyCode;n.isDefaultPrevented()||((33<=i&&i<=36||37<=i&&i<=40||45===i||n.ctrlKey)&&(o(),e.nodeChanged()),46!==i&&8!==i||e.nodeChanged(),r.get()&&t.typing&&!1===Gp(jp(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))}),e.on("keydown",function(e){var i=e.keyCode;e.isDefaultPrevented()||(33<=i&&i<=36||37<=i&&i<=40||45===i?t.typing&&o(e):!(i<16||20<i)||224===i||91===i||t.typing||e.ctrlKey&&!e.altKey||e.metaKey||(t.beforeChange(),Xp(t,!0,n),t.add({},e),r.set(!0)))}),e.on("mousedown",function(e){t.typing&&o(e)}),e.on("input",function(e){var t,n;e.inputType&&("insertReplacementText"===e.inputType||"insertText"===(n=e).inputType&&null===n.data||"insertFromPaste"===(t=e).inputType||"insertFromDrop"===t.inputType)&&o(e)}),e.on("AddUndo Undo Redo ClearUndos",function(t){t.isDefaultPrevented()||e.nodeChanged()})}(e,i,r),(t=e).addShortcut("meta+z","","Undo"),t.addShortcut("meta+y,meta+shift+z","","Redo"),i},mv=[9,27,Sf.HOME,Sf.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Sf.DOWN,Sf.UP,Sf.LEFT,Sf.RIGHT].concat(yt.browser.isFirefox()?[224]:[]),gv="data-mce-placeholder",pv=function(e){return"keydown"===e.type||"keyup"===e.type},hv=function(e){var t=e.keyCode;return t===Sf.BACKSPACE||t===Sf.DELETE},vv=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,bv=function(e,t){return Nt(At(t),e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string"))},yv=function(e,t,n){var r,o,i=(r=e,o=t,$(ca.DOM.getParents(n.container(),"*",o),r));return k.from(i[i.length-1])},xv=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?ao(n)?Dn(n.nextSibling)?hc(n.nextSibling,0):hc.after(n):lo(t)?hc(n,r+1):t:ao(n)?Dn(n.previousSibling)?hc(n.previousSibling,n.previousSibling.data.length):hc.before(n):fo(t)?hc(n,r-1):t},wv=f(xv,!0),Cv=f(xv,!1),Sv=function(e,t){return Pt(e,t)?kr(t,function(e){return Xr(e)||Yr(e)},(n=e,function(e){return Dt(n,At(e.dom.parentNode))})):k.none();var n},kv=function(e){var t,n,r;e.dom.isEmpty(e.getBody())&&(e.setContent(""),r=(n=(t=e).getBody()).firstChild&&t.dom.isBlock(n.firstChild)?n.firstChild:n,t.selection.setCursorLocation(r,0))},Ov=function(e,t){return{from:e,to:t}},_v=function(e,t){var n=At(e),r=At(t.container());return Sv(n,r).map(function(e){return{block:e,position:t}})},Tv=function(e){var t,n=(t=Kt(e),J(t,qr).fold(function(){return t},function(e){return t.slice(0,e)}));return q(n,dn),n},Ev=function(e,t){var n=bm(t,e);return Y(n.reverse(),function(e){return Do(e)}).each(dn)},Av=function(e,t,n,r){if(Do(n))return pm(n),sl(n.dom);0===$($t(r),function(e){return!Do(e)}).length&&Do(t)&&un(r,Tt("br"));var o=cl(n.dom,hc.before(r.dom));return q(Tv(t),function(e){un(r,e)}),Ev(e,t),o},Rv=function(e,t,n){if(Do(n))return dn(n),Do(t)&&pm(t),sl(t.dom);var r=ll(n.dom);return q(Tv(t),function(e){sn(n,e)}),Ev(e,t),r},Nv=function(e,t){ul(e,t.dom).map(function(e){return e.getNode()}).map(At).filter($r).each(dn)},Bv=function(e,t,n){return Nv(!0,t),Nv(!1,n),function(e,t){return Pt(t,e)?(n=bm(e,t),k.from(n[n.length-1])):k.none();var n}(t,n).fold(f(Rv,e,t,n),f(Av,e,t,n))},Dv=function(e,t,n,r){return t?Bv(e,r,n):Bv(e,n,r)},Pv=function(e,t){var n,r,o,i=At(e.getBody()),u=(n=i.dom,r=t,((o=e.selection.getRng()).collapsed?function(e,t,n){var r=_v(e,hc.fromRangeStart(n)),o=r.bind(function(n){return rl(t,e,n.position).bind(function(n){return _v(e,n).map(function(n){return r=e,o=t,Ln((i=n).position.getNode())&&!1===Do(i.block)?ul(!1,i.block.dom).bind(function(e){return e.isEqual(i.position)?rl(o,r,e).bind(function(e){return _v(r,e)}):k.some(i)}).getOr(i):i;var r,o,i})})});return Va(r,o,Ov).filter(function(e){return!1===Dt((r=e).from.block,r.to.block)&&Wt((n=e).from.block).bind(function(e){return Wt(n.to.block).filter(function(t){return Dt(e,t)})}).isSome()&&!1===Hn((t=e).from.block.dom)&&!1===Hn(t.to.block.dom);var t,n,r})}(n,r,o):k.none()).bind(function(e){return Dv(i,t,e.from.block,e.to.block)}));return u.each(function(t){e.selection.setRng(t.toRange())}),u.isSome()},Mv=function(e,t){var n=At(t),r=f(Dt,e);return Sr(n,Qr,r).isSome()},Iv=function(e,t){return!e.selection.isCollapsed()&&function(e){var t,n,r,o,i=At(e.getBody());return function(e,t){var n,r,o=cl(e.dom,hc.fromRangeStart(t)).isNone(),i=al(e.dom,hc.fromRangeEnd(t)).isNone();return!(Mv(n=e,(r=t).startContainer)||Mv(n,r.endContainer))&&o&&i}(i,e.selection.getRng())?((o=e).setContent(""),o.selection.setCursorLocation(),!0):(t=i,r=(n=e.selection).getRng(),Va(Sv(t,At(r.startContainer)),Sv(t,At(r.endContainer)),function(e,o){return!1===Dt(e,o)&&(r.deleteContents(),Dv(t,!0,e,o).each(function(e){n.setRng(e.toRange())}),!0)}).getOr(!1))}(e)},Lv=zn,Fv=Hn,zv=function(e,t,n,r,o){return k.from(t._selectionOverrides.showCaret(e,n,r,o))},Hv=function(e,t){var n,r;return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?k.none():k.some(((r=(n=t).ownerDocument.createRange()).selectNode(n),r))},Vv=function(e,t,n){var r=Ms(1,e.getBody(),t),o=hc.fromRangeStart(r),i=o.getNode();if(vs(i))return zv(1,e,i,!o.isAtEnd(),!1);var u=o.getNode(!0);if(vs(u))return zv(1,e,u,!1,!1);var a=e.dom.getParent(o.getNode(),function(e){return Fv(e)||Lv(e)});return vs(a)?zv(1,e,a,!1,n):k.none()},jv=function(e,t,n){return t.collapsed?Vv(e,t,n).getOr(t):t},Uv=function(e){return mm(e)||sm(e)},Wv=function(e){return gm(e)||lm(e)},qv=function(e,t,n,r,o,i){var u,a;return zv(r,e,i.getNode(!o),o,!0).each(function(n){var r;t.collapsed?(r=t.cloneRange(),o?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()):t.deleteContents(),e.selection.setRng(n)}),u=e.dom,Dn(a=n)&&0===a.data.length&&u.remove(a),!0},Gv=function(e,t){var n=e.selection.getRng();if(!Dn(n.commonAncestorContainer))return!1;var r=t?vc.Forwards:vc.Backwards,o=Zs(e.getBody()),i=f(zs,t?o.next:o.prev),u=t?Uv:Wv,a=Ls(r,e.getBody(),n),c=xv(t,i(a));if(!c||!Hs(a,c))return!1;if(u(c))return qv(e,n,a.getNode(),r,t,c);var s=i(c);return!!(s&&u(s)&&Hs(c,s))&&qv(e,n,a.getNode(),r,t,s)},$v=gr([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Xv=function(e,t,n){return rl(t,e,n).bind(function(r){return s=r.getNode(),Qr(At(s))||Yr(At(s))?k.none():(o=e,a=r,c=function(e){return Gr(At(e))&&!As(u,a,o)},Is(!(i=t),u=n).fold(function(){return Is(i,a).fold(y,c)},c)?k.none():t&&Hn(r.getNode())||!1===t&&Hn(r.getNode(!0))?function(e,t,n,r){var o=r.getNode(!1===t);return Sv(At(e),At(n.getNode())).map(function(e){return Do(e)?$v.remove(e.dom):$v.moveToElement(o)}).orThunk(function(){return k.some($v.moveToElement(o))})}(e,t,n,r):t&&gm(n)||!1===t&&mm(n)?k.some($v.moveToPosition(r)):k.none());var o,i,u,a,c,s})},Kv=function(e,t){return k.from(xf(e.getBody(),t))},Yv=function(e,t){var n=e.selection.getNode();return Kv(e,n).filter(Hn).fold(function(){return n=e.getBody(),r=t,o=e.selection.getRng(),i=Ms(r?1:-1,n,o),u=hc.fromRangeStart(i),a=At(n),(!1===r&&gm(u)?k.some($v.remove(u.getNode(!0))):r&&mm(u)?k.some($v.remove(u.getNode())):!1===r&&mm(u)&&Rm(a,u)?Nm(a,u).map(function(e){return $v.remove(e.getNode())}):r&&gm(u)&&Am(a,u)?Bm(a,u).map(function(e){return $v.remove(e.getNode())}):function(e,t,n){return u=n.getNode(!1===(i=t)),a=i?"after":"before",On(u)&&u.getAttribute("data-mce-caret")===a?(r=t,o=n.getNode(!1===t),(r&&Hn(o.nextSibling)?k.some($v.moveToElement(o.nextSibling)):!1===r&&Hn(o.previousSibling)?k.some($v.moveToElement(o.previousSibling)):k.none()).fold(function(){return Xv(e,t,n)},k.some)):Xv(e,t,n).bind(function(t){return r=e,o=n,t.fold(function(e){return k.some($v.remove(e))},function(e){return k.some($v.moveToElement(e))},function(e){return As(o,e,r)?k.none():k.some($v.moveToPosition(e))});var r,o});var r,o,i,u,a}(n,r,u)).exists(function(n){return n.fold(function(e){return u._selectionOverrides.hideFakeCaret(),rg(u,a,At(e)),!0},(i=a=t,function(e){var t=i?hc.before(e):hc.after(e);return o.selection.setRng(t.toRange()),!0}),(r=o=u=e,function(e){return r.selection.setRng(e.toRange()),!0}));var r,o,i,u,a});var n,r,o,i,u,a},x)},Jv=function(e,t){var n=e.selection.getNode();return!!Hn(n)&&Kv(e,n.parentNode).filter(Hn).fold(function(){var n;return n=At(e.getBody()),q(Ta(n,".mce-offscreen-selection"),dn),rg(e,t,At(e.selection.getNode())),kv(e),!0},x)},Qv=function(e){var t,n=e.dom,r=e.selection,o=xf(e.getBody(),r.getNode());return zn(o)&&n.isBlock(o)&&n.isEmpty(o)&&(t=n.create("br",{"data-mce-bogus":"1"}),n.setHTML(o,""),o.appendChild(t),r.setRng(hc.before(t).toRange())),!0},Zv=function(e,t){return(e.selection.isCollapsed()?Yv:Jv)(e,t)},eb=function(e,t){return!!e.selection.isCollapsed()&&(r=t,o=hc.fromRangeStart((n=e).selection.getRng()),rl(r,n.getBody(),o).filter(function(e){return(r?am:cm)(e)}).bind(function(e){return k.from(Rs(r?0:-1,e))}).exists(function(e){return n.selection.select(e),!0}));var n,r,o},tb=Dn,nb=function(e){return tb(e)&&e.data[0]===to},rb=function(e){return tb(e)&&e.data[e.data.length-1]===to},ob=function(e){return e.ownerDocument.createTextNode(to)},ib=function(e,t){return(e?function(e){if(tb(e.previousSibling))return rb(e.previousSibling)||e.previousSibling.appendData(to),e.previousSibling;if(tb(e))return nb(e)||e.insertData(0,to),e;var t=ob(e);return e.parentNode.insertBefore(t,e),t}:function(e){if(tb(e.nextSibling))return nb(e.nextSibling)||e.nextSibling.insertData(0,to),e.nextSibling;if(tb(e))return rb(e)||e.appendData(to),e;var t=ob(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t})(t)},ub=f(ib,!0),ab=f(ib,!1),cb=function(e,t){return Dn(e.container())?ib(t,e.container()):ib(t,e.getNode())},sb=function(e,t){var n=t.get();return n&&e.container()===n&&ao(n)},lb=function(e,t){return t.fold(function(t){ls(e.get());var n=ub(t);return e.set(n),k.some(hc(n,n.length-1))},function(t){return sl(t).map(function(t){if(sb(t,e))return hc(e.get(),1);ls(e.get());var n=cb(t,!0);return e.set(n),hc(n,1)})},function(t){return ll(t).map(function(t){if(sb(t,e))return hc(e.get(),e.get().length-1);ls(e.get());var n=cb(t,!1);return e.set(n),hc(n,n.length-1)})},function(t){ls(e.get());var n=ab(t);return e.set(n),k.some(hc(n,1))})},fb=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return k.none()},db=gr([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),mb=function(e,t){return Es(t,e)||e},gb=function(e,t,n){var r=wv(n),o=mb(t,r.container());return yv(e,o,r).fold(function(){return al(o,r).bind(f(yv,e,o)).map(function(e){return db.before(e)})},k.none)},pb=function(e,t){return null===ml(e,t)},hb=function(e,t,n){return yv(e,t,n).filter(f(pb,t))},vb=function(e,t,n){var r=Cv(n);return hb(e,t,r).bind(function(e){return cl(e,r).isNone()?k.some(db.start(e)):k.none()})},bb=function(e,t,n){var r=wv(n);return hb(e,t,r).bind(function(e){return al(e,r).isNone()?k.some(db.end(e)):k.none()})},yb=function(e,t,n){var r=Cv(n),o=mb(t,r.container());return yv(e,o,r).fold(function(){return cl(o,r).bind(f(yv,e,o)).map(function(e){return db.after(e)})},k.none)},xb=function(e){return!1===function(e){return"rtl"===ca.DOM.getStyle(e,"direction",!0)||vv.test(e.textContent)}(Cb(e))},wb=function(e,t,n){return fb([gb,vb,bb,yb],[e,t,n]).filter(xb)},Cb=function(e){return e.fold(l,l,l,l)},Sb=function(e){return e.fold(s("before"),s("start"),s("end"),s("after"))},kb=function(e){return e.fold(db.before,db.before,db.after,db.after)},Ob=function(e){return e.fold(db.start,db.start,db.end,db.end)},_b=function(e,t,n,r,o,i){return Va(yv(t,n,r),yv(t,n,o),function(t,r){return t!==r&&(u=r,a=Es(t,o=n),c=Es(u,o),a&&a===c)?db.after(e?t:r):i;var o,u,a,c}).getOr(i)},Tb=function(e,t){return e.fold(x,function(e){return r=t,!(Sb(n=e)===Sb(r)&&Cb(n)===Cb(r));var n,r})},Eb=function(e,t){return e?t.fold(c(k.some,db.start),k.none,c(k.some,db.after),k.none):t.fold(k.none,c(k.some,db.before),k.none,c(k.some,db.end))},Ab=function(e,t,n,r){var o=xv(e,r),i=wb(t,n,o);return wb(t,n,o).bind(f(Eb,e)).orThunk(function(){return u=t,a=n,c=i,s=xv(o=e,r),rl(o,a,s).map(f(xv,o)).fold(function(){return c.map(kb)},function(e){return wb(u,a,e).map(f(_b,o,u,a,s,e)).filter(f(Tb,c))}).filter(xb);var o,u,a,c,s})},Rb=(f(Ab,!1),f(Ab,!0),function(e,t,n){var r=e?1:-1;return t.setRng(hc(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0}),Nb=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},Bb=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},Db=function(e,t,n){return lb(t,n).map(function(t){return Nb(e,t),n})},Pb=function(e,t,n){return!!es(e)&&(o=t,i=n,u=(r=e).getBody(),a=hc.fromRangeStart(r.selection.getRng()),c=f(bv,r),Ab(i,c,u,a).bind(function(e){return Db(r,o,e)}).isSome());var r,o,i,u,a,c},Mb=function(e,t,n){return!!es(t)&&function(e,t){var n=t.selection.getRng(),r=e?hc.fromRangeEnd(n):hc.fromRangeStart(n);return!!I(t.selection.getSel().modify)&&(e&&lo(r)?Rb(!0,t.selection,r):!(e||!fo(r))&&Rb(!1,t.selection,r))}(e,t)},Ib=f(Mb,!0),Lb=f(Mb,!1),Fb=function(e,t){return function(n){return lb(t,n).exists(function(t){return Nb(e,t),!0})}},zb=function(e,t,n,r){var o=e.getBody(),i=f(bv,e);e.undoManager.ignore(function(){var u,a,c;e.selection.setRng((u=n,a=r,(c=document.createRange()).setStart(u.container(),u.offset()),c.setEnd(a.container(),a.offset()),c)),e.execCommand("Delete"),wb(i,o,hc.fromRangeStart(e.selection.getRng())).map(Ob).map(Fb(e,t))}),e.nodeChanged()},Hb=function(e,t,n){if(e.selection.isCollapsed()&&es(e)){var r=hc.fromRangeStart(e.selection.getRng());return function(e,t,n,r){var o,i,u=(o=e.getBody(),i=r.container(),Es(i,o)||o),a=f(bv,e),c=wb(a,u,r);return c.bind(function(e){return n?e.fold(s(k.some(Ob(e))),k.none,s(k.some(kb(e))),k.none):e.fold(k.none,s(k.some(kb(e))),k.none,s(k.some(Ob(e))))}).map(Fb(e,t)).getOrThunk(function(){var o=ol(n,u,r),i=o.bind(function(e){return wb(a,u,e)});return Va(c,i,function(){return yv(a,u,r).exists(function(t){return!!Va(sl(r=t),ll(r),function(e,t){var n=xv(!0,e),o=xv(!1,t);return al(r,n).forall(function(e){return e.isEqual(o)})}).getOr(!0)&&(rg(e,n,At(t)),!0);var r})}).orThunk(function(){return i.bind(function(i){return o.map(function(o){return n?zb(e,t,r,o):zb(e,t,o,r),!0})})}).getOr(!1)})}(e,t,n,r)}return!1},Vb=function(e){return 1===Kt(e).length},jb=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n,r=At(e.getBody()),o=At(e.selection.getStart()),i=$((n=bm(o,r),J(n,qr).fold(s(n),function(e){return n.slice(0,e)})),Vb);return oe(i).exists(function(n){var r,o,u,a,c=hc.fromRangeStart(e.selection.getRng());return o=t,u=c,!(!Va(sl(a=n.dom),ll(a),function(e,t){var n=xv(!0,e),r=xv(!1,t),i=xv(!1,u);return o?al(a,i).exists(function(e){return e.isEqual(r)&&u.isEqual(n)}):cl(a,i).exists(function(e){return e.isEqual(n)&&u.isEqual(r)})}).getOr(!0)||dl((r=n).dom)&&jg(r.dom)||(function(e,t,n,r){var o,i,u,a,c,s=f(Kg,t),l=W($(r,s),function(e){return e.dom});0===l.length?rg(t,e,n):(i=n.dom,u=l,a=Wg(!1),c=Xg(u,a.dom),un(At(i),a),dn(At(i)),o=hc(c,0),t.selection.setRng(o.toRange()))}(t,e,n,i),0))})}(e,t)},Ub=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),rg(e,t,At(n)),!0},Wb=function(e,t){return e.selection.isCollapsed()?(a=(u=t)?sm:lm,c=Ls(u?vc.Forwards:vc.Backwards,(i=e).getBody(),i.selection.getRng()),a(c)?Ub(i,u,c.getNode(!u)):k.from(xv(u,c)).filter(function(e){return a(e)&&Hs(c,e)}).exists(function(e){return Ub(i,u,e.getNode(!u))})):(r=t,o=(n=e).selection.getNode(),!!jn(o)&&Ub(n,r,o));var n,r,o,i,u,a,c},qb=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},Gb=function(e,t){return(e||"table"===Mt(t)?"margin":"padding")+("rtl"===Yn(t,"direction")?"-right":"-left")},$b=function(e){var t,n=Kb(e);return!e.mode.isReadOnly()&&(1<n.length||(t=e,Z(n,function(e){var n=Gb(Kc(t),e),r=Qn(e,n).map(qb).getOr(0);return"false"!==t.dom.getContentEditable(e.dom)&&0<r})))},Xb=function(e){return Kr(e)||Yr(e)},Kb=function(e){return $(W(e.selection.getSelectedBlocks(),At),function(e){return!Xb(e)&&!Wt(e).map(Xb).getOr(!1)&&kr(e,function(e){return zn(e.dom)||Hn(e.dom)}).exists(function(e){return zn(e.dom)})})},Yb=function(e,t){var n=e.dom,r=e.selection,o=e.formatter,i=e.getParam("indentation","40px","string"),u=/[a-z%]+$/i.exec(i)[0],a=parseInt(i,10),c=Kc(e),s=Uc(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==s||n.getParent(r.getNode(),n.isBlock)||o.apply("div"),q(Kb(e),function(e){var r,o,i,s,l,f,d;r=n,o=t,i=a,s=u,d=Gb(c,At(l=e.dom)),"outdent"===o?(f=Math.max(0,qb(l.style[d])-i),r.setStyle(l,d,f?f+s:"")):(f=qb(l.style[d])+i+s,r.setStyle(l,d,f))})},Jb=function(e,t){if(e.selection.isCollapsed()&&$b(e)){var n=e.dom,r=e.selection.getRng(),o=hc.fromRangeStart(r),i=n.getParent(r.startContainer,n.isBlock);if(null!==i&&Sm(At(i),o))return Yb(e,"outdent"),!0}return!1},Qb=function(e,t){e.getDoc().execCommand(t,!1,null)},Zb=function(e){return void 0===e.touches||1!==e.touches.length?k.none():k.some(e.touches[0])},ey=function(e,t){return e.hasOwnProperty(t.nodeName)},ty=function(e){var t,n,r,o=e.dom,i=e.selection,u=e.schema,a=u.getBlockElements(),c=i.getStart(),s=e.getBody(),l=Uc(e);if(c&&On(c)&&l){var f=s.nodeName.toLowerCase();if(u.isValidChild(f,l.toLowerCase())&&(d=a,m=s,!U(vm(At(c),At(m)),function(e){return ey(d,e.dom)}))){var d,m,g,p,h=i.getRng(),v=h.startContainer,b=h.startOffset,y=h.endContainer,x=h.endOffset,w=Ed(e);for(c=s.firstChild;c;)if(g=a,Dn(p=c)||On(p)&&!ey(g,p)&&!wl(p)){if(function(e,t){if(Dn(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||ey(e,t.nextSibling)))return!0}return!1}(a,c)){c=(n=c).nextSibling,o.remove(n);continue}t||(t=o.create(l,Wc(e)),c.parentNode.insertBefore(t,c),r=!0),c=(n=c).nextSibling,t.appendChild(n)}else t=null,c=c.nextSibling;r&&w&&(h.setStart(v,b),h.setEnd(y,x),i.setRng(h),e.nodeChanged())}}},ny=function(e,t){var n;t.hasAttribute("data-mce-caret")&&(po(t),(n=e).selection.setRng(n.selection.getRng()),e.selection.scrollIntoView(t))},ry=function(e,t){var n=_r(At(e.getBody()),"*[data-mce-caret]").fold(s(null),function(e){return e.dom});if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void ny(e,n)):void(so(n)&&(ny(e,n),e.undoManager.add()))};(np=tp=tp||{})[np.Br=0]="Br",np[np.Block=1]="Block",np[np.Wrap=2]="Wrap",np[np.Eol=3]="Eol";var oy,iy,uy=function(e,t){return e===vc.Backwards?ee(t):t},ay=function(e,t,n,r){for(var o,i,u,a,c,s=Zs(n),l=r,f=[];l&&(a=s,c=l,o=t===vc.Forwards?a.next(c):a.prev(c));){if(Ln(o.getNode(!1)))return t===vc.Forwards?{positions:uy(t,f).concat([o]),breakType:tp.Br,breakAt:k.some(o)}:{positions:uy(t,f),breakType:tp.Br,breakAt:k.some(o)};if(o.isVisible()){if(e(l,o)){var d=(i=l,Ln((u=o).getNode(t===vc.Forwards))?tp.Br:!1===As(i,u)?tp.Block:tp.Wrap);return{positions:uy(t,f),breakType:d,breakAt:k.some(o)}}f.push(o),l=o}else l=o}return{positions:uy(t,f),breakType:tp.Eol,breakAt:k.none()}},cy=function(e,t,n,r){return t(n,r).breakAt.map(function(r){var o=t(n,r).positions;return e===vc.Backwards?o.concat(r):[r].concat(o)}).getOr([])},sy=function(e,t){return K(e,function(e,n){return e.fold(function(){return k.some(n)},function(r){return Va(re(r.getClientRects()),re(n.getClientRects()),function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r}).or(e)})},k.none())},ly=function(e,t){return re(t.getClientRects()).bind(function(t){return sy(e,t.left)})},fy=f(ay,hc.isAbove,-1),dy=f(ay,hc.isBelow,1),my=f(cy,-1,fy),gy=f(cy,1,dy),py=function(e){var t=function(t){return W(t,function(t){return(t=Ua(t)).node=e,t})};if(On(e))return t(e.getClientRects());if(Dn(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},hy=function(e){return Q(e,py)};(iy=oy=oy||{})[iy.Up=-1]="Up",iy[iy.Down=1]="Down";var vy=function(e,t,n,r,o,i){var u=0,a=[],c=function(r){var i,c,l=hy([r]);for(-1===e&&(l=l.reverse()),i=0;i<l.length;i++)if(!n(c=l[i],s)){if(0<a.length&&t(c,Oe(a))&&u++,c.line=u,o(c))return!0;a.push(c)}},s=Oe(i.getClientRects());if(!s)return a;var l=i.getNode();return c(l),function(e,t,n,r){for(;r=Ts(r,e,_o,t);)if(n(r))return}(e,r,c,l),a},by=f(vy,oy.Up,Ga,$a),yy=f(vy,oy.Down,$a,Ga),xy=function(e){return function(t){return t.line>e}},wy=function(e){return function(t){return t.line===e}},Cy=Hn,Sy=Ts,ky=function(e,t){return Math.abs(e.left-t)},Oy=function(e,t){return Math.abs(e.right-t)},_y=function(e,t){return e>=t.left&&e<=t.right},Ty=function(e,t){return e>=t.top&&e<=t.bottom},Ey=function(e,t){return Se(e,function(e,n){var r=Math.min(ky(e,t),Oy(e,t)),o=Math.min(ky(n,t),Oy(n,t));return _y(t,n)||!_y(t,e)&&(o===r&&Cy(n.node)||o<r)?n:e})},Ay=function(e,t,n,r,o){var i=Sy(r,e,_o,t,!o);do{if(!i||n(i))return}while(i=Sy(i,e,_o,t))},Ry=function(e,t){e.selection.setRng(t),ad(e,e.selection.getRng())},Ny=function(e,t,n){return k.some(jv(e,t,n))},By=function(e,t,n,r,o,i){var u=t===vc.Forwards,a=Zs(e.getBody()),c=f(zs,u?a.next:a.prev),s=u?r:o;if(!n.collapsed){var l=Ka(n);if(i(l))return zv(t,e,l,t===vc.Backwards,!1)}var d=Ls(t,e.getBody(),n);if(s(d))return Hv(e,d.getNode(!u));var m=xv(u,c(d)),g=uo(n.startContainer);if(!m)return g?k.some(n):k.none();if(s(m))return zv(t,e,m.getNode(!u),u,!1);var p=c(m);return p&&s(p)&&Hs(m,p)?zv(t,e,p.getNode(!u),u,!1):g?Ny(e,m.toRange(),!1):k.none()},Dy=function(e,t,n,r,o,i){var u=Ls(t,e.getBody(),n),a=Oe(u.getClientRects()),c=t===oy.Down;if(!a)return k.none();var s,l=(c?yy:by)(e.getBody(),xy(1),u),f=$(l,wy(1)),d=a.left,m=Ey(f,d);if(m&&i(m.node)){var g=Math.abs(d-m.left),p=Math.abs(d-m.right);return zv(t,e,m.node,g<p,!1)}if(s=r(u)?u.getNode():o(u)?u.getNode(!0):Ka(n)){var h=function(e,t,n,r){var o,i,u,a,c=Zs(t),s=[],l=0,f=function(e){return Oe(e.getClientRects())},d=1===e?(o=c.next,i=$a,u=Ga,hc.after(r)):(o=c.prev,i=Ga,u=$a,hc.before(r)),m=f(d);do{if(d.isVisible()&&!u(a=f(d),m)){if(0<s.length&&i(a,Oe(s))&&l++,(a=Ua(a)).position=d,a.line=l,n(a))return s;s.push(a)}}while(d=o(d));return s}(t,e.getBody(),xy(1),s),v=Ey($(h,wy(1)),d);if(v)return Ny(e,v.position.toRange(),!1);if(v=Oe($(h,wy(0))))return Ny(e,v.position.toRange(),!1)}return 0===f.length?Py(e,c).filter(c?o:r).map(function(t){return jv(e,t.toRange(),!1)}):k.none()},Py=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var o=hc.fromRangeEnd(n),i=dy(r,o);return oe(i.positions)}return o=hc.fromRangeStart(n),i=fy(r,o),re(i.positions)},My=function(e,t,n){return Py(e,t).filter(n).exists(function(t){return e.selection.setRng(t.toRange()),!0})},Iy=Hn,Ly=function(e,t,n){var r,o,i=Zs(e.getBody()),u=f(zs,1===t?i.next:i.prev);if(n.collapsed&&""!==Uc(e)){var a,c=e.dom.getParent(n.startContainer,"PRE");if(!c)return;u(hc.fromRangeStart(n))||(o=(r=e).dom.create(Uc(r)),(!yt.ie||11<=yt.ie)&&(o.innerHTML='<br data-mce-bogus="1">'),a=o,1===t?e.$(c).after(a):e.$(c).before(a),e.selection.select(a,!0),e.selection.collapse())}},Fy=function(e,t){return function(e,t){var n=t?vc.Forwards:vc.Backwards,r=e.selection.getRng();return By(e,n,r,mm,gm,Iy).orThunk(function(){return Ly(e,n,r),k.none()})}(e,t).exists(function(t){return Ry(e,t),!0})},zy=function(e,t){return function(e,t){var n=t?1:-1,r=e.selection.getRng();return Dy(e,n,r,function(e){return mm(e)||fm(e)},function(e){return gm(e)||dm(e)},Iy).orThunk(function(){return Ly(e,n,r),k.none()})}(e,t).exists(function(t){return Ry(e,t),!0})},Hy=function(e,t){return My(e,t,t?gm:mm)},Vy=function(e){return j(["figcaption"],Mt(e))},jy=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},Uy=function(e,t,n){(n?sn:cn)(e,t)},Wy=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n,r,o=At(e.getBody()),i=hc.fromRangeStart(e.selection.getRng()),u=Uc(e),a=Wc(e);return n=i,r=f(Dt,o),kr(At(n.container()),qr,r).filter(Vy).exists(function(){if(function(e,t,n){return t?dy(e.dom,n).breakAt.isNone():fy(e.dom,n).breakAt.isNone()}(o,t,i)){var n=function(e,t,n,r){return""===t?(s=e,l=r,f=Tt("br"),Uy(s,f,l),jy(f)):(o=e,i=r,u=n,a=Tt(t),c=Tt("br"),Gn(a,u),sn(a,c),Uy(o,a,i),jy(c));var o,i,u,a,c,s,l,f}(o,u,a,t);return e.selection.setRng(n),!0}return!1})}(e,t)},qy=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},Gy=function(e,t){return Y(function(e,t){return Q(W(e,function(e){return _e({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:a},e)}),function(e){return(r=t).keyCode===(n=e).keyCode&&r.shiftKey===n.shiftKey&&r.altKey===n.altKey&&r.ctrlKey===n.ctrlKey&&r.metaKey===n.metaKey?[e]:[];var n,r})}(e,t),function(e){return e.action()})},$y=function(e,t){var n=t?vc.Forwards:vc.Backwards,r=e.selection.getRng();return By(e,n,r,sm,lm,jn).exists(function(t){return Ry(e,t),!0})},Xy=function(e,t){var n=t?1:-1,r=e.selection.getRng();return Dy(e,n,r,sm,lm,jn).exists(function(t){return Ry(e,t),!0})},Ky=function(e,t){return My(e,t,t?lm:sm)},Yy=function(e,t,n,r,o){var i,u,a=Ta(At(n),"td,th,caption").map(function(e){return e.dom}),c=$(function(e,t){return Q(t,function(t){var n,r={left:(n=Ua(t.getBoundingClientRect())).left- -1,top:n.top- -1,right:n.right+-2,bottom:n.bottom+-2,width:n.width+-1,height:n.height+-1};return[{x:r.left,y:e(r),cell:t},{x:r.right,y:e(r),cell:t}]})}(e,a),function(e){return t(e,o)});return i=r,u=o,K(c,function(e,t){return e.fold(function(){return k.some(t)},function(e){var n=Math.sqrt(Math.abs(e.x-i)+Math.abs(e.y-u)),r=Math.sqrt(Math.abs(t.x-i)+Math.abs(t.y-u));return k.some(r<n?t:e)})},k.none()).map(function(e){return e.cell})},Jy=f(Yy,function(e){return e.bottom},function(e,t){return e.y<t}),Qy=f(Yy,function(e){return e.top},function(e,t){return e.y>t}),Zy=function(e,t,n){var r,o,i,u,a=e(t,n);return(u=a).breakType===tp.Wrap&&0===u.positions.length||!Ln(n.getNode())&&(i=a).breakType===tp.Br&&1===i.positions.length?(r=e,o=t,!a.breakAt.exists(function(e){return r(o,e).breakAt.isSome()})):a.breakAt.isNone()},ex=f(Zy,fy),tx=f(Zy,dy),nx=function(e,t,n,r){var o,i,u,a,c=e.selection.getRng(),s=t?1:-1;return!(!hs()||(o=t,i=c,u=n,a=hc.fromRangeStart(i),!ul(!o,u).exists(function(e){return e.isEqual(a)}))||(zv(s,e,n,!t,!1).each(function(t){Ry(e,t)}),0))},rx=function(e,t,n){var r=function(e,t){var n=t.getNode(e);return On(n)&&"TABLE"===n.nodeName?k.some(n):k.none()}(!!t,n),o=!1===t;r.fold(function(){return Ry(e,n.toRange())},function(r){return ul(o,e.getBody()).filter(function(e){return e.isEqual(n)}).fold(function(){return Ry(e,n.toRange())},function(o){return i=t,a=r,c=n,void((s=Uc(u=e))?u.undoManager.transact(function(){var e=Tt(s);Gn(e,Wc(u)),sn(e,Tt("br")),(i?an:un)(At(a),e);var t=u.dom.createRng();t.setStart(e.dom,0),t.setEnd(e.dom,0),Ry(u,t)}):Ry(u,c.toRange()));var i,u,a,c,s})})},ox=function(e,t,n,r){var o,i,u,a,c,s,l=e.selection.getRng(),f=hc.fromRangeStart(l),d=e.getBody();if(!t&&ex(r,f)){var m=(a=d,function(e,t){return re(t.getClientRects()).bind(function(t){return Jy(e,t.left,t.top)}).bind(function(e){return ly(ll(n=e).map(function(e){return fy(n,e).positions.concat(e)}).getOr([]),t);var n})}(c=n,s=f).orThunk(function(){return re(s.getClientRects()).bind(function(e){return sy(my(a,hc.before(c)),e.left)})}).getOr(hc.before(c)));return rx(e,t,m),!0}return!(!t||!tx(r,f)||(o=d,m=function(e,t){return oe(t.getClientRects()).bind(function(t){return Qy(e,t.left,t.top)}).bind(function(e){return ly(sl(n=e).map(function(e){return[e].concat(dy(n,e).positions)}).getOr([]),t);var n})}(i=n,u=f).orThunk(function(){return re(u.getClientRects()).bind(function(e){return sy(gy(o,hc.after(i)),e.left)})}).getOr(hc.after(i)),rx(e,t,m),0))},ix=function(e,t,n){return k.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(function(r){return k.from(e.dom.getParent(r,"table")).map(function(o){return n(e,t,o,r)})}).getOr(!1)},ux=function(e,t){return ix(e,t,nx)},ax=function(e,t){return ix(e,t,ox)},cx=function(e,t){var n,r,o=t,i=e.dom,u=e.schema.getMoveCaretBeforeOnEnterElements();if(t){!/^(LI|DT|DD)$/.test(t.nodeName)||(r=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild))&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(i.doc.createTextNode(eo),t.firstChild);var a=i.createRng();if(t.normalize(),t.hasChildNodes()){for(var c=new Vr(t,t);n=c.current();){if(Dn(n)){a.setStart(n,0),a.setEnd(n,0);break}if(u[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}o=n,n=c.next()}n||(a.setStart(o,0),a.setEnd(o,0))}else Ln(t)?t.nextSibling&&i.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),ad(e,a)}},sx=function(e){return k.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},lx=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},fx=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},dx=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},mx=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!On(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},gx=function(e){e.innerHTML='<br data-mce-bogus="1">'},px=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},hx=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},vx=function(e,t,n){return!1===Dn(t)?n:e?1===n&&t.data.charAt(n-1)===to?0:n:n===t.data.length-1&&t.data.charAt(n)===to?t.data.length:n},bx=function(e,t){for(var n,r=e.getRoot(),o=t;o!==r&&"false"!==e.getContentEditable(o);)"true"===e.getContentEditable(o)&&(n=o),o=o.parentNode;return o!==r?n:r},yx=function(e,t){var n=Uc(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){var r=e.dom;k.from(n.style).map(r.parseStyle).each(function(e){var n=Zn(At(t)),o=_e(_e({},n),e);r.setStyles(t,o)});var o=k.from(n.class).map(function(e){return e.split(/\s+/)}),i=k.from(t.className).map(function(e){return $(e.split(/\s+/),function(e){return""!==e})});Va(o,i,function(e,n){var o=$(n,function(t){return!j(e,t)}),i=Te(e,o);r.setAttrib(t,"class",i.join(" "))});var u=["style","class"],a=ge(n,function(e,t){return!j(u,t)});r.setAttribs(t,a)}(e,t,Wc(e))},xx=function(e,t,n){var r=e.dom.createRng();n?(r.setStartBefore(t),r.setEndBefore(t)):(r.setStartAfter(t),r.setEndAfter(t)),e.selection.setRng(r),ad(e,r)},wx=function(e,t){var n=Tt("br");un(At(t),n),e.undoManager.add()},Cx=function(e,t){Sx(e.getBody(),t)||an(At(t),Tt("br"));var n=Tt("br");an(At(t),n),xx(e,n.dom,!1),e.undoManager.add()},Sx=function(e,t){return n=hc.after(t),!!Ln(n.getNode())||al(e,hc.after(t)).map(function(e){return Ln(e.getNode())}).getOr(!1);var n},kx=function(e){return e&&"A"===e.nodeName&&"href"in e},Ox=function(e){return e.fold(y,kx,kx,y)},_x=function(e,t){t.fold(a,f(wx,e),f(Cx,e),a)},Tx=function(e,t){var n,r,o,i=(r=f(bv,n=e),o=hc.fromRangeStart(n.selection.getRng()),wb(r,n.getBody(),o).filter(Ox));i.isSome()?i.each(f(_x,e)):function(e,t){var n,r,o=e.dom,i=e.selection.getRng();Pf(o,i).each(function(e){i.setStart(e.startContainer,e.startOffset),i.setEnd(e.endContainer,e.endOffset)});var u,a=i.startOffset,c=i.startContainer;1===c.nodeType&&c.hasChildNodes()&&(u=a>c.childNodes.length-1,c=c.childNodes[Math.min(a,c.childNodes.length-1)]||c,a=u&&3===c.nodeType?c.nodeValue.length:0);var s=o.getParent(c,o.isBlock),l=s?o.getParent(s.parentNode,o.isBlock):null;"LI"!==(l?l.nodeName.toUpperCase():"")||!(!t||!t.ctrlKey)||(s=l),c&&3===c.nodeType&&a>=c.nodeValue.length&&!function(e,t,n){for(var r,o=new Vr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||0<r.length)return!0}(e.schema,c,s)&&(n=o.create("br"),i.insertNode(n),i.setStartAfter(n),i.setEndAfter(n),r=!0),n=o.create("br"),xc(o,i,n),xx(e,n,r),e.undoManager.add()}(e,t)},Ex=function(e,t){return sx(e).filter(function(e){return 0<t.length&&Nt(At(e),t)}).isSome()},Ax=gr([{br:[]},{block:[]},{none:[]}]),Rx=function(e,t){return Ex(n=e,n.getParam("no_newline_selector",""));var n},Nx=function(e){return function(t,n){return""===Uc(t)===e}},Bx=function(e){return function(t,n){return sx(t).filter(function(e){return Yr(At(e))}).isSome()===e}},Dx=function(e,t){return function(n,r){return sx(n).fold(s(""),function(e){return e.nodeName.toUpperCase()})===e.toUpperCase()===t}},Px=function(e){return Dx("pre",e)},Mx=function(e){return function(t,n){return t.getParam("br_in_pre",!0)===e}},Ix=function(e,t){return Ex(n=e,n.getParam("br_newline_selector",".mce-toc h2,figcaption,caption"));var n},Lx=function(e,t){return t},Fx=function(e){var t=Uc(e),n=function(e,t){for(var n,r=e.getRoot(),o=t;o!==r&&"false"!==e.getContentEditable(o);)"true"===e.getContentEditable(o)&&(n=o),o=o.parentNode;return o!==r?n:r}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},zx=function(e,t){return function(n,r){return K(e,function(e,t){return e&&t(n,r)},!0)?k.some(t):k.none()}},Hx=function(e,t){(function(e,t){return fb([zx([Rx],Ax.none()),zx([Dx("summary",!0)],Ax.br()),zx([Px(!0),Mx(!1),Lx],Ax.br()),zx([Px(!0),Mx(!1)],Ax.block()),zx([Px(!0),Mx(!0),Lx],Ax.block()),zx([Px(!0),Mx(!0)],Ax.br()),zx([Bx(!0),Lx],Ax.br()),zx([Bx(!0)],Ax.block()),zx([Nx(!0),Lx,Fx],Ax.block()),zx([Nx(!0)],Ax.br()),zx([Ix],Ax.br()),zx([Nx(!1),Lx],Ax.br()),zx([Fx],Ax.block())],[e,!(!t||!t.shiftKey)]).getOr(Ax.none())})(e,t).fold(function(){Tx(e,t)},function(){!function(e,t){var n,r,o,i,u,a,c,s,l,f=e.dom,d=e.schema,m=d.getNonEmptyElements(),g=e.selection.getRng(),p=function(t){var n,o=r,u=d.getTextInlineElements(),a=t||"TABLE"===s||"HR"===s?f.create(t||S):i.cloneNode(!1),c=a;if(!1===e.getParam("keep_styles",!0))f.setAttrib(a,"style",null),f.setAttrib(a,"class",null);else do{if(u[o.nodeName]){if(dl(o)||wl(o))continue;n=o.cloneNode(!1),f.setAttrib(n,"id",""),a.hasChildNodes()?n.appendChild(a.firstChild):c=n,a.appendChild(n)}}while((o=o.parentNode)&&o!==k);return yx(e,a),gx(c),a},h=function(e){var t,n,u=vx(e,r,o);if(Dn(r)&&(e?0<u:u<r.nodeValue.length))return!1;if(r.parentNode===i&&l&&!e)return!0;if(e&&On(r)&&r===i.firstChild)return!0;if(px(r,"TABLE")||px(r,"HR"))return l&&!e||!l&&e;var a=new Vr(r,i);for(Dn(r)&&(e&&0===u?a.prev():e||u!==r.nodeValue.length||a.next());t=a.current();){if(On(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),m[n]&&"br"!==n))return!1}else if(Dn(t)&&!Eo(t.nodeValue))return!1;e?a.prev():a.next()}return!0},v=function(){u=/^(H[1-6]|PRE|FIGURE)$/.test(s)&&"HGROUP"!==x?p(S):p(),e.getParam("end_container_on_empty_block",!1)&&hx(f,c)&&f.isEmpty(i)?u=f.split(c,i):f.insertAfter(u,i),cx(e,u)};Pf(f,g).each(function(e){g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)}),r=g.startContainer,o=g.startOffset,S=Uc(e);var b=!(!t||!t.shiftKey),y=!(!t||!t.ctrlKey);On(r)&&r.hasChildNodes()&&(l=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=l&&Dn(r)?r.nodeValue.length:0);var x,w,C,S,k=bx(f,r);k&&((S&&!b||!S&&b)&&(r=function(e,t,n,r,o){var i,u,a,c,s,l,f=t||"P",d=e.dom,m=bx(d,r),g=d.getParent(r,d.isBlock);if(!g||!hx(d,g)){if(s=(g=g||m)===e.getBody()||(l=g)&&/^(TD|TH|CAPTION)$/.test(l.nodeName)?g.nodeName.toLowerCase():g.parentNode.nodeName.toLowerCase(),!g.hasChildNodes())return i=d.create(f),yx(e,i),g.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(a=r;a.parentNode!==g;)a=a.parentNode;for(;a&&!d.isBlock(a);)a=(u=a).previousSibling;if(u&&e.schema.isValidChild(s,f.toLowerCase())){for(i=d.create(f),yx(e,i),u.parentNode.insertBefore(i,u),a=u;a&&!d.isBlock(a);)c=a.nextSibling,i.appendChild(a),a=c;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,S,g,r,o)),i=f.getParent(r,f.isBlock),c=i?f.getParent(i.parentNode,f.isBlock):null,s=i?i.nodeName.toUpperCase():"","LI"!==(x=c?c.nodeName.toUpperCase():"")||y||(c=(i=c).parentNode,s=x),/^(LI|DT|DD)$/.test(s)&&f.isEmpty(i)?function(e,t,n,r,o){var i,u,a,c,s,l,f,d,m=e.dom,g=e.selection.getRng();n!==e.getBody()&&(fx(i=n)&&fx(i.parentNode)&&(o="LI"),u=o?t(o):m.create("BR"),mx(n,r,!0)&&mx(n,r,!1)?lx(n,"LI")?(a=dx(n),m.insertAfter(u,a),(null===(d=(f=n).parentNode)||void 0===d?void 0:d.firstChild)===f?m.remove(a):m.remove(n)):m.replace(u,n):(mx(n,r,!0)?lx(n,"LI")?(m.insertAfter(u,dx(n)),u.appendChild(m.doc.createTextNode(" ")),u.appendChild(n)):n.parentNode.insertBefore(u,n):mx(n,r,!1)?m.insertAfter(u,dx(n)):(n=dx(n),(c=g.cloneRange()).setStartAfter(r),c.setEndAfter(n),s=c.extractContents(),"LI"===o&&(l=s).firstChild&&"LI"===l.firstChild.nodeName?(u=s.firstChild,m.insertAfter(s,n)):(m.insertAfter(s,n),m.insertAfter(u,n))),m.remove(r)),cx(e,u))}(e,p,c,i,S):S&&i===e.getBody()||(S=S||"P",uo(i)?(u=po(i),f.isEmpty(i)&&gx(i),yx(e,u),cx(e,u)):h()?v():h(!0)?(u=i.parentNode.insertBefore(p(),i),cx(e,px(i,"HR")?u:i)):((C=(w=g).cloneRange()).setStart(w.startContainer,vx(!0,w.startContainer,w.startOffset)),C.setEnd(w.endContainer,vx(!1,w.endContainer,w.endOffset)),(n=C.cloneRange()).setEndAfter(i),a=n.extractContents(),q(_a(At(a),zt),function(e){var t=e.dom;t.nodeValue=ro(t.nodeValue)}),function(e){for(;Dn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild;);}(a),u=a.firstChild,f.insertAfter(a,i),function(e,t,n){var r,o,i=n,u=[];if(i){for(;i=i.firstChild;){if(e.isBlock(i))return;On(i)&&!t[i.nodeName.toLowerCase()]&&u.push(i)}for(r=u.length;r--;)(!(i=u[r]).hasChildNodes()||i.firstChild===i.lastChild&&""===i.firstChild.nodeValue||(o=i)&&"A"===o.nodeName&&e.isEmpty(o))&&e.remove(i)}}(f,m,u),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(f,i),f.isEmpty(i)&&gx(i),u.normalize(),f.isEmpty(u)?(f.remove(u),v()):(yx(e,u),cx(e,u))),f.setAttrib(u,"id",""),e.fire("NewBlock",{newBlock:u})))}(e,t)},a)},Vx=lt().browser,jx=function(e,t){var n=t.container(),r=t.offset();return Dn(n)?(n.insertData(r,e),k.some(hc(n,r+e.length))):Fs(t).map(function(n){var r=Et(e);return(t.isAtEnd()?an:un)(n,r),hc(r.dom,e.length)})},Ux=f(jx,eo),Wx=f(jx," "),qx=function(e){var t,n,r=hc.fromRangeStart(e.selection.getRng()),o=At(e.getBody());if(e.selection.isCollapsed()){var i=f(bv,e),u=hc.fromRangeStart(e.selection.getRng());return wb(i,e.getBody(),u).bind((n=o,function(e){return e.fold(function(e){return cl(n.dom,hc.before(e))},function(e){return sl(e)},function(e){return ll(e)},function(e){return al(n.dom,hc.after(e))})})).bind(function(e,t){return function(n){return r=e,(!Lm(o=n)&&(function(e,t){return cl(e.dom,t).isNone()||al(e.dom,t).isNone()||Sm(e,t)||km(e,t)||Rm(e,t)||Am(e,t)}(r,o)||Mm(r,o)||Im(r,o))?Ux:Wx)(t);var r,o}}(o,r)).exists((t=e,function(e){return t.selection.setRng(e.toRange()),t.nodeChanged(),!0}))}return!1},Gx=($x.prototype.nodeChanged=function(e){var t,n,r,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(t=o.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,function(e){return e===r||void n.push(e)}),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},$x.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;0<=t&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},$x);function $x(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",function(n){var r=e.selection.getRng(),o={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Ef(o,t)||e.fire("SelectionChange"),t=o}),e.on("contextmenu",function(){e.fire("SelectionChange")}),e.on("SelectionChange",function(){var t=e.selection.getStart(!0);!t||!yt.range&&e.selection.isCollapsed()||df(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",function(t){!t.isDefaultPrevented()&&df(e)&&("IMG"===e.selection.getNode().nodeName?Fr.setEditorTimeout(e,function(){e.nodeChanged()}):e.nodeChanged())})}var Xx=function(e){return On(e)&&Xr(At(e))},Kx=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-r.clientTop,left:t.left+o.pageXOffset-r.clientLeft}},Yx=function(e,t){return n=(a=e).inline?Kx(a.getBody()):{left:0,top:0},u=(i=e).getBody(),r=i.inline?{left:u.scrollLeft,top:u.scrollTop}:{left:0,top:0},{pageX:(o=function(e,t){if(t.target.ownerDocument===e.getDoc())return{left:t.pageX,top:t.pageY};var n,r,o,i=Kx(e.getContentAreaContainer()),u=(r=(n=e).getBody(),o=n.getDoc().documentElement,n.inline?{left:r.scrollLeft,top:r.scrollTop}:{left:r.scrollLeft||o.scrollLeft,top:r.scrollTop||o.scrollTop});return{left:t.pageX-i.left+u.left,top:t.pageY-i.top+u.top}}(e,t)).left-n.left+r.left,pageY:o.top-n.top+r.top};var n,r,o,i,u,a},Jx=Hn,Qx=zn,Zx=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},ew=function(e){e.on(function(e){Zx(e.ghost)}),e.clear()},tw=zn,nw=Hn,rw=function(e,t){return xf(e.getBody(),t)},ow=ca.DOM,iw=function(e){return ge(e,function(e){return!1===D(e)})},uw=function(e){var t,n=e.settings,r=e.editorUpload.blobCache;return iw({allow_conditional_comments:n.allow_conditional_comments,allow_html_data_urls:n.allow_html_data_urls,allow_svg_data_urls:n.allow_svg_data_urls,allow_html_in_named_anchor:n.allow_html_in_named_anchor,allow_script_urls:n.allow_script_urls,allow_unsafe_link_target:n.allow_unsafe_link_target,convert_fonts_to_spans:n.convert_fonts_to_spans,fix_list_elements:n.fix_list_elements,font_size_legacy_values:n.font_size_legacy_values,forced_root_block:n.forced_root_block,forced_root_block_attrs:n.forced_root_block_attrs,padd_empty_with_br:n.padd_empty_with_br,preserve_cdata:n.preserve_cdata,remove_trailing_brs:n.remove_trailing_brs,inline_styles:n.inline_styles,root_name:(t=e).inline?t.getElement().nodeName.toLowerCase():void 0,validate:!0,blob_cache:r,images_dataimg_filter:n.images_dataimg_filter})},aw=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader},cw=function(e,t){var n=e.settings,r=e.getDoc(),o=e.getBody();n.browser_spellcheck||n.gecko_spellcheck||(r.body.spellcheck=!1,ow.setAttrib(o,"spellcheck","false")),e.quirks=function(e){var t,n,r,o=kt.each,i=Sf.BACKSPACE,u=Sf.DELETE,c=e.dom,s=e.selection,l=e.parser,f=yt.gecko,d=yt.webkit,m="data:text/mce-internal,",g=yt.ie?"Text":"URL",p=function(t,r){try{e.getDoc().execCommand(t,!1,r)}catch(n){}},h=function(e){return e.isDefaultPrevented()},v=function(){e.shortcuts.add("meta+a",null,"SelectAll")},b=function(){e.on("keydown",function(e){if(!h(e)&&e.keyCode===i&&s.isCollapsed()&&0===s.getRng().startOffset){var t=s.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}})},y=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",function(t){var n;if("HTML"===t.target.nodeName){if(11<yt.ie)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}}))},x=a;return e.on("keydown",function(t){var n;if(!h(t)&&t.keyCode===Sf.BACKSPACE){var r=(n=s.getRng()).startContainer,o=n.startOffset,i=c.getRoot(),u=r;if(n.collapsed&&0===o){for(;u&&u.parentNode&&u.parentNode.firstChild===u&&u.parentNode!==i;)u=u.parentNode;"BLOCKQUOTE"===u.tagName&&(e.formatter.toggle("blockquote",null,u),(n=c.createRng()).setStart(r,0),n.setEnd(r,0),s.setRng(n))}}}),t=function(e){var t=c.create("body"),n=e.cloneContents();return t.appendChild(n),s.serializer.serialize(t,{format:"html"})},e.on("keydown",function(n){var r,o,a,s,l,f=n.keyCode;if(!h(n)&&(f===u||f===i)){if(r=e.selection.isCollapsed(),o=e.getBody(),r&&!c.isEmpty(o))return;if(!r&&(a=e.selection.getRng(),s=t(a),(l=c.createRng()).selectNode(e.getBody()),s!==t(l)))return;n.preventDefault(),e.setContent(""),o.firstChild&&c.isBlock(o.firstChild)?e.selection.setCursorLocation(o.firstChild,0):e.selection.setCursorLocation(o,0),e.nodeChanged()}}),yt.windowsPhone||e.on("keyup focusin mouseup",function(e){Sf.modifierPressed(e)||s.normalize()},!0),d&&(e.inline||c.bind(e.getDoc(),"mousedown mouseup",function(t){var n;if(t.target===e.getDoc().documentElement)if(n=s.getRng(),e.getBody().focus(),"mousedown"===t.type){if(co(n.startContainer))return;s.placeCaretAt(t.clientX,t.clientY)}else s.setRng(n)}),e.on("click",function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==c.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&c.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),s.select(n))}),Uc(e)&&e.on("init",function(){p("DefaultParagraphSeparator",Uc(e))}),e.on("init",function(){e.dom.bind(e.getBody(),"submit",function(e){e.preventDefault()})}),b(),l.addNodeFilter("br",function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}),yt.iOS?(e.inline||e.on("keydown",function(){document.activeElement===document.body&&e.getWin().focus()}),y(),e.on("click",function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):v()),11<=yt.ie&&(y(),b()),yt.ie&&(v(),p("AutoUrlDetect",!1),e.on("dragstart",function(t){var n,r,o;(n=t).dataTransfer&&(e.selection.isCollapsed()&&"IMG"===n.target.tagName&&s.select(n.target),0<(r=e.selection.getContent()).length&&(o=m+escape(e.id)+","+escape(r),n.dataTransfer.setData(g,o)))}),e.on("drop",function(t){var n,r,o,i,u;h(t)||(n=(i=t).dataTransfer&&(u=i.dataTransfer.getData(g))&&0<=u.indexOf(m)?(u=u.substr(m.length).split(","),{id:unescape(u[0]),html:unescape(u[1])}):null)&&n.id!==e.id&&(t.preventDefault(),r=Tf(t.x,t.y,e.getDoc()),s.setRng(r),o=n.html,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:!0}):e.execCommand("mceInsertContent",!1,o))})),f&&(e.on("keydown",function(t){if(!h(t)&&t.keyCode===i){if(!e.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&0===s.getRng().startOffset){var n=s.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return c.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(c.remove(r),t.preventDefault())}}}),Range.prototype.getClientRects||e.on("mousedown",function(t){var n;h(t)||"HTML"!==t.target.nodeName||((n=e.getBody()).blur(),Fr.setEditorTimeout(e,function(){n.focus()}))}),n=function(){var t=c.getAttribs(s.getStart().cloneNode(!1));return function(){var n=s.getStart();n!==e.getBody()&&(c.setAttrib(n,"style",null),o(t,function(e){n.setAttributeNode(e.cloneNode(!0))}))}},r=function(){return!s.isCollapsed()&&c.getParent(s.getStart(),c.isBlock)!==c.getParent(s.getEnd(),c.isBlock)},e.on("keypress",function(t){var o;if(!h(t)&&(8===t.keyCode||46===t.keyCode)&&r())return o=n(),e.getDoc().execCommand("delete",!1,null),o(),t.preventDefault(),!1}),c.bind(e.getDoc(),"cut",function(t){var o;!h(t)&&r()&&(o=n(),Fr.setEditorTimeout(e,function(){o()}))}),e.getParam("readonly")||e.on("BeforeExecCommand mousedown",function(){p("StyleWithCSS",!1),p("enableInlineTableEditing",!1),Jc(e)||p("enableObjectResizing",!1)}),e.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||o(c.select("a"),function(e){var t=e.parentNode,n=c.getRoot();if(t.lastChild===e){for(;t&&!c.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}c.add(t,"br",{"data-mce-bogus":1})}})}),e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),yt.mac&&e.on("keydown",function(t){!Sf.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))}),b()),{refreshContentEditable:x,isHidden:function(){if(!f||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}}(e),e.fire("PostRender");var i,u,c,s,l,f,d=e.getParam("directionality",ba.isRtl()?"rtl":void 0);void 0!==d&&(o.dir=d),n.protect&&e.on("BeforeSetContent",function(e){kt.each(n.protect,function(t){e.content=e.content.replace(t,function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"})})}),e.on("SetContent",function(){e.addVisual(e.getBody())}),!1===t&&e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"}),e.on("compositionstart compositionend",function(t){e.composing="compositionstart"===t.type}),0<e.contentStyles.length&&(i="",kt.each(e.contentStyles,function(e){i+=e+"\r\n"}),e.dom.addStyle(i)),function(e,t){var n,r,o,i,u=aw(e),a=Yc(e),c=function(){u.unloadAll(t),e.inline||e.ui.styleSheetLoader.unloadAll(a)},s=function(){e.removed?c():(e.on("remove",c),function(e){var t;e.bindPendingEventDelegates(),e.initialized=!0,e.fire("Init"),e.focus(!0),function(e){var t=e.dom.getRoot();e.inline||df(e)&&e.selection.getStart(!0)!==t||sl(t).each(function(t){var n,r,o,i,u=t.getNode(),a=Rn(u)?sl(u).getOr(t):t;yt.browser.isIE()?(n=e,r=a.toRange(),o=At(n.getBody()),i=(hd(n)?k.from(r):k.none()).map(vd).filter(pd(o)),n.bookmark=i.isSome()?i:n.bookmark):e.selection.setRng(a.toRange())})}(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),(t=e).settings.auto_focus&&Fr.setEditorTimeout(t,function(){var e=!0===t.settings.auto_focus?t:t.editorManager.get(t.settings.auto_focus);e.destroyed||e.focus()},100)}(e))};Er.all((n=e,r=t,o=a,i=[new Er(function(e,t){return aw(n).loadAll(r,e,t)})],n.inline?i:i.concat([new Er(function(e,t){return n.ui.styleSheetLoader.loadAll(o,e,t)})]))).then(s).catch(s)}(e,e.contentCSS),n.content_style&&(c=n.content_style,s=At((u=e).getBody()),l=rn(nn(s)),f=Tt("style"),qn(f,"type","text/css"),sn(f,Et(c)),sn(l,f),u.on("remove",function(){dn(f)}))},sw=function(e,t){var n=e.settings,r=e.getElement(),o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(o.open(),o.write(e.iframeHTML),o.close()),e.inline&&(ow.addClass(r,"mce-content-body"),e.contentDocument=o=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var i,u,c,l,d=e.getBody();d.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===ow.getStyle(d,"position",!0)&&(d.style.position="relative"),d.contentEditable=e.getParam("content_editable_state",!0)),d.disabled=!1,e.editorUpload=function(e){var t,n,r,o,i,u,a=(t=[],n=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t=e.id||rv("blobid"),n=e.name||t,r=e.blob;return{id:s(t),name:s(n),filename:s(e.filename||n+"."+({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[r.type.toLowerCase()]||"dat")),blob:s(r),base64:s(e.base64),blobUri:s(e.blobUri||URL.createObjectURL(r)),uri:s(e.uri)}},{create:function(e,t,r,o,i){if(E(e))return n({id:e,name:o,filename:i,blob:t,base64:r});if(A(e))return n(e);throw new Error("Unknown input type")},add:function(e){o(e.id())||t.push(e)},get:o=function(e){return r(function(t){return t.id()===e})},getByUri:function(e){return r(function(t){return t.blobUri()===e})},getByData:function(e,t){return r(function(n){return n.base64()===e&&n.blob().type===t})},findFirst:r=function(e){return Y(t,e).getOrUndefined()},removeByUri:function(e){t=$(t,function(t){return t.blobUri()!==e||void URL.revokeObjectURL(t.blobUri())})},destroy:function(){q(t,function(e){URL.revokeObjectURL(e.blobUri())}),t=[]}}),c=tv(),l=[],f=function(e){var t=ga(null);return e.on("change AddUndo",function(e){t.set(_e({},e.level))}),{fireIfChanged:function(){var n=e.undoManager.data;oe(n).filter(function(e){return!Gp(t.get(),e)}).each(function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:ne(n,n.length-2).getOrNull()})})}}}(e),d=function(t){return function(n){return e.selection?t(n):[]}},m=function(e,t,n){for(var r=0;-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1),-1!==r;);return e},g=function(e,t,n){return e=m(e,'src="'+t+'"','src="'+n+'"'+(n===yt.transparentSrc?' data-mce-placeholder="1"':"")),m(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},p=function(t,n){q(e.undoManager.data,function(e){"fragmented"===e.type?e.fragments=W(e.fragments,function(e){return g(e,t,n)}):e.content=g(e.content,t,n)})},h=function(t){return i=i||iv(e,c),y().then(d(function(n){var r=W(n,function(e){return e.blobInfo});return i.upload(r,ov(e)).then(d(function(r){var o=[],i=W(r,function(t,r){var i=n[r].blobInfo,u=n[r].image;return t.status&&e.getParam("images_replace_blob_uris",!0,"boolean")?(a.removeByUri(u.src),function(t,n){var r,o=e.convertURL(n,"src");p(t.src,n),e.$(t).attr({src:e.getParam("images_reuse_filename",!1,"boolean")?(r=n)+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime():n,"data-mce-src":o})}(u,t.url)):t.error&&(t.error.options.remove&&(p(u.getAttribute("src"),yt.transparentSrc),o.push(u)),Kh(e,ba.translate(["Failed to upload image: {0}",t.error.message]))),{element:u,status:t.status,uploadUri:t.url,blobInfo:i}});return 0<i.length&&f.fireIfChanged(),0<o.length&&(Jp(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact(function(){q(o,function(t){e.dom.remove(t),a.removeByUri(t.src)})})),t&&t(i),i}))}))},v=function(t){if(qc(e))return h(t)},b=function(t){return!1!==Z(l,function(e){return e(t)})&&(0!==t.getAttribute("src").indexOf("data:")||e.getParam("images_dataimg_filter",x,"function")(t))},y=function(){return(u=u||function(e,t){var n={};return{findAll:function(r,o){o=o||x;var i,u=$((i=r)?ie(i.getElementsByTagName("img")):[],function(t){var n=t.src;return yt.fileApi&&!t.hasAttribute("data-mce-bogus")&&!t.hasAttribute("data-mce-placeholder")&&n&&n!==yt.transparentSrc&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t))}),a=W(u,function(e){if(void 0!==n[e.src])return new Er(function(t){n[e.src].then(function(n){return"string"==typeof n?n:void t({image:e,blobInfo:n.blobInfo})})});var r=new Er(function(n,r){!function(e,t,n,r){var o,i,u,a;0!==t.src.indexOf("blob:")?(i=(o=uh(t.src)).data,(a=e.getByData(u=i,o.type))?n({image:t,blobInfo:a}):ch(t.src).then(function(r){a=e.create(lh(),r,u),e.add(a),n({image:t,blobInfo:a})},function(e){r(e)})):(a=e.getByUri(t.src))?n({image:t,blobInfo:a}):ch(t.src).then(function(r){var o;o=r,new Er(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(o)}).then(function(o){u=uh(o).data,a=e.create(lh(),r,u),e.add(a),n({image:t,blobInfo:a})})},function(e){r(e)})}(t,e,n,r)}).then(function(e){return delete n[e.image.src],e}).catch(function(t){return delete n[e.src],t});return n[e.src]=r});return Er.all(a)}}}(c,a)).findAll(e.getBody(),b).then(d(function(t){return t=$(t,function(t){return"string"!=typeof t||void Kh(e,t)}),q(t,function(e){p(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")}),t}))},w=function(t){return t.replace(/src="(blob:[^"]+)"/g,function(t,n){var r=c.getResultUri(n);if(r)return'src="'+r+'"';var o=a.getByUri(n);return(o=o||K(e.editorManager.get(),function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)},null))?'src="data:'+o.blob().type+";base64,"+o.base64()+'"':t})};return e.on("SetContent",function(){(qc(e)?v:y)()}),e.on("RawSaveContent",function(e){e.content=w(e.content)}),e.on("GetContent",function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=w(e.content))}),e.on("PostRender",function(){e.parser.addNodeFilter("img",function(e){q(e,function(e){var t,n=e.attr("src");a.getByUri(n)||(t=c.getResultUri(n))&&e.attr("src",t)})})}),{blobCache:a,addFilter:function(e){l.push(e)},uploadImages:h,uploadImagesAuto:v,scanForImages:y,destroy:function(){a.destroy(),c.destroy(),u=i=null}}}(e),e.schema=ui(n),e.dom=ca(o,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:e.getParam("content_css_cors",!1,"boolean"),referrerPolicy:$c(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=((u=bh(uw(i=e),i.schema)).addAttributeFilter("src,href,style,tabindex",function(e,t){for(var n,r,o=e.length,u=i.dom,a="data-mce-"+t;o--;)if((r=(n=e[o]).attr(t))&&!n.attr(a)){if(0===r.indexOf("data:")||0===r.indexOf("blob:"))continue;"style"===t?((r=u.serializeStyle(u.parseStyle(r),n.name)).length||(r=null),n.attr(a,r),n.attr(t,r)):"tabindex"===t?(n.attr(a,r),n.attr(t,null)):n.attr(a,i.convertURL(r,t,n.name))}}),u.addNodeFilter("script",function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}}),i.settings.preserve_cdata&&u.addNodeFilter("#cdata",function(e){for(var t=e.length;t--;){var n=e[t];n.type=8,n.name="#comment",n.value="[CDATA["+i.dom.encode(n.value)+"]]"}}),u.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(e){for(var t=e.length,n=i.schema.getNonEmptyElements();t--;){var r=e[t];r.isEmpty(n)&&0===r.getAll("br").length&&(r.append(new zd("br",1)).shortEnded=!0)}}),u),e.serializer=xh((l=(c=e).settings,_e(_e({},uw(c)),iw({url_converter:l.url_converter,url_converter_scope:l.url_converter_scope,element_format:l.element_format,entities:l.entities,entity_encoding:l.entity_encoding,indent:l.indent,indent_after:l.indent_after,indent_before:l.indent_before,block_elements:l.block_elements,boolean_attributes:l.boolean_attributes,custom_elements:l.custom_elements,extended_valid_elements:l.extended_valid_elements,invalid_elements:l.invalid_elements,invalid_styles:l.invalid_styles,move_caret_before_on_enter_elements:l.move_caret_before_on_enter_elements,non_empty_elements:l.non_empty_elements,schema:l.schema,self_closing_elements:l.self_closing_elements,short_ended_elements:l.short_ended_elements,special:l.special,text_block_elements:l.text_block_elements,text_inline_elements:l.text_inline_elements,valid_children:l.valid_children,valid_classes:l.valid_classes,valid_elements:l.valid_elements,valid_styles:l.valid_styles,verify_html:l.verify_html,whitespace_elements:l.whitespace_elements}))),e),e.selection=ih(e.dom,e.getWin(),e.serializer,e),e.annotator=bf(e),e.formatter=fv(e),e.undoManager=dv(e),e._nodeChangeDispatcher=new Gx(e),e._selectionOverrides=function(e){var t,n=e.selection,r=e.dom,o=r.isBlock,i=e.getBody(),u=function(e,t,n,r){var o,i,u=ga(k.none()),a=Uc(e),c=0<a.length?a:"p",s=function(){!function(e){for(var t=Ta(At(e),"*[contentEditable=false],video,audio,embed,object"),n=0;n<t.length;n++){var r,o=t[n].dom,i=o.previousSibling;go(i)&&(1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(r.length-1,1)),mo(i=o.nextSibling)&&(1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1))}}(t),i&&(ls(i),i=null),u.get().each(function(e){ta(e.caret).remove(),u.set(k.none())}),o&&(Fr.clearInterval(o),o=null)},l=function(){o=Fr.setInterval(function(){r()?ta("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):ta("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")},500)};return{show:function(e,r){var o,a;if(s(),gs(r))return null;if(!n(r))return i=function(e,t){var n,r=e.ownerDocument.createTextNode(to),o=e.parentNode;if(t){if(io(n=e.previousSibling)){if(co(n))return n;if(go(n))return n.splitText(n.data.length-1)}o.insertBefore(r,e)}else{if(io(n=e.nextSibling)){if(co(n))return n;if(mo(n))return n.splitText(1),n}e.nextSibling?o.insertBefore(r,e.nextSibling):o.appendChild(r)}return r}(r,e),a=r.ownerDocument.createRange(),vs(i.nextSibling)?(a.setStart(i,0),a.setEnd(i,0)):(a.setStart(i,1),a.setEnd(i,1)),a;i=function(e,t,n){var r,o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var i=t.parentNode;return n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o),o}(c,r,e),o=ps(t,r,e),ta(i).css("top",o.top);var f=ta('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(o).appendTo(t)[0];return u.set(k.some({caret:f,element:r,before:e})),u.get().each(function(t){e&&ta(t.caret).addClass("mce-visual-caret-before")}),l(),(a=r.ownerDocument.createRange()).setStart(i,0),a.setEnd(i,0),a},hide:s,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){u.get().each(function(e){var n=ps(t,e.element,e.before);ta(e.caret).css(_e({},n))})},destroy:function(){return Fr.clearInterval(o)}}}(e,i,o,function(){return Ed(e)}),a="sel-"+r.uniqueId(),c="data-mce-selected",s=function(e){return e!==i&&(nw(e)||jn(e))&&r.isChildOf(e,i)},l=function(e){e&&n.setRng(e)},d=n.getRng,m=function(t,r,o,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:r,direction:t,before:o}).isDefaultPrevented()?null:(i&&n.scrollIntoView(r,-1===t),u.show(o,r))},g=function(e){return co(e)||mo(e)||go(e)},p=function(e){return g(e.startContainer)||g(e.endContainer)},h=function(o){var i=o.cloneNode(!0),u=e.fire("ObjectSelected",{target:o,targetClone:i});if(u.isDefaultPrevented())return null;var s=function(t,o,i){var u=e.$,c=_r(At(e.getBody()),"#"+a).fold(function(){return u([])},function(e){return u([e.dom])});0===c.length&&(c=u('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",a)).appendTo(e.getBody());var s=r.createRng();o===i&&yt.ie?(c.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(o),s.setStartAfter(c[0].firstChild.firstChild),s.setEndAfter(o)):(c.empty().append(eo).append(o).append(eo),s.setStart(c[0].firstChild,1),s.setEnd(c[0].lastChild,0)),c.css({top:r.getPos(t,e.getBody()).y}),c[0].focus();var l=n.getSel();return l.removeAllRanges(),l.addRange(s),s}(o,u.targetClone,i),l=At(o);return q(Ta(At(e.getBody()),"*[data-mce-selected]"),function(e){Dt(l,e)||Kn(e,c)}),r.getAttrib(o,c)||o.setAttribute(c,"1"),t=o,y(),s},v=function(e,t){if(!e)return null;if(e.collapsed){if(!p(e)){var n=t?1:-1,o=Ls(n,i,e),u=o.getNode(!t);if(bs(u))return m(n,u,!!t&&!o.isAtEnd(),!1);var a=o.getNode(t);if(bs(a))return m(n,a,!t&&!o.isAtEnd(),!1)}return null}var c=e.startContainer,l=e.startOffset,f=e.endOffset;if(3===c.nodeType&&0===l&&nw(c.parentNode)&&(l=r.nodeIndex(c=c.parentNode),c=c.parentNode),1!==c.nodeType)return null;if(f===l+1&&c===e.endContainer){var d=c.childNodes[l];if(s(d))return h(d)}return null},b=function(){t&&t.removeAttribute(c),_r(At(e.getBody()),"#"+a).each(dn),t=null},y=function(){u.hide()};return yt.ceFalse&&function(){var c,g,h;e.on("mouseup",function(t){var n=d();n.collapsed&&Uh(e,t.clientX,t.clientY)&&Vv(e,n,!1).each(l)}),e.on("click",function(t){var o=rw(e,t.target);o&&(nw(o)&&(t.preventDefault(),e.focus()),tw(o)&&r.isChildOf(o,n.getNode())&&b())}),e.on("blur NewBlock",b),e.on("ResizeWindow FullscreenStateChanged",u.reposition),e.on("tap",function(t){var n=t.target,r=rw(e,n);nw(r)?(t.preventDefault(),Hv(e,r).each(v)):s(n)&&Hv(e,n).each(v)},!0),e.on("mousedown",function(t){var u,a,c,d=t.target;d!==i&&"HTML"!==d.nodeName&&!r.isChildOf(d,i)||!1===Uh(e,t.clientX,t.clientY)||((u=rw(e,d))?nw(u)?(t.preventDefault(),Hv(e,u).each(v)):(b(),tw(u)&&t.shiftKey||wf(t.clientX,t.clientY,n.getRng())||(y(),n.placeCaretAt(t.clientX,t.clientY))):s(d)?Hv(e,d).each(v):!1===bs(d)&&(b(),y(),(a=function(e,t,n){var r,o,i=hy($(ie(e.getElementsByTagName("*")),bs)),u=$(i,f(Ty,n));if(a=Ey(u,t)){var a,c=!Rn(a.node)&&!jn(a.node);if((a=Ey(function(e,t,n){void 0===n&&(n=!0);var r=[],o=function(e,n){var o=$(hy([n]),function(n){return!e(n,t)});return r=r.concat(o),0===o.length};return r.push(t),Ay(oy.Up,e,f(o,Ga),t.node,n),Ay(oy.Down,e,f(o,$a),t.node,n),r}(e,a,c),t))&&bs(a.node))return{node:(r=a).node,before:ky(r,o=t)<Oy(r,o)}}return null}(i,t.clientX,t.clientY))&&(function(t,n){var i,u=r.getParent(t,o),a=r.getParent(n,o);return!(!u||t===a||!r.isChildOf(u,a)||!1!==nw(rw(e,u)))||u&&(i=a,!(r.getParent(u,o)===r.getParent(i,o)))&&function(e){var t=Zs(e);if(!e.firstChild)return!1;var n,r=hc.before(e.firstChild),o=t.next(r);return o&&!(mm(n=o)||gm(n)||sm(n)||lm(n))}(u)}(d,a.node)||(t.preventDefault(),c=m(1,a.node,a.before,!1),e.getBody().focus(),l(c)))))}),e.on("keypress",function(e){Sf.modifierPressed(e)||nw(n.getNode())&&e.preventDefault()}),e.on("GetSelectionRange",function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}}),e.on("SetSelectionRange",function(t){t.range=function(t){var n=e.schema.getShortEndedElements(),o=r.createRng(),i=t.startContainer,u=t.startOffset,a=t.endContainer,c=t.endOffset;return he(n,i.nodeName.toLowerCase())?0===u?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,u),he(n,a.nodeName.toLowerCase())?0===c?o.setEndBefore(a):o.setEndAfter(a):o.setEnd(a,c),o}(t.range);var n=v(t.range,t.forward);n&&(t.range=n)}),e.on("AfterSetSelectionRange",function(e){var t=e.range,n=t.startContainer.parentNode;p(t)||"mcepastebin"===n.id||y(),r.hasClass(n,"mce-offscreen-selection")||b()}),e.on("copy",function(e){var t,n,o=e.clipboardData;e.isDefaultPrevented()||!e.clipboardData||yt.ie||(t=(n=r.get(a))?n.getElementsByTagName("*")[0]:n)&&(e.preventDefault(),o.clearData(),o.setData("text/html",t.outerHTML),o.setData("text/plain",t.outerText||t.innerText))}),function(e){var t,n,r,o,i;(function(e){var t,n,r,o=(t=ga(k.none()),{clear:function(){return t.set(k.none())},set:function(e){return t.set(k.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}),i=ca.DOM,u=document,a=function(e,t){return function(n){var r,o,i,u,a,c;0===n.button&&(r=Y(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(Jx,Qx)).getOr(null),a=t.getBody(),Jx(c=r)&&c!==a&&(o=t.dom.getPos(r),i=t.getBody(),u=t.getDoc().documentElement,e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:u.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:u.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:r.offsetWidth,height:r.offsetHeight,ghost:function(e,t,n,r){var o=e.dom,i=t.cloneNode(!0);o.setStyles(i,{width:n,height:r}),o.setAttrib(i,"data-mce-selected",null);var u=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(u,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(i,{margin:0,boxSizing:"border-box"}),u.appendChild(i),u}(t,r,r.offsetWidth,r.offsetHeight)})))}}(o,e),c=function(e,t){var n=Fr.throttle(function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)},0);return t.on("remove",n.stop),function(r){return e.on(function(e){var o,i,u,a,c,s,l,f,d,m,g,p,h,v=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&10<v){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}e.dragging&&(p=e,o={pageX:(h=Yx(t,r)).pageX-p.relX,pageY:h.pageY+5},m=e.ghost,g=t.getBody(),m.parentNode!==g&&g.appendChild(m),a=e.width,c=e.height,s=e.maxX,l=e.maxY,d=f=0,(i=e.ghost).style.left=(u=o).pageX+"px",i.style.top=u.pageY+"px",u.pageX+a>s&&(f=u.pageX+a-s),u.pageY+c>l&&(d=u.pageY+c-l),i.style.width=a-f+"px",i.style.height=c-d+"px",n(r.clientX,r.clientY))})}}(o,e),s=function(e,t){return function(n){e.on(function(e){var r,o,i,u,a,c;e.dragging&&((u=3===(c=(i=t).selection.getSel().getRangeAt(0).startContainer).nodeType?c.parentNode:c)===(a=e.element)||i.dom.isChildOf(u,a)||Jx(u)||((o=e.element.cloneNode(!0)).removeAttribute("data-mce-selected"),r=o,t.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact(function(){Zx(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()})))}),ew(e)}}(o,e),l=(n=o,function(){n.on(function(e){e.dragging&&r.fire("dragend")}),ew(n)});(r=e).on("mousedown",a),e.on("mousemove",c),e.on("mouseup",s),i.bind(u,"mousemove",c),i.bind(u,"mouseup",l),e.on("remove",function(){i.unbind(u,"mousemove",c),i.unbind(u,"mouseup",l)})})(e),(t=e).on("drop",function(e){var n=void 0!==e.clientX?t.getDoc().elementFromPoint(e.clientX,e.clientY):null;!Jx(n)&&"false"!==t.dom.getContentEditableParent(n)||e.preventDefault()}),e.getParam("block_unsupported_drop",!0,"boolean")&&(r=function(e){var t;e.isDefaultPrevented()||(t=e.dataTransfer)&&(j(t.types,"Files")||0<t.files.length)&&(e.preventDefault(),"drop"===e.type&&Kh(n,"Dropped file type is not supported"))},o=function(e){Sd(n,e.target)&&r(e)},i=function(){var e=ca.DOM,t=n.dom,i=document,u=n.inline?n.getBody():n.getDoc(),a=["drop","dragover"];q(a,function(n){e.bind(i,n,o),t.bind(u,n,r)}),n.on("remove",function(){q(a,function(n){e.unbind(i,n,o),t.unbind(u,n,r)})})},(n=e).on("init",function(){Fr.setEditorTimeout(n,i,0)}))}(e),g=xa(function(){var e,t;c.removed||!c.getBody().contains(document.activeElement)||(e=c.selection.getRng()).collapsed&&(t=jv(c,e,!1),c.selection.setRng(t))},0),(c=e).on("focus",function(){g.throttle()}),c.on("blur",function(){g.cancel()}),(h=e).on("init",function(){h.on("focusin",function(e){var t,n,r=e.target;jn(r)&&(t=xf(h.getBody(),r),n=Hn(t)?t:r,h.selection.getNode()!==n&&Hv(h,n).each(function(e){return h.selection.setRng(e)}))})})}(),{showCaret:m,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(po(e),l(d()),n.scrollIntoView(e))},hideFakeCaret:y,destroy:function(){u.destroy(),t=null}}}(e),function(e){var t=ga(k.none()),n=ga(!1),r=wa(function(t){e.fire("longpress",_e(_e({},t),{type:"longpress"})),n.set(!0)},400);e.on("touchstart",function(e){Zb(e).each(function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(k.some(i))})},!0),e.on("touchmove",function(o){r.cancel(),Zb(o).each(function(r){t.get().each(function(o){var i,u,a,c;i=r,u=o,a=Math.abs(i.clientX-u.x),c=Math.abs(i.clientY-u.y),(5<a||5<c)&&(t.set(k.none()),n.set(!1),e.fire("longpresscancel"))})})},!0),e.on("touchend touchcancel",function(o){r.cancel(),"touchcancel"!==o.type&&t.get().filter(function(e){return e.target.isEqualNode(o.target)}).each(function(){n.get()?o.preventDefault():e.fire("tap",_e(_e({},o),{type:"tap"}))})},!0)}(e),function(e){var t,n;(t=e).on("click",function(e){t.dom.getParent(e.target,"details")&&e.preventDefault()}),(n=e).parser.addNodeFilter("details",function(e){q(e,function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")})}),n.serializer.addNodeFilter("details",function(e){q(e,function(e){var t=e.attr("data-mce-open");e.attr("open",E(t)?t:null),e.attr("data-mce-open",null)})})}(e),Jp(e)||function(e){e.on("click",function(t){var n,r,o,i,u;3<=t.detail&&(o=(n=e).selection.getRng(),i=hc.fromRangeStart(o),u=hc.fromRangeEnd(o),hc.isElementPosition(i)&&(r=i.container(),Xx(r)&&sl(r).each(function(e){return o.setStart(e.container(),e.offset())})),hc.isElementPosition(u)&&(r=i.container(),Xx(r)&&ll(r).each(function(e){return o.setEnd(e.container(),e.offset())})),n.selection.setRng(Sg(o)))})}(e);var m,g,p=Jp(m=e)?ga(null):function(e){var t,n=function(e){var t=ga(null),n=f(bv,e);return e.on("NodeChange",function(r){var o,i,u,a,c,s,l,d,m,g;!es(e)||yt.browser.isIE()&&r.initial||(s=n,l=r.parents,d=W(Ta(At(e.dom.getRoot()),'*[data-mce-selected="inline-boundary"]'),function(e){return e.dom}),m=$(d,s),g=$(l,s),q(te(m,g),f(Bb,!1)),q(te(g,m),f(Bb,!0)),function(e,t){var n,r;e.selection.isCollapsed()&&!0!==e.composing&&t.get()&&(n=hc.fromRangeStart(e.selection.getRng()),hc.isTextPosition(n)&&!1===(lo(r=n)||fo(r))&&(Nb(e,ss(t.get(),n)),t.set(null)))}(e,t),o=n,u=t,a=r.parents,(i=e).selection.isCollapsed()&&(c=$(a,o),q(c,function(e){var t=hc.fromRangeStart(i.selection.getRng());wb(o,i.getBody(),t).bind(function(e){return Db(i,u,e)})})))}),t}(e);return(t=e).on("keyup compositionstart",f(ry,t)),function(e,t){e.on("keydown",function(n){var r,o,i,u;!1===n.isDefaultPrevented()&&(r=e,o=t,i=n,u=lt().os,Gy([{keyCode:Sf.RIGHT,action:qy(Fy,r,!0)},{keyCode:Sf.LEFT,action:qy(Fy,r,!1)},{keyCode:Sf.UP,action:qy(zy,r,!1)},{keyCode:Sf.DOWN,action:qy(zy,r,!0)},{keyCode:Sf.RIGHT,action:qy(ux,r,!0)},{keyCode:Sf.LEFT,action:qy(ux,r,!1)},{keyCode:Sf.UP,action:qy(ax,r,!1)},{keyCode:Sf.DOWN,action:qy(ax,r,!0)},{keyCode:Sf.RIGHT,action:qy($y,r,!0)},{keyCode:Sf.LEFT,action:qy($y,r,!1)},{keyCode:Sf.UP,action:qy(Xy,r,!1)},{keyCode:Sf.DOWN,action:qy(Xy,r,!0)},{keyCode:Sf.RIGHT,action:qy(Pb,r,o,!0)},{keyCode:Sf.LEFT,action:qy(Pb,r,o,!1)},{keyCode:Sf.RIGHT,ctrlKey:!u.isOSX(),altKey:u.isOSX(),action:qy(Ib,r,o)},{keyCode:Sf.LEFT,ctrlKey:!u.isOSX(),altKey:u.isOSX(),action:qy(Lb,r,o)},{keyCode:Sf.UP,action:qy(Wy,r,!1)},{keyCode:Sf.DOWN,action:qy(Wy,r,!0)}],i).each(function(e){i.preventDefault()}))})}(e,n),function(e,t){e.on("keydown",function(n){var r,o,i;!1===n.isDefaultPrevented()&&(o=t,i=n,Gy([{keyCode:Sf.BACKSPACE,action:qy(Jb,r=e,!1)},{keyCode:Sf.BACKSPACE,action:qy(Zv,r,!1)},{keyCode:Sf.DELETE,action:qy(Zv,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(Gv,r,!1)},{keyCode:Sf.DELETE,action:qy(Gv,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(Hb,r,o,!1)},{keyCode:Sf.DELETE,action:qy(Hb,r,o,!0)},{keyCode:Sf.BACKSPACE,action:qy(Cg,r,!1)},{keyCode:Sf.DELETE,action:qy(Cg,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(eb,r,!1)},{keyCode:Sf.DELETE,action:qy(eb,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(Wb,r,!1)},{keyCode:Sf.DELETE,action:qy(Wb,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(Iv,r,!1)},{keyCode:Sf.DELETE,action:qy(Iv,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(Pv,r,!1)},{keyCode:Sf.DELETE,action:qy(Pv,r,!0)},{keyCode:Sf.BACKSPACE,action:qy(jb,r,!1)},{keyCode:Sf.DELETE,action:qy(jb,r,!0)}],i).each(function(e){i.preventDefault()}))}),e.on("keyup",function(t){var n,r;!1===t.isDefaultPrevented()&&(r=t,Gy([{keyCode:Sf.BACKSPACE,action:qy(Qv,n=e)},{keyCode:Sf.DELETE,action:qy(Qv,n)}],r))})}(e,n),function(e){e.on("keydown",function(t){var n,r,o;t.keyCode===Sf.ENTER&&(n=e,(r=t).isDefaultPrevented()||(r.preventDefault(),(o=n.undoManager).typing&&(o.typing=!1,o.add()),n.undoManager.transact(function(){!1===n.selection.isCollapsed()&&n.execCommand("Delete"),Hx(n,r)})))})}(e),function(e){e.on("keydown",function(t){var n;!1===t.isDefaultPrevented()&&(n=t,Gy([{keyCode:Sf.SPACEBAR,action:qy(qx,e)}],n).each(function(e){n.preventDefault()}))})}(e),function(e){var t,n;t=e,n=xa(function(){t.composing||Um(t)},0),Vx.isIE()&&(t.on("keypress",function(e){n.throttle()}),t.on("remove",function(e){n.cancel()})),e.on("input",function(t){!1===t.isComposing&&Um(e)})}(e),function(e){e.on("keydown",function(t){var n,r;!1===t.isDefaultPrevented()&&(r=t,Gy([{keyCode:Sf.END,action:qy(Hy,n=e,!0)},{keyCode:Sf.HOME,action:qy(Hy,n,!1)},{keyCode:Sf.END,action:qy(Ky,n,!0)},{keyCode:Sf.HOME,action:qy(Ky,n,!1)}],r).each(function(e){r.preventDefault()}))})}(e),n}(m);(function(e,t){e.addCommand("delete",function(){var n,r;r=t,Jb(n=e)||Zv(n,!1)||Gv(n,!1)||Hb(n,r,!1)||Pv(n,!1)||Cg(n)||eb(n,!1)||Wb(n,!1)||Iv(n)||jb(n,!1)||(Qb(n,"Delete"),kv(n))}),e.addCommand("forwardDelete",function(){var n,r;r=t,Zv(n=e,!0)||Gv(n,!0)||Hb(n,r,!0)||Pv(n,!0)||Cg(n)||eb(n,!0)||Wb(n,!0)||Iv(n)||jb(n,!0)||Qb(n,"ForwardDelete")})})(e,p),Uc(g=e)&&g.on("NodeChange",f(ty,g)),function(e){var t,n=e.dom,r=Uc(e),o=(t=e).getParam("placeholder",Hc.getAttrib(t.getElement(),"placeholder"),"string"),i=function(t,u){var a,c,s;!function(e){if(pv(e)){var t=e.keyCode;return!hv(e)&&(Sf.metaKeyPressed(e)||e.altKey||112<=t&&t<=123||j(mv,t))}return!1}(t)&&(a=e.getBody(),c=!(pv(s=t)&&!(hv(s)||"keyup"===s.type&&229===s.keyCode))&&function(e,t,n){if(Do(At(t),!1)){var r=""===n,o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(o):n===o.nodeName.toLowerCase())}return!1}(n,a,r),""!==n.getAttrib(a,gv)===c&&!u||(n.setAttrib(a,gv,c?o:null),n.setAttrib(a,"aria-placeholder",c?o:null),e.fire("PlaceholderToggle",{state:c}),e.on(c?"keydown":"keyup",i),e.off(c?"keyup":"keydown",i)))};o&&e.on("init",function(t){i(t,!0),e.on("change SetContent ExecCommand",i),e.on("paste",function(t){return Fr.setEditorTimeout(e,function(){return i(t)})})})}(e),e.fire("PreInit"),function(e){var t=e;return pe(e.plugins,"rtc").fold(function(){return t.rtcInstance=Yp(e),k.none()},function(e){return k.some(e.setup().then(function(e){var n,r,o,i,u,c,s,l;return t.rtcInstance=(r=function(e){return A(e)?e:{}},o=h("Unimplemented feature for rtc"),i=(n=e).undoManager,u=n.formatter,c=n.editor,s=n.selection,l=n.raw,{undoManager:{beforeChange:a,addUndoLevel:o,undo:function(){return i.undo()},redo:function(){return i.redo()},clear:function(){return i.clear()},reset:function(){return i.reset()},hasUndo:function(){return i.hasUndo()},hasRedo:function(){return i.hasRedo()},transact:function(e,t,n){return i.transact(n)},ignore:function(e,t){return i.ignore(t)},extra:function(e,t,n,r){return i.extra(n,r)}},formatter:{match:function(e,t,n){return u.match(e,r(t))},matchAll:o,matchNode:o,canApply:function(e){return u.canApply(e)},closest:function(e){return u.closest(e)},apply:function(e,t,n){return u.apply(e,r(t))},remove:function(e,t,n,o){return u.remove(e,r(t))},toggle:function(e,t,n){return u.toggle(e,r(t))},formatChanged:function(e,t,n,r){return u.formatChanged(t,n,r)}},editor:{getContent:function(e,t){return c.getContent(e)},setContent:function(e,t){return c.setContent(e,t)},insertContent:function(e,t){return c.insertContent(e)},addVisual:a},selection:{getContent:function(e,t){return s.getContent(t)}},raw:{getModel:function(){return k.some(l.getRawModel())}}}),e.rtc.isRemote},function(e){var n,r;return t.rtcInstance=(n=s(null),r=s(""),{undoManager:{beforeChange:a,addUndoLevel:n,undo:n,redo:n,clear:a,reset:a,hasUndo:y,hasRedo:y,transact:n,ignore:a,extra:a},formatter:{match:y,matchAll:s([]),matchNode:y,canApply:y,closest:r,apply:a,remove:a,toggle:a,formatChanged:s({unbind:a})},editor:{getContent:r,setContent:r,insertContent:a,addVisual:a},selection:{getContent:r},raw:{getModel:s(k.none())}}),Er.reject(e)}))})}(e).fold(function(){cw(e,!1)},function(t){e.setProgressState(!0),t.then(function(t){e.setProgressState(!1),cw(e,t)},function(t){e.notificationManager.open({type:"error",text:String(t)}),cw(e,!0)})})},lw=ca.DOM,fw=ca.DOM,dw=function(e,t,n){var r=qh.get(n),o=qh.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=kt.trim(n),r&&-1===kt.inArray(t,n)){if(kt.each(qh.dependencies(n),function(n){dw(e,t,n)}),e.plugins[n])return;try{var i=new r(e,o,e.$);(e.plugins[n]=i).init&&(i.init(e,o),t.push(n))}catch(rS){!function(e,t,n){var r=ba.translate(["Failed to initialize plugin: {0}",t]);Cf(e,"PluginLoadError",{message:r}),Zh(r,n),Kh(e,r)}(e,n,rS)}}},mw=function(e){return e.replace(/^\-/,"")},gw=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},pw=function(e){var t,n,r,o,i,u,c,s,l;e.fire("ScriptsLoaded"),n=kt.trim(Gc(t=e)),r=t.ui.registry.getAll().icons,o=_e(_e({},Ih.get("default").icons),Ih.get(n).icons),ce(o,function(e,n){he(r,n)||t.ui.registry.addIcon(n,e)}),c=Zc(i=e),E(c)?(i.settings.theme=mw(c),u=Gh.get(c),i.theme=new u(i,Gh.urls[c]),i.theme.init&&i.theme.init(i,Gh.urls[c]||i.documentBaseUrl.replace(/\/$/,""),i.$)):i.theme={},l=[],kt.each(ts(s=e).split(/[ ,]/),function(e){dw(s,l,mw(e))});var f,d,m,g=function(e){var t,n,r,o=e.getElement();return e.orgDisplay=o.style.display,E(Zc(e))?e.theme.renderUI():I(Zc(e))?(n=(t=e).getElement(),(r=Zc(t)(t,n)).editorContainer.nodeType&&(r.editorContainer.id=r.editorContainer.id||t.id+"_parent"),r.iframeContainer&&r.iframeContainer.nodeType&&(r.iframeContainer.id=r.iframeContainer.id||t.id+"_iframecontainer"),r.height=r.iframeHeight?r.iframeHeight:n.offsetHeight,r):function(e){var t,n,r=e.getElement();return e.inline?gw(null):(t=r,n=fw.create("div"),fw.insertAfter(n,t),gw(n))}(e)}(e);f=e,d=k.from(g.api).getOr({}),m={show:k.from(d.show).getOr(a),hide:k.from(d.hide).getOr(a),disable:k.from(d.disable).getOr(a),isDisabled:k.from(d.isDisabled).getOr(y),enable:function(){f.mode.isReadOnly()||k.from(d.enable).map(b)}},f.ui=_e(_e({},f.ui),m);var p,h,v,x={editorContainer:g.editorContainer,iframeContainer:g.iframeContainer};return e.editorContainer=x.editorContainer?x.editorContainer:null,function(e){var t;e.contentCSS=e.contentCSS.concat(function(e){return ev(e,(n=(t=e).getParam("content_css"),E(n)?W(n.split(","),Ve):R(n)?n:!1===n||t.inline?[]:["default"]));var t,n}(e),ev(t=e,Yc(t)))}(e),e.inline?sw(e):(v=function(e,t){var n,r,o,i,u=e.editorManager.translate("Rich Text Area. Press ALT-0 for help."),a=(n=e.id,r=u,o=e.getParam("iframe_attrs",{}),i=Tt("iframe"),Gn(i,o),Gn(i,{id:n+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),ka(i,"tox-edit-area__iframe"),i.dom);a.onload=function(){a.onload=null,e.fire("load")};var c=function(e,t){if(document.domain!==window.location.hostname&&yt.browser.isIE()){var n=rv("mce");e[n]=function(){sw(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return lw.setAttrib(t,"src",r),!0}return!1}(e,a);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=a,e.iframeHTML=function(e){var t=e.getParam("doctype","<!DOCTYPE html>")+"<html><head>";e.getParam("document_base_url","")!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=Vc(e,"body_id","tinymce"),r=Vc(e,"body_class","");return jc(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+jc(e)+'" />'),t+'</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'"><br></body></html>'}(e),lw.add(t.iframeContainer,a),c}(p=e,h=x),h.editorContainer&&(lw.get(h.editorContainer).style.display=p.orgDisplay,p.hidden=lw.isHidden(h.editorContainer)),p.getElement().style.display="none",lw.setAttrib(p.id,"aria-hidden","true"),void(v||sw(p)))},hw=ca.DOM,vw=function(e){return"-"===e.charAt(0)},bw=function(e,t,n){return k.from(t).filter(function(e){return 0<e.length&&!Ih.has(e)}).map(function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:k.some(t)}})},yw={"font-size":"size","font-family":"face"},xw=function(e){return function(t,n){return k.from(n).map(At).filter(Ft).bind(function(n){return function(e,t,n){return Bg(At(n),function(t){return Qn(n=t,e).orThunk(function(){return"font"===Mt(n)?pe(yw,e).bind(function(e){return Xn(n,e)}):k.none()});var n},function(e){return Dt(At(t),e)})}(e,t,n.dom).or(k.from(ca.DOM.getStyle(n.dom,e,!0)))}).getOr("")}},ww=xw("font-size"),Cw=c(function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},xw("font-family")),Sw=function(e){return sl(e.getBody()).map(function(e){var t=e.container();return Dn(t)?t.parentNode:t})},kw=function(e,t){return k.from((n=e).selection.getRng()).bind(function(e){var t=n.getBody();return e.startContainer===t&&0===e.startOffset?k.none():k.from(n.selection.getStart(!0))}).orThunk(f(Sw,e)).map(At).filter(Ft).map(t);var n},Ow=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(1<=n&&n<=7){var r=kt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large")),o=kt.explode(e.getParam("font_size_classes",""));return o?o[n-1]||t:r[n-1]||t}return t}return t},_w=kt.each,Tw=kt.map,Ew=kt.inArray,Aw=(Rw.prototype.execCommand=function(e,t,n,r){var i,u,a=!1,c=this;if(!c.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?xd(u=c.editor).each(function(e){return u.selection.setRng(e)}):c.editor.focus(),(r=c.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var s=e.toLowerCase();if(i=c.commands.exec[s])return i(s,t,n),c.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(_w(this.editor.plugins,function(r){if(r.execCommand&&r.execCommand(e,t,n))return c.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!(a=!0)}),a)return a;if(c.editor.theme&&c.editor.theme.execCommand&&c.editor.theme.execCommand(e,t,n))return c.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{a=c.editor.getDoc().execCommand(e,t,n)}catch(o){}return!!a&&(c.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},Rw.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(m){}return!1}},Rw.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(m){}}},Rw.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;_w(e,function(e,r){_w(r.toLowerCase().split(","),function(r){n.commands[t][r]=e})})},Rw.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,o,i,u){return t.call(n||r.editor,o,i,u)}},Rw.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(t){}return!1},Rw.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},Rw.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},Rw.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},Rw.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},Rw.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},Rw.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},Rw.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},Rw.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},Rw.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":a,"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(n){var r,o,i=e.getDoc();try{t.execNativeCommand(n)}catch(l){r=!0}"paste"!==n||i.queryCommandEnabled(n)||(r=!0),!r&&i.queryCommandSupported(n)||(o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."),yt.mac&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"}))},unlink:function(){var t;e.selection.isCollapsed()?(t=e.dom.getParent(e.selection.getStart(),"a"))&&e.dom.remove(t,!0):e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),_w("left,center,right,justify".split(","),function(t){r!==t&&e.formatter.remove("align"+t)}),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");o&&/^(H[1-6]|P|ADDRESS|PRE)$/.test((r=o.parentNode).nodeName)&&(t.storeSelection(),e.dom.split(r,o),t.restoreSelection())},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,r)},FontName:function(t,n,r){!function(e,t){var n,r=Ow(e,t);e.formatter.toggle("fontname",{value:(n=r.split(/\s*,\s*/),W(n,function(e){return-1===e.indexOf(" ")||ze(e,'"')||ze(e,"'")?e:"'"+e+"'"}).join(","))}),e.nodeChanged()}(e,r)},FontSize:function(t,n,r){var o;(o=e).formatter.toggle("fontsize",{value:Ow(o,r)}),o.nodeChanged()},LineHeight:function(t,n,r){var o,i;i=r,(o=e).undoManager.transact(function(){o.formatter.toggle("lineheight",{value:String(i)}),o.nodeChanged()})},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,o){var i=o||e.selection.getNode();i!==e.getBody()&&(t.storeSelection(),e.dom.remove(i,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var o=0;e.dom.getParent(e.selection.getNode(),function(t){if(1===t.nodeType&&o++===r)return e.selection.select(t),!1},e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){!function(e,t){var n,r,o,i,u="string"!=typeof(n=t)?(r=kt.extend({paste:n.paste,data:{paste:n.paste}},n),{content:n.content,details:r}):{content:n,details:{}};o=u.content,i=u.details,Qp(e).editor.insertContent(o,i)}(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,function(){return r}))},mceInsertNewLine:function(t,n,r){Hx(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){Yb(e,t)},mceRepaint:a,InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"==typeof r&&(r={href:r});var o=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),o&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,o)},selectAll:function(){var t,n=e.dom.getParent(e.selection.getStart(),zn);n&&((t=e.dom.createRng()).selectNodeContents(n),e.selection.setRng(t))},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return Tx(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),o=Tw(r,function(n){return!!e.formatter.matchNode(n,t)});return-1!==Ew(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return $b(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",function(){return kw(t=e,function(e){return Cw(t.getBody(),e.dom)}).getOr("");var t},this),t.addQueryValueHandler("FontSize",function(){return kw(t=e,function(e){return ww(t.getBody(),e.dom)}).getOr("");var t},this),t.addQueryValueHandler("LineHeight",function(){return kw(t=e,function(e){var n=At(t.getBody());return Bg(e,function(e){return Qn(e,"line-height")},f(Dt,n)).getOrThunk(function(){var t=parseFloat(Yn(e,"line-height")),n=parseFloat(Yn(e,"font-size"));return String(t/n)})}).getOr("");var t},this)},Rw);function Rw(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}var Nw="data-mce-contenteditable",Bw=function(t,n,r){try{t.getDoc().execCommand(n,!1,String(r))}catch(e){}},Dw=function(e,t){e.dom.contentEditable=t?"true":"false"},Pw=function(e){return e.readonly},Mw=function(e){e.parser.addAttributeFilter("contenteditable",function(t){Pw(e)&&q(t,function(e){e.attr(Nw,e.attr("contenteditable")),e.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(Nw,function(t){Pw(e)&&q(t,function(e){e.attr("contenteditable",e.attr(Nw))})}),e.serializer.addTempAttr(Nw)},Iw=kt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),Lw=(Fw.isNative=function(e){return!!Iw[e.toLowerCase()]},Fw.prototype.fire=function(e,t){var n=e.toLowerCase(),r=t||{};r.type=n,r.target||(r.target=this.scope),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=x},r.stopPropagation=function(){r.isPropagationStopped=x},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=x},r.isDefaultPrevented=y,r.isPropagationStopped=y,r.isImmediatePropagationStopped=y),this.settings.beforeFire&&this.settings.beforeFire(r);var o=this.bindings[n];if(o)for(var i=0,u=o.length;i<u;i++){var a=o[i];if(a.once&&this.off(n,a.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===a.func.call(this.scope,r))return r.preventDefault(),r}return r},Fw.prototype.on=function(e,t,n,r){if(!1===t&&(t=y),t){var o={func:t};r&&kt.extend(o,r);for(var i=e.toLowerCase().split(" "),u=i.length;u--;){var a=i[u],c=this.bindings[a];c||(c=this.bindings[a]=[],this.toggleEvent(a,!0)),n?c.unshift(o):c.push(o)}}return this},Fw.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),o=r.length;o--;){var i=r[o],u=this.bindings[i];if(!i)return ce(this.bindings,function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]}),this;if(u){if(t)for(var a=u.length;a--;)u[a].func===t&&(u=u.slice(0,a).concat(u.slice(a+1)),this.bindings[i]=u);else u.length=0;u.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else ce(this.bindings,function(e,t){n.toggleEvent(t,!1)}),this.bindings={};return this},Fw.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},Fw.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},Fw);function Fw(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||y}var zw,Hw=function(e){return e._eventDispatcher||(e._eventDispatcher=new Lw({scope:e,toggleEvent:function(t,n){Lw.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},Vw={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=Hw(this).fire(e,t);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},on:function(e,t,n){return Hw(this).on(e,t,n)},off:function(e,t){return Hw(this).off(e,t)},once:function(e,t){return Hw(this).once(e,t)},hasEventListeners:function(e){return Hw(this).has(e)}},jw=ca.DOM,Uw=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=Qc(e);return n?(e.eventRoot||(e.eventRoot=jw.select(n)[0]),e.eventRoot):e.getBody()},Ww=function(e,t,n){var r;(r=e).hidden||Pw(r)?Pw(e)&&function(e,t){var n,r;"click"!==t.type||Sf.metaKeyPressed(t)||(n=At(t.target),r=e,Tr(n,"a",function(e){return Dt(e,At(r.getBody()))}).bind(function(e){return Xn(e,"href")}).each(function(n){var r,o,i,u;t.preventDefault(),/^#/.test(n)?(r=e.dom.select(n+',[name="'+(ze(o=n,"#")?(i=o,u="#".length,i.substring(u)):o)+'"]')).length&&e.selection.scrollIntoView(r[0],!0):window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))}(e,n):e.fire(t,n)},qw=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=Uw(e,t);if(Qc(e)){if(zw||(zw={},e.editorManager.on("removeEditor",function(){e.editorManager.activeEditor||zw&&(ce(zw,function(t,n){e.dom.unbind(Uw(e,n))}),zw=null)})),zw[t])return;zw[t]=n=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var u=o[i].getBody();u!==r&&!jw.isChildOf(r,u)||Ww(o[i],t,n)}},jw.bind(r,t,n)}else jw.bind(r,t,n=function(n){Ww(e,t,n)}),e.delegates[t]=n}},Gw=_e(_e({},Vw),{bindPendingEventDelegates:function(){var e=this;kt.each(e._pendingNativeEvents,function(t){qw(e,t)})},toggleNativeEvent:function(e,t){var n=this;"focus"!==e&&"blur"!==e&&(t?n.initialized?qw(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(Uw(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(ce(e.delegates,function(t,n){e.dom.unbind(Uw(e,n),n,t)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),$w=["design","readonly"],Xw=function(e,t,n,r){var o=n[t.get()],i=n[r];try{i.activate()}catch(rS){return void console.error("problem while activating editor mode "+r+":",rS)}o.deactivate(),o.editorReadOnly!==i.editorReadOnly&&function(e,t){var n,r,o=At(e.getBody());(function(e,t,n){var r,o;Oa(e,t)&&!1===n?(o=t,Sa(r=e)?r.dom.classList.remove(o):function(e,t){return 0<(o=$(Ca(n=e,r="class"),function(e){return"mce-content-readonly"!==e})).length?qn(n,r,o.join(" ")):Kn(n,r),!1;var n,r,o}(r),function(e){0===(Sa(e)?e.dom.classList:Ca(e,"class")).length&&Kn(e,"class")}(r)):n&&ka(e,t)})(o,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),k.from(e.selection.getNode()).each(function(e){e.removeAttribute("data-mce-selected")}),e.readonly=!0,Dw(o,!1),q(Ta(o,'*[contenteditable="true"]'),function(e){qn(e,Nw,"true"),Dw(e,!1)})):(e.readonly=!1,Dw(o,!0),q(Ta(o,"*["+Nw+'="true"]'),function(e){Kn(e,Nw),Dw(e,!0)}),Bw(e,"StyleWithCSS",!1),Bw(e,"enableInlineTableEditing",!1),Bw(e,"enableObjectResizing",!1),(Ed(r=e)||function(e){var t=nn(At(e.getElement()));return sd(t).filter(function(t){return!(void 0!==(n=t.dom.classList)&&(n.contains("tox-edit-area")||n.contains("tox-edit-area__iframe")||n.contains("mce-content-body")))&&Sd(e,t.dom);var n}).isSome()}(r))&&e.focus(),(n=e).selection.setRng(n.selection.getRng()),e.nodeChanged())}(e,i.editorReadOnly),t.set(r),e.fire("SwitchMode",{mode:r})},Kw=kt.each,Yw=kt.explode,Jw={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Qw=kt.makeMap("alt,ctrl,shift,meta,access"),Zw=function(e){var t,n={};Kw(Yw(e.toLowerCase(),"+"),function(e){e in Qw?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=Jw[e]||e.toUpperCase().charCodeAt(0))});var r=[n.keyCode];for(t in Qw)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,yt.mac?n.ctrl=!0:n.shift=!0),n.meta&&(yt.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},eC=(tC.prototype.add=function(e,t,n,r){var o=this,i=o.normalizeCommandFunc(n);return Kw(Yw(kt.trim(e)),function(e){var n=o.createShortcut(e,t,i,r);o.shortcuts[n.id]=n}),!0},tC.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},tC.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:kt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},tC.prototype.createShortcut=function(e,t,n,r){var o=kt.map(Yw(e,">"),Zw);return o[o.length-1]=kt.extend(o[o.length-1],{func:n,scope:r||this.editor}),kt.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})},tC.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},tC.prototype.isFunctionKey=function(e){return"keydown"===e.type&&112<=e.keyCode&&e.keyCode<=123},tC.prototype.matchShortcut=function(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)},tC.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},tC);function tC(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(Kw(t.shortcuts,function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0}),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))})}var nC=function(){var e,t,n,r,o,i,u,a,c=(t={},n={},r={},o={},i={},u={},{addButton:(a=function(e,t){return function(n,r){return e[n.toLowerCase()]=_e(_e({},r),{type:t})}})(e={},"button"),addGroupToolbarButton:a(e,"grouptoolbarbutton"),addToggleButton:a(e,"togglebutton"),addMenuButton:a(e,"menubutton"),addSplitButton:a(e,"splitbutton"),addMenuItem:a(t,"menuitem"),addNestedMenuItem:a(t,"nestedmenuitem"),addToggleMenuItem:a(t,"togglemenuitem"),addAutocompleter:a(n,"autocompleter"),addContextMenu:a(o,"contextmenu"),addContextToolbar:a(i,"contexttoolbar"),addContextForm:a(i,"contextform"),addSidebar:a(u,"sidebar"),addIcon:function(e,t){return r[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:o,contextToolbars:i,sidebars:u}}});return{addAutocompleter:c.addAutocompleter,addButton:c.addButton,addContextForm:c.addContextForm,addContextMenu:c.addContextMenu,addContextToolbar:c.addContextToolbar,addIcon:c.addIcon,addMenuButton:c.addMenuButton,addMenuItem:c.addMenuItem,addNestedMenuItem:c.addNestedMenuItem,addSidebar:c.addSidebar,addSplitButton:c.addSplitButton,addToggleButton:c.addToggleButton,addGroupToolbarButton:c.addGroupToolbarButton,addToggleMenuItem:c.addToggleMenuItem,getAll:c.getAll}},rC=kt.each,oC=kt.trim,iC="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),uC={ftp:21,http:80,https:443,mailto:25},aC=(cC.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},cC.getDocumentBaseUrl=function(e){var t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname;return/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},cC.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},cC.prototype.toRelative=function(e){var t;if("./"===e)return e;var n=new cC(e,{base_uri:this});if("mce_host"!==n.host&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&""!==n.protocol)return n.getURI();var r=this.getURI(),o=n.getURI();return r===o||"/"===r.charAt(r.length-1)&&r.substr(0,r.length-1)===o?r:(t=this.toRelPath(this.path,n.path),n.query&&(t+="?"+n.query),n.anchor&&(t+="#"+n.anchor),t)},cC.prototype.toAbsolute=function(e,t){var n=new cC(e,{base_uri:this});return n.getURI(t&&this.isSameOrigin(n))},cC.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=uC[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},cC.prototype.toRelPath=function(e,t){var n,r,o=0,i="",u=e.substring(0,e.lastIndexOf("/")).split("/"),a=t.split("/");if(u.length>=a.length)for(n=0,r=u.length;n<r;n++)if(n>=a.length||u[n]!==a[n]){o=n+1;break}if(u.length<a.length)for(n=0,r=a.length;n<r;n++)if(n>=u.length||u[n]!==a[n]){o=n+1;break}if(1===o)return t;for(n=0,r=u.length-(o-1);n<r;n++)i+="../";for(n=o-1,r=a.length;n<r;n++)i+=n!==o-1?"/"+a[n]:a[n];return i},cC.prototype.toAbsPath=function(e,t){var n,r,o=0,i=[],u=/\/$/.test(t)?"/":"",a=e.split("/"),c=t.split("/");for(rC(a,function(e){e&&i.push(e)}),a=i,n=c.length-1,i=[];0<=n;n--)0!==c[n].length&&"."!==c[n]&&(".."!==c[n]?0<o?o--:i.push(c[n]):o++);return 0!==(r=(n=a.length-o)<=0?ee(i).join("/"):a.slice(0,n).join("/")+"/"+ee(i).join("/")).indexOf("/")&&(r="/"+r),u&&r.lastIndexOf("/")!==r.length-1&&(r+=u),r},cC.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(t+=this.protocol?this.protocol+"://":"//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},cC);function cC(e,t){e=oC(e),this.settings=t||{};var n,r,o,i,u=this.settings.base_uri,a=this;/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)?a.source=e:(n=0===e.indexOf("//"),0!==e.indexOf("/")||n||(e=(u&&u.protocol||"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(r=this.settings.base_uri?this.settings.base_uri.path:new cC(document.location.href).directory,e=this.settings.base_uri&&""==this.settings.base_uri.protocol?"//mce_host"+a.toAbsPath(r,e):(o=/([^#?]*)([#?]?.*)/.exec(e),(u&&u.protocol||"http")+"://mce_host"+a.toAbsPath(r,o[1])+o[2])),e=e.replace(/@@/g,"(mce_at)"),i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),rC(iC,function(e,t){var n=(n=i[t])&&n.replace(/\(mce_at\)/g,"@@");a[e]=n}),u&&(a.protocol||(a.protocol=u.protocol),a.userInfo||(a.userInfo=u.userInfo),a.port||"mce_host"!==a.host||(a.port=u.port),a.host&&"mce_host"!==a.host||(a.host=u.host),a.source=""),n&&(a.protocol=""))}var sC=ca.DOM,lC=kt.extend,fC=kt.each,dC=kt.resolve,mC=yt.ie,gC=(pC.prototype.render=function(){!function(e){var t=e.id;ba.setCode(Xc(e));var n,r,o,i,u=function(){hw.unbind(window,"ready",u),e.render()};hi.Event.domLoaded?e.getElement()&&yt.contentEditable&&(n=At(e.getElement()),r=K(n.dom.attributes,function(e,t){return e[t.name]=t.value,e},{}),e.on("remove",function(){G(n.dom.attributes,function(e){return Kn(n,e.name),0}),Gn(n,r)}),e.ui.styleSheetLoader=Hr.forElement(n,{contentCssCors:(o=e).getParam("content_css_cors"),referrerPolicy:$c(o)}),e.getParam("inline")?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden"),(i=e.getElement().form||hw.getParent(t,"form"))&&(e.formElement=i,e.getParam("hidden_input")&&!Bn(e.getElement())&&(hw.insertAfter(hw.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},hw.bind(i,"submit reset",e.formEventDelegate),e.on("reset",function(){e.resetContent()}),!e.getParam("submit_patch")||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),i._mceOldSubmit(i)})),e.windowManager=$h(e),e.notificationManager=Wh(e),"xml"===e.getParam("encoding")&&e.on("GetContent",function(e){e.save&&(e.content=hw.encode(e.content))}),e.getParam("add_form_submit_trigger")&&e.on("submit",function(){e.initialized&&e.save()}),e.getParam("add_unload_trigger")&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),function(e,t){var n,r,o,i,u,c,s=da.ScriptLoader;n=s,o=t,i=function(){var n,r;(function(e,t){var n,r=Xc(t),o=t.getParam("language_url","","string");!1===ba.hasCode(r)&&"en"!==r&&e.add(n=""!==o?o:t.editorManager.baseURL+"/langs/"+r+".js",a,void 0,function(){Yh(t,"LanguageLoadError",Jh("language",n,r))})})(s,e),function(e,t,n){var r=bw(t,"default",n),o=k.from(t.getParam("icons_url","","string")).filter(function(e){return 0<e.length}).map(function(e){return{url:e,name:k.none()}}).orThunk(function(){return bw(t,Gc(t),"")});q(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([r,o]),function(n){e.add(n.url,a,void 0,function(){var e,r,o;e=t,r=n.url,o=n.name.getOrUndefined(),Yh(e,"IconsLoadError",Jh("icons",r,o))})})}(s,e,t),r=t,kt.each((n=e).getParam("external_plugins"),function(e,t){qh.load(t,e,a,void 0,function(){Qh(n,e,t)}),n.settings.plugins+=" "+t}),kt.each(ts(n).split(/[ ,]/),function(e){var t,o;(e=kt.trim(e))&&!qh.urls[e]&&(vw(e)?(e=e.substr(1,e.length),t=qh.dependencies(e),kt.each(t,function(e){var t=qh.createUrl({prefix:"plugins/",resource:e,suffix:"/plugin"+r+".js"},e);qh.load(t.resource,t,a,void 0,function(){Qh(n,t.prefix+t.resource+t.suffix,t.resource)})})):qh.load(e,o={prefix:"plugins/",resource:e,suffix:"/plugin"+r+".js"},a,void 0,function(){Qh(n,o.prefix+o.resource+o.suffix,e)}))}),s.loadQueue(function(){e.removed||pw(e)},e,function(){e.removed||pw(e)})},c=Zc(r=e),E(c)?(vw(c)||Gh.urls.hasOwnProperty(c)||((u=r.getParam("theme_url"))?Gh.load(c,r.documentBaseURI.toAbsolute(u)):Gh.load(c,"themes/"+c+"/theme"+o+".js")),n.loadQueue(function(){Gh.waitFor(c,i)})):i()}(e,e.suffix)):hw.bind(window,"ready",u)}(this)},pC.prototype.focus=function(e){this.removed||(e?Rd:Ad)(this)},pC.prototype.hasFocus=function(){return Ed(this)},pC.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this.settings[e];if(o)return this.callbackLookup&&(r=this.callbackLookup[e])&&(o=r.func,r=r.scope),"string"==typeof o&&(r=(r=o.replace(/\.\w+$/,""))?dC(r):0,o=dC(o),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[e]={func:o,scope:r}),o.apply(r||this,t)},pC.prototype.translate=function(e){return ba.translate(e)},pC.prototype.getParam=function(e,t,n){return function(e,t,n,r){var o,i,u,a=t in e.settings?e.settings[t]:n;return"hash"===r?(u={},"string"==typeof(i=a)?q(0<i.indexOf("=")?i.split(/[;,](?![^=;,]*(?:[;,]|$))/):i.split(","),function(e){var t=e.split("=");u[kt.trim(t[0])]=kt.trim(1<t.length?t[1]:t[0])}):u=i,u):"string"===r?Mh(E,e,t).getOr(n):"number"===r?Mh(L,e,t).getOr(n):"boolean"===r?Mh(B,e,t).getOr(n):"object"===r?Mh(A,e,t).getOr(n):"array"===r?Mh(R,e,t).getOr(n):"string[]"===r?Mh((o=E,function(e){return R(e)&&Z(e,o)}),e,t).getOr(n):"function"===r?Mh(I,e,t).getOr(n):a}(this,e,t,n)},pC.prototype.hasPlugin=function(e,t){return!(!j(ts(this).split(/[ ,]/),e)||t&&void 0===qh.get(e))},pC.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},pC.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},pC.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},pC.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},pC.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},pC.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},pC.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},pC.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},pC.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},pC.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(sC.show(this.getContainer()),sC.hide(this.id)),this.load(),this.fire("show"))},pC.prototype.hide=function(){var e=this,t=e.getDoc();e.hidden||(mC&&t&&!e.inline&&t.execCommand("SelectAll"),e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(sC.hide(e.getContainer()),sC.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.fire("hide"))},pC.prototype.isHidden=function(){return!!this.hidden},pC.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},pC.prototype.load=function(e){var t=this.getElement();if(this.removed)return"";if(t){(e=e||{}).load=!0;var n=Bn(t)?t.value:t.innerHTML,r=this.setContent(n,e);return e.element=t,e.no_events||this.fire("LoadContent",e),e.element=t=null,r}},pC.prototype.save=function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Bn(o)?o.value=t:(!e.is_removing&&r.inline||(o.innerHTML=t),(n=sC.getParent(r.id,"form"))&&fC(n.elements,function(e){if(e.name===r.id)return e.value=t,!1})),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},pC.prototype.setContent=function(e,t){return wh(this,e,t)},pC.prototype.getContent=function(e){return function(e,t){var n,r;return void 0===t&&(t={}),n=t,r=t.format?t.format:"html",Qp(e).editor.getContent(n,r)}(this,e)},pC.prototype.insertContent=function(e,t){t&&(e=lC({content:e},t)),this.execCommand("mceInsertContent",!1,e)},pC.prototype.resetContent=function(e){void 0===e?wh(this,this.startContent,{format:"raw"}):wh(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},pC.prototype.isDirty=function(){return!this.isNotDirty},pC.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},pC.prototype.getContainer=function(){return this.container||(this.container=sC.get(this.editorContainer||this.id+"_parent")),this.container},pC.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},pC.prototype.getElement=function(){return this.targetElm||(this.targetElm=sC.get(this.id)),this.targetElm},pC.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},pC.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},pC.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},pC.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},pC.prototype.addVisual=function(e){!function(e,t){return n=t,Zp(e).editor.addVisual(n);var n}(this,e)},pC.prototype.remove=function(){!function(e){var t,n,r,o,i;e.removed||(t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement(),r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&Ch.remove(o.nextSibling),e.fire("remove"),e.editorManager.remove(e),!e.inline&&r&&Ch.setStyle((i=e).id,"display",i.orgDisplay),e.fire("detach"),Ch.remove(e.getContainer()),Sh(t),Sh(n),e.destroy())}(this)},pC.prototype.destroy=function(e){!function(e,t){var n,r,o,i=e.selection,u=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Sh(i),Sh(u)),(r=(n=e).formElement)&&(r._mceOldSubmit&&(r.submit=r._mceOldSubmit,r._mceOldSubmit=null),Ch.unbind(r,"submit reset",n.formEventDelegate)),(o=e).contentAreaContainer=o.formElement=o.container=o.editorContainer=null,o.bodyElement=o.contentDocument=o.contentWindow=null,o.iframeElement=o.targetElm=null,o.selection&&(o.selection=o.selection.win=o.selection.dom=o.selection.dom.doc=null),e.destroyed=!0):e.remove())}(this,e)},pC.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},pC.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},pC.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},pC.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},pC.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},pC.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},pC);function pC(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,lC(this,Gw),this.settings=function(e,t,n,r,o){var i,u,a,c,l=(i=n,u=Th,a=e,c={id:t,theme:"silver",toolbar_mode:Ph(o,"floating"),plugins:"",document_base_url:i,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:a.convertURL,url_converter_scope:a},_e(_e({},c),u?Nh:{}));return function(e,t,n,r,o){var i,u,a,c,l,d,m=e?{mobile:(i=o.mobile||{},u=t,a={resize:!1,toolbar_mode:Ph(i,"scrolling"),toolbar_sticky:!1},_e(_e(_e({},Nh),a),u?{menubar:!1}:{}))}:{},g=function(e,t){var n,r=me(t,function(t,n){return j(e,n)});return n=r.f,{sections:s(r.t),settings:s(n)}}(["mobile"],Oh(m,o)),p=kt.extend(n,r,g.settings(),e&&Dh(g,"mobile")?function(e,t,n){void 0===n&&(n={});var r=e.sections(),o=r.hasOwnProperty(t)?r[t]:{};return kt.extend({},n,o)}(g,"mobile"):{},{validate:!0,external_plugins:(c=r,l=g.settings(),d=l.external_plugins?l.external_plugins:{},c&&c.external_plugins?kt.extend({},c.external_plugins,d):d)});return function(e,t,n,r){var o,i,u=Bh(n.forced_plugins),a=Bh(r.plugins),c=Dh(o=t,"mobile")?o.sections().mobile:{},s=function(e,t,n,r){return e&&(u=i="mobile",a=(o=t).sections(),Dh(o,i)&&a[i].theme===u)?$(r,f(j,Rh)):e&&Dh(t,"mobile")?r:n;var o,i,u,a}(e,t,a,c.plugins?Bh(c.plugins):a),l=(i=s,[].concat(Bh(u)).concat(Bh(i)));if(yt.browser.isIE()&&j(l,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return kt.extend(r,{plugins:l.join(" ")})}(e,g,r,p)}(Eh||Ah,Eh,l,r,o)}(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(da.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),ca.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),ya.languageLoad=this.settings.language_load,ya.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new aC(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new eC(this),this.editorCommands=new Aw(this),this.settings.cache_suffix&&(yt.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:nC(),styleSheetLoader:void 0,show:a,hide:a,enable:a,disable:a,isDisabled:y};var o=function(e){var t,n,r=ga("design"),o=ga({design:{activate:a,deactivate:a,editorReadOnly:!1},readonly:{activate:a,deactivate:a,editorReadOnly:!0}});return(t=e).serializer?Mw(t):t.on("PreInit",function(){Mw(t)}),(n=e).on("ShowCaret",function(e){Pw(n)&&e.preventDefault()}),n.on("ObjectSelected",function(e){Pw(n)&&e.preventDefault()}),{isReadOnly:function(){return Pw(e)},set:function(t){return function(e,t,n,r){if(r!==n.get()){if(!he(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?Xw(e,n,t,r):e.on("init",function(){return Xw(e,n,t,r)})}}(e,o.get(),r,t)},get:function(){return r.get()},register:function(e,t){o.set(function(e,t,n){var r;if(j($w,t))throw new Error("Cannot override default mode "+t);return _e(_e({},e),((r={})[t]=_e(_e({},n),{deactivate:function(){try{n.deactivate()}catch(rS){console.error("problem while deactivating editor mode "+t+":",rS)}}}),r))}(o.get(),e,t))}}}(this);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=ta.overrideDefaults(function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}})}var hC,vC=ca.DOM,bC=kt.explode,yC=kt.each,xC=kt.extend,wC=0,CC=!1,SC=[],kC=[],OC=function(e){var t=e.type;yC(AC.get(),function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}})},_C=function(e){e!==CC&&(e?ta(window).on("resize scroll",OC):ta(window).off("resize scroll",OC),CC=e)},TC=function(e){var t=kC;delete SC[e.id];for(var n=0;n<SC.length;n++)if(SC[n]===e){SC.splice(n,1);break}return kC=$(kC,function(t){return e!==t}),AC.activeEditor===e&&(AC.activeEditor=0<kC.length?kC[0]:null),AC.focusedEditor===e&&(AC.focusedEditor=null),t.length!==kC.length},EC="CSS1Compat"!==document.compatMode,AC=_e(_e({},Vw),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:ta,majorVersion:"5",minorVersion:"7.1",releaseDate:"2021-03-17",editors:SC,i18n:ba,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t="",n=aC.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));var r,o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,t=o.suffix;else{for(var i,u=document.getElementsByTagName("script"),a=0;a<u.length;a++)if(""!==(i=u[a].src||"")){var c=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){-1!==c.indexOf(".min")&&(t=".min"),e=i.substring(0,i.lastIndexOf("/"));break}}!e&&document.currentScript&&(-1!==(i=document.currentScript.src).indexOf(".min")&&(t=".min"),e=i.substring(0,i.lastIndexOf("/")))}this.baseURL=new aC(n).toAbsolute(e),this.documentBaseURL=n,this.baseURI=new aC(this.baseURL),this.suffix=t,(r=this).on("AddEditor",f(kd,r)),r.on("RemoveEditor",f(Od,r))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t),e.suffix&&(this.suffix=e.suffix);var n=(this.defaultSettings=e).plugin_base_urls;void 0!==n&&ce(n,function(e,t){ya.PluginManager.urls[t]=e})},init:function(e){var t,n=this,r=kt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=function(e){var t=e.id;return t||(t=pe(e,"name").filter(function(e){return!vC.get(e)}).getOrThunk(vC.uniqueId),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):vC.hasClass(e,t)},u=function(e){t=e},a=function(){var t,c=0,s=[],l=function(e,r,o){var i=new gC(e,r,n);s.push(i),i.on("init",function(){++c===t.length&&u(s)}),i.targetElm=i.targetElm||o,i.render()};vC.unbind(window,"ready",a),function(t){var r=e.onpageload;r&&r.apply(n,[])}(),t=ta.unique(function(e){var t=[];if(yt.browser.isIE()&&yt.browser.version.major<11)return Zh("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(EC)return Zh("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return yC(e.types,function(e){t=t.concat(vC.select(e.selector))}),t;if(e.selector)return vC.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";0<n.length&&yC(bC(n),function(e){var n=vC.get(e);n?t.push(n):yC(document.forms,function(n){yC(n.elements,function(n){n.name===e&&(e="mce_editor_"+wC++,vC.setAttrib(n,"id",e),t.push(n))})})});break;case"textareas":case"specific_textareas":yC(vC.select("textarea"),function(n){e.editor_deselector&&i(n,e.editor_deselector)||e.editor_selector&&!i(n,e.editor_selector)||t.push(n)})}return t}(e)),e.types?yC(e.types,function(n){kt.each(t,function(t){return!vC.is(t,n.selector)||(l(o(t),xC({},e,n),t),!1)})}):(kt.each(t,function(e){var t;(t=n.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(TC(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)}),0===(t=kt.grep(t,function(e){return!n.get(e.id)})).length?u([]):yC(t,function(t){e.inline&&t.tagName.toLowerCase()in r?Zh("Could not initialize inline editor on invalid inline target element",t):l(o(t),e,t)}))};return n.settings=e,vC.bind(window,"ready",a),new Er(function(e){t?e(t):u=function(t){e(t)}})},get:function(e){return 0===arguments.length?kC.slice(0):E(e)?Y(kC,function(t){return t.id===e}).getOr(null):L(e)&&kC[e]?kC[e]:null},add:function(e){var t=this;return SC[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(SC[e.id]=e),SC.push(e),kC.push(e)),_C(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),hC||(hC=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",hC))),e},createEditor:function(e,t){return this.add(new gC(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!E(e))return N(r.get((n=e).id))?null:(TC(n)&&r.fire("RemoveEditor",{editor:n}),0===kC.length&&window.removeEventListener("beforeunload",hC),n.remove(),_C(0<kC.length),n);yC(vC.select(e),function(e){(n=r.get(e.id))&&r.remove(n)})}else for(t=kC.length-1;0<=t;t--)r.remove(kC[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new gC(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",!1,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){yC(kC,function(e){e.save()})},addI18n:function(e,t){ba.add(e,t)},translate:function(e){return ba.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new aC(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new aC(this.baseURL)}});AC.setup();var RC,NC,BC,DC,PC=Math.min,MC=Math.max,IC=Math.round,LC=function(e,t,n){var r=t.x,o=t.y,i=e.w,u=e.h,a=t.w,c=t.h,s=(n||"").split("");return"b"===s[0]&&(o+=c),"r"===s[1]&&(r+=a),"c"===s[0]&&(o+=IC(c/2)),"c"===s[1]&&(r+=IC(a/2)),"b"===s[3]&&(o-=u),"r"===s[4]&&(r-=i),"c"===s[3]&&(o-=IC(u/2)),"c"===s[4]&&(r-=IC(i/2)),FC(r,o,i,u)},FC=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},zC={inflate:function(e,t,n){return FC(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:LC,findBestRelativePosition:function(e,t,n,r){for(var o,i=0;i<r.length;i++)if((o=LC(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n=MC(e.x,t.x),r=MC(e.y,t.y),o=PC(e.x+e.w,t.x+t.w),i=PC(e.y+e.h,t.y+t.h);return o-n<0||i-r<0?null:FC(n,r,o-n,i-r)},clamp:function(e,t,n){var r=e.x,o=e.y,i=e.x+e.w,u=e.y+e.h,a=t.x+t.w,c=t.y+t.h,s=MC(0,t.x-r),l=MC(0,t.y-o),f=MC(0,i-a),d=MC(0,u-c);return r+=s,o+=l,n&&(i+=s,u+=l,r-=f,o-=d),FC(r,o,(i-=f)-r,(u-=d)-o)},create:FC,fromClientRect:function(e){return FC(e.left,e.top,e.width,e.height)}},HC=(RC={},NC={},{load:function(e,t){var n='Script at URL "'+t+'" failed to load',r='Script at URL "'+t+"\" did not call `tinymce.Resource.add('"+e+"', data)` within 1 second";if(void 0!==RC[e])return RC[e];var o=new Er(function(o,i){var u=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))}},u=i(e),a=i(t);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==o||(o=setTimeout(function(){return a.apply(null,e)},n))},resolve:u,reject:a}}(o,i);NC[e]=u.resolve,da.ScriptLoader.loadScript(t,function(){return u.start(r)},function(){return u.reject(n)})});return RC[e]=o},add:function(e,t){void 0!==NC[e]&&(NC[e](t),delete NC[e]),RC[e]=Er.resolve(t)}}),VC=kt.each,jC=kt.extend,UC=function(){};UC.extend=BC=function(e){var t=this.prototype,n=function(){var e,t,n;if(!DC&&(this.init&&this.init.apply(this,arguments),t=this.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(this,arguments)},r=function(){return this};DC=!0;var o=new this;return DC=!1,e.Mixins&&(VC(e.Mixins,function(t){for(var n in t)"init"!==n&&(e[n]=t[n])}),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&VC(e.Methods.split(","),function(t){e[t]=r}),e.Properties&&VC(e.Properties.split(","),function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}}),e.Statics&&VC(e.Statics,function(e,t){n[t]=e}),e.Defaults&&t.Defaults&&(e.Defaults=jC({},t.Defaults,e.Defaults)),ce(e,function(e,n){var r,i;o[n]="function"==typeof e&&t[n]?(r=n,i=e,function(){var e=this._super;this._super=t[r];var n=i.apply(this,arguments);return this._super=e,n}):e}),n.prototype=o,(n.constructor=n).extend=BC,n};var WC=Math.min,qC=Math.max,GC=Math.round,$C={serialize:function(e){var t=JSON.stringify(e);return E(t)?t.replace(/[\u0080-\uFFFF]/g,function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t}):t},parse:function(e){try{return JSON.parse(e)}catch(t){}}},XC={callbacks:{},count:0,send:function(e){var t=this,n=ca.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},KC=_e(_e({},Vw),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||1e4<n++?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,1e4<n?"TIMED_OUT":"GENERAL",t,e),t=null):Fr.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",KC.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&kt.each(e.requestheaders,function(e){t.setRequestHeader(e.key,e.value)}),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=KC.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();Fr.setTimeout(r,10)}}),YC=kt.extend,JC=(QC.sendRPC=function(e){return(new QC).send(e)},QC.prototype.send=function(e){var t=e.error,n=e.success,r=YC(this.settings,e);r.success=function(e,o){void 0===(e=$C.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,o):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=$C.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",KC.send(r)},QC);function QC(e){this.settings=YC({},e),this.count=0}try{var ZC,eS="__storage_test__";(ZC=window.localStorage).setItem(eS,eS),ZC.removeItem(eS)}catch(rS){ZC=function(){return e={},t=[],n={getItem:function(t){return e[t]||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter(function(e){return e===n}),delete e[n]},clear:function(){t=[],e={}},length:0},Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n;var e,t,n}()}var tS,nS=kt.extend(AC,{geom:{Rect:zC},util:{Promise:Er,Delay:Fr,Tools:kt,VK:Sf,URI:aC,Class:UC,EventDispatcher:Lw,Observable:Vw,I18n:ba,XHR:KC,JSON:$C,JSONRequest:JC,JSONP:XC,LocalStorage:ZC,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=qC(0,WC(t,1)),i=qC(0,WC(i,1)),0!==t){var u=e/60,a=i*t,c=a*(1-Math.abs(u%2-1)),s=i-a;switch(Math.floor(u)){case 0:n=a,r=c,o=0;break;case 1:n=c,r=a,o=0;break;case 2:n=0,r=a,o=c;break;case 3:n=0,r=c,o=a;break;case 4:n=c,r=0,o=a;break;case 5:n=a,r=0,o=c;break;default:n=r=o=0}n=GC(255*(n+s)),r=GC(255*(r+s)),o=GC(255*(o+s))}else n=r=o=GC(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:255<n?255:n,r=r<0?0:255<r?255:r,o=o<0?0:255<o?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return e=n,t=r,i=o,a=0,(c=WC(e/=255,WC(t/=255,i/=255)))===(s=qC(e,qC(t,i)))?{h:0,s:0,v:100*(a=c)}:(u=(s-c)/s,{h:GC(60*((e===c?3:i===c?1:5)-(e===c?t-i:i===c?e-t:i-e)/((a=s)-c))),s:GC(100*u),v:GC(100*a)});var e,t,i,u,a,c,s},t.toHex=function(){var e=function(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t},ImageUploader:function(e){var t=tv(),n=iv(e,t);return{upload:function(t,r){return void 0===r&&(r=!0),n.upload(t,r?ov(e):void 0)}}}},dom:{EventUtils:hi,Sizzle:hu,DomQuery:ta,TreeWalker:Vr,TextSeeker:Ha,DOMUtils:ca,ScriptLoader:da,RangeUtils:Lf,Serializer:xh,StyleSheetLoader:zr,ControlSelection:Of,BookmarkManager:yf,Selection:ih,Event:hi.Event},html:{Styles:ci,Entities:Yo,Node:zd,Schema:ui,SaxParser:qd,DomParser:bh,Writer:Qd,Serializer:Zd},Env:yt,AddOnManager:ya,Annotator:bf,Formatter:fv,UndoManager:dv,EditorCommands:Aw,WindowManager:$h,NotificationManager:Wh,EditorObservable:Gw,Shortcuts:eC,Editor:gC,FocusManager:wd,EditorManager:AC,DOM:ca.DOM,ScriptLoader:da.ScriptLoader,PluginManager:qh,ThemeManager:Gh,IconManager:Ih,Resource:HC,trim:kt.trim,isArray:kt.isArray,is:kt.is,toArray:kt.toArray,makeMap:kt.makeMap,each:kt.each,map:kt.map,grep:kt.grep,inArray:kt.inArray,extend:kt.extend,create:kt.create,walk:kt.walk,createNS:kt.createNS,resolve:kt.resolve,explode:kt.explode,_addCacheSuffix:kt._addCacheSuffix,isOpera:yt.opera,isWebKit:yt.webkit,isIE:yt.ie,isGecko:yt.gecko,isMac:yt.mac});tS=nS,window.tinymce=tS,window.tinyMCE=tS,function(e){if("object"==typeof module)try{module.exports=e}catch(t){}}(nS)}(),function(){"use strict";var e=function(){},t=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},n=function(e){return function(){return e}},r=function(e){return e};function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var i=function(e){return function(t){return!e(t)}},u=function(e){return function(){throw new Error(e)}},a=n(!1),c=n(!0),s=tinymce.util.Tools.resolve("tinymce.ThemeManager"),l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function d(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var m,g,p,h,v,b=function(){return y},y=(m=function(e){return e.isNone()},{fold:function(e,t){return e()},is:a,isSome:a,isNone:c,getOr:p=function(e){return e},getOrThunk:g=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:n(null),getOrUndefined:n(void 0),or:p,orThunk:g,map:b,each:e,bind:b,exists:a,forall:c,filter:b,equals:m,equals_:m,toArray:function(){return[]},toString:n("none()")}),x=function(e){var t=n(e),r=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:a,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:r,orThunk:r,map:function(t){return x(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:y},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(a,function(t){return n(e,t)})}};return i},w={some:x,none:b,from:function(e){return null==e?y:x(e)}},C=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},S=function(e){return function(t){return typeof t===e}},k=C("string"),O=C("object"),_=C("array"),T=S("boolean"),E=function(e){return!(null===(t=e)||void 0===t);var t},A=S("function"),R=S("number"),N=function(e,t){if(_(e)){for(var n=0,r=e.length;n<r;++n)if(!t(e[n]))return!1;return!0}return!1},B=Array.prototype.slice,D=Array.prototype.indexOf,P=Array.prototype.push,M=function(e,t){return D.call(e,t)},I=function(e,t){return-1<M(e,t)},L=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},F=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},z=function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=B.call(e,r,r+t);n.push(o)}return n},H=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o],o);return r},V=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},j=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u,o)?n:r).push(u)}return{pass:n,fail:r}},U=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},W=function(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,function(e){n=t(n,e)}),n},q=function(e,t,n){return V(e,function(e){n=t(n,e)}),n},G=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return w.some(i);if(n(i,r))break}return w.none()}(e,t,a)},$=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return w.some(n);return w.none()},X=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!_(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);P.apply(t,e[n])}return t},K=function(e,t){return X(H(e,t))},Y=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0},J=function(e){var t=B.call(e,0);return t.reverse(),t},Q=function(e,t){return U(e,function(e){return!I(t,e)})},Z=function(e,t){var n=B.call(e,0);return n.sort(t),n},ee=function(e,t){return 0<=t&&t<e.length?w.some(e[t]):w.none()},te=function(e){return ee(e,0)},ne=function(e){return ee(e,e.length-1)},re=A(Array.from)?Array.from:function(e){return B.call(e)},oe=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return w.none()},ie=function(e){return{is:function(t){return e===t},isValue:c,isError:a,getOr:n(e),getOrThunk:n(e),getOrDie:n(e),or:function(t){return ie(e)},orThunk:function(t){return ie(e)},fold:function(t,n){return n(e)},map:function(t){return ie(t(e))},mapError:function(t){return ie(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return w.some(e)}}},ue=function(t){return{is:a,isValue:a,isError:c,getOr:r,getOrThunk:function(e){return e()},getOrDie:function(){return u(String(t))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return ue(t)},mapError:function(e){return ue(e(t))},each:e,bind:function(e){return ue(t)},exists:a,forall:c,toOptional:w.none}},ae={value:ie,error:ue,fromOption:function(e,t){return e.fold(function(){return ue(t)},ie)}};(v=h=h||{})[v.Error=0]="Error",v[v.Value=1]="Value";var ce,se,le=function(e,t,n){return e.stype===h.Error?t(e.serror):n(e.svalue)},fe=function(e){return{stype:h.Value,svalue:e}},de=function(e){return{stype:h.Error,serror:e}},me=fe,ge=function(e){var t=[],n=[];return V(e,function(e){le(e,function(e){return n.push(e)},function(e){return t.push(e)})}),{values:t,errors:n}},pe=de,he=function(e,t){return e.stype===h.Value?t(e.svalue):e},ve=function(e,t){return e.stype===h.Value?{stype:h.Value,svalue:t(e.svalue)}:e},be=Object.keys,ye=Object.hasOwnProperty,xe=function(e,t){for(var n=be(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},we=function(e,t){return Ce(e,function(e,n){return{k:n,v:t(e,n)}})},Ce=function(e,t){var n={};return xe(e,function(e,r){var o=t(e,r);n[o.k]=o.v}),n},Se=function(e,t){var n=[];return xe(e,function(e,r){n.push(t(e,r))}),n},ke=function(e,t){for(var n=be(e),r=0,o=n.length;r<o;r++){var i=n[r],u=e[i];if(t(u,i,e))return w.some(u)}return w.none()},Oe=function(e){return Se(e,function(e){return e})},_e=function(e,t){return Te(e,t)?w.from(e[t]):w.none()},Te=function(e,t){return ye.call(e,t)},Ee=function(e,t){return Te(e,t)&&null!=e[t]},Ae=function(e){if(!_(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return V(e,function(r,o){var i=be(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!_(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:function(e){var r=be(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!Y(t,function(e){return I(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:u,params:n})}}}}),n},Re=Object.prototype.hasOwnProperty,Ne=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)Re.call(i,u)&&(r[u]=e(r[u],i[u]))}return r}},Be=Ne(function(e,t){return O(e)&&O(t)?Be(e,t):t}),De=Ne(function(e,t){return t}),Pe=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},Me=Ae([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Ie=function(e){return Me.defaultedThunk(n(e))},Le=Me.strict,Fe=Me.asOption,ze=Me.defaultedThunk,He=Me.mergeWithThunk,Ve=(Ae([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e,t){var n={};return n[e]=t,n}),je=Ve,Ue=function(e){return t={},V(e,function(e){t[e.key]=e.value}),t;var t},We=function(e){return t(pe,X)(e)},qe=function(e){var t=ge(e);return 0<t.errors.length?We(t.errors):me(t.values)},Ge=function(e){return O(e)&&100<be(e).length?" removed due to size":JSON.stringify(e,null,2)},$e=function(e,t){return pe([{path:e,getErrorInfo:t}])},Xe=Ae([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Ke=function(e,t,n){var o=_e(e,t).fold(function(){return n(e)},r);return me(o)},Ye=function(e){return{extract:function(t,n,r){return function(e,n){return e.stype===h.Error?function(e){return n=e,$e(t,function(){return n});var n}(e.serror):e}(e(r,n))},toString:function(){return"val"}}},Je=function(t){var r=Qe(t),o=W(t,function(e,t){return t.fold(function(t){return Be(e,je(t,!0))},n(e))},{});return{extract:function(t,n,i){var u,a=T(i)?[]:be(function(t,n){var r,o,i,u,a={};return r=function(e){return null!=e},u=a,o=function(e,t){u[t]=e},i=e,xe(t,function(e,t){(r(e)?o:i)(e,t)}),a}(i)),c=U(a,function(e){return!Ee(o,e)});return 0===c.length?r.extract(t,n,i):(u=c,$e(t,function(){return"There are unsupported fields: ["+u.join(", ")+"] specified"}))},toString:r.toString}},Qe=function(e){return{extract:function(t,r,o){return i=t,u=o,a=r,function(e,t){var n,r,o=ge(e);return 0<o.errors.length?We(o.errors):(r={},me(0<(n=o.values).length?Be(r,De.apply(void 0,n)):r))}(H(e,function(e){return function(e,t,r,o){return r.fold(function(r,i,u,a){var c=function(t){var n=a.extract(e.concat([r]),o,t);return ve(n,function(e){return Ve(i,o(e))})},s=function(t){return t.fold(function(){var e=Ve(i,o(w.none()));return me(e)},function(t){var n=a.extract(e.concat([r]),o,t);return ve(n,function(e){return Ve(i,o(w.some(e)))})})};return u.fold(function(){return he(function(e,t,n){return _e(t,n).fold(function(){return r=n,o=t,$e(e,function(){return'Could not find valid *strict* value for "'+r+'" in '+Ge(o)});var r,o},me)}(e,t,r),c)},function(e){return he(Ke(t,r,e),c)},function(){return he(me(_e(t,r)),s)},function(e){return he((o=e,i=_e(n=t,r).map(function(e){return!0===e?o(n):e}),me(i)),s);var n,o,i},function(e){var o=e(t),i=ve(Ke(t,r,n({})),function(e){return Be(o,e)});return he(i,c)})},function(e,n){var r=n(t);return me(Ve(e,o(r)))})}(i,u,e,a)}));var i,u,a},toString:function(){return"obj{\n"+H(e,function(e){return e.fold(function(e,t,n,r){return e+" -> "+r.toString()},function(e,t){return"state("+e+")"})}).join("\n")+"}"}}},Ze=function(e){return{extract:function(t,n,r){var o=H(r,function(r,o){return e.extract(t.concat(["["+o+"]"]),n,r)});return qe(o)},toString:function(){return"array("+e.toString()+")"}}},et=function(e){return{extract:function(t,n,r){for(var o=[],i=0,u=e;i<u.length;i++){var a=u[i].extract(t,n,r);if(a.stype===h.Value)return a;o.push(a)}return qe(o)},toString:function(){return"oneOf("+H(e,function(e){return e.toString()}).join(", ")+")"}}},tt=n(Ye(me)),nt=t(Ze,Qe),rt=Xe.state,ot=Xe.field,it=function(e,t){return{extract:function(n,r,o){return _e(o,e).fold(function(){return t=e,$e(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(e){return function(e,t,n,r,o){return _e(r,o).fold(function(){return t=r,n=o,$e(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Ge(t)});var t,n},function(r){return r.extract(e.concat(["branch: "+o]),t,n)})}(n,r,o,t,e)})},toString:function(){return"chooseOn("+e+"). Possible values: "+be(t)}}},ut=Ye(me),at=function(e){return nt(e)},ct=function(e){return{extract:function(t,n,r){return e().extract(t,n,r)},toString:function(){return e().toString()}}},st=function(e){return Ye(function(t){return e(t).fold(pe,me)})},lt=function(e,t){return function(e,t){return{extract:function(n,o,i){var u,a,c=be(i),s=(u=n,a=c,Ze(Ye(e)).extract(u,r,a));return he(s,function(e){var r=H(e,function(e){return Xe.field(e,e,Le(),t)});return Qe(r).extract(n,o,i)})},toString:function(){return"setOf("+t.toString()+")"}}}(function(t){return function(e){return e.fold(de,fe)}(e(t))},t)},ft=function(e,t,n){return function(e){return le(e,ae.error,ae.value)}(function(e,t){return e.stype===h.Error?{stype:h.Error,serror:function(e){return{input:o,errors:e}}(e.serror)}:e}(t.extract([e],r,o=n)));var o},dt=function(e){return e.fold(function(e){throw new Error(gt(e))},r)},mt=function(e,t,n){return dt(ft(e,t,n))},gt=function(e){return"Errors: \n"+(n=10<(t=e.errors).length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,H(n,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()}).join("\n")+"\n\nInput object: ")+Ge(e.input);var t,n},pt=it,ht=function(e,t){return it(e,we(t,Qe))},vt=n(ut),bt=function(e,t){return Ye(function(n){var r=typeof n;return e(n)?me(n):pe("Expected type: "+t+" but got: "+r)})},yt=bt(R,"number"),xt=bt(k,"string"),wt=bt(T,"boolean"),Ct=bt(A,"function"),St=function(e){var t=function(e,t){for(var n=e.next();!n.done;){if(!t(n.value))return!1;n=e.next()}return!0};if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(function(t){return St(e[t])});case"Map":return t(e.keys(),St)&&t(e.values(),St);case"Set":return t(e.keys(),St);default:return!1}},kt=Ye(function(e){return St(e)?me(e):pe("Expected value to be acceptable for sending via postMessage")}),Ot=function(e){return st(function(t){return I(e,t)?ae.value(t):ae.error('Unsupported value: "'+t+'", choose one of "'+e.join(", ")+'".')})},_t=function(e){return ot(e,e,Le(),tt())},Tt=function(e,t){return ot(e,e,Le(),t)},Et=function(e){return Tt(e,xt)},At=function(e,t){return ot(e,e,Le(),Ot(t))},Rt=function(e){return Tt(e,Ct)},Nt=function(e,t){return ot(e,e,Le(),Qe(t))},Bt=function(e,t){return ot(e,e,Le(),nt(t))},Dt=function(e,t){return ot(e,e,Le(),Ze(t))},Pt=function(e){return ot(e,e,Fe(),tt())},Mt=function(e,t){return ot(e,e,Fe(),t)},It=function(e){return Mt(e,yt)},Lt=function(e){return Mt(e,xt)},Ft=function(e){return Mt(e,Ct)},zt=function(e,t){return Mt(e,Qe(t))},Ht=function(e,t){return ot(e,e,Ie(t),tt())},Vt=function(e,t,n){return ot(e,e,Ie(t),n)},jt=function(e,t){return Vt(e,t,yt)},Ut=function(e,t){return Vt(e,t,xt)},Wt=function(e,t,n){return Vt(e,t,Ot(n))},qt=function(e,t){return Vt(e,t,wt)},Gt=function(e,t){return Vt(e,t,Ct)},$t=function(e,t,n){return Vt(e,t,Ze(n))},Xt=function(e,t,n){return Vt(e,t,Qe(n))},Kt=function(e,t){return rt(e,t)},Yt=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Jt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Qt=function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Jt(n.childNodes[0])},Zt=function(e,t){var n=(t||document).createElement(e);return Jt(n)},en=function(e,t){var n=(t||document).createTextNode(e);return Jt(n)},tn=Jt,nn=function(){return rn(0,0)},rn=function(e,t){return{major:e,minor:t}},on=function(e,t){var n=String(t).toLowerCase();return 0===e.length?nn():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return rn(r(1),r(2))}(e,n)},un=nn,an=function(e,t){var n=String(t).toLowerCase();return G(e,function(e){return e.search(n)})},cn=function(e,t){return-1!==e.indexOf(t)},sn=function(e,t){return o=(n=e).length-t.length,""===(r=t)||n.length>=r.length&&n.substr(o,o+r.length)===r;var n,r,o},ln=(ce=/^\s+|\s+$/g,function(e){return e.replace(ce,"")}),fn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,dn=function(e){return function(t){return cn(t,e)}},mn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return cn(e,"edge/")&&cn(e,"chrome")&&cn(e,"safari")&&cn(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,fn],search:function(e){return cn(e,"chrome")&&!cn(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return cn(e,"msie")||cn(e,"trident")}},{name:"Opera",versionRegexes:[fn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:dn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:dn("firefox")},{name:"Safari",versionRegexes:[fn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(cn(e,"safari")||cn(e,"mobile/"))&&cn(e,"applewebkit")}}],gn=[{name:"Windows",search:dn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return cn(e,"iphone")||cn(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:dn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:dn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:dn("linux"),versionRegexes:[]},{name:"Solaris",search:dn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:dn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:dn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],pn={browsers:n(mn),oses:n(gn)},hn="Firefox",vn=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(hn),isSafari:n("Safari")}},bn=function(){return vn({current:void 0,version:un()})},yn=vn,xn=(n("Edge"),n("Chrome"),n("IE"),n("Opera"),n(hn),n("Safari"),"Windows"),wn="Android",Cn="Solaris",Sn="FreeBSD",kn="ChromeOS",On=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(xn),isiOS:n("iOS"),isAndroid:n(wn),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Cn),isFreeBSD:n(Sn),isChromeOS:n(kn)}},_n=function(){return On({current:void 0,version:un()})},Tn=On,En=(n(xn),n("iOS"),n(wn),n("Linux"),n("OSX"),n(Cn),n(Sn),n(kn),function(e,t){var r,o,i,u,a,c,s,l,f,d,m,g,p=pn.browsers(),h=pn.oses(),v=function(e,t){return an(e,t).map(function(e){var n=on(e.versionRegexes,t);return{current:e.name,version:n}})}(p,e).fold(bn,yn),b=function(e,t){return an(e,t).map(function(e){var n=on(e.versionRegexes,t);return{current:e.name,version:n}})}(h,e).fold(_n,Tn);return{browser:v,os:b,deviceType:(o=v,i=e,u=t,a=(r=b).isiOS()&&!0===/ipad/i.test(i),c=r.isiOS()&&!a,s=r.isiOS()||r.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=o.isSafari()&&r.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:n(a),isiPhone:n(c),isTablet:n(f),isPhone:n(d),isTouch:n(l),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:n(m),isDesktop:n(g)})}}),An=function(e){return window.matchMedia(e).matches},Rn=Pe(function(){return En(navigator.userAgent,An)}),Nn=function(){return Rn()},Bn=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Dn=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Pn=function(e,t){return e.dom===t.dom},Mn=function(e,t){return Nn().browser.isIE()?function(e,t){return n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.dom.compareDocumentPosition(t.dom)&n);var n}(e,t):(n=e.dom)!==(r=t.dom)&&n.contains(r);var n,r},In=function(e){return A(e)?e:a},Ln=function(e,t,n){for(var r=e.dom,o=In(n);r.parentNode;){var i=tn(r=r.parentNode),u=t(i);if(u.isSome())return u;if(o(i))break}return w.none()},Fn=function(e,t,n){var r=t(e),o=In(n);return r.orThunk(function(){return o(e)?w.none():Ln(e,t,o)})},zn=function(e,t){return Pn(e.element,t.event.target)},Hn=function(t){if(!Ee(t,"can")&&!Ee(t,"abort")&&!Ee(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return mt("Extracting event.handler",Je([Ht("can",c),Ht("abort",a),Ht("run",e)]),t)},Vn=n,jn=Vn("touchstart"),Un=Vn("touchmove"),Wn=Vn("touchend"),qn=Vn("touchcancel"),Gn=Vn("mousedown"),$n=Vn("mousemove"),Xn=Vn("mouseout"),Kn=Vn("mouseup"),Yn=Vn("mouseover"),Jn=Vn("focusin"),Qn=Vn("focusout"),Zn=Vn("keydown"),er=Vn("keyup"),tr=Vn("input"),nr=Vn("change"),rr=Vn("click"),or=Vn("transitionend"),ir=Vn("selectstart"),ur=function(e){return n("alloy."+e)},ar={tap:ur("tap")},cr=ur("focus"),sr=ur("blur.post"),lr=ur("paste.post"),fr=ur("receive"),dr=ur("execute"),mr=ur("focus.item"),gr=ar.tap,pr=ur("longpress"),hr=ur("sandbox.close"),vr=ur("typeahead.cancel"),br=ur("system.init"),yr=ur("system.touchmove"),xr=ur("system.touchend"),wr=ur("system.scroll"),Cr=ur("system.resize"),Sr=ur("system.attached"),kr=ur("system.detached"),Or=ur("system.dismissRequested"),_r=ur("system.repositionRequested"),Tr=ur("focusmanager.shifted"),Er=ur("slotcontainer.visibility"),Ar=ur("change.tab"),Rr=ur("dismiss.tab"),Nr=ur("highlight"),Br=ur("dehighlight"),Dr=function(e,t){Lr(e,e.element,t,{})},Pr=function(e,t,n){Lr(e,e.element,t,n)},Mr=function(e){Dr(e,dr())},Ir=function(e,t,n){Lr(e,t,n,{})},Lr=function(e,t,n,r){var o=l({target:t},r);e.getSystem().triggerEvent(n,t,o)},Fr=function(e,t,n,r){e.getSystem().triggerEvent(n,t,r.event)},zr=Ue,Hr=function(e,t){return{key:e,value:Hn({abort:t})}},Vr=function(e){return{key:e,value:Hn({run:function(e,t){t.event.prevent()}})}},jr=function(e,t){return{key:e,value:Hn({run:t})}},Ur=function(e,t,n){return{key:e,value:Hn({run:function(e,r){t.apply(void 0,[e,r].concat(n))}})}},Wr=function(e){return function(t){return{key:e,value:Hn({run:function(e,n){zn(e,n)&&t(e,n)}})}}},qr=function(e,t,n){var r,o;return o=t.partUids[n],jr(r=e,function(e,t){e.getSystem().getByUid(o).each(function(e){Fr(e,e.element,r,t)})})},Gr=function(e,t){return jr(e,function(e,n){var r=n.event,o=e.getSystem().getByDom(r.target).fold(function(){return Fn(r.target,function(t){return e.getSystem().getByDom(t).toOptional()},a).getOr(e)},function(e){return e});t(e,o,n)})},$r=function(e){return jr(e,function(e,t){t.cut()})},Xr=function(e,t){return Wr(e)(t)},Kr=Wr(Sr()),Yr=Wr(kr()),Jr=Wr(br()),Qr=(se=dr(),function(e){return jr(se,e)}),Zr=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),eo=function(e){return function(t){return t.dom.nodeType===e}},to=eo(1),no=eo(3),ro=eo(9),oo=eo(11),io=function(e){return tn(e.dom.ownerDocument)},uo=function(e){return ro(e)?e:io(e)},ao=function(e){return tn(uo(e).dom.documentElement)},co=function(e){return tn(uo(e).dom.defaultView)},so=function(e){return w.from(e.dom.parentNode).map(tn)},lo=so,fo=function(e){return w.from(e.dom.offsetParent).map(tn)},mo=function(e){return H(e.dom.childNodes,tn)},go=function(e,t){return w.from(e.dom.childNodes[t]).map(tn)},po=function(e){return oo(e)&&E(e.dom.host)},ho=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),vo=n(ho),bo=ho?function(e){return tn(e.dom.getRootNode())}:uo,yo=function(e){return po(e)?e:tn(uo(e).dom.body)},xo=function(e){var t=bo(e);return po(t)?w.some(t):w.none()},wo=function(e){return tn(e.dom.host)},Co=function(e,t){so(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},So=function(e,t){var n;(n=e,w.from(n.dom.nextSibling).map(tn)).fold(function(){so(e).each(function(e){Oo(e,t)})},function(e){Co(e,t)})},ko=function(e,t){go(e,0).fold(function(){Oo(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},Oo=function(e,t){e.dom.appendChild(t.dom)},_o=function(e,t){V(t,function(t){Oo(e,t)})},To=function(e){e.dom.textContent="",V(mo(e),function(e){Eo(e)})},Eo=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Ao=function(e){var t,n=mo(e);0<n.length&&(t=e,V(n,function(e){Co(t,e)})),Eo(e)},Ro=function(e){return e.dom.innerHTML},No=function(e,t){var n,r,o=io(e).dom,i=tn(o.createDocumentFragment()),u=(n=t,(r=(o||document).createElement("div")).innerHTML=n,mo(tn(r)));_o(i,u),To(e),Oo(e,i)},Bo=function(e,t,n){if(!(k(n)||T(n)||R(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Do=function(e,t,n){Bo(e.dom,t,n)},Po=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Mo=function(e,t){return w.from(Po(e,t))},Io=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},Lo=function(e,t){e.dom.removeAttribute(t)},Fo=function(e){return po(e)?"#shadow-root":(t=function(e){return tn(e.dom.cloneNode(!1))}(e),n=Zt("div"),r=tn(t.dom.cloneNode(!0)),Oo(n,r),Ro(n));var t,n,r},zo=zr([{key:cr(),value:Hn({can:function(e,t){var n,r,o=t.event,i=o.originator,u=o.target;return r=u,!(Pn(n=i,e.element)&&!Pn(n,r)&&(console.warn(cr()+" did not get interpreted by the desired target. \nOriginator: "+Fo(i)+"\nTarget: "+Fo(u)+"\nCheck the "+cr()+" event handlers"),1))}})}]),Ho=Object.freeze({__proto__:null,events:zo}),Vo=0,jo=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Vo+String(t)},Uo=n("alloy-id-"),Wo=n("data-alloy-id"),qo=Uo(),Go=Wo(),$o=function(e,t){Object.defineProperty(e.dom,Go,{value:t,writable:!0})},Xo=function(e){var t=to(e)?e.dom[Go]:null;return w.from(t)},Ko=jo,Yo=r,Jo=function(e){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(e?"\n"+Fo(e().element)+" is not in context.":""))}};return{debugInfo:n("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:a}},Qo=Jo(),Zo=function(e){return H(e,function(e){return sn(e,"/*")?e.substring(0,e.length-"/*".length):e})},ei=function(e,t){var n=e.toString(),r=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:Zo(i)}},e},ti=jo("alloy-premade"),ni=function(e){return je(ti,e)},ri=function(e){return t=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.apply(void 0,d([t.getApis(),t],n))},r=(n=e.toString()).indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,r-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Zo(i.slice(1))}},t;var t,n,r,o,i},oi={init:function(){return ii({readState:function(){return"No State required"}})}},ii=function(e){return e},ui=function(e,t){var n={};return xe(e,function(e,r){xe(e,function(e,o){var i=_e(n,o).getOr([]);n[o]=i.concat([t(r,e)])})}),n},ai=function(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}},ci=function(e){return e.cHandler},si=function(e,t){return{name:e,handler:t}},li=function(e,t){return function(e,t){var n,r,o,i,u=(n=[],r=[],V(e,function(e){e.fold(function(e){n.push(e)},function(e){r.push(e)})}),{errors:n,values:r});return 0<u.errors.length?ae.error(X(u.errors)):(i={},0===(o=u.values).length?ae.value(i):ae.value(Be(i,De.apply(void 0,o))))}(Se(e,function(e,n){return(1===e.length?ae.value(e[0].handler):function(e,t,n){var r=t[n];return r?function(e,t,r,o){try{var i=Z(r,function(n,r){var i=n[t],u=r[t],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+e+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+e+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0});return ae.value(i)}catch(n){return ae.error([n])}}("Event: "+n,"name",e,r).map(function(e){return function(e){var t,n,r,o,i=(n=function(e){return e.can},function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return q(t,function(t,r){return t&&n(r).apply(void 0,e)},!0)}),u=(r=t=e,o=function(e){return e.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(r,function(t,n){return t||o(n).apply(void 0,e)},!1)});return Hn({can:i,abort:u,run:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];V(e,function(e){e.run.apply(void 0,t)})}})}(H(e,function(e){return e.handler}))}):ae.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(H(e,function(e){return e.name}),null,2)])}(e,t,n)).map(function(r){var o=function(e){var t,n=A(t=e)?{can:c,abort:a,run:t}:t;return function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[e,t].concat(r);n.abort.apply(void 0,i)?t.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}}(r),i=1<e.length?U(t[n],function(t){return L(e,function(e){return e.name===t})}).join(" > "):e[0].name;return je(n,{handler:o,purpose:i})})}))},fi="alloy.base.behaviour",di=function(e,t){var n=Po(e,t);return void 0===n||""===n?[]:n.split(" ")},mi=function(e){return void 0!==e.dom.classList},gi=function(e,t){mi(e)?e.dom.classList.add(t):function(e,t){return r=t,o=di(n=e,"class").concat([r]),Do(n,"class",o.join(" ")),!0;var n,r,o}(e,t)},pi=function(e,t){mi(e)?e.dom.classList.remove(t):function(e,t){return o=t,0<(i=U(di(n=e,r="class"),function(e){return e!==o})).length?Do(n,r,i.join(" ")):Lo(n,r),!1;var n,r,o,i}(e,t),function(e){0===(mi(e)?e.dom.classList:di(e,"class")).length&&Lo(e,"class")}(e)},hi=function(e,t){return mi(e)&&e.dom.classList.contains(t)},vi=function(e,t){V(t,function(t){gi(e,t)})},bi=function(e,t){V(t,function(t){pi(e,t)})},yi=function(e){return void 0!==e.style&&A(e.style.getPropertyValue)},xi=function(e){var t=no(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return xo(tn(t)).fold(function(){return o.body.contains(t)},(n=xi,r=wo,function(e){return n(r(e))}))},wi=function(){return Ci(tn(document))},Ci=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return tn(t)},Si=function(e,t,n){if(!k(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);yi(e)&&e.style.setProperty(t,n)},ki=function(e,t){yi(e)&&e.style.removeProperty(t)},Oi=function(e,t,n){Si(e.dom,t,n)},_i=function(e,t){var n=e.dom;xe(t,function(e,t){Si(n,t,e)})},Ti=function(e,t){var n=e.dom;xe(t,function(e,t){e.fold(function(){ki(n,t)},function(e){Si(n,t,e)})})},Ei=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||xi(e)?r:Ai(n,t)},Ai=function(e,t){return yi(e)?e.style.getPropertyValue(t):""},Ri=function(e,t){var n=Ai(e.dom,t);return w.from(n).filter(function(e){return 0<e.length})},Ni=function(e,t,n){var r=Zt(e);return Oi(r,t,n),Ri(r,t).isSome()},Bi=function(e,t){ki(e.dom,t),Mo(e,"style").map(ln).is("")&&Lo(e,"style")},Di=function(e){return e.dom.offsetWidth},Pi=function(e){return e.dom.value},Mi=function(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},Ii=function(e){var t=en(e);return Li({element:t})},Li=function(t){var r=mt("external.component",Je([_t("element"),Pt("uid")]),t),o=Yt(Jo());r.uid.each(function(e){$o(r.element,e)});var i={getSystem:o.get,config:w.none,hasConfigured:a,connect:function(e){o.set(e)},disconnect:function(){o.set(Jo(function(){return i}))},getApis:function(){return{}},element:r.element,spec:t,readState:n("No state"),syncComponents:e,components:n([]),events:{}};return ni(i)},Fi=Ko,zi=function(e){return _e(e,ti).fold(function(){return function(e){var t,r,o,i,u,a,c,s,d,m,g,p,h,v=Yo(e),b=v.events,y=f(v,["events"]),x=(t=_e(y,"components").getOr([]),H(t,zi)),w=l(l({},y),{events:l(l({},Ho),b),components:x});return ae.value((o=function(){return h},i=Yt(Qo),u=dt(function(e){var t,r;return ft("custom.definition",Qe([ot("dom","dom",Le(),Qe([_t("tag"),Ht("styles",{}),Ht("classes",[]),Ht("attributes",{}),Pt("value"),Pt("innerHtml")])),_t("components"),_t("uid"),Ht("events",{}),Ht("apis",{}),ot("eventOrder","eventOrder",((t={})[dr()]=["disabling",fi,"toggling","typeaheadevents"],t[cr()]=[fi,"focusing","keying"],t[br()]=[fi,"disabling","toggling","representing"],t[tr()]=[fi,"representing","streaming","invalidating"],t[kr()]=[fi,"representing","item-events","tooltipping"],t[Gn()]=["focusing",fi,"item-type-events"],t[jn()]=["focusing",fi,"item-type-events"],t[Yn()]=["item-type-events","tooltipping"],t[fr()]=["receiving","reflecting","tooltipping"],r=t,Me.mergeWithThunk(n(r))),vt()),Pt("domModification")]),e)}(r=w)),a=function(e){var t,n;return function(e,t){return n=e,o=H(r=t,function(e){return zt(e.name(),[_t("config"),Ht("state",oi)])}),i=ft("component.behaviours",Qe(o),n.behaviours).fold(function(e){throw new Error(gt(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},function(e){return e}),{list:r,data:we(i,function(e){var t=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return t}})};var n,r,o,i}(e,(t=_e(e,"behaviours").getOr({}),n=U(be(t),function(e){return void 0!==t[e]}),H(n,function(e){return t[e].me})))}(r),d=function(e,t,n){var r,o,i,u=l(l({},(r=e).dom),{uid:r.uid,domChildren:H(r.components,function(e){return e.element})}),a=e.domModification.fold(function(){return ai({})},ai);return i=0<t.length?function(e,t,n,r){var o=l({},t);V(n,function(t){o[t.name()]=t.exhibit(e,r)});var i=ui(o,function(e,t){return{name:e,modification:t}}),u=function(e){return W(e,function(e,t){return l(l({},t.modification),e)},{})},a=W(i.classes,function(e,t){return t.modification.concat(e)},[]),c=u(i.attributes),s=u(i.styles);return ai({classes:a,attributes:c,styles:s})}(n,{"alloy.base.modification":a},t,u):a,l(l({},o=u),{attributes:l(l({},o.attributes),i.attributes),styles:l(l({},o.styles),i.styles),classes:o.classes.concat(i.classes)})}(u,c=a.list,s=a.data),m=function(e){var t,n=Zt(e.tag);return t=n.dom,xe(e.attributes,function(e,n){Bo(t,n,e)}),vi(n,e.classes),_i(n,e.styles),e.innerHtml.each(function(e){return No(n,e)}),_o(n,e.domChildren),e.value.each(function(e){Mi(n,e)}),$o(n,e.uid),n}(d),g=function(e,t,n){var r,o;return r=e.eventOrder,o=function(e,t,n){var r,o,i=l(l({},n),(r=e,o={},V(t,function(e){o[e.name()]=e.handlers(r)}),o));return ui(i,si)}(n,t,{"alloy.base.behaviour":e.events}),li(o,r).getOrDie()}(u,c,s),p=Yt(u.components),h={getSystem:i.get,config:function(e){var t=s;return(A(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(r,null,2))})()},hasConfigured:function(e){return A(s[e.name()])},spec:r,readState:function(e){return s[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return u.apis},connect:function(e){i.set(e)},disconnect:function(){i.set(Jo(o))},element:m,syncComponents:function(){var e=mo(m),t=K(e,function(e){return i.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});p.set(t)},components:p.get,events:g}))}(e.hasOwnProperty("uid")?e:l({uid:Fi("")},e)).getOrDie()},function(e){return e})},Hi=ni,Vi=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Ei(n,e);return parseFloat(o)||0}return r},r=function(e,t){return q(t,function(t,n){var r=Ei(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!R(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;yi(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return o<t?t-o:0}}},ji=Vi("height",function(e){var t=e.dom;return xi(e)?t.getBoundingClientRect().height:t.offsetHeight}),Ui=function(e){return ji.get(e)},Wi=function(e){return ji.getOuter(e)},qi=function(e,t){return{left:e,top:t,translate:function(n,r){return qi(e+n,t+r)}}},Gi=qi,$i=function(e,t){return void 0!==e?e:void 0!==t?t:0},Xi=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Gi(n.offsetLeft,n.offsetTop);var i=$i(null==r?void 0:r.pageYOffset,o.scrollTop),u=$i(null==r?void 0:r.pageXOffset,o.scrollLeft),a=$i(o.clientTop,n.clientTop),c=$i(o.clientLeft,n.clientLeft);return Ki(e).translate(u-c,i-a)},Ki=function(e){var t,n=e.dom,r=n.ownerDocument.body;return r===n?Gi(r.offsetLeft,r.offsetTop):xi(e)?(t=n.getBoundingClientRect(),Gi(t.left,t.top)):Gi(0,0)},Yi=Vi("width",function(e){return e.dom.offsetWidth}),Ji=function(e){return Yi.get(e)},Qi=function(e){return Yi.getOuter(e)},Zi=function(e){var n=tn(function(e){if(vo()&&E(e.target)){var t=tn(e.target);if(to(t)&&function(e){return E(e.dom.shadowRoot)}(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return te(n)}}return w.from(e.target)}(e).getOr(e.target)),r=function(){return e.stopPropagation()},o=function(){return e.preventDefault()},i=t(o,r);return{target:n,x:e.clientX,y:e.clientY,stop:r,prevent:o,kill:i,raw:e}},eu=function(e,t,n,r,i){var u,a,c=(u=n,a=r,function(e){u(e)&&a(Zi(e))});return e.dom.addEventListener(t,c,i),{unbind:o(tu,e,t,c,i)}},tu=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},nu=function(e){var t=void 0!==e?e.dom:document;return Gi(t.body.scrollLeft||t.documentElement.scrollLeft,t.body.scrollTop||t.documentElement.scrollTop)},ru=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},ou=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},iu=function(e){var t,n,r=void 0===e?window:e,o=nu(tn(r.document));return n=void 0===(t=r)?window:t,w.from(n.visualViewport).fold(function(){var e=r.document.documentElement;return ou(o.left,o.top,e.clientWidth,e.clientHeight)},function(e){return ou(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)})},uu=function(e,t){return e.view(t).fold(n([]),function(t){var n=e.owner(t),r=uu(e,n);return[t].concat(r)})},au=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?w.none():w.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(tn)},owner:io}),cu=function(e){var t,n,r,i,u=tn(document),a=nu(u);return(t=e,r=(n=au).owner(t),i=uu(n,r),w.some(i)).fold(o(Xi,e),function(t){var n=Ki(e),r=W(t,function(e,t){var n=Ki(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return Gi(r.left+n.left+a.left,r.top+n.top+a.top)})},su=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},lu=function(e){var t=Xi(e),n=Qi(e),r=Wi(e);return su(t.left,t.top,n,r)},fu=function(e){var t=cu(e),n=Qi(e),r=Wi(e);return su(t.left,t.top,n,r)},du=function(){return iu(window)};function mu(e,t,n,r,o){return e(n,r)?w.some(n):A(o)&&o(n)?w.none():t(n,r,o)}var gu,pu,hu=function(e,t,n){for(var r=e.dom,o=A(n)?n:a;r.parentNode;){var i=tn(r=r.parentNode);if(t(i))return w.some(i);if(o(i))break}return w.none()},vu=function(e,t,n){return mu(function(e,t){return t(e)},hu,e,t,n)},bu=function(e,t,n){return vu(e,t,n).isSome()},yu=function(e,t,n){return hu(e,function(e){return Bn(e,t)},n)},xu=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Dn(o)?w.none():w.from(o.querySelector(n)).map(tn);var n,r,o},wu=function(e,t,n){return mu(Bn,yu,e,t,n)},Cu=function(){var e=jo("aria-owns");return{id:e,link:function(t){Do(t,"aria-owns",e)},unlink:function(e){Lo(e,"aria-owns")}}},Su=function(e,t){return bu(t,function(t){return Pn(t,e.element)},a)||function(e,t){return vu(t,function(e){if(!to(e))return!1;var t=Po(e,"id");return void 0!==t&&-1<t.indexOf("aria-owns")}).bind(function(e){var t=Po(e,"id"),n=bo(e);return xu(n,'[aria-owns="'+t+'"]')}).exists(function(t){return Su(e,t)})}(e,t)};(pu=gu=gu||{})[pu.STOP=0]="STOP",pu[pu.NORMAL=1]="NORMAL",pu[pu.LOGGING=2]="LOGGING";var ku,Ou,_u=Yt({}),Tu=["alloy/data/Fields","alloy/debugging/Debugging"],Eu=function(e,t,n){var r,o,i,u;switch(_e(_u.get(),e).orThunk(function(){var t=be(_u.get());return oe(t,function(t){return-1<e.indexOf(t)?w.some(_u.get()[t]):w.none()})}).getOr(gu.NORMAL)){case gu.NORMAL:return n(Au());case gu.LOGGING:var a=(r=e,o=t,i=[],u=(new Date).getTime(),{logEventCut:function(e,t,n){i.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){i.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){i.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){i.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){i.push({outcome:"response",purpose:n,target:t})},write:function(){var e=(new Date).getTime();I(["mousemove","mouseover","mouseout",br()],r)||console.log(r,{event:r,time:e-u,target:o.dom,sequence:H(i,function(e){return I(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Fo(e.target)+")":e.outcome})})}}),c=n(a);return a.write(),c;case gu.STOP:return!0}},Au=n({logEventCut:e,logEventStopped:e,logNoParent:e,logEventNoHandlers:e,logEventResponse:e,write:e}),Ru=n([_t("menu"),_t("selectedMenu")]),Nu=n([_t("item"),_t("selectedItem")]),Bu=(n(Qe(Nu().concat(Ru()))),n(Qe(Nu()))),Du=Nt("initSize",[_t("numColumns"),_t("numRows")]),Pu=function(){return Nt("markers",[_t("backgroundMenu")].concat(Ru()).concat(Nu()))},Mu=function(e){return Nt("markers",H(e,_t))},Iu=function(e,t,n){return function(){var e=new Error;if(void 0!==e.stack){var t=e.stack.split("\n");G(t,function(e){return 0<e.indexOf("alloy")&&!L(Tu,function(t){return-1<e.indexOf(t)})}).getOr("unknown")}}(),ot(t,t,n,st(function(e){return ae.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)})}))},Lu=function(t){return Iu(0,t,Ie(e))},Fu=function(e){return Iu(0,e,Ie(w.none))},zu=function(e){return Iu(0,e,Le())},Hu=function(e){return Iu(0,e,Le())},Vu=function(e,t){return Kt(e,n(t))},ju=function(e){return Kt(e,r)},Uu=n(Du),Wu=function(e,t,n,r,o,i){return{x:e,y:t,bubble:n,direction:r,boundsRestriction:o,label:i}},qu=Ae([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Gu=qu.southeast,$u=qu.southwest,Xu=qu.northeast,Ku=qu.northwest,Yu=qu.south,Ju=qu.north,Qu=qu.east,Zu=qu.west,ea=function(e,t){return function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i)}return n}(["left","right","top","bottom"],function(n){return _e(t,n).map(function(t){return function(e,t){switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}}(e,t)})})},ta=function(e){return e.x},na=function(e,t){return e.x+e.width/2-t.width/2},ra=function(e,t){return e.x+e.width-t.width},oa=function(e,t){return e.y-t.height},ia=function(e){return e.y+e.height},ua=function(e,t){return e.y+e.height/2-t.height/2},aa=function(e,t,n){return Wu(ta(e),ia(e),n.southeast(),Gu(),ea(e,{left:1,top:3}),"layout-se")},ca=function(e,t,n){return Wu(ra(e,t),ia(e),n.southwest(),$u(),ea(e,{right:0,top:3}),"layout-sw")},sa=function(e,t,n){return Wu(ta(e),oa(e,t),n.northeast(),Xu(),ea(e,{left:1,bottom:2}),"layout-ne")},la=function(e,t,n){return Wu(ra(e,t),oa(e,t),n.northwest(),Ku(),ea(e,{right:0,bottom:2}),"layout-nw")},fa=function(e,t,n){return Wu(na(e,t),oa(e,t),n.north(),Ju(),ea(e,{bottom:2}),"layout-n")},da=function(e,t,n){return Wu(na(e,t),ia(e),n.south(),Yu(),ea(e,{top:3}),"layout-s")},ma=function(e,t,n){return Wu((r=e).x+r.width,ua(e,t),n.east(),Qu(),ea(e,{left:0}),"layout-e");var r},ga=function(e,t,n){return Wu(e.x-t.width,ua(e,t),n.west(),Zu(),ea(e,{right:1}),"layout-w")},pa=function(){return[aa,ca,sa,la,da,fa,ma,ga]},ha=function(){return[ca,aa,la,sa,da,fa,ma,ga]},va=function(){return[sa,la,aa,ca,fa,da]},ba=function(){return[la,sa,ca,aa,fa,da]},ya=function(){return[aa,ca,sa,la,da,fa]},xa=function(){return[ca,aa,la,sa,da,fa]},wa=Object.freeze({__proto__:null,events:function(e){return zr([jr(fr(),function(t,n){var r,o,i=e.channels,u=be(i),a=n,c=(r=u,(o=a).universal?r:U(r,function(e){return I(o.channels,e)}));V(c,function(e){var n=i[e],r=n.schema,o=mt("channel["+e+"] data\nReceiver: "+Fo(t.element),r,a.data);n.onReceive(t,o)})})])}}),Ca=[Tt("channels",lt(ae.value,Je([zu("onReceive"),Ht("schema",vt())])))],Sa=function(e,t,n){return Jr(function(r,o){n(r,e,t)})},ka=function(e){return{key:e,value:void 0}},Oa=function(e,t,r,i,u,a,c){var s=function(e){return Ee(e,r)?e[r]():w.none()},f=we(u,function(e,t){return function(e,t,r){var o,i,u,a,c,s;return o=function(o){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[o].concat(i);return o.config({name:n(e)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+r)},function(e){var n=Array.prototype.slice.call(a,1);return t.apply(void 0,[o,e.config,e.state].concat(n))})},i=r,a=(u=t.toString()).indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),o.toFunctionAnnotation=function(){return{name:i,parameters:Zo(s.slice(0,1).concat(s.slice(3)))}},o}(r,e,t)}),d=we(a,ei),m=l(l(l({},d),f),{revoke:o(ka,r),config:function(t){var n=mt(r+"-config",e,t);return{key:r,value:{config:n,me:m,configAsRaw:Pe(function(){return mt(r+"-config",e,t)}),initialConfig:t,state:c}}},schema:n(t),exhibit:function(e,t){return s(e).bind(function(e){return _e(i,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(ai({}))},name:n(r),handlers:function(e){return s(e).map(function(e){return _e(i,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return m},_a=Ue,Ta=Je([_t("fields"),_t("name"),Ht("active",{}),Ht("apis",{}),Ht("state",oi),Ht("extra",{})]),Ea=function(e){var t=mt("Creating behaviour: "+e.name,Ta,e);return function(e,t,n,r,o,i){var u=Je(e),a=zt(t,[Mt("config",Je(e))]);return Oa(u,a,t,n,r,o,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Aa=Je([_t("branchKey"),_t("branches"),_t("name"),Ht("active",{}),Ht("apis",{}),Ht("state",oi),Ht("extra",{})]),Ra=function(e){var t,n,r,o,i,u,a,c,s=mt("Creating behaviour: "+e.name,Aa,e);return t=ht(s.branchKey,s.branches),r=s.active,o=s.apis,i=s.extra,u=s.state,c=zt(n=s.name,[Mt("config",a=t)]),Oa(a,c,n,r,o,i,u)},Na=n(void 0),Ba=Ea({fields:Ca,name:"receiving",active:wa}),Da=Object.freeze({__proto__:null,exhibit:function(e,t){return ai({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),Pa=function(e){return e.dom.focus()},Ma=function(e){return void 0===e&&(e=tn(document)),w.from(e.dom.activeElement).map(tn)},Ia=function(e){return Ma(bo(e)).filter(function(t){return e.dom.contains(t.dom)})},La=function(t,n){var r=bo(n),o=Ma(r).bind(function(e){var t,r,o=function(t){return Pn(e,t)};return o(n)?w.some(n):(t=o,(r=function(e){for(var n=0;n<e.childNodes.length;n++){var o=tn(e.childNodes[n]);if(t(o))return w.some(o);var i=r(e.childNodes[n]);if(i.isSome())return i}return w.none()})(n.dom))}),i=t(n);return o.each(function(t){Ma(r).filter(function(e){return Pn(e,t)}).fold(function(){Pa(t)},e)}),i},Fa=function(e,t,n,r,o){return{position:e,left:t,top:n,right:r,bottom:o}},za=function(e,t){var n=function(e){return e+"px"};Ti(e,{position:w.some(t.position),left:t.left.map(n),top:t.top.map(n),right:t.right.map(n),bottom:t.bottom.map(n)})},Ha=Ae([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Va=function(e,t,n,r,o,i){var u=t.x-n,a=t.y-r,c=o-(u+t.width),s=i-(a+t.height),l=w.some(u),f=w.some(a),d=w.some(c),m=w.some(s),g=w.none();return t.direction.fold(function(){return Fa(e,l,f,g,g)},function(){return Fa(e,g,f,d,g)},function(){return Fa(e,l,g,g,m)},function(){return Fa(e,g,g,d,m)},function(){return Fa(e,l,f,g,g)},function(){return Fa(e,l,g,g,m)},function(){return Fa(e,l,f,g,g)},function(){return Fa(e,g,f,d,g)})},ja=function(e,t){var n=o(cu,t),r=e.fold(n,n,function(){var e=nu();return cu(t).translate(-e.left,-e.top)}),i=Qi(t),u=Wi(t);return su(r.left,r.top,i,u)},Ua=function(e,t,r){var o=Gi(t,r);return e.fold(n(o),n(o),function(){var e=nu();return o.translate(-e.left,-e.top)})},Wa=Ha.relative,qa=Ha.fixed,Ga=function(e,t,n,r){var o=e+t;return r<o?n:o<n?r:o},$a=function(e,t,n){return Math.min(Math.max(e,t),n)},Xa=Ae([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ka=function(e,t){var n,r,o;n=e,r=Math.floor(t),o=ji.max(n,r,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Oi(n,"max-height",o+"px")},Ya=n(function(e,t){Ka(e,t),_i(e,{"overflow-x":"hidden","overflow-y":"auto"})}),Ja=n(function(e,t){Ka(e,t)}),Qa=function(e,t,n){return void 0===e[t]?n:e[t]},Za=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],ec=function(e,t,n){var r=function(e){return _e(n,e).getOr([])},o=function(e,t,n){var o=Q(Za,n);return{offset:Gi(e,t),classesOn:K(n,r),classesOff:K(o,r)}};return{southeast:function(){return o(-e,t,["top","alignLeft"])},southwest:function(){return o(e,t,["top","alignRight"])},south:function(){return o(-e/2,t,["top","alignCentre"])},northeast:function(){return o(-e,-t,["bottom","alignLeft"])},northwest:function(){return o(e,-t,["bottom","alignRight"])},north:function(){return o(-e/2,-t,["bottom","alignCentre"])},east:function(){return o(e,-t/2,["valignCentre","left"])},west:function(){return o(-e,-t/2,["valignCentre","right"])},innerNorthwest:function(){return o(-e,t,["top","alignRight"])},innerNortheast:function(){return o(e,t,["top","alignLeft"])},innerNorth:function(){return o(-e/2,t,["top","alignCentre"])},innerSouthwest:function(){return o(-e,-t,["bottom","alignRight"])},innerSoutheast:function(){return o(e,-t,["bottom","alignLeft"])},innerSouth:function(){return o(-e/2,-t,["bottom","alignCentre"])},innerWest:function(){return o(e,-t/2,["valignCentre","right"])},innerEast:function(){return o(-e,-t/2,["valignCentre","left"])}}},tc=function(){return ec(0,0,{})},nc=function(e,t){return function(n){return"rtl"===rc(n)?t:e}},rc=function(e){return"rtl"===Ei(e,"direction")?"rtl":"ltr"};(Ou=ku=ku||{}).TopToBottom="toptobottom",Ou.BottomToTop="bottomtotop";var oc,ic,uc,ac,cc="data-alloy-vertical-dir",sc=function(e){return bu(e,function(e){return to(e)&&Po(e,"data-alloy-vertical-dir")===ku.BottomToTop})},lc=function(){return zt("layouts",[_t("onLtr"),_t("onRtl"),Pt("onBottomLtr"),Pt("onBottomRtl")])},fc=function(e,t,n,r,o,i,u){var a=u.map(sc).getOr(!1),c=t.layouts.map(function(t){return t.onLtr(e)}),s=t.layouts.map(function(t){return t.onRtl(e)}),l=a?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(e)})}).or(c).getOr(o):c.getOr(n),f=a?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(e)})}).or(s).getOr(i):s.getOr(r);return nc(l,f)(e)},dc=[_t("hotspot"),Pt("bubble"),Ht("overrides",{}),lc(),Vu("placement",function(e,t,n){var r=ja(n,t.hotspot.element),o=fc(e.element,t,ya(),xa(),va(),ba(),w.some(t.hotspot.element));return w.some({anchorBox:r,bubble:t.bubble.getOr(tc()),overrides:t.overrides,layouts:o,placer:w.none()})})],mc=[_t("x"),_t("y"),Ht("height",0),Ht("width",0),Ht("bubble",tc()),Ht("overrides",{}),lc(),Vu("placement",function(e,t,n){var r=Ua(n,t.x,t.y),o=su(r.left,r.top,t.width,t.height),i=fc(e.element,t,pa(),ha(),pa(),ha(),w.none());return w.some({anchorBox:o,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:w.none()})})],gc=Ae([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),pc=function(e){return e.fold(r,function(e,t,n){return e.translate(-t,-n)})},hc=function(e){return e.fold(r,r)},vc=function(e){return q(e,function(e,t){return e.translate(t.left,t.top)},Gi(0,0))},bc=function(e){var t=H(e,hc);return vc(t)},yc=gc.screen,xc=gc.absolute,wc=function(e,t,n){var r,o,i=io(e.element),u=nu(i),a=(r=e,o=co(n.root).dom,w.from(o.frameElement).map(tn).filter(function(e){var t=io(e),n=io(r.element);return Pn(t,n)}).map(Xi).getOr(u));return xc(a,u.left,u.top)},Cc=function(e,t,n,r){var o=e,i=t,u=n,a=r;e<0&&(o=0,u=n+e),t<0&&(i=0,a=r+t);var c=yc(Gi(o,i));return w.some({point:c,width:u,height:a})},Sc=function(e,t,n,r,o){return e.map(function(e){var i=[t,e.point],u=r.fold(function(){return bc(i)},function(){return bc(i)},function(){return e=H(i,pc),vc(e);var e}),a={x:u.left,y:u.top,width:e.width,height:e.height},c=(n.showAbove?va:ya)(),s=(n.showAbove?ba:xa)(),l=fc(o,n,c,s,c,s,w.none());return{anchorBox:a,bubble:n.bubble.getOr(tc()),overrides:n.overrides,layouts:l,placer:w.none()}})},kc=[_t("node"),_t("root"),Pt("bubble"),lc(),Ht("overrides",{}),Ht("showAbove",!1),Vu("placement",function(e,t,n){var r=wc(e,0,t);return t.node.filter(xi).bind(function(o){var i=o.dom.getBoundingClientRect(),u=Cc(i.left,i.top,i.width,i.height),a=t.node.getOr(e.element);return Sc(u,r,t,n,a)})})],Oc=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},_c=(Ae([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),function(e){return e.fold(r,r,r)}),Tc=Ae([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ec={domRange:Tc.domRange,relative:Tc.relative,exact:Tc.exact,exactFromRange:function(e){return Tc.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=e.match({domRange:function(e){return tn(e.startContainer)},relative:function(e,t){return _c(e)},exact:function(e,t,n,r){return e}});return co(t)},range:Oc},Ac=function(e,t,n){var r,o,i=e.document.createRange();return r=i,t.fold(function(e){r.setStartBefore(e.dom)},function(e,t){r.setStart(e.dom,t)},function(e){r.setStartAfter(e.dom)}),o=i,n.fold(function(e){o.setEndBefore(e.dom)},function(e,t){o.setEnd(e.dom,t)},function(e){o.setEndAfter(e.dom)}),i},Rc=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},Nc=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Bc=Ae([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Dc=function(e,t,n){return t(tn(n.startContainer),n.startOffset,tn(n.endContainer),n.endOffset)},Pc=(oc=no,{get:function(e){if(!oc(e))throw new Error("Can only get text value of a text node");return ic(e).getOr("")},getOption:ic=function(e){return oc(e)?w.from(e.dom.nodeValue):w.none()},set:function(e,t){if(!oc(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),Mc=function(e){return Pc.getOption(e)},Ic=["img","br"],Lc=function(e){return Mc(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf(" ")}).isSome()||I(Ic,Zr(e))},Fc=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Dn(o)?[]:H(o.querySelectorAll(n),tn);var n,r,o},zc=function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return w.some(Oc(tn(t.startContainer),t.startOffset,tn(n.endContainer),n.endOffset))}return w.none()},Hc=function(e){if(null===e.anchorNode||null===e.focusNode)return zc(e);var t=tn(e.anchorNode),n=tn(e.focusNode);return function(e,t,n,r){var o,i,u,a,c,s=(i=t,u=n,a=r,(c=io(o=e).dom.createRange()).setStart(o.dom,i),c.setEnd(u.dom,a),c),l=Pn(e,n)&&t===r;return s.collapsed&&!l}(t,e.anchorOffset,n,e.focusOffset)?w.some(Oc(t,e.anchorOffset,n,e.focusOffset)):zc(e)},Vc=function(e,t){var r,o,i,u,a=function(e,t){var r,o,i,u=(r=e,t.match({domRange:function(e){return{ltr:n(e),rtl:w.none}},relative:function(e,t){return{ltr:Pe(function(){return Ac(r,e,t)}),rtl:Pe(function(){return w.some(Ac(r,t,e))})}},exact:function(e,t,n,o){return{ltr:Pe(function(){return Rc(r,e,t,n,o)}),rtl:Pe(function(){return w.some(Rc(r,n,o,e,t))})}}}));return(i=(o=u).ltr()).collapsed?o.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Bc.rtl(tn(e.endContainer),e.endOffset,tn(e.startContainer),e.startOffset)}).getOrThunk(function(){return Dc(0,Bc.ltr,i)}):Dc(0,Bc.ltr,i)}(r=e,t).match({ltr:function(e,t,n,o){var i=r.document.createRange();return i.setStart(e.dom,t),i.setEnd(n.dom,o),i},rtl:function(e,t,n,o){var i=r.document.createRange();return i.setStart(n.dom,o),i.setEnd(e.dom,t),i}});return 0<(u=0<(i=(o=a).getClientRects()).length?i[0]:o.getBoundingClientRect()).width||0<u.height?w.some(u).map(Nc):w.none()},jc=function(e,t){return{element:e,offset:t}},Uc=function(e,t){var n=mo(e);if(0===n.length)return jc(e,t);if(t<n.length)return jc(n[t],0);var r=n[n.length-1],o=no(r)?Pc.get(r).length:mo(r).length;return jc(r,o)},Wc=function(e,t){return(no(e)?jc:Uc)(e,t)},qc=function(e,t){return t.getSelection.getOrThunk(function(){return function(){return function(e){return w.from(e.getSelection()).filter(function(e){return 0<e.rangeCount}).bind(Hc)}(e)}})().map(function(e){var t=Wc(e.start,e.soffset),n=Wc(e.finish,e.foffset);return Ec.range(t.element,t.offset,n.element,n.offset)})},Gc=[Pt("getSelection"),_t("root"),Pt("bubble"),lc(),Ht("overrides",{}),Ht("showAbove",!1),Vu("placement",function(e,t,n){var r=co(t.root).dom,o=wc(e,0,t),i=qc(r,t).bind(function(e){return Vc(r,Ec.exactFromRange(e)).orThunk(function(){var t=en("\ufeff");return Co(e.start,t),Vc(r,Ec.exact(t,0,t,1)).map(function(e){return Eo(t),e})}).bind(function(e){return Cc(e.left,e.top,e.width,e.height)})}),u=qc(r,t).bind(function(e){return to(e.start)?w.some(e.start):lo(e.start)}).getOr(e.element);return Sc(i,o,t,n,u)})],$c=function(e){return e.x+e.width},Xc=function(e,t){return e.x-t.width},Kc=function(e,t){return e.y-t.height+e.height},Yc=function(e){return e.y},Jc=function(e,t,n){return Wu($c(e),Yc(e),n.southeast(),Gu(),ea(e,{left:0,top:2}),"link-layout-se")},Qc=function(e,t,n){return Wu(Xc(e,t),Yc(e),n.southwest(),$u(),ea(e,{right:1,top:2}),"link-layout-sw")},Zc=function(e,t,n){return Wu($c(e),Kc(e,t),n.northeast(),Xu(),ea(e,{left:0,bottom:3}),"link-layout-ne")},es=function(e,t,n){return Wu(Xc(e,t),Kc(e,t),n.northwest(),Ku(),ea(e,{right:1,bottom:3}),"link-layout-nw")},ts=function(){return[Jc,Qc,Zc,es]},ns=function(){return[Qc,Jc,es,Zc]},rs=[_t("item"),lc(),Ht("overrides",{}),Vu("placement",function(e,t,n){var r=ja(n,t.item.element),o=fc(e.element,t,ts(),ns(),ts(),ns(),w.none());return w.some({anchorBox:r,bubble:tc(),overrides:t.overrides,layouts:o,placer:w.none()})})],os=ht("anchor",{selection:Gc,node:kc,hotspot:dc,submenu:rs,makeshift:mc}),is=function(t,i,u,a,c){!function(t,i,u,a,c,s){var l,f=Qa(s,"maxHeightFunction",Ya()),d=Qa(s,"maxWidthFunction",e),m=t.anchorBox,g=t.origin,p={bounds:(l=g,c.fold(function(){return l.fold(du,du,su)},function(e){return l.fold(e,e,function(){var t=e(),n=Ua(l,t.x,t.y);return su(n.left,n.top,t.width,t.height)})})),origin:g,preference:a,maxHeightFunction:f,maxWidthFunction:d};!function(e,t,i,u){var a,c,s=function(e,t,i,u){Bi(t,"max-height"),Bi(t,"max-width");var a,c,s,l,f,d,m,g,p={width:Qi(a=t),height:Wi(a)};return l=i,f=u.bounds,d=(s=p).width,m=s.height,g=function(e,t,o,i){return function(e,t,o,i){var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,C,S,k,O,_,T,E,A,R,N,B,D,P,M,I,L,F,z=e.x,H=e.y,V=e.bubble.offset,j=V.left,U=V.top,W=(a=e.boundsRestriction,c=V,l=(s=function(e,t){var n="top"===e||"bottom"===e?c.top:c.left;return _e(a,e).bind(r).bind(function(n){return"left"===e||"top"===e?t<=n?w.some(n):w.none():n<=t?w.some(n):w.none()}).map(function(e){return e+n}).getOr(t)})("left",(u=i).x),f=s("top",u.y),d=s("right",u.right),m=s("bottom",u.bottom),su(l,f,d-l,m-f)),q=W.y,G=W.bottom,$=W.x,X=W.right,K=H+U,Y=(v=o,y=(b=W).x,S=b.height,O=(x=b.y)<=(p=K),_=(k=y<=(g=z+j))&&O,T=g+(h=t)<=y+(C=b.width)&&p+v<=x+S,E=Math.abs(Math.min(h,k?y+C-g:y-(g+h))),A=Math.abs(Math.min(v,O?x+S-p:x-(p+v))),R=Math.max(b.x,b.right-h),N=Math.max(b.y,b.bottom-v),{originInBounds:_,sizeInBounds:T,limitX:$a(g,b.x,R),limitY:$a(p,b.y,N),deltaW:E,deltaH:A}),J=Y.originInBounds,Q=Y.sizeInBounds,Z=Y.limitX,ee=Y.limitY,te=Y.deltaW,ne=Y.deltaH,re=n(ee+ne-q),oe=(D=B=n(G-ee),e.direction.fold(B,B,P=re,P,B,P,D,D)),ie=n(Z+te-$),ue=n(X-Z),ae={x:Z,y:ee,width:te,height:ne,maxHeight:oe,maxWidth:(M=e.direction,L=I=ue,F=ie,M.fold(I,F,I,F,L,L,I,F)),direction:e.direction,classes:{on:e.bubble.classesOn,off:e.bubble.classesOff},label:e.label,candidateYforTest:K};return J&&Q?Xa.fit(ae):Xa.nofit(ae,te,ne)}(e(c,s,l),d,m,f).fold(Xa.fit,function(e,n,r){return i<r||o<n?Xa.nofit(e,n,r):Xa.nofit(t,o,i)})},q(u.preference,function(e,t){var n=o(g,t);return e.fold(Xa.fit,n)},Xa.nofit({x:(c=e).x,y:c.y,width:s.width,height:s.height,maxHeight:s.height,maxWidth:s.width,direction:Gu(),classes:{on:[],off:[]},label:"none",candidateYforTest:c.y},-1,-1)).fold(r,r)}(e,t,i,u);(function(e,t,n){var r;za(e,(r=t,n.origin.fold(function(){return Fa("absolute",w.some(r.x),w.some(r.y),w.none(),w.none())},function(e,t,n,o){return Va("absolute",r,e,t,n,o)},function(e,t,n,o){return Va("fixed",r,e,t,n,o)})))})(t,s,u),bi(a=t,(c=s.classes).off),vi(a,c.on),(0,u.maxHeightFunction)(t,s.maxHeight),(0,u.maxWidthFunction)(t,s.maxWidth)}(m,i,u,p)}({anchorBox:u.anchorBox,origin:i},c.element,u.bubble,u.layouts,a,u.overrides)},us=function(e,t,n,r,o,i){var u=i.map(lu);return as(e,t,n,r,o,u)},as=function(e,t,r,o,i,u){var a=mt("positioning anchor.info",os,o);La(function(){Oi(i.element,"position","fixed");var r=Ri(i.element,"visibility");Oi(i.element,"visibility","hidden");var o,c,s,l,f=t.useFixed()?(l=document.documentElement,qa(0,0,l.clientWidth,l.clientHeight)):(c=Xi((o=e).element),s=o.element.dom.getBoundingClientRect(),Wa(c.left,c.top,s.width,s.height)),d=a.placement,m=u.map(n).or(t.getBounds);d(e,a,f).each(function(t){t.placer.getOr(is)(e,f,t,m,i)}),r.fold(function(){Bi(i.element,"visibility")},function(e){Oi(i.element,"visibility",e)}),Ri(i.element,"left").isNone()&&Ri(i.element,"top").isNone()&&Ri(i.element,"right").isNone()&&Ri(i.element,"bottom").isNone()&&Ri(i.element,"position").is("fixed")&&Bi(i.element,"position")},i.element)},cs=Object.freeze({__proto__:null,position:function(e,t,n,r,o){us(e,t,n,r,o,w.none())},positionWithin:us,positionWithinBounds:as,getMode:function(e,t,n){return t.useFixed()?"fixed":"absolute"}}),ss=[Ht("useFixed",a),Pt("getBounds")],ls=Ea({fields:ss,name:"positioning",active:Da,apis:cs}),fs=function(e){Dr(e,kr());var t=e.components();V(t,fs)},ds=function(e){var t=e.components();V(t,ds),Dr(e,Sr())},ms=function(e,t){Oo(e.element,t.element)},gs=function(e,t){var n,r=e.components();V((n=e).components(),function(e){return Eo(e.element)}),To(n.element),n.syncComponents();var o=Q(r,t);V(o,function(t){fs(t),e.getSystem().removeFromWorld(t)}),V(t,function(t){t.getSystem().isConnected()?ms(e,t):(e.getSystem().addToWorld(t),ms(e,t),xi(e.element)&&ds(t)),e.syncComponents()})},ps=function(e,t){hs(e,t,Oo)},hs=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),xi(e.element)&&ds(t),e.syncComponents()},vs=function(e){fs(e),Eo(e.element),e.getSystem().removeFromWorld(e)},bs=function(e){var t=so(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()});vs(e),t.each(function(e){e.syncComponents()})},ys=function(e){var t=e.components();V(t,vs),To(e.element),e.syncComponents()},xs=function(e,t){ws(e,t,Oo)},ws=function(e,t,n){n(e,t.element);var r=mo(t.element);V(r,function(e){t.getByDom(e).each(ds)})},Cs=function(e){var t=mo(e.element);V(t,function(t){e.getByDom(t).each(fs)}),Eo(e.element)},Ss=function(e,t,n,r){n.get().each(function(t){ys(e)});var o=t.getAttachPoint(e);ps(o,e);var i=e.getSystem().build(r);return ps(e,i),n.set(i),i},ks=function(e,t,n,r){var o=Ss(e,t,n,r);return t.onOpen(e,o),o},Os=function(e,t,n){n.get().each(function(r){ys(e),bs(e),t.onClose(e,r),n.clear()})},_s=function(e,t,n){return n.isOpen()},Ts=function(e,t,n){var r,o,i=t.getAttachPoint(e);Oi(e.element,"position",ls.getMode(i)),o=t.cloakVisibilityAttr,Ri((r=e).element,"visibility").fold(function(){Lo(r.element,o)},function(e){Do(r.element,o,e)}),Oi(r.element,"visibility","hidden")},Es=function(e,t,n){var r,o,i;r=e.element,L(["top","left","right","bottom"],function(e){return Ri(r,e).isSome()})||Bi(e.element,"position"),i="visibility",Mo((o=e).element,t.cloakVisibilityAttr).fold(function(){return Bi(o.element,i)},function(e){return Oi(o.element,i,e)})},As=Object.freeze({__proto__:null,cloak:Ts,decloak:Es,open:ks,openWhileCloaked:function(e,t,n,r,o){Ts(e,t),ks(e,t,n,r),o(),Es(e,t)},close:Os,isOpen:_s,isPartOf:function(e,t,n,r){return _s(0,0,n)&&n.get().exists(function(n){return t.isPartOf(e,n,r)})},getState:function(e,t,n){return n.get()},setContent:function(e,t,n,r){return n.get().map(function(){return Ss(e,t,n,r)})}}),Rs=Object.freeze({__proto__:null,events:function(e,t){return zr([jr(hr(),function(n,r){Os(n,e,t)})])}}),Ns=[Lu("onOpen"),Lu("onClose"),_t("isPartOf"),_t("getAttachPoint"),Ht("cloakVisibilityAttr","data-precloak-visibility")],Bs=Ea({fields:Ns,name:"sandboxing",active:Rs,apis:As,state:Object.freeze({__proto__:null,init:function(){var e=Yt(w.none()),t=n("not-implemented");return ii({readState:t,isOpen:function(){return e.get().isSome()},clear:function(){e.set(w.none())},set:function(t){e.set(w.some(t))},get:function(){return e.get()}})}})}),Ds=n("dismiss.popups"),Ps=n("reposition.popups"),Ms=n("mouse.released"),Is=Je([Ht("isExtraPart",a),zt("fireEventInstead",[Ht("event",Or())])]),Ls=function(e){var t=mt("Dismissal",Is,e),n={};return n[Ds()]={schema:Je([_t("target")]),onReceive:function(e,n){Bs.isOpen(e)&&(Bs.isPartOf(e,n.target)||t.isExtraPart(e,n.target)||t.fireEventInstead.fold(function(){return Bs.close(e)},function(t){return Dr(e,t.event)}))}},n},Fs=Je([zt("fireEventInstead",[Ht("event",_r())]),Rt("doReposition")]),zs=function(e){var t=mt("Reposition",Fs,e),n={};return n[Ps()]={onReceive:function(e){Bs.isOpen(e)&&t.fireEventInstead.fold(function(){return t.doReposition(e)},function(t){return Dr(e,t.event)})}},n},Hs=function(e,t,n){t.store.manager.onLoad(e,t,n)},Vs=function(e,t,n){t.store.manager.onUnload(e,t,n)},js=Object.freeze({__proto__:null,onLoad:Hs,onUnload:Vs,setValue:function(e,t,n,r){t.store.manager.setValue(e,t,n,r)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),Us=Object.freeze({__proto__:null,events:function(e,t){var n=e.resetOnDom?[Kr(function(n,r){Hs(n,e,t)}),Yr(function(n,r){Vs(n,e,t)})]:[Sa(e,t,Hs)];return zr(n)}}),Ws=function(){var e=Yt(null);return ii({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},qs=function(){var e=Yt({}),t=Yt({});return ii({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},lookup:function(n){return _e(e.get(),n).orThunk(function(){return _e(t.get(),n)})},update:function(n){var r=e.get(),o=t.get(),i={},u={};V(n,function(e){i[e.value]=e,_e(e,"meta").each(function(t){_e(t,"text").each(function(t){u[t]=e})})}),e.set(l(l({},r),i)),t.set(l(l({},o),u))},clear:function(){e.set({}),t.set({})}})},Gs=Object.freeze({__proto__:null,memory:Ws,dataset:qs,manual:function(){return ii({readState:e})},init:function(e){return e.store.manager.state(e)}}),$s=function(e,t,n,r){var o=t.store;n.update([r]),o.setValue(e,r),t.onSetValue(e,r)},Xs=[Pt("initialValue"),_t("getFallbackEntry"),_t("getDataKey"),_t("setValue"),Vu("manager",{setValue:$s,getValue:function(e,t,n){var r=t.store,o=r.getDataKey(e);return n.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(e){return e})},onLoad:function(e,t,n){t.store.initialValue.each(function(r){$s(e,t,n,r)})},onUnload:function(e,t,n){n.clear()},state:qs})],Ks=[_t("getValue"),Ht("setValue",e),Pt("initialValue"),Vu("manager",{setValue:function(e,t,n,r){t.store.setValue(e,r),t.onSetValue(e,r)},getValue:function(e,t,n){return t.store.getValue(e)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:e,state:oi.init})],Ys=[Pt("initialValue"),Vu("manager",{setValue:function(e,t,n,r){n.set(r),t.onSetValue(e,r)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each(function(e){n.isNotSet()&&n.set(e)})},onUnload:function(e,t,n){n.clear()},state:Ws})],Js=[Vt("store",{mode:"memory"},ht("mode",{memory:Ys,manual:Ks,dataset:Xs})),Lu("onSetValue"),Ht("resetOnDom",!1)],Qs=Ea({fields:Js,name:"representing",active:Us,apis:js,extra:{setValueFrom:function(e,t){var n=Qs.getValue(t);Qs.setValue(e,n)}},state:Gs}),Zs=function(e,t){return Xt(e,{},H(t,function(t){return n=t.name(),r="Cannot configure "+t.name()+" for "+e,ot(n,n,Fe(),Ye(function(e){return pe("The field: "+n+" is forbidden. "+r)}));var n,r}).concat([Kt("dump",r)]))},el=function(e){return e.dump},tl=function(e,t){return l(l({},e.dump),_a(t))},nl=Zs,rl=tl,ol="placeholder",il=Ae([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ul=function(e){return Te(e,"uiType")},al=function(e,t,o,i){return function(e,t,r,o){return ul(r)&&r.uiType===ol?(u=r,a=o,(i=e).exists(function(e){return e!==u.owner})?il.single(!0,n(u)):_e(a,u.name).fold(function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+be(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))},function(e){return e.replace()})):il.single(!1,n(r));var i,u,a}(e,0,o,i).fold(function(n,r){var u=ul(o)?r(t,o.config,o.validated):r(t),a=_e(u,"components").getOr([]),c=K(a,function(n){return al(e,t,n,i)});return[l(l({},u),{components:c})]},function(e,n){if(ul(o)){var i=n(t,o.config,o.validated);return o.validated.preprocess.getOr(r)(i)}return n(t)})},cl=il.single,sl=il.multiple,ll=n(ol),fl=Ae([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),dl=Ht("factory",{sketch:r}),ml=Ht("schema",[]),gl=_t("name"),pl=ot("pname","pname",ze(function(e){return"<alloy."+jo(e.name)+">"}),vt()),hl=Kt("schema",function(){return[Pt("preprocess")]}),vl=Ht("defaults",n({})),bl=Ht("overrides",n({})),yl=Qe([dl,ml,gl,pl,vl,bl]),xl=Qe([dl,ml,gl,vl,bl]),wl=Qe([dl,ml,gl,pl,vl,bl]),Cl=Qe([dl,hl,gl,_t("unit"),pl,vl,bl]),Sl=function(e){return e.fold(w.some,w.none,w.some,w.some)},kl=function(e){var t=function(e){return e.name};return e.fold(t,t,t,t)},Ol=function(e,t){return function(n){var r=mt("Converting part type",t,n);return e(r)}},_l=Ol(fl.required,yl),Tl=Ol(fl.external,xl),El=Ol(fl.optional,wl),Al=Ol(fl.group,Cl),Rl=n("entirety"),Nl=Object.freeze({__proto__:null,required:_l,external:Tl,optional:El,group:Al,asNamedPart:Sl,name:kl,asCommon:function(e){return e.fold(r,r,r,r)},original:Rl}),Bl=function(e,t,n,r){return Be(t.defaults(e,n,r),n,{uid:e.partUids[t.name]},t.overrides(e,n,r))},Dl=function(e,t){var n={};return V(t,function(t){Sl(t).each(function(t){var r=Pl(e,t.pname);n[t.name]=function(n){var o=mt("Part: "+t.name+" in "+e,Qe(t.schema),n);return l(l({},r),{config:n,validated:o})}})}),n},Pl=function(e,t){return{uiType:ll(),owner:e,name:t}},Ml=function(e,t,n){return{uiType:ll(),owner:e,name:t,config:n,validated:{}}},Il=function(e){return K(e,function(e){return e.fold(w.none,w.some,w.none,w.none).map(function(e){return Nt(e.name,e.schema.concat([ju(Rl())]))}).toArray()})},Ll=function(e){return H(e,kl)},Fl=function(e,t,r){return o=t,i={},u={},V(r,function(e){e.fold(function(e){i[e.pname]=cl(!0,function(t,n,r){return e.factory.sketch(Bl(t,e,n,r))})},function(e){var t=o.parts[e.name];u[e.name]=n(e.factory.sketch(Bl(o,e,t[Rl()]),t))},function(e){i[e.pname]=cl(!1,function(t,n,r){return e.factory.sketch(Bl(t,e,n,r))})},function(e){i[e.pname]=sl(!0,function(t,n,r){return H(t[e.name],function(n){return e.factory.sketch(Be(e.defaults(t,n,r),n,e.overrides(t,n)))})})})}),{internals:n(i),externals:n(u)};var o,i,u},zl=function(e,t,r){return function(e,t,r,o){var i,u,a,c=we(o,function(e,t){return o=e,i=!1,{name:n(r=t),required:function(){return o.fold(function(e,t){return e},function(e,t){return e})},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+r);return i=!0,o}};var r,o,i}),s=(i=e,u=t,a=c,K(r,function(e){return al(i,u,e,a)}));return xe(c,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),s}(w.some(e),t,t.components,r)},Hl=function(e,t,n){var r=t.partUids[n];return e.getSystem().getByUid(r).toOptional()},Vl=function(e,t,n){return Hl(e,t,n).getOrDie("Could not find part: "+n)},jl=function(e,t,r){var o={},i=t.partUids,u=e.getSystem();return V(r,function(e){o[e]=n(u.getByUid(i[e]))}),o},Ul=function(e,t){var r=e.getSystem();return we(t.partUids,function(e,t){return n(r.getByUid(e))})},Wl=function(e){return be(e.partUids)},ql=function(e,t,r){var o={},i=t.partUids,u=e.getSystem();return V(r,function(e){o[e]=n(u.getByUid(i[e]).getOrDie())}),o},Gl=function(e,t){var n=Ll(t);return Ue(H(n,function(t){return{key:t,value:e+"-"+t}}))},$l=function(e){return ot("partUids","partUids",He(function(t){return Gl(t.uid,e)}),vt())},Xl=Object.freeze({__proto__:null,generate:Dl,generateOne:Ml,schemas:Il,names:Ll,substitutes:Fl,components:zl,defaultUids:Gl,defaultUidsSchema:$l,getAllParts:Ul,getAllPartNames:Wl,getPart:Hl,getPartOrDie:Vl,getParts:jl,getPartsOrDie:ql}),Kl=function(e,t,n,r,o){var i,u,a=(u=o,(0<(i=r).length?[Nt("parts",i)]:[]).concat([_t("uid"),Ht("dom",{}),Ht("components",[]),ju("originalSpec"),Ht("debug.sketcher",{})]).concat(u));return mt(e+" [SpecSchema]",Je(a.concat(t)),n)},Yl=function(e,t,n,r,o){var i=Jl(o),u=Il(n),a=$l(n),c=Kl(e,t,i,u,[a]),s=Fl(0,c,n);return r(c,zl(e,c,s.internals()),i,s.externals())},Jl=function(e){return Te(e,"uid")?e:l(l({},e),{uid:Ko("uid")})},Ql=Je([_t("name"),_t("factory"),_t("configFields"),Ht("apis",{}),Ht("extraApis",{})]),Zl=Je([_t("name"),_t("factory"),_t("configFields"),_t("partFields"),Ht("apis",{}),Ht("extraApis",{})]),ef=function(e){var t=mt("Sketcher for "+e.name,Ql,e),n=we(t.apis,ri),r=we(t.extraApis,ei);return l(l({name:t.name,configFields:t.configFields,sketch:function(e){return n=t.name,r=t.configFields,o=t.factory,i=Jl(e),o(Kl(n,r,i,[],[]),i);var n,r,o,i}},n),r)},tf=function(e){var t=mt("Sketcher for "+e.name,Zl,e),n=Dl(t.name,t.partFields),r=we(t.apis,ri),o=we(t.extraApis,ei);return l(l({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(e){return Yl(t.name,t.configFields,t.partFields,t.factory,e)},parts:n},r),o)},nf=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},rf=function(e,t){return e?w.some(t):w.none()},of=function(e){return"input"===Zr(e)&&"radio"!==Po(e,"type")||"textarea"===Zr(e)},uf=Object.freeze({__proto__:null,getCurrent:function(e,t,n){return t.find(e)}}),af=[_t("find")],cf=Ea({fields:af,name:"composing",apis:uf}),sf=function(e,t,n,r){var o=Fc(e.element,"."+t.highlightClass);V(o,function(n){L(r,function(e){return e.element===n})||(pi(n,t.highlightClass),e.getSystem().getByDom(n).each(function(n){t.onDehighlight(e,n),Dr(n,Br())}))})},lf=function(e,t,n,r){sf(e,t,0,[r]),ff(e,t,n,r)||(gi(r.element,t.highlightClass),t.onHighlight(e,r),Dr(r,Nr()))},ff=function(e,t,n,r){return hi(r.element,t.highlightClass)},df=function(e,t,n){return xu(e.element,"."+t.itemClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},mf=function(e,t,n){var r=Fc(e.element,"."+t.itemClass);return(0<r.length?w.some(r[r.length-1]):w.none()).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},gf=function(e,t,n,r){var o=Fc(e.element,"."+t.itemClass);return $(o,function(e){return hi(e,t.highlightClass)}).bind(function(t){var n=Ga(t,r,0,o.length-1);return e.getSystem().getByDom(o[n]).toOptional()})},pf=function(e,t,n){var r=Fc(e.element,"."+t.itemClass);return nf(H(r,function(t){return e.getSystem().getByDom(t).toOptional()}))},hf=Object.freeze({__proto__:null,dehighlightAll:function(e,t,n){return sf(e,t,0,[])},dehighlight:function(e,t,n,r){ff(e,t,n,r)&&(pi(r.element,t.highlightClass),t.onDehighlight(e,r),Dr(r,Br()))},highlight:lf,highlightFirst:function(e,t,n){df(e,t).each(function(r){lf(e,t,n,r)})},highlightLast:function(e,t,n){mf(e,t).each(function(r){lf(e,t,n,r)})},highlightAt:function(e,t,n,r){(function(e,t,n,r){var o=Fc(e.element,"."+t.itemClass);return w.from(o[r]).fold(function(){return ae.error(new Error("No element found with index "+r))},e.getSystem().getByDom)})(e,t,0,r).fold(function(e){throw e},function(r){lf(e,t,n,r)})},highlightBy:function(e,t,n,r){var o=pf(e,t);G(o,r).each(function(r){lf(e,t,n,r)})},isHighlighted:ff,getHighlighted:function(e,t,n){return xu(e.element,"."+t.highlightClass).bind(function(t){return e.getSystem().getByDom(t).toOptional()})},getFirst:df,getLast:mf,getPrevious:function(e,t,n){return gf(e,t,0,-1)},getNext:function(e,t,n){return gf(e,t,0,1)},getCandidates:pf}),vf=[_t("highlightClass"),_t("itemClass"),Lu("onHighlight"),Lu("onDehighlight")],bf=Ea({fields:vf,name:"highlighting",apis:hf}),yf=[8],xf=[9],wf=[13],Cf=[27],Sf=[32],kf=[37],Of=[38],_f=[39],Tf=[40],Ef=function(e,t,n){var r=J(e.slice(0,t)),o=J(e.slice(t+1));return G(r.concat(o),n)},Af=function(e,t,n){var r=J(e.slice(0,t));return G(r,n)},Rf=function(e,t,n){var r=e.slice(0,t),o=e.slice(t+1);return G(o.concat(r),n)},Nf=function(e,t,n){var r=e.slice(t+1);return G(r,n)},Bf=function(e){return function(t){return I(e,t.raw.which)}},Df=function(e){return function(t){return Y(e,function(e){return e(t)})}},Pf=function(e){return!0===e.raw.shiftKey},Mf=function(e){return!0===e.raw.ctrlKey},If=i(Pf),Lf=function(e,t){return{matches:e,classification:t}},Ff=function(e,t,n){t.exists(function(e){return n.exists(function(t){return Pn(t,e)})})||Pr(e,Tr(),{prevFocus:t,newFocus:n})},zf=function(){var e=function(e){return Ia(e.element)};return{get:e,set:function(t,n){var r=e(t);t.getSystem().triggerFocus(n,t.element);var o=e(t);Ff(t,r,o)}}},Hf=function(){var t=function(e){return bf.getHighlighted(e).map(function(e){return e.element})};return{get:t,set:function(n,r){var o=t(n);n.getSystem().getByDom(r).fold(e,function(e){bf.highlight(n,e)});var i=t(n);Ff(n,o,i)}}};(ac=uc=uc||{}).OnFocusMode="onFocus",ac.OnEnterOrSpaceMode="onEnterOrSpace",ac.OnApiMode="onApi";var Vf,jf,Uf=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i,u=n(e,t,r,o);return i=t.event,G(u,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(n){return n(e,t,r,o)})},u={schema:function(){return e.concat([Ht("focusManager",zf()),Vt("focusInside","onFocus",st(function(e){return I(["onFocus","onEnterOrSpace","onApi"],e)?ae.value(e):ae.error("Invalid value for focusInside")})),Vu("handler",u),Vu("state",t),Vu("sendFocusIn",o)])},processKey:i,toEvents:function(e,t){var u=e.focusInside!==uc.OnFocusMode?w.none():o(e).map(function(n){return jr(cr(),function(r,o){n(r,e,t),o.stop()})}),a=[jr(Zn(),function(r,u){i(r,u,n,e,t).fold(function(){var n,i,a;n=r,i=u,a=Bf(Sf.concat(wf))(i.event),e.focusInside===uc.OnEnterOrSpaceMode&&a&&zn(n,i)&&o(e).each(function(r){r(n,e,t),i.stop()})},function(e){u.stop()})}),jr(er(),function(n,o){i(n,o,r,e,t).each(function(e){o.stop()})})];return zr(u.toArray().concat(a))}};return u},Wf=function(e){var t=[Pt("onEscape"),Pt("onEnter"),Ht("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ht("firstTabstop",0),Ht("useTabstopAt",c),Pt("visibilitySelector")].concat([e]),r=function(e,t){var n=e.visibilitySelector.bind(function(e){return wu(t,e)}).getOr(t);return 0<Ui(n)},i=function(e,t,n){var o,i,u;i=Fc(e.element,(o=t).selector),u=U(i,function(e){return r(o,e)}),w.from(u[o.firstTabstop]).each(function(n){t.focusManager.set(e,n)})},u=function(e,t,n,o,i){return i(t,n,function(e){return r(t=o,n=e)&&t.useTabstopAt(n);var t,n}).fold(function(){return o.cyclic?w.some(!0):w.none()},function(t){return o.focusManager.set(e,t),w.some(!0)})},a=function(e,t,n,r){var i,a=Fc(e.element,n.selector);return(i=n).focusManager.get(e).bind(function(e){return wu(e,i.selector)}).bind(function(t){return $(a,o(Pn,t)).bind(function(t){return u(e,a,t,n,r)})})},s=n([Lf(Df([Pf,Bf(xf)]),function(e,t,n){return a(e,0,n,n.cyclic?Ef:Af)}),Lf(Bf(xf),function(e,t,n){return a(e,0,n,n.cyclic?Rf:Nf)}),Lf(Bf(Cf),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),Lf(Df([If,Bf(wf)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),l=n([]);return Uf(t,oi.init,s,l,function(){return w.some(i)})},qf=Wf(Kt("cyclic",a)),Gf=Wf(Kt("cyclic",c)),$f=function(e,t,n){return of(n)&&Bf(Sf)(t.event)?w.none():(Ir(e,n,dr()),w.some(!0))},Xf=function(e,t){return w.some(!0)},Kf=[Ht("execute",$f),Ht("useSpace",!1),Ht("useEnter",!0),Ht("useControlEnter",!1),Ht("useDown",!1)],Yf=function(e,t,n){return n.execute(e,t,e.element)},Jf=Uf(Kf,oi.init,function(e,t,n,r){var o=n.useSpace&&!of(e.element)?Sf:[],i=n.useDown?Tf:[],u=o.concat(n.useEnter?wf:[]).concat(i);return[Lf(Bf(u),Yf)].concat(n.useControlEnter?[Lf(Df([Mf,Bf(wf)]),Yf)]:[])},function(e,t,n,r){return n.useSpace&&!of(e.element)?[Lf(Bf(Sf),Xf)]:[]},function(){return w.none()}),Qf=function(){var e=Yt(w.none());return ii({readState:function(){return e.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(w.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(e){return e.numRows})},getNumColumns:function(){return e.get().map(function(e){return e.numColumns})}})},Zf=Object.freeze({__proto__:null,flatgrid:Qf,init:function(e){return e.state(e)}}),ed=function(e){return function(t,n,r,o){var i=e(t.element);return od(i,t,n,r,o)}},td=function(e,t){var n=nc(e,t);return ed(n)},nd=function(e,t){var n=nc(t,e);return ed(n)},rd=function(e){return function(t,n,r,o){return od(e,t,n,r,o)}},od=function(e,t,n,r,o){return r.focusManager.get(t).bind(function(n){return e(t.element,n,r,o)}).map(function(e){return r.focusManager.set(t,e),!0})},id=rd,ud=rd,ad=rd,cd=function(e){return!((t=e.dom).offsetWidth<=0&&t.offsetHeight<=0);var t},sd=function(e,t,n){var r,o=Fc(e,n),i=U(o,cd);return $(r=i,function(e){return Pn(e,t)}).map(function(e){return{index:e,candidates:r}})},ld=function(e,t){return $(e,function(e){return Pn(t,e)})},fd=function(e,t,n,r){return r(Math.floor(t/n),t%n).bind(function(t){var r=t.row*n+t.column;return 0<=r&&r<e.length?w.some(e[r]):w.none()})},dd=function(e,t,n,r,o){return fd(e,t,r,function(t,i){var u=Ga(i,o,0,(t===n-1?e.length-t*r:r)-1);return w.some({row:t,column:u})})},md=function(e,t,n,r,o){return fd(e,t,r,function(t,i){var u=Ga(t,o,0,n-1),a=$a(i,0,(u===n-1?e.length-u*r:r)-1);return w.some({row:u,column:a})})},gd=[_t("selector"),Ht("execute",$f),Fu("onEscape"),Ht("captureTab",!1),Uu()],pd=function(e,t,n){xu(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},hd=function(e){return function(t,n,r,o){return sd(t,n,r.selector).bind(function(t){return e(t.candidates,t.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},vd=function(e,t,n){return n.captureTab?w.some(!0):w.none()},bd=hd(function(e,t,n,r){return dd(e,t,n,r,-1)}),yd=hd(function(e,t,n,r){return dd(e,t,n,r,1)}),xd=hd(function(e,t,n,r){return md(e,t,n,r,-1)}),wd=hd(function(e,t,n,r){return md(e,t,n,r,1)}),Cd=n([Lf(Bf(kf),td(bd,yd)),Lf(Bf(_f),nd(bd,yd)),Lf(Bf(Of),id(xd)),Lf(Bf(Tf),ud(wd)),Lf(Df([Pf,Bf(xf)]),vd),Lf(Df([If,Bf(xf)]),vd),Lf(Bf(Cf),function(e,t,n){return n.onEscape(e,t)}),Lf(Bf(Sf.concat(wf)),function(e,t,n,r){return(o=n).focusManager.get(e).bind(function(e){return wu(e,o.selector)}).bind(function(r){return n.execute(e,t,r)});var o})]),Sd=n([Lf(Bf(Sf),Xf)]),kd=Uf(gd,Qf,Cd,Sd,function(){return w.some(pd)}),Od=function(e,t,n,r){var o=function(e,t,n){var i,u=Ga(t,r,0,n.length-1);return u===e?w.none():"button"===Zr(i=n[u])&&"disabled"===Po(i,"disabled")?o(e,u,n):w.from(n[u])};return sd(e,n,t).bind(function(e){var t=e.index;return o(t,t,e.candidates)})},_d=[_t("selector"),Ht("getInitial",w.none),Ht("execute",$f),Fu("onEscape"),Ht("executeOnMove",!1),Ht("allowVertical",!0)],Td=function(e,t,n){return(r=n).focusManager.get(e).bind(function(e){return wu(e,r.selector)}).bind(function(r){return n.execute(e,t,r)});var r},Ed=function(e,t,n){t.getInitial(e).orThunk(function(){return xu(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})},Ad=function(e,t,n){return Od(e,n.selector,t,-1)},Rd=function(e,t,n){return Od(e,n.selector,t,1)},Nd=function(e){return function(t,n,r,o){return e(t,n,r,o).bind(function(){return r.executeOnMove?Td(t,n,r):w.some(!0)})}},Bd=function(e,t,n){return n.onEscape(e,t)},Dd=n([Lf(Bf(Sf),Xf)]),Pd=Uf(_d,oi.init,function(e,t,n,r){var o=kf.concat(n.allowVertical?Of:[]),i=_f.concat(n.allowVertical?Tf:[]);return[Lf(Bf(o),Nd(td(Ad,Rd))),Lf(Bf(i),Nd(nd(Ad,Rd))),Lf(Bf(wf),Td),Lf(Bf(Sf),Td),Lf(Bf(Cf),Bd)]},Dd,function(){return w.some(Ed)}),Md=function(e,t,n){return w.from(e[t]).bind(function(e){return w.from(e[n]).map(function(e){return{rowIndex:t,columnIndex:n,cell:e}})})},Id=function(e,t,n,r){var o=Ga(n,r,0,e[t].length-1);return Md(e,t,o)},Ld=function(e,t,n,r){var o=Ga(n,r,0,e.length-1),i=$a(t,0,e[o].length-1);return Md(e,o,i)},Fd=function(e,t,n,r){var o=$a(n+r,0,e[t].length-1);return Md(e,t,o)},zd=function(e,t,n,r){var o=$a(n+r,0,e.length-1),i=$a(t,0,e[o].length-1);return Md(e,o,i)},Hd=[Nt("selectors",[_t("row"),_t("cell")]),Ht("cycles",!0),Ht("previousSelector",w.none),Ht("execute",$f)],Vd=function(e,t,n){t.previousSelector(e).orThunk(function(){return xu(e.element,t.selectors.cell)}).each(function(n){t.focusManager.set(e,n)})},jd=function(e,t){return function(n,r,o){var i=o.cycles?e:t;return wu(r,o.selectors.row).bind(function(e){var t=Fc(e,o.selectors.cell);return ld(t,r).bind(function(t){var r=Fc(n,o.selectors.row);return ld(r,e).bind(function(e){var n,u=(n=o,H(r,function(e){return Fc(e,n.selectors.cell)}));return i(u,e,t).map(function(e){return e.cell})})})})}},Ud=jd(function(e,t,n){return Id(e,t,n,-1)},function(e,t,n){return Fd(e,t,n,-1)}),Wd=jd(function(e,t,n){return Id(e,t,n,1)},function(e,t,n){return Fd(e,t,n,1)}),qd=jd(function(e,t,n){return Ld(e,n,t,-1)},function(e,t,n){return zd(e,n,t,-1)}),Gd=jd(function(e,t,n){return Ld(e,n,t,1)},function(e,t,n){return zd(e,n,t,1)}),$d=n([Lf(Bf(kf),td(Ud,Wd)),Lf(Bf(_f),nd(Ud,Wd)),Lf(Bf(Of),id(qd)),Lf(Bf(Tf),ud(Gd)),Lf(Bf(Sf.concat(wf)),function(e,t,n){return Ia(e.element).bind(function(r){return n.execute(e,t,r)})})]),Xd=n([Lf(Bf(Sf),Xf)]),Kd=Uf(Hd,oi.init,$d,Xd,function(){return w.some(Vd)}),Yd=[_t("selector"),Ht("execute",$f),Ht("moveOnTab",!1)],Jd=function(e,t,n){return n.focusManager.get(e).bind(function(r){return n.execute(e,t,r)})},Qd=function(e,t,n){xu(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})},Zd=function(e,t,n){return Od(e,n.selector,t,-1)},em=function(e,t,n){return Od(e,n.selector,t,1)},tm=n([Lf(Bf(Of),ad(Zd)),Lf(Bf(Tf),ad(em)),Lf(Df([Pf,Bf(xf)]),function(e,t,n,r){return n.moveOnTab?ad(Zd)(e,t,n,r):w.none()}),Lf(Df([If,Bf(xf)]),function(e,t,n,r){return n.moveOnTab?ad(em)(e,t,n,r):w.none()}),Lf(Bf(wf),Jd),Lf(Bf(Sf),Jd)]),nm=n([Lf(Bf(Sf),Xf)]),rm=Uf(Yd,oi.init,tm,nm,function(){return w.some(Qd)}),om=[Fu("onSpace"),Fu("onEnter"),Fu("onShiftEnter"),Fu("onLeft"),Fu("onRight"),Fu("onTab"),Fu("onShiftTab"),Fu("onUp"),Fu("onDown"),Fu("onEscape"),Ht("stopSpaceKeyup",!1),Pt("focusIn")],im=Uf(om,oi.init,function(e,t,n){return[Lf(Bf(Sf),n.onSpace),Lf(Df([If,Bf(wf)]),n.onEnter),Lf(Df([Pf,Bf(wf)]),n.onShiftEnter),Lf(Df([Pf,Bf(xf)]),n.onShiftTab),Lf(Df([If,Bf(xf)]),n.onTab),Lf(Bf(Of),n.onUp),Lf(Bf(Tf),n.onDown),Lf(Bf(kf),n.onLeft),Lf(Bf(_f),n.onRight),Lf(Bf(Sf),n.onSpace),Lf(Bf(Cf),n.onEscape)]},function(e,t,n){return n.stopSpaceKeyup?[Lf(Bf(Sf),Xf)]:[]},function(e){return e.focusIn}),um=qf.schema(),am=Gf.schema(),cm=Pd.schema(),sm=kd.schema(),lm=Kd.schema(),fm=Jf.schema(),dm=rm.schema(),mm=im.schema(),gm=Ra({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:um,cyclic:am,flow:cm,flatgrid:sm,matrix:lm,execution:fm,menu:dm,special:mm}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(e,t,n){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(r){r(e,t,n)})},setGridSize:function(e,t,n,r,o){Ee(n,"setGridSize")?n.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:Zf}),pm=function(e,t,n,r){var o=e.getSystem().build(r);hs(e,o,n)},hm=function(e,t,n,r){var o=vm(e);G(o,function(e){return Pn(r.element,e.element)}).each(bs)},vm=function(e,t){return e.components()},bm=function(e,t,n,r,o){var i=vm(e);return w.from(i[r]).map(function(t){return hm(e,0,0,t),o.each(function(t){pm(e,0,function(e,t){var n,o;o=t,go(n=e,r).fold(function(){Oo(n,o)},function(e){Co(e,o)})},t)}),t})},ym=Ea({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,r){pm(e,0,Oo,r)},prepend:function(e,t,n,r){pm(e,0,ko,r)},remove:hm,replaceAt:bm,replaceBy:function(e,t,n,r,o){var i=vm(e);return $(i,r).bind(function(t){return bm(e,0,0,t,o)})},set:function(e,t,n,r){La(function(){var t=H(r,e.getSystem().build);gs(e,t)},e.element)},contents:vm})}),xm=function(e,t){var r,o;return{key:e,value:{config:{},me:(r=e,o=zr(t),Ea({fields:[_t("enabled")],name:r,active:{events:n(o)}})),configAsRaw:n({}),initialConfig:{},state:oi}}},wm=function(e,t){t.ignore||(Pa(e.element),t.onFocus(e))},Cm=Object.freeze({__proto__:null,focus:wm,blur:function(e,t){t.ignore||e.element.dom.blur()},isFocused:function(e){return n=bo(t=e.element).dom,t.dom===n.activeElement;var t,n}}),Sm=Object.freeze({__proto__:null,exhibit:function(e,t){return ai(t.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(e){return zr([jr(cr(),function(t,n){wm(t,e),n.stop()})].concat(e.stopMousedown?[jr(Gn(),function(e,t){t.event.prevent()})]:[]))}}),km=[Lu("onFocus"),Ht("stopMousedown",!1),Ht("ignore",!1)],Om=Ea({fields:km,name:"focusing",active:Sm,apis:Cm}),_m=function(e,t,n){var r=t.aria;r.update(e,r,n.get())},Tm=function(e,t,n){t.toggleClass.each(function(t){(n.get()?gi:pi)(e.element,t)})},Em=function(e,t,n){Nm(e,t,n,!n.get())},Am=function(e,t,n){n.set(!0),Tm(e,t,n),_m(e,t,n)},Rm=function(e,t,n){n.set(!1),Tm(e,t,n),_m(e,t,n)},Nm=function(e,t,n,r){(r?Am:Rm)(e,t,n)},Bm=function(e,t,n){Nm(e,t,n,t.selected)},Dm=Object.freeze({__proto__:null,onLoad:Bm,toggle:Em,isOn:function(e,t,n){return n.get()},on:Am,off:Rm,set:Nm}),Pm=Object.freeze({__proto__:null,exhibit:function(){return ai({})},events:function(e,t){var n,r,o,i=(n=e,r=t,o=Em,Qr(function(e){o(e,n,r)})),u=Sa(e,t,Bm);return zr(X([e.toggleOnExecute?[i]:[],[u]]))}}),Mm=function(e,t,n){Do(e.element,"aria-expanded",n)},Im=[Ht("selected",!1),Pt("toggleClass"),Ht("toggleOnExecute",!0),Vt("aria",{mode:"none"},ht("mode",{pressed:[Ht("syncWithExpanded",!1),Vu("update",function(e,t,n){Do(e.element,"aria-pressed",n),t.syncWithExpanded&&Mm(e,0,n)})],checked:[Vu("update",function(e,t,n){Do(e.element,"aria-checked",n)})],expanded:[Vu("update",Mm)],selected:[Vu("update",function(e,t,n){Do(e.element,"aria-selected",n)})],none:[Vu("update",e)]}))],Lm=Ea({fields:Im,name:"toggling",active:Pm,apis:Dm,state:{init:function(){var e=Yt(!1);return{get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(!1)},readState:function(){return e.get()}}}}}),Fm=function(){var e=function(e,t){t.stop(),Mr(e)};return[jr(rr(),e),jr(gr(),e),$r(jn()),$r(Gn())]},zm=function(e){return zr(X([e.map(function(e){return Qr(function(t,n){e(t),n.stop()})}).toArray(),Fm()]))},Hm="alloy.item-hover",Vm="alloy.item-focus",jm=function(e){(Ia(e.element).isNone()||Om.isFocused(e))&&(Om.isFocused(e)||Om.focus(e),Pr(e,Hm,{item:e}))},Um=function(e){Pr(e,Vm,{item:e})},Wm=n(Hm),qm=n(Vm),Gm=[_t("data"),_t("components"),_t("dom"),Ht("hasSubmenu",!1),Pt("toggling"),nl("itemBehaviours",[Lm,Om,gm,Qs]),Ht("ignoreFocus",!1),Ht("domModification",{}),Vu("builder",function(e){return{dom:e.dom,domModification:l(l({},e.domModification),{attributes:l(l(l({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:rl(e.itemBehaviours,[e.toggling.fold(Lm.revoke,function(e){return Lm.config(l({aria:{mode:"checked"}},e))}),Om.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){Um(e)}}),gm.config({mode:"execution"}),Qs.config({store:{mode:"memory",initialValue:e.data}}),xm("item-type-events",d(Fm(),[jr(Yn(),jm),jr(mr(),Om.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),Ht("eventOrder",{})],$m=[_t("dom"),_t("components"),Vu("builder",function(e){return{dom:e.dom,components:e.components,events:zr([(t=mr(),jr(t,function(e,t){t.stop()}))])};var t})],Xm=n("item-widget"),Km=n([_l({name:"widget",overrides:function(t){return{behaviours:_a([Qs.config({store:{mode:"manual",getValue:function(e){return t.data},setValue:e}})])}}})]),Ym=[_t("uid"),_t("data"),_t("components"),_t("dom"),Ht("autofocus",!1),Ht("ignoreFocus",!1),nl("widgetBehaviours",[Qs,Om,gm]),Ht("domModification",{}),$l(Km()),Vu("builder",function(e){var t=Fl(Xm(),e,Km()),n=zl(Xm(),e,t.internals()),r=function(t){return Hl(t,e,"widget").map(function(e){return gm.focusIn(e),e})},o=function(t,n){return of(n.event.target)||e.autofocus&&n.setSource(t.element),w.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:zr([Qr(function(e,t){r(e).each(function(e){t.stop()})}),jr(Yn(),jm),jr(mr(),function(t,n){e.autofocus?r(t):Om.focus(t)})]),behaviours:rl(e.widgetBehaviours,[Qs.config({store:{mode:"memory",initialValue:e.data}}),Om.config({ignore:e.ignoreFocus,onFocus:function(e){Um(e)}}),gm.config({mode:"special",focusIn:e.autofocus?function(e){r(e)}:Na(),onLeft:o,onRight:o,onEscape:function(t,n){return Om.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),w.none()):(Om.focus(t),w.some(!0))}})])}})],Jm=ht("type",{widget:Ym,item:Gm,separator:$m}),Qm=n([Al({factory:{sketch:function(e){var t=mt("menu.spec item",Jm,e);return t.builder(t)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:l(l({},t),{uid:Ko("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),Zm=n([_t("value"),_t("items"),_t("dom"),_t("components"),Ht("eventOrder",{}),Zs("menuBehaviours",[bf,Qs,cf,gm]),Vt("movement",{mode:"menu",moveOnTab:!0},ht("mode",{grid:[Uu(),Vu("config",function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}})],matrix:[Vu("config",function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),_t("rowSelector")],menu:[Ht("moveOnTab",!0),Vu("config",function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}})]})),Tt("markers",Bu()),Ht("fakeFocus",!1),Ht("focusManager",zf()),Lu("onHighlight")]),eg=n("alloy.menu-focus"),tg=tf({name:"Menu",configFields:Zm(),partFields:Qm(),factory:function(e,t,n,r){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:tl(e.menuBehaviours,[bf.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),Qs.config({store:{mode:"memory",initialValue:e.value}}),cf.config({find:w.some}),gm.config(e.movement.config(e,e.movement))]),events:zr([jr(qm(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){bf.highlight(e,n),t.stop(),Pr(e,eg(),{menu:e,item:n})})}),jr(Wm(),function(e,t){bf.highlight(e,t.event.item)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ng=function(e,t,n,r){return _e(n,r).bind(function(r){return _e(e,r).bind(function(r){var o=ng(e,t,n,r);return w.some([r].concat(o))})}).getOr([])},rg=function(e){return"prepared"===e.type?w.some(e.menu):w.none()},og=rg,ig=n("collapse-item"),ug=ef({name:"TieredMenu",configFields:[Hu("onExecute"),Hu("onEscape"),zu("onOpenMenu"),zu("onOpenSubmenu"),Lu("onRepositionMenu"),Lu("onCollapseMenu"),Ht("highlightImmediately",!0),Nt("data",[_t("primary"),_t("menus"),_t("expansions")]),Ht("fakeFocus",!1),Lu("onHighlight"),Lu("onHover"),Pu(),_t("dom"),Ht("navigateOnHover",!0),Ht("stayInDom",!1),Zs("tmenuBehaviours",[gm,bf,cf,ym]),Ht("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(t,n){var r,o,i=Yt(w.none()),u=function(){var e=Yt({}),t=Yt({}),n=Yt({}),r=Yt(w.none()),o=Yt({}),i=function(t,n,r){return u(t).bind(function(o){return i=t,ke(e.get(),function(e,t){return e===i}).bind(function(e){return n(e).map(function(e){return{triggeredMenu:o,triggeringItem:e,triggeringPath:r}})});var i})},u=function(e){return a(e).bind(rg)},a=function(e){return _e(t.get(),e)},c=function(t){return _e(e.get(),t)};return{setMenuBuilt:function(e,n){var r;t.set(l(l({},t.get()),((r={})[e]={type:"prepared",menu:n},r)))},setContents:function(i,u,a,c){r.set(w.some(i)),e.set(a),t.set(u),o.set(c);var s=function(e,t){var n={};xe(e,function(e,t){V(e,function(e){n[e]=t})});var r=t,o=Ce(t,function(e,t){return{k:e,v:t}}),i=we(o,function(e,t){return[t].concat(ng(n,r,o,t))});return we(n,function(e){return _e(i,e).getOr([e])})}(c,a);n.set(s)},expand:function(t){return _e(e.get(),t).map(function(e){var r=_e(n.get(),t).getOr([]);return[e].concat(r)})},refresh:function(e){return _e(n.get(),e)},collapse:function(e){return _e(n.get(),e).bind(function(e){return 1<e.length?w.some(e.slice(1)):w.none()})},lookupMenu:a,lookupItem:c,otherMenus:function(e){var t=o.get();return Q(be(t),e)},getPrimary:function(){return r.get().bind(u)},getMenus:function(){return t.get()},clear:function(){e.set({}),t.set({}),n.set({}),r.set(w.none())},isClear:function(){return r.get().isNone()},getTriggeringPath:function(e,t){var o=U(c(e).toArray(),function(e){return u(e).isSome()});return _e(n.get(),e).bind(function(e){var n=J(o.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(!r.isSome())return w.none();t.push(r.getOrDie())}return w.some(t)}(K(n,function(e,o){return i(e,t,n.slice(0,o+1)).fold(function(){return r.get().is(e)?[]:[w.none()]},function(e){return[w.some(e)]})}))})}}}(),a=function(e){return Qs.getValue(e).value},s=function(e,t){bf.highlight(e,t),bf.getHighlighted(t).orThunk(function(){return bf.getFirst(t)}).each(function(t){Ir(e,t.element,mr())})},f=function(e,t){return nf(H(t,function(t){return e.lookupMenu(t).bind(function(e){return"prepared"===e.type?w.some(e.menu):w.none()})}))},d=function(e,n,r){var o=f(n,n.otherMenus(r));V(o,function(n){bi(n.element,[t.markers.backgroundMenu]),t.stayInDom||ym.remove(e,n)})},m=function(e,n){var r,o=(r=e,i.get().getOrThunk(function(){var e={},n=Fc(r.element,"."+t.markers.item),o=U(n,function(e){return"true"===Po(e,"aria-haspopup")});return V(o,function(t){r.getSystem().getByDom(t).each(function(t){var n=a(t);e[n]=t})}),i.set(w.some(e)),e}));xe(o,function(e,t){var r=I(n,t);Do(e.element,"aria-expanded",r)})},g=function(e,n,r){return w.from(r[0]).bind(function(o){return n.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return w.none();var i=o.menu,u=f(n,r.slice(1));return V(u,function(e){gi(e.element,t.markers.backgroundMenu)}),xi(i.element)||ym.append(e,Hi(i)),bi(i.element,[t.markers.backgroundMenu]),s(e,i),d(e,n,r),w.some(i)})})};(o=r=r||{})[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";var p=function(e,n,o){void 0===o&&(o=r.HighlightSubmenu);var i=a(n);return u.expand(i).bind(function(i){return m(e,i),w.from(i[0]).bind(function(a){return u.lookupMenu(a).bind(function(c){var s=function(e,t,n){if("notbuilt"!==n.type)return n.menu;var r=e.getSystem().build(n.nbMenu());return u.setMenuBuilt(t,r),r}(e,a,c);return xi(s.element)||ym.append(e,Hi(s)),t.onOpenSubmenu(e,n,s,J(i)),o===r.HighlightSubmenu?(bf.highlightFirst(s),g(e,u,i)):(bf.dehighlightAll(s),w.some(n))})})})},h=function(e,n){var r=a(n);return u.collapse(r).bind(function(r){return m(e,r),g(e,u,r).map(function(r){return t.onCollapseMenu(e,n,r),r})})},v=function(e){return function(n,r){return wu(r.getSource(),"."+t.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOptional().bind(function(t){return e(n,t).map(c)})})}},b=zr([jr(eg(),function(e,t){u.lookupItem(a(t.event.item)).each(function(){bf.highlight(e,t.event.menu);var n=a(t.event.item);u.refresh(n).each(function(t){return d(e,u,t)})})}),Qr(function(n,o){var i=o.event.target;n.getSystem().getByDom(i).each(function(o){0===a(o).indexOf("collapse-item")&&h(n,o),p(n,o,r.HighlightSubmenu).fold(function(){t.onExecute(n,o)},e)})}),Kr(function(e,n){(function(e){var n,r,o=(n=e,r=t.data.primary,we(t.data.menus,function(e,o){var i=function(){return tg.sketch(l(l({},e),{value:o,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?Hf:zf)()}))};return o===r?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})),i=we(t.data.menus,function(e,t){return K(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})});return u.setContents(t.data.primary,o,t.data.expansions,i),u.getPrimary()})(e).each(function(n){ym.append(e,Hi(n)),t.onOpenMenu(e,n),t.highlightImmediately&&s(e,n)})})].concat(t.navigateOnHover?[jr(Wm(),function(e,n){var o,i,c=n.event.item;o=e,i=a(c),u.refresh(i).bind(function(e){return m(o,e),g(o,u,e)}),p(e,c,r.HighlightParent),t.onHover(e,c)})]:[])),y=function(e){return bf.getHighlighted(e).bind(bf.getHighlighted)},x={collapseMenu:function(e){y(e).each(function(t){h(e,t)})},highlightPrimary:function(e){u.getPrimary().each(function(t){s(e,t)})},repositionMenus:function(e){u.getPrimary().bind(function(t){return y(e).bind(function(e){var t=a(e),n=Oe(u.getMenus()),r=nf(H(n,og));return u.getTriggeringPath(t,function(e){return t=e,oe(r,function(e){if(!e.getSystem().isConnected())return w.none();var n=bf.getCandidates(e);return G(n,function(e){return a(e)===t})});var t})}).map(function(e){return{primary:t,triggeringPath:e}})}).fold(function(){w.from(e.components()[0]).filter(function(e){return"menu"===Po(e.element,"role")}).each(function(n){t.onRepositionMenu(e,n,[])})},function(n){t.onRepositionMenu(e,n.primary,n.triggeringPath)})}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:tl(t.tmenuBehaviours,[gm.config({mode:"special",onRight:v(function(e,t){return of(t.element)?w.none():p(e,t,r.HighlightSubmenu)}),onLeft:v(function(e,t){return of(t.element)?w.none():h(e,t)}),onEscape:v(function(e,n){return h(e,n).orThunk(function(){return t.onEscape(e,n).map(function(){return e})})}),focusIn:function(e,t){u.getPrimary().each(function(t){Ir(e,t.element,mr())})}}),bf.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),cf.config({find:function(e){return bf.getHighlighted(e)}}),ym.config({})]),eventOrder:t.eventOrder,apis:x,events:b}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:je(e,t),expansions:{}}},collapseItem:function(e){return{value:jo(ig()),meta:{text:e}}}}}),ag=ef({name:"InlineView",configFields:[_t("lazySink"),Lu("onShow"),Lu("onHide"),Ft("onEscape"),Zs("inlineBehaviours",[Bs,Qs,Ba]),zt("fireDismissalEventInstead",[Ht("event",Or())]),zt("fireRepositionEventInstead",[Ht("event",_r())]),Ht("getRelated",w.none),Ht("isExtraPart",a),Ht("eventOrder",w.none)],factory:function(e,t){var n=function(e,t,n,o){r(e,t,n,function(){return o.map(lu)})},r=function(t,n,r,o){var i=e.lazySink(t).getOrDie();Bs.openWhileCloaked(t,r,function(){return ls.positionWithinBounds(i,n,t,o())}),Qs.setValue(t,w.some({mode:"position",anchor:n,getBounds:o}))},o=function(t,n,r,o){var i,u,a,c,s,f,d,m,g=(i=e,u=t,a=n,s=o,f=function(){return i.lazySink(u)},d="horizontal"===(c=r).type?{layouts:{onLtr:ya,onRtl:xa}}:{},m=function(e){return 2===e.length?d:{}},ug.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return Bs.close(u),i.onEscape.map(function(e){return e(u)}),w.some(!0)},onExecute:function(){return w.some(!0)},onOpenMenu:function(e,t){ls.positionWithinBounds(f().getOrDie(),a,t,s())},onOpenSubmenu:function(e,t,n,r){var o=f().getOrDie();ls.position(o,l({anchor:"submenu",item:t},m(r)),n)},onRepositionMenu:function(e,t,n){var r=f().getOrDie();ls.positionWithinBounds(r,a,t,s()),V(n,function(e){var t=m(e.triggeringPath);ls.position(r,l({anchor:"submenu",item:e.triggeringItem},t),e.triggeredMenu)})}}));Bs.open(t,g),Qs.setValue(t,w.some({mode:"menu",menu:g}))},i=function(t){Bs.isOpen(t)&&Qs.getValue(t).each(function(n){switch(n.mode){case"menu":Bs.getState(t).each(function(e){ug.repositionMenus(e)});break;case"position":var r=e.lazySink(t).getOrDie();ls.positionWithinBounds(r,n.anchor,t,n.getBounds())}})},u={setContent:function(e,t){Bs.setContent(e,t)},showAt:function(e,t,r){n(e,t,r,w.none())},showWithin:n,showWithinBounds:r,showMenuAt:function(e,t,n){o(e,t,n,function(){return w.none()})},showMenuWithinBounds:o,hide:function(e){Bs.isOpen(e)&&(Qs.setValue(e,w.none()),Bs.close(e))},getContent:function(e){return Bs.getState(e)},reposition:i,isOpen:Bs.isOpen};return{uid:e.uid,dom:e.dom,behaviours:tl(e.inlineBehaviours,[Bs.config({isPartOf:function(t,n,r){return Su(n,r)||(o=r,e.getRelated(t).exists(function(e){return Su(e,o)}));var o},getAttachPoint:function(t){return e.lazySink(t).getOrDie()},onOpen:function(t){e.onShow(t)},onClose:function(t){e.onHide(t)}}),Qs.config({store:{mode:"memory",initialValue:w.none()}}),Ba.config({channels:l(l({},Ls(l({isExtraPart:t.isExtraPart},e.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),zs(l(l({},e.fireRepositionEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})),{doReposition:i})))})]),eventOrder:e.eventOrder,apis:u}},apis:{showAt:function(e,t,n,r){e.showAt(t,n,r)},showWithin:function(e,t,n,r,o){e.showWithin(t,n,r,o)},showWithinBounds:function(e,t,n,r,o){e.showWithinBounds(t,n,r,o)},showMenuAt:function(e,t,n,r){e.showMenuAt(t,n,r)},showMenuWithinBounds:function(e,t,n,r,o){e.showMenuWithinBounds(t,n,r,o)},hide:function(e,t){e.hide(t)},isOpen:function(e,t){return e.isOpen(t)},getContent:function(e,t){return e.getContent(t)},setContent:function(e,t,n){e.setContent(t,n)},reposition:function(e,t){e.reposition(t)}}}),cg=function(e){return e.x},sg=function(e,t){return e.x+e.width/2-t.width/2},lg=function(e,t){return e.x+e.width-t.width},fg=function(e){return e.y},dg=function(e,t){return e.y+e.height-t.height},mg=function(e,t,n){return Wu(lg(e,t),dg(e,t),n.innerSoutheast(),Ku(),ea(e,{right:0,bottom:3}),"layout-inner-se")},gg=function(e,t,n){return Wu(cg(e),dg(e,t),n.innerSouthwest(),Xu(),ea(e,{left:1,bottom:3}),"layout-inner-sw")},pg=function(e,t,n){return Wu(lg(e,t),fg(e),n.innerNortheast(),$u(),ea(e,{right:0,top:2}),"layout-inner-ne")},hg=function(e,t,n){return Wu(cg(e),fg(e),n.innerNorthwest(),Gu(),ea(e,{left:1,top:2}),"layout-inner-nw")},vg=function(e,t,n){return Wu(sg(e,t),fg(e),n.innerNorth(),Yu(),ea(e,{top:2}),"layout-inner-n")},bg=function(e,t,n){return Wu(sg(e,t),dg(e,t),n.innerSouth(),Ju(),ea(e,{bottom:3}),"layout-inner-s")},yg=tinymce.util.Tools.resolve("tinymce.util.Delay"),xg=ef({name:"Button",factory:function(e){var t=zm(e.action),n=e.dom.tag,r=function(t){return _e(e.dom,"attributes").bind(function(e){return _e(e,t)})};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:rl(e.buttonBehaviours,[Om.config({}),gm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==n)return{role:r("role").getOr("button")};var e=r("type").getOr("button"),t=r("role").map(function(e){return{role:e}}).getOr({});return l({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[Ht("uid",void 0),_t("dom"),Ht("components",[]),nl("buttonBehaviours",[Om,gm]),Pt("action"),Pt("role"),Ht("eventOrder",{})]}),wg=function(e){var t=void 0!==e.uid&&Ee(e,"uid")?e.uid:Ko("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOptional()},asSpec:function(){return l(l({},e),{uid:t})}}},Cg=function(e){return w.from(e()["temporary-placeholder"]).getOr("!not found!")},Sg=function(e,t){return w.from(t()[e.toLowerCase()]).getOrThunk(function(){return Cg(t)})},kg={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Og=ef({name:"Notification",factory:function(e){var t,n,r=wg({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:_a([ym.config({})])}),o=function(e){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+e+"%"}}}},i=function(e){return{dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}},u=wg({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},i(0)],behaviours:_a([ym.config({})])}),a={updateProgress:function(e,t){e.getSystem().isConnected()&&u.getOpt(e).each(function(e){ym.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(t)]},i(t)])})},updateText:function(e,t){var n;e.getSystem().isConnected()&&(n=r.get(e),ym.set(n,[Ii(t)]))}},c=X([e.icon.toArray(),e.level.toArray(),e.level.bind(function(e){return w.from(kg[e])}).toArray()]),s=wg(xg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Sg("close",e.iconProvider),attributes:{"aria-label":e.translationProvider("Close")}}}],action:function(t){e.onAction(t)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(t=c,n=e.iconProvider,oe(t,function(e){return w.from(n()[e.toLowerCase()])}).getOrThunk(function(){return Cg(n)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[r.asSpec()],behaviours:_a([ym.config({})])}];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(function(e){return["tox-notification","tox-notification--in","tox-notification--"+e]}).getOr(["tox-notification","tox-notification--in"])},behaviours:_a([Om.config({}),xm("notification-events",[jr(Jn(),function(e){s.getOpt(e).each(Om.focus)})])]),components:l.concat(e.progress?[u.asSpec()]:[]).concat(e.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[Pt("level"),_t("progress"),_t("icon"),_t("onAction"),_t("text"),_t("iconProvider"),_t("translationProvider"),qt("closeButton",!0)],apis:{updateProgress:function(e,t,n){e.updateProgress(t,n)},updateText:function(e,t,n){e.updateText(t,n)}}}),_g=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}},Tg=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Eg=function(e,t,n,r,o){var i=Tg(e,function(t){return(n=e).isBlock(r=t)||I(["BR","IMG","HR","INPUT"],r.nodeName)||"false"===n.getContentEditable(r);var n,r});return w.from(i.backwards(t,n,r,o))},Ag=function(e){return wu(e,"[data-mce-autocompleter]")},Rg=function(e){return e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Ng=function(e){return""!==e&&-1!=="  \f\n\r\t\v".indexOf(e)},Bg=function(e,t){return e.substring(t.length)},Dg=function(e,t,n,r){return void 0===r&&(r=0),Ag(tn(t.startContainer)).fold(function(){return function(e,t,n,r){if(void 0===r&&(r=0),!(o=t).collapsed||3!==o.startContainer.nodeType)return w.none();var o,i=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Eg(e,t.startContainer,t.startOffset,function(e,t,r){return function(e,t,n){for(var r=t-1;0<=r;r--){var o=e.charAt(r);if(Ng(o))return w.none();if(o===n)break}return w.some(r)}(r,t,n).getOr(t)},i).bind(function(e){var o=t.cloneRange();if(o.setStart(e.container,e.offset),o.setEnd(t.endContainer,t.endOffset),o.collapsed)return w.none();var i=Rg(o);return 0!==i.lastIndexOf(n)||Bg(i,n).length<r?w.none():w.some({text:Bg(i,n),range:o,triggerChar:n})})}(e,t,n,r)},function(t){var r=e.createRng();r.selectNode(t.dom);var o=Rg(r);return w.some({range:r,text:Bg(o,n),triggerChar:n})})},Pg=tinymce.util.Tools.resolve("tinymce.util.Promise"),Mg=function(e,t){return{container:e,offset:t}},Ig=function(e){if(3===e.nodeType)return Mg(e,e.data.length);var t=e.childNodes;return 0<t.length?Ig(t[t.length-1]):Mg(e,t.length)},Lg=function(e,t){var n=e.childNodes;return 0<n.length&&t<n.length?Lg(n[t],0):0<n.length&&1===e.nodeType&&n.length===t?Ig(n[n.length-1]):Mg(e,t)},Fg=function(e,t,n,r){void 0===r&&(r={});var o=t(),i=e.selection.getRng().startContainer.nodeValue,u=U(o.lookupByChar(n.triggerChar),function(t){return n.text.length>=t.minChars&&t.matches.getOrThunk(function(){return function(e){return function(t){var n,r,o=Lg(t.startContainer,t.startOffset);return!Eg(n=e,(r=o).container,r.offset,function(e,t){return 0===t?-1:t},n.getRoot()).filter(function(e){var t=e.container.data.charAt(e.offset-1);return!Ng(t)}).isSome()}}(e.dom)})(n.range,i,n.text)});if(0===u.length)return w.none();var a=Pg.all(H(u,function(e){return e.fetch(n.text,e.maxResults,r).then(function(t){return{matchText:n.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}})}));return w.some({lookupData:a,context:n})},zg=Qe([Et("type"),Lt("text")]),Hg=Qe([Ht("type","autocompleteitem"),Ht("active",!1),Ht("disabled",!1),Ht("meta",{}),Et("value"),Lt("text"),Lt("icon")]),Vg=Qe([Et("type"),Et("ch"),jt("minChars",1),Ht("columns",1),jt("maxResults",10),Ft("matches"),Rt("fetch"),Rt("onAction"),$t("highlightOn",[],xt)]),jg=[qt("disabled",!1),Lt("tooltip"),Lt("icon"),Lt("text"),Gt("onSetup",function(){return e})],Ug=Qe([Et("type"),Rt("onAction")].concat(jg)),Wg=function(e){return ft("toolbarbutton",Ug,e)},qg=[qt("active",!1)].concat(jg),Gg=Qe(qg.concat([Et("type"),Rt("onAction")])),$g=function(e){return ft("ToggleButton",Gg,e)},Xg=[Gt("predicate",a),Wt("scope","node",["node","editor"]),Wt("position","selection",["node","selection","line"])],Kg=jg.concat([Ht("type","contextformbutton"),Ht("primary",!1),Rt("onAction"),Kt("original",r)]),Yg=qg.concat([Ht("type","contextformbutton"),Ht("primary",!1),Rt("onAction"),Kt("original",r)]),Jg=jg.concat([Ht("type","contextformbutton")]),Qg=qg.concat([Ht("type","contextformtogglebutton")]),Zg=ht("type",{contextformbutton:Kg,contextformtogglebutton:Yg}),ep=Qe([Ht("type","contextform"),Gt("initValue",function(){return""}),Lt("label"),Dt("commands",Zg),Mt("launch",ht("type",{contextformbutton:Jg,contextformtogglebutton:Qg}))].concat(Xg)),tp=Qe([Ht("type","contexttoolbar"),Et("items")].concat(Xg));(jf=Vf=Vf||{})[jf.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",jf[jf.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var np,rp,op=Vf,ip="tox-menu-nav__js",up="tox-collection__item",ap={normal:ip,color:"tox-swatch"},cp="tox-collection__item--enabled",sp="tox-collection__item-label",lp="tox-collection__item-caret",fp="tox-collection__item--active",dp="tox-collection__item-container",mp="tox-collection__item-container--row",gp=function(e){return _e(ap,e).getOr(ip)},pp=function(e){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===e?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},hp=function(e){var t=pp(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:gp(e)}},vp=[tg.parts.items({})],bp=function(e,t,n){var r=pp(n);return{dom:{tag:"div",classes:X([[r.tieredMenu]])},markers:hp(n)}},yp=function(e,t){return function(n){var r=z(n,t);return H(r,function(t){return{dom:e,components:t}})}},xp=function(e,t){var n=[],r=[];return V(e,function(e,o){t(e,o)?(0<r.length&&n.push(r),r=[],Te(e.dom,"innerHtml")&&r.push(e)):r.push(e)}),0<r.length&&n.push(r),H(n,function(e){return{dom:{tag:"div",classes:["tox-collection__group"]},components:e}})},wp=function(e,t,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[tg.parts.items({preprocess:function(n){return"auto"!==e&&1<e?yp({tag:"div",classes:["tox-collection__group"]},e)(n):xp(n,function(e,n){return"separator"===t[n].type})}})]}},Cp=function(e){return L(e,function(e){return"icon"in e&&void 0!==e.icon})},Sp=function(e){return console.error(gt(e)),console.log(e),w.none()},kp=function(e,t,n,r,o){var i,u=(i=n,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[tg.parts.items({preprocess:function(e){return xp(e,function(e,t){return"separator"===i[t].type})}})]});return{value:e,dom:u.dom,components:u.components,items:n}},Op=function(e,t,n,o,i){var u,a,c,s,l,f;return"color"===i?{value:e,dom:(u=o,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[tg.parts.items({preprocess:"auto"!==u?yp({tag:"div",classes:["tox-swatches__row"]},u):r})]}]}).dom,components:c.components,items:n}:"normal"===i&&"auto"===o?{value:e,dom:(c=wp(o,n)).dom,components:c.components,items:n}:"normal"===i&&1===o?{value:e,dom:(c=wp(1,n)).dom,components:c.components,items:n}:"normal"===i?{value:e,dom:(c=wp(o,n)).dom,components:c.components,items:n}:"listpreview"!==i||"auto"===o?{value:e,dom:(s=t,l=o,f=pp(i),{tag:"div",classes:X([[f.menu,"tox-menu-"+l+"-column"],s?[f.hasIcons]:[]])}),components:vp,items:n}:{value:e,dom:(a=o,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[tg.parts.items({preprocess:yp({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:c.components,items:n}},_p=[Et("type"),Et("src"),Lt("alt"),$t("classes",[],xt)],Tp=Qe(_p),Ep=[Et("type"),Et("text"),Lt("name"),$t("classes",["tox-collection__item-label"],xt)],Ap=Qe(Ep),Rp=ct(function(){return pt("type",{cardimage:Tp,cardtext:Ap,cardcontainer:Np})}),Np=Qe([Et("type"),Ut("direction","horizontal"),Ut("align","left"),Ut("valign","middle"),Dt("items",Rp)]),Bp=[qt("disabled",!1),Lt("text"),Lt("shortcut"),ot("value","value",ze(function(){return jo("menuitem-value")}),vt()),Ht("meta",{})],Dp=Qe([Et("type"),Lt("label"),Dt("items",Rp),Gt("onSetup",function(){return e}),Gt("onAction",e)].concat(Bp)),Pp=Qe([Et("type"),qt("active",!1),Lt("icon")].concat(Bp)),Mp=Qe([Et("type"),At("fancytype",["inserttable","colorswatch"]),Gt("onAction",e)]),Ip=Qe([Et("type"),Gt("onSetup",function(){return e}),Gt("onAction",e),Lt("icon")].concat(Bp)),Lp=Qe([Et("type"),Rt("getSubmenuItems"),Gt("onSetup",function(){return e}),Lt("icon")].concat(Bp)),Fp=Qe([Et("type"),Lt("icon"),qt("active",!1),Gt("onSetup",function(){return e}),Rt("onAction")].concat(Bp)),zp=function(e,t,n){var r=Fc(e.element,"."+n);if(0<r.length){var o=$(r,function(e){var n=e.dom.getBoundingClientRect().top,o=r[0].dom.getBoundingClientRect().top;return Math.abs(n-o)>t}).getOr(r.length);return w.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return w.none()},Hp=function(e){return function(e,t){return _a([xm(e,t)])}(jo("unnamed-events"),e)},Vp=jo("tooltip.exclusive"),jp=jo("tooltip.show"),Up=jo("tooltip.hide"),Wp=function(e,t,n){e.getSystem().broadcastOn([Vp],{})},qp=Object.freeze({__proto__:null,hideAllExclusive:Wp,setComponents:function(e,t,n,r){n.getTooltip().each(function(e){e.getSystem().isConnected()&&ym.set(e,r)})}}),Gp=Object.freeze({__proto__:null,events:function(e,t){var n=function(n){t.getTooltip().each(function(r){bs(r),e.onHide(n,r),t.clearTooltip()}),t.clearTimer()};return zr(X([[jr(jp,function(n){t.resetTimer(function(){var r,o,i;r=n,t.isShowing()||(Wp(r),o=e.lazySink(r).getOrDie(),i=r.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:zr("normal"===e.mode?[jr(Yn(),function(e){Dr(r,jp)}),jr(Xn(),function(e){Dr(r,Up)})]:[]),behaviours:_a([ym.config({})])}),t.setTooltip(i),ps(o,i),e.onShow(r,i),ls.position(o,e.anchor(r),i))},e.delay)}),jr(Up,function(r){t.resetTimer(function(){n(r)},e.delay)}),jr(fr(),function(e,t){t.universal||I(t.channels,Vp)&&n(e)}),Yr(function(e){n(e)})],"normal"===e.mode?[jr(Jn(),function(e){Dr(e,jp)}),jr(sr(),function(e){Dr(e,Up)}),jr(Yn(),function(e){Dr(e,jp)}),jr(Xn(),function(e){Dr(e,Up)})]:[jr(Nr(),function(e,t){Dr(e,jp)}),jr(Br(),function(e){Dr(e,Up)})]]))}}),$p=[_t("lazySink"),_t("tooltipDom"),Ht("exclusive",!0),Ht("tooltipComponents",[]),Ht("delay",300),Wt("mode","normal",["normal","follow-highlight"]),Ht("anchor",function(e){return{anchor:"hotspot",hotspot:e,layouts:{onLtr:n([da,fa,aa,sa,ca,la]),onRtl:n([da,fa,aa,sa,ca,la])}}}),Lu("onHide"),Lu("onShow")],Xp=Ea({fields:$p,name:"tooltipping",active:Gp,state:Object.freeze({__proto__:null,init:function(){var e=Yt(w.none()),t=Yt(w.none()),r=function(){e.get().each(function(e){clearTimeout(e)})},o=n("not-implemented");return ii({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(e){t.set(w.some(e))},clearTooltip:function(){t.set(w.none())},clearTimer:r,resetTimer:function(t,n){r(),e.set(w.some(setTimeout(function(){t()},n)))},readState:o})}}),apis:qp}),Kp=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Yp=tinymce.util.Tools.resolve("tinymce.util.I18n"),Jp=["input","button","textarea","select"],Qp=function(e,t,n){(t.disabled()?oh:ih)(e,t)},Zp=function(e,t){return!0===t.useNative&&I(Jp,Zr(e.element))},eh=function(e){Do(e.element,"disabled","disabled")},th=function(e){Lo(e.element,"disabled")},nh=function(e){Do(e.element,"aria-disabled","true")},rh=function(e){Do(e.element,"aria-disabled","false")},oh=function(e,t,n){t.disableClass.each(function(t){gi(e.element,t)}),(Zp(e,t)?eh:nh)(e),t.onDisabled(e)},ih=function(e,t,n){t.disableClass.each(function(t){pi(e.element,t)}),(Zp(e,t)?th:rh)(e),t.onEnabled(e)},uh=function(e,t){return Zp(e,t)?Io(e.element,"disabled"):"true"===Po(e.element,"aria-disabled")},ah=Object.freeze({__proto__:null,enable:ih,disable:oh,isDisabled:uh,onLoad:Qp,set:function(e,t,n,r){(r?oh:ih)(e,t)}}),ch=Object.freeze({__proto__:null,exhibit:function(e,t){return ai({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(e,t){return zr([Hr(dr(),function(t,n){return uh(t,e)}),Sa(e,t,Qp)])}}),sh=[Gt("disabled",a),Ht("useNative",!0),Pt("disableClass"),Lu("onDisabled"),Lu("onEnabled")],lh=Ea({fields:sh,name:"disabling",active:ch,apis:ah}),fh=tinymce.util.Tools.resolve("tinymce.EditorManager"),dh=function(e){return e.getParam("height",Math.max(e.getElement().offsetHeight,200))},mh=function(e){return e.getParam("width",Kp.DOM.getStyle(e.getElement(),"width"))},gh=function(e){return w.from(e.getParam("min_width")).filter(R)},ph=function(e){return w.from(e.getParam("min_height")).filter(R)},hh=function(e){return w.from(e.getParam("max_width")).filter(R)},vh=function(e){return w.from(e.getParam("max_height")).filter(R)},bh=function(e){return!1!==e.getParam("menubar",!0,"boolean")},yh=function(e){var t=e.getParam("toolbar",!0),n=!0===t,r=k(t),o=_(t)&&0<t.length;return!wh(e)&&(o||r||n)},xh=function(e){var t=F(9,function(t){return e.getParam("toolbar"+(t+1),!1,"string")}),n=U(t,function(e){return"string"==typeof e});return 0<n.length?w.some(n):w.none()},wh=function(e){return xh(e).fold(function(){return 0<e.getParam("toolbar",[],"string[]").length},c)};(rp=np=np||{}).default="wrap",rp.floating="floating",rp.sliding="sliding",rp.scrolling="scrolling";var Ch,Sh,kh=function(e){return e.getParam("toolbar_mode","","string")};(Sh=Ch=Ch||{}).auto="auto",Sh.top="top",Sh.bottom="bottom";var Oh,_h,Th,Eh=function(e){return e.getParam("toolbar_location",Ch.auto,"string")},Ah=function(e){return Eh(e)===Ch.bottom},Rh=function(e){var t=e.getParam("fixed_toolbar_container","","string");return 0<t.length&&e.inline?xu(wi(),t):w.none()},Nh=function(e){return e.inline&&Rh(e).isSome()},Bh=function(e){return Rh(e).getOrThunk(function(){return yo(bo(tn(e.getElement())))})},Dh=function(e){return e.inline&&!bh(e)&&!yh(e)&&!wh(e)},Ph=function(e){return(e.getParam("toolbar_sticky",!1,"boolean")||e.inline)&&!Nh(e)&&!Dh(e)},Mh="silver.readonly",Ih=Qe([Tt("readonly",wt)]),Lh=function(e,t){var n=e.outerContainer.element;t&&(e.mothership.broadcastOn([Ds()],{target:n}),e.uiMothership.broadcastOn([Ds()],{target:n})),e.mothership.broadcastOn([Mh],{readonly:t}),e.uiMothership.broadcastOn([Mh],{readonly:t})},Fh=function(e,t){e.on("init",function(){e.mode.isReadOnly()&&Lh(t,!0)}),e.on("SwitchMode",function(){return Lh(t,e.mode.isReadOnly())}),e.getParam("readonly",!1,"boolean")&&e.setMode("readonly")},zh=function(){var e;return Ba.config({channels:((e={})[Mh]={schema:Ih,onReceive:function(e,t){lh.set(e,t.readonly)}},e)})},Hh=function(e){return lh.config({disabled:e,disableClass:"tox-collection__item--state-disabled"})},Vh=function(e){return lh.config({disabled:e})},jh=function(e){return lh.config({disabled:e,disableClass:"tox-tbtn--disabled"})},Uh=function(e){return lh.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},Wh=function(e,t){var n=e.getApi(t);return function(e){e(n)}},qh=function(e,t){return Kr(function(n){Wh(e,n)(function(n){var r=e.onSetup(n);A(r)&&t.set(r)})})},Gh=function(e,t){return Yr(function(n){return Wh(e,n)(t.get())})},$h=((Oh={})[dr()]=["disabling","alloy.base.behaviour","toggling","item-events"],Oh),Xh=function(e){return K(e,function(e){return e.toArray()})},Kh=function(t,n,r,o){var i,u,a=Yt(e);return{type:"item",dom:n.dom,components:Xh(n.optComponents),data:t.data,eventOrder:$h,hasSubmenu:t.triggersSubmenu,itemBehaviours:_a([xm("item-events",[(i=t,u=r,Qr(function(e,t){Wh(i,e)(i.onAction),i.triggersSubmenu||u!==op.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&Dr(e,hr()),t.stop())})),qh(t,a),Gh(t,a)]),Hh(function(){return t.disabled||o.isDisabled()}),zh(),ym.config({})].concat(t.itemBehaviours))}},Yh=function(e){return{value:e.value,meta:l({text:e.text.getOr("")},e.meta)}},Jh=tinymce.util.Tools.resolve("tinymce.Env"),Qh=function(e){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:e}}},Zh=function(e){return{dom:{tag:"div",classes:[sp]},components:[Ii(Yp.translate(e))]}},ev=function(e,t){return{dom:{tag:"div",classes:t,innerHtml:e}}},tv=function(e,t){return{dom:{tag:"div",classes:[sp]},components:[{dom:{tag:e.tag,styles:e.styles},components:[Ii(Yp.translate(t))]}]}},nv=function(e){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(t=e,n=Jh.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},r=t.split("+"),o=H(r,function(e){var t=e.toLowerCase().trim();return Te(n,t)?n[t]:e}),o.join(Jh.mac?"":"+"))}};var t,n,r,o},rv=function(e){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Sg("checkmark",e)}}},ov=function(e,t){var n=t.map(function(e){return{attributes:{title:Yp.translate(e)}}}).getOr({});return l({tag:"div",classes:[ip,up].concat(e?["tox-collection__item-icon-rtl"]:[])},n)},iv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],uv=["list-bull-circle","list-bull-default","list-bull-square"],av=function(e,t,n,r){void 0===r&&(r=w.none());var i,u,a,c,s,f,m,g,p,h,v,b=Yp.isRtl()&&e.iconContent.exists(function(e){return I(uv,e)}),y=e.iconContent.map(function(e){return Yp.isRtl()&&I(iv,e)?e+"-rtl":e}).map(function(e){return n=e,i=r,w.from((o=t.icons)()[n.toLowerCase()]).or(i).getOrThunk(function(){return Cg(o)});var n,o,i}),x=w.from(e.meta).fold(function(){return Zh},function(e){return Te(e,"style")?o(tv,e.style):Zh});return"color"===e.presets?(m=e.ariaLabel,g=e.value,p=t,{dom:(h=y.getOr(""),v={tag:"div",attributes:m.map(function(e){return{title:p.translate(e)}}).getOr({}),classes:["tox-swatch"]},l(l({},v),"custom"===g?{tag:"button",classes:d(v.classes,["tox-swatches__picker-btn"]),innerHtml:h}:"remove"===g?{classes:d(v.classes,["tox-swatch--remove"]),innerHtml:h}:{attributes:l(l({},v.attributes),{"data-mce-color":g}),styles:{"background-color":g}})),optComponents:[]}):(i=e,u=x,a=b,c=n?y.or(w.some("")).map(Qh):w.none(),s=i.checkMark,f=i.htmlContent.fold(function(){return i.textContent.map(u)},function(e){return w.some(ev(e,[sp]))}),{dom:ov(a,i.ariaLabel),optComponents:[c,f,i.shortcutContent.map(nv),s,i.caret]})},cv=function(e,t){return _e(e,"tooltipWorker").map(function(e){return[Xp.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(e){return{anchor:"submenu",item:e,overrides:{maxHeightFunction:Ja}}},mode:"follow-highlight",onShow:function(t,n){e(function(e){Xp.setComponents(t,[Li({element:tn(e)})])})}})]}).getOr([])},sv=function(e,t){var n=Yp.translate(e),r=Kp.DOM.encode(n);if(0<t.length){var o=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return r.replace(o,function(e){return'<span class="tox-autocompleter-highlight">'+e+"</span>"})}return r},lv=function(e,t){return H(e,function(e){switch(e.type){case"cardcontainer":return o=lv((r=e).items,t),{dom:{tag:"div",classes:[dp,"vertical"===r.direction?"tox-collection__item-container--column":mp,"left"===r.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",function(){switch(r.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:o};case"cardimage":return{dom:{tag:"img",classes:e.classes,attributes:{src:e.src,alt:e.alt.getOr("")}}};case"cardtext":var n=e.name.exists(function(e){return I(t.cardText.highlightOn,e)})?w.from(t.cardText.matchText).getOr(""):"";return ev(sv(e.text,n),e.classes)}var r,o})},fv=Dl(Xm(),Km()),dv=function(e){return{value:e}},mv=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,gv=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,pv=function(e){return mv.test(e)||gv.test(e)},hv=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},vv=function(e){var t=hv(e.red)+hv(e.green)+hv(e.blue);return dv(t)},bv=Math.min,yv=Math.max,xv=Math.round,wv=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Cv=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Sv=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},kv=function(e){var t=parseInt(e,10);return t.toString()===e&&0<=t&&t<=255},Ov=function(e){var t,n,r,o=(e.hue||0)%360,i=e.value/100,u=yv(0,bv(u=e.saturation/100,1));if(i=yv(0,bv(i,1)),0===u)return t=n=r=xv(255*i),Sv(t,n,r,1);var a=o/60,c=i*u,s=c*(1-Math.abs(a%2-1)),l=i-c;switch(Math.floor(a)){case 0:t=c,n=s,r=0;break;case 1:t=s,n=c,r=0;break;case 2:t=0,n=c,r=s;break;case 3:t=0,n=s,r=c;break;case 4:t=s,n=0,r=c;break;case 5:t=c,n=0,r=s;break;default:t=n=r=0}return t=xv(255*(t+l)),n=xv(255*(n+l)),r=xv(255*(r+l)),Sv(t,n,r,1)},_v=function(e){var t=function(e){var t={value:e.value.replace(mv,function(e,t,n,r){return t+t+n+n+r+r})},n=gv.exec(t.value);return null===n?["FFFFFF","FF","FF","FF"]:n}(e),n=parseInt(t[1],16),r=parseInt(t[2],16),o=parseInt(t[3],16);return Sv(n,r,o,1)},Tv=function(e,t,n,r){var o=parseInt(e,10),i=parseInt(t,10),u=parseInt(n,10),a=parseFloat(r);return Sv(o,i,u,a)},Ev=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},Av=Sv(255,0,0,1),Rv=function(e,t){return e.fire("ResizeContent",t)},Nv=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Bv="tinymce-custom-colors",Dv="choiceitem",Pv=[{type:Dv,text:"Light Green",value:"#BFEDD2"},{type:Dv,text:"Light Yellow",value:"#FBEEB8"},{type:Dv,text:"Light Red",value:"#F8CAC6"},{type:Dv,text:"Light Purple",value:"#ECCAFA"},{type:Dv,text:"Light Blue",value:"#C2E0F4"},{type:Dv,text:"Green",value:"#2DC26B"},{type:Dv,text:"Yellow",value:"#F1C40F"},{type:Dv,text:"Red",value:"#E03E2D"},{type:Dv,text:"Purple",value:"#B96AD9"},{type:Dv,text:"Blue",value:"#3598DB"},{type:Dv,text:"Dark Turquoise",value:"#169179"},{type:Dv,text:"Orange",value:"#E67E23"},{type:Dv,text:"Dark Red",value:"#BA372A"},{type:Dv,text:"Dark Purple",value:"#843FA1"},{type:Dv,text:"Dark Blue",value:"#236FA1"},{type:Dv,text:"Light Gray",value:"#ECF0F1"},{type:Dv,text:"Medium Gray",value:"#CED4D9"},{type:Dv,text:"Gray",value:"#95A5A6"},{type:Dv,text:"Dark Gray",value:"#7E8C8D"},{type:Dv,text:"Navy Blue",value:"#34495E"},{type:Dv,text:"Black",value:"#000000"},{type:Dv,text:"White",value:"#ffffff"}],Mv=function(e){void 0===e&&(e=10);var t,n=Nv.getItem(Bv),r=k(n)?JSON.parse(n):[],o=e-(t=r).length<0?t.slice(0,e):t,i=function(e){o.splice(e,1)};return{add:function(t){var n;(-1===(n=M(o,t))?w.none():w.some(n)).each(i),o.unshift(t),o.length>e&&o.pop(),Nv.setItem(Bv,JSON.stringify(o))},state:function(){return o.slice(0)}}}(10),Iv=function(e){return!1!==e.getParam("custom_colors")},Lv=function(e){var t=e.getParam("color_map");return void 0!==t?function(e){var t=[],n=document.createElement("canvas");n.height=1,n.width=1;for(var r=n.getContext("2d"),o=function(e,t){var n=t/255;return("0"+Math.round(e*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},i=0;i<e.length;i+=2)t.push({text:e[i+1],value:function(e){if(/^[0-9A-Fa-f]{6}$/.test(e))return"#"+e.toUpperCase();r.clearRect(0,0,n.width,n.height),r.fillStyle="#FFFFFF",r.fillStyle=e,r.fillRect(0,0,1,1);var t=r.getImageData(0,0,1,1).data,i=t[1],u=t[2],a=t[3];return"#"+o(t[0],a)+o(i,a)+o(u,a)}(e[i]),type:"choiceitem"});return t}(t):Pv},Fv=function(e){Mv.add(e)},zv=function(e){var t=Lv(e),n=Math.max(5,Math.ceil(Math.sqrt(t.length)));return e.getParam("color_cols",n,"number")},Hv=function(e,t,n,r){"custom"===n?Gv(e)(function(n){n.each(function(n){Fv(n),e.execCommand("mceApplyTextcolor",t,n),r(n)})},"#000000"):"remove"===n?(r(""),e.execCommand("mceRemoveTextcolor",t)):(r(n),e.execCommand("mceApplyTextcolor",t,n))},Vv=function(e,t){return e.concat(H(Mv.state(),function(e){return{type:Dv,text:e,value:e}}).concat((n={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},t?[n,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[n])));var n},jv=function(e,t){return function(n){n(Vv(e,t))}},Uv=function(e,t,n){var r,o;e.setIconFill(r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o=n),e.setIconStroke(r,o)},Wv=function(t,n,r,o,i){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(e){var n,o,i;return w.from((o=r,(n=t).dom.getParents(n.selection.getStart(),function(e){var t;(t=e.style["forecolor"===o?"color":"background-color"])&&(i=i||t)}),i)).bind(function(t){return function(e){if("transparent"===e)return w.some(Sv(0,0,0,0));var t=wv.exec(e);if(null!==t)return w.some(Tv(t[1],t[2],t[3],"1"));var n=Cv.exec(e);return null!==n?w.some(Tv(n[1],n[2],n[3],n[4])):w.none()}(t).map(function(t){var n=vv(t).value;return cn(e.toLowerCase(),n)})}).getOr(!1)},columns:zv(t),fetch:jv(Lv(t),Iv(t)),onAction:function(n){null!==i.get()&&Hv(t,r,i.get(),e)},onItemAction:function(e,o){Hv(t,r,o,function(e){i.set(e),t.fire("TextColorChange",{name:n,color:e})})},onSetup:function(e){null!==i.get()&&Uv(e,n,i.get());var r=function(t){t.name===n&&Uv(e,t.name,t.color)};return t.on("TextColorChange",r),function(){t.off("TextColorChange",r)}}})},qv=function(t,n,r,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){Hv(t,r,n.value,e)}}]}})},Gv=function(t){return function(n,r){var o,i=(o=n,function(e){var t=e.getData();o(w.from(t.colorpicker)),e.close()});t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:r},onAction:function(e,t){"hex-valid"===t.name&&(t.value?e.enable("ok"):e.disable("ok"))},onSubmit:i,onClose:e,onCancel:function(){n(w.none())}})}},$v=function(e,t,n,r,o,i,u,a){var c=Cp(t),s=Xv(t,n,r,"color"!==o?"normal":"color",i,u,a);return Op(e,c,s,r,o)},Xv=function(t,n,r,o,i,u,a){return nf(H(t,function(c){return"choiceitem"===c.type?ft("choicemenuitem",Pp,c).fold(Sp,function(s){return w.some(function(t,n,r,o,i,u,a,c){void 0===c&&(c=!0);var s=av({presets:r,textContent:n?t.text:w.none(),htmlContent:w.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:w.none(),checkMark:n?w.some(rv(a.icons)):w.none(),caret:w.none(),value:t.value},a,c);return Be(Kh({data:Yh(t),disabled:t.disabled,getApi:function(e){return{setActive:function(t){Lm.set(e,t)},isActive:function(){return Lm.isOn(e)},isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},onAction:function(e){return o(t.value)},onSetup:function(t){return t.setActive(i),e},triggersSubmenu:!1,itemBehaviours:[]},s,u,a),{toggling:{toggleClass:cp,toggleOnExecute:!1,selected:t.active}})}(s,1===r,o,n,u(c.value),i,a,Cp(t)))}):w.none()}))},Kv=function(e,t){var n=hp(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}},Yv=jo("cell-over"),Jv=jo("cell-execute"),Qv={inserttable:function(e){var t=jo("size-label"),n=function(e,t,n){for(var r=[],o=0;o<10;o++){for(var i=[],u=0;u<10;u++)i.push(function(e,t,n){var r,o=function(n){return Pr(n,Jv,{row:e,col:t})},i=function(e,t){t.stop(),o(e)};return zi({dom:{tag:"div",attributes:((r={role:"button"})["aria-labelledby"]=n,r)},behaviours:_a([xm("insert-table-picker-cell",[jr(Yn(),Om.focus),jr(dr(),o),jr(rr(),i),jr(gr(),i)]),Lm.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Om.config({onFocus:function(n){return Pr(n,Yv,{row:e,col:t})}})])})}(o,u,e));r.push(i)}return r}(t),r=wg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[Ii("0x0")],behaviours:_a([ym.config({})])});return{type:"widget",data:{value:jo("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[fv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:K(n,function(e){return H(e,Hi)}).concat(r.asSpec()),behaviours:_a([xm("insert-table-picker",[Gr(Yv,function(e,t,o){var i=o.event.row,u=o.event.col;!function(e,t,n,r,o){for(var i=0;i<10;i++)for(var u=0;u<10;u++)Lm.set(e[i][u],i<=t&&u<=n)}(n,i,u),ym.set(r.get(e),[Ii(u+1+"x"+(i+1))])}),Gr(Jv,function(t,n,r){e.onAction({numRows:r.event.row+1,numColumns:r.event.col+1}),Dr(t,hr())})]),gm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(e,t){var n=Vv(t.colorinput.getColors(),t.colorinput.hasCustomColors()),r=t.colorinput.getColorCols(),o=$v(jo("menu-value"),n,function(t){e.onAction({value:t})},r,"color",op.CLOSE_ON_EXECUTE,a,t.shared.providers),i=l(l({},o),{markers:hp("color"),movement:Kv(r,"color")});return{type:"widget",data:{value:jo("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[fv.widget(tg.sketch(i))]}}},Zv=function(e){var t=e.text.fold(function(){return{}},function(e){return{innerHtml:e}});return{type:"separator",dom:l({tag:"div",classes:[up,"tox-collection__group-heading"]},t),components:[]}};(Th=_h=_h||{})[Th.ContentFocus=0]="ContentFocus",Th[Th.UiFocus=1]="UiFocus";var eb,tb,nb=function(t,n,r,o,i){var u=Cp(n),a=nf(H(n,function(t){var n=function(t){return function(t,n,r,o,i){var u=r.shared.providers,a=function(e){return i?l(l({},e),{shortcut:w.none(),icon:e.text.isSome()?w.none():e.icon}):e};switch(t.type){case"menuitem":return ft("menuitem",Ip,t).fold(Sp,function(e){return w.some(function(e,t,n,r){void 0===r&&(r=!0);var o=av({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:w.none(),ariaLabel:e.text,caret:w.none(),checkMark:w.none(),shortcutContent:e.shortcut},n,r);return Kh({data:Yh(e),getApi:function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},disabled:e.disabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n)}(a(e),n,u,o))});case"nestedmenuitem":return ft("nestedmenuitem",Lp,t).fold(Sp,function(t){return w.some(function(t,n,r,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var u=i?{dom:{tag:"div",classes:[lp],innerHtml:Sg("chevron-down",r.icons)}}:{dom:{tag:"div",classes:[lp],innerHtml:Sg("chevron-right",r.icons)}},a=av({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:w.none(),ariaLabel:t.text,caret:w.some(u),checkMark:w.none(),shortcutContent:t.shortcut},r,o);return Kh({data:Yh(t),getApi:function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},disabled:t.disabled,onAction:e,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,r)}(a(t),n,u,o,i))});case"togglemenuitem":return ft("togglemenuitem",Fp,t).fold(Sp,function(e){return w.some(function(e,t,n,r){void 0===r&&(r=!0);var o=av({iconContent:e.icon,textContent:e.text,htmlContent:w.none(),ariaLabel:e.text,checkMark:w.some(rv(n.icons)),caret:w.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,r);return Be(Kh({data:Yh(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){Lm.set(e,t)},isActive:function(){return Lm.isOn(e)},isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n),{toggling:{toggleClass:cp,toggleOnExecute:!1,selected:e.active}})}(a(e),n,u,o))});case"separator":return ft("separatormenuitem",zg,t).fold(Sp,function(e){return w.some(Zv(e))});case"fancymenuitem":return ft("fancymenuitem",Mp,t).fold(Sp,function(e){return function(e,t){return n=Qv,r=e.fancytype,(Object.prototype.hasOwnProperty.call(n,r)?w.some(n[r]):w.none()).map(function(n){return n(e,t)});var n,r}(a(e),r)});default:return console.error("Unknown item in general menu",t),w.none()}}(t,r,o,i?!t.hasOwnProperty("text"):u,i)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(l(l({},t),{disabled:!0})):n(t)}));return(i?kp:Op)(t,u,a,1,"normal")},rb=function(e){return ug.singleData(e.value,e)},ob=c,ib=function(e,t,n){return eu(e,t,ob,n,!1)},ub=function(e,t,n){return eu(e,t,ob,n,!0)},ab=Zi,cb=function(e,t,n){return wu(e,t,n).isSome()},sb=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},schedule:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n=setTimeout(function(){e.apply(null,r),n=null},t)}}},lb=function(e){var t=e.raw;return void 0===t.touches||1!==t.touches.length?w.none():w.some(t.touches[0])},fb=function(){return Nn().browser.isFirefox()},db=Je([Rt("triggerEvent"),Ht("stopBackspace",!0)]),mb=function(e,t){var n=_e(e,"target").getOr(t);return Yt(n)},gb=Ae([{stopped:[]},{resume:["element"]},{complete:[]}]),pb=function(e,t,n,r,o,i){var u,a,c,s,l=e(t,r),f=(u=n,a=o,c=Yt(!1),s=Yt(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold(function(){return i.logEventNoHandlers(t,r),gb.complete()},function(e){var n=e.descHandler;return ci(n)(f),f.isStopped()?(i.logEventStopped(t,e.element,n.purpose),gb.stopped()):f.isCut()?(i.logEventCut(t,e.element,n.purpose),gb.complete()):so(e.element).fold(function(){return i.logNoParent(t,e.element,n.purpose),gb.complete()},function(r){return i.logEventResponse(t,e.element,n.purpose),gb.resume(r)})})},hb=function(e,t,n,r,o,i){return pb(e,t,n,r,o,i).fold(c,function(r){return hb(e,t,n,r,o,i)},a)},vb=function(t,n,r){var o,i,c=(o=n,i=Yt(!1),{stop:function(){i.set(!0)},cut:e,isStopped:i.get,isCut:a,event:o,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return V(t,function(e){ci(e.descHandler)(c)}),c.isStopped()},bb=function(e,t,n,r,o){var i=mb(n,r);return hb(e,t,n,r,i,o)},yb=ef({name:"Container",factory:function(e){var t=e.dom,n=t.attributes,r=f(t,["attributes"]);return{uid:e.uid,dom:l({tag:"div",attributes:l({role:"presentation"},n)},r),components:e.components,behaviours:el(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[Ht("components",[]),Zs("containerBehaviours",[]),Ht("events",{}),Ht("domModification",{}),Ht("eventOrder",{})]}),xb=function(t){var r=function(e){return so(t.element).fold(c,function(t){return Pn(e,t)})},i=function(){var e=function(){var e={};return{registerId:function(t,n,r){xe(r,function(r,i){var u,a=void 0!==e[i]?e[i]:{};a[n]={cHandler:o.apply(void 0,[(u=r).handler].concat(t)),purpose:u.purpose},e[i]=a})},unregisterId:function(t){xe(e,function(e,n){e.hasOwnProperty(t)&&delete e[t]})},filterByType:function(t){return _e(e,t).map(function(e){return Se(e,function(e,t){return{id:t,descHandler:e}})}).getOr([])},find:function(t,n,r){var o=_e(e,n);return Fn(r,function(e){return t=o,Xo(n=e).fold(function(){return w.none()},function(e){return t.bind(function(t){return _e(t,e)}).map(function(e){return{element:n,descHandler:e}})});var t,n},t)}}}(),t={},n=function(n){Xo(n.element).each(function(n){delete t[n],e.unregisterId(n)})};return{find:function(t,n,r){return e.find(t,n,r)},filter:function(t){return e.filterByType(t)},register:function(r){var o=function(e){return Xo(e.element).fold(function(){return t=e.element,n=jo(qo+"uid-"),$o(t,n),n;var t,n},function(e){return e})}(r);Ee(t,o)&&function(e,r){var o=t[r];if(o!==e)throw new Error('The tagId "'+r+'" is already used by: '+Fo(o.element)+"\nCannot use it for: "+Fo(e.element)+"\nThe conflicting element is"+(xi(o.element)?" ":" not ")+"already in the DOM");n(e)}(r,o),e.registerId([r],o,r.events),t[o]=r},unregister:n,getById:function(e){return _e(t,e)}}}(),u=function(e,t){return i.find(r,e,t)},a=function(e,t){var n,r,o,i,u=mt("Getting GUI events settings",db,t),a=function(e){var t=Yt(w.none()),n=Yt(!1),r=sb(function(t){e.triggerEvent(pr(),t),n.set(!0)},400),o=Ue([{key:jn(),value:function(e){return lb(e).each(function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.schedule(e),n.set(!1),t.set(w.some(i))}),w.none()}},{key:Un(),value:function(e){return r.cancel(),lb(e).each(function(e){t.get().each(function(n){var r,o,i,u;r=e,o=n,i=Math.abs(r.clientX-o.x),u=Math.abs(r.clientY-o.y),(5<i||5<u)&&t.set(w.none())})}),w.none()}},{key:Wn(),value:function(o){return r.cancel(),t.get().filter(function(e){return Pn(e.target,o.target)}).map(function(t){return n.get()?(o.prevent(),!1):e.triggerEvent(gr(),o)})}}]);return{fireIfReady:function(e,t){return _e(o,t).bind(function(t){return t(e)})}}}(u),c=H(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return ib(e,t,function(e){a.fireIfReady(e,t).each(function(t){t&&e.kill()}),u.triggerEvent(t,e)&&e.kill()})}),s=Yt(w.none()),l=ib(e,"paste",function(e){a.fireIfReady(e,"paste").each(function(t){t&&e.kill()}),u.triggerEvent("paste",e)&&e.kill(),s.set(w.some(setTimeout(function(){u.triggerEvent(lr(),e)},0)))}),f=ib(e,"keydown",function(e){var t;u.triggerEvent("keydown",e)?e.kill():!0!==u.stopBackspace||(t=e).raw.which!==yf[0]||I(["input","textarea"],Zr(t.target))||cb(t.target,'[contenteditable="true"]')||e.prevent()}),d=(n=e,r=function(e){u.triggerEvent("focusin",e)&&e.kill()},fb()?ub(n,"focus",r):ib(n,"focusin",r)),m=Yt(w.none()),g=(o=e,i=function(e){u.triggerEvent("focusout",e)&&e.kill(),m.set(w.some(setTimeout(function(){u.triggerEvent(sr(),e)},0)))},fb()?ub(o,"blur",i):ib(o,"focusout",i));return{unbind:function(){V(c,function(e){e.unbind()}),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}}(t.element,{triggerEvent:function(e,t){return Eu(e,t.target,function(n){return bb(u,e,r=t,r.target,n);var r})}}),s={debugInfo:n("real"),triggerEvent:function(e,t,n){Eu(e,t,function(r){return bb(u,e,n,t,r)})},triggerFocus:function(t,n){Xo(t).fold(function(){Pa(t)},function(r){Eu(cr(),t,function(r){var o,i,a,c,s,l;return o=u,i=cr(),s=r,l=mb(a={originator:n,kill:e,prevent:e,target:t},c=t),pb(o,i,a,c,l,s),!1})})},triggerEscape:function(e,t){s.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return b(e)},getByDom:function(e){return y(e)},build:zi,addToGui:function(e){d(e)},removeFromGui:function(e){m(e)},addToWorld:function(e){l(e)},removeFromWorld:function(e){f(e)},broadcast:function(e){p(e)},broadcastOn:function(e,t){h(e,t)},broadcastEvent:function(e,t){v(e,t)},isConnected:c},l=function(e){e.connect(s),no(e.element)||(i.register(e),V(e.components(),l),s.triggerEvent(br(),e.element,{target:e.element}))},f=function(e){no(e.element)||(V(e.components(),f),i.unregister(e)),e.disconnect()},d=function(e){ps(t,e)},m=function(e){bs(e)},g=function(e){var t=i.filter(fr());V(t,function(t){ci(t.descHandler)(e)})},p=function(e){g({universal:!0,data:e})},h=function(e,t){g({universal:!1,channels:e,data:t})},v=function(e,t){var n=i.filter(e);return vb(n,t)},b=function(e){return i.getById(e).fold(function(){return ae.error(new Error('Could not find component with uid: "'+e+'" in system.'))},ae.value)},y=function(e){var t=Xo(e).getOr("not found");return b(t)};return l(t),{root:t,element:t.element,destroy:function(){a.unbind(),Eo(t.element)},add:d,remove:m,getByUid:b,getByDom:y,addToWorld:l,removeFromWorld:f,broadcast:p,broadcastOn:h,broadcastEvent:v}},wb=n([Ht("prefix","form-field"),Zs("fieldBehaviours",[cf,Qs])]),Cb=n([El({schema:[_t("dom")],name:"label"}),El({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[_t("text")],name:"aria-descriptor"}),_l({factory:{sketch:function(e){var t=function(e,t){return n=["factory"],r={},xe(e,function(e,t){I(n,t)||(r[t]=e)}),r;var n,r}(e);return e.factory.sketch(t)}},schema:[_t("factory")],name:"field"})]),Sb=tf({name:"FormField",configFields:wb(),partFields:Cb(),factory:function(e,t,n,r){var o=tl(e.fieldBehaviours,[cf.config({find:function(t){return Hl(t,e,"field")}}),Qs.config({store:{mode:"manual",getValue:function(e){return cf.getCurrent(e).bind(Qs.getValue)},setValue:function(e,t){cf.getCurrent(e).each(function(e){Qs.setValue(e,t)})}}})]),i=zr([Kr(function(t,n){var r=jl(t,e,["label","field","aria-descriptor"]);r.field().each(function(t){var n=jo(e.prefix);r.label().each(function(e){Do(e.element,"for",n),Do(t.element,"id",n)}),r["aria-descriptor"]().each(function(n){var r=jo(e.prefix);Do(n.element,"id",r),Do(t.element,"aria-describedby",r)})})})]);return{uid:e.uid,dom:e.dom,components:t,behaviours:o,events:i,apis:{getField:function(t){return Hl(t,e,"field")},getLabel:function(t){return Hl(t,e,"label")}}}},apis:{getField:function(e,t){return e.getField(t)},getLabel:function(e,t){return e.getLabel(t)}}}),kb=Object.freeze({__proto__:null,exhibit:function(e,t){return ai({attributes:Ue([{key:t.tabAttr,value:"true"}])})}}),Ob=[Ht("tabAttr","data-alloy-tabstop")],_b=Ea({fields:Ob,name:"tabstopping",active:kb}),Tb=tinymce.util.Tools.resolve("tinymce.html.Entities"),Eb=function(e,t,n,r){var o=Ab(e,t,n,r);return Sb.sketch(o)},Ab=function(e,t,n,r){return{dom:Rb(n),components:e.toArray().concat([t]),fieldBehaviours:_a(r)}},Rb=function(e){return{tag:"div",classes:["tox-form__group"].concat(e)}},Nb=function(e,t){return Sb.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}})},Bb=jo("form-component-change"),Db=jo("form-close"),Pb=jo("form-cancel"),Mb=jo("form-action"),Ib=jo("form-submit"),Lb=jo("form-block"),Fb=jo("form-unblock"),zb=jo("form-tabchange"),Hb=jo("form-resize"),Vb=n([Pt("data"),Ht("inputAttributes",{}),Ht("inputStyles",{}),Ht("tag","input"),Ht("inputClasses",[]),Lu("onSetValue"),Ht("styles",{}),Ht("eventOrder",{}),Zs("inputBehaviours",[Qs,Om]),Ht("selectOnFocus",!0)]),jb=function(t){return _a([Om.config({onFocus:t.selectOnFocus?function(e){var t=e.element,n=Pi(t);t.dom.setSelectionRange(0,n.length)}:e})])},Ub=function(e){return{tag:e.tag,attributes:l({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}},Wb=ef({name:"Input",configFields:Vb(),factory:function(e,t){return{uid:e.uid,dom:Ub(e),components:[],behaviours:l(l({},jb(n=e)),tl(n.inputBehaviours,[Qs.config({store:l(l({mode:"manual"},n.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return Pi(e.element)},setValue:function(e,t){Pi(e.element)!==t&&Mi(e.element,t)}}),onSetValue:n.onSetValue})])),eventOrder:e.eventOrder};var n}}),qb={},Gb={exports:qb};eb=qb,tb=Gb,function(e){"object"==typeof eb&&void 0!==tb?tb.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[u]={exports:{}};t[u][0].call(s.exports,function(e){return o(t[u][1][e]||e)},s,s.exports,e,t,n,r)}return n[u].exports}for(var i=!1,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var e=c(m);f=!0;for(var t=l.length;t;){for(s=l,l=[];++d<t;)s&&s[d].run();d=-1,t=l.length}s=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){function n(){}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var n,r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){try{n=r(e._value)}catch(l){return void u(t.promise,l)}i(t.promise,n)}else(1===e._state?i:u)(t.promise,e._value)})):e._deferreds.push(t)}function i(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void a(e);if("function"==typeof n)return void s((o=n,c=t,function(){o.apply(c,arguments)}),e)}e._state=1,e._value=t,a(e)}catch(i){u(e,i)}var o,c}function u(e,t){e._state=2,e._value=t,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function s(e,t){var r=!1;try{e(function(e){r||(r=!0,i(t,e))},function(e){r||(r=!0,u(t,e))})}catch(n){if(r)return;r=!0,u(t,n)}}var l;l=setTimeout,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new c(e,t,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,r){if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)!function i(u,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(e){i(u,e)},r)}t[u]=a,0==--o&&e(t)}catch(n){r(n)}}(i,t[i])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},r._immediateFn="function"==typeof e?function(t){e(t)}:function(e){l(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=r:this.Promise||(this.Promise=r)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){var o=e("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,o(function(){a[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete a[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var $b,Xb,Kb=Gb.exports.boltExport,Yb=function(e){var t=w.none(),n=[],r=function(e){o()?i(e):n.push(e)},o=function(){return t.isSome()},i=function(e){t.each(function(t){setTimeout(function(){e(t)},0)})};return e(function(e){o()||(t=w.some(e),function(e){V(e,i)}(n),n=[])}),{get:r,map:function(e){return Yb(function(t){r(function(n){t(e(n))})})},isReady:o}},Jb={nu:Yb,pure:function(e){return Yb(function(t){t(e)})}},Qb=function(e){setTimeout(function(){throw e},0)},Zb=function(e){var t=function(t){e().then(t,Qb)};return{map:function(t){return Zb(function(){return e().then(t)})},bind:function(t){return Zb(function(){return e().then(function(e){return t(e).toPromise()})})},anonBind:function(t){return Zb(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return Jb.nu(t)},toCached:function(){var t=null;return Zb(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},ey=function(e){return Zb(function(){return new Kb(e)})},ty=function(e){return Zb(function(){return Kb.resolve(e)})},ny=["input","textarea"],ry=function(e){var t=Zr(e);return I(ny,t)},oy=function(e,t){var n=t.getRoot(e).getOr(e.element);pi(n,t.invalidClass),t.notify.each(function(t){ry(e.element)&&Do(e.element,"aria-invalid",!1),t.getContainer(e).each(function(e){No(e,t.validHtml)}),t.onValid(e)})},iy=function(e,t,n,r){var o=t.getRoot(e).getOr(e.element);gi(o,t.invalidClass),t.notify.each(function(t){ry(e.element)&&Do(e.element,"aria-invalid",!0),t.getContainer(e).each(function(e){No(e,r)}),t.onInvalid(e,r)})},uy=function(e,t,n){return t.validator.fold(function(){return ty(ae.value(!0))},function(t){return t.validate(e)})},ay=function(e,t,n){return t.notify.each(function(t){t.onValidate(e)}),uy(e,t).map(function(n){return e.getSystem().isConnected()?n.fold(function(n){return iy(e,t,0,n),ae.error(n)},function(n){return oy(e,t),ae.value(n)}):ae.error("No longer in system")})},cy=Object.freeze({__proto__:null,markValid:oy,markInvalid:iy,query:uy,run:ay,isInvalid:function(e,t){var n=t.getRoot(e).getOr(e.element);return hi(n,t.invalidClass)}}),sy=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map(function(n){return zr([jr(n.onEvent,function(e){ay(e,t).get(r)})].concat(n.validateOnLoad?[Kr(function(n){ay(n,t).get(e)})]:[]))}).getOr({})}}),ly=[_t("invalidClass"),Ht("getRoot",w.none),zt("notify",[Ht("aria","alert"),Ht("getContainer",w.none),Ht("validHtml",""),Lu("onValid"),Lu("onInvalid"),Lu("onValidate")]),zt("validator",[_t("validate"),Ht("onEvent","input"),Ht("validateOnLoad",!0)])],fy=Ea({fields:ly,name:"invalidating",active:sy,apis:cy,extra:{validation:function(e){return function(t){var n=Qs.getValue(t);return ty(e(n))}}}}),dy=Object.freeze({__proto__:null,getCoupled:function(e,t,n,r){return n.getOrCreate(e,t,r)}}),my=[Tt("others",lt(ae.value,vt()))],gy=Ea({fields:my,name:"coupling",apis:dy,state:Object.freeze({__proto__:null,init:function(){var e={},t=n({});return ii({readState:t,getOrCreate:function(t,n,r){var o=be(n.others);if(o)return _e(e,r).getOrThunk(function(){var o=_e(n.others,r).getOrDie("No information found for coupled component: "+r)(t),i=t.getSystem().build(o);return e[r]=i});throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(o,null,2))}})}})}),py=n("sink"),hy=n(El({name:py(),overrides:n({dom:{tag:"div"},behaviours:_a([ls.config({useFixed:c})]),events:zr([$r(Zn()),$r(Gn()),$r(rr())])})}));(Xb=$b=$b||{})[Xb.HighlightFirst=0]="HighlightFirst",Xb[Xb.HighlightNone=1]="HighlightNone";var vy,by,yy,xy,wy,Cy,Sy=function(e,t){var n=e.getHotspot(t).getOr(t),r=e.getAnchorOverrides();return e.layouts.fold(function(){return{anchor:"hotspot",hotspot:n,overrides:r}},function(e){return{anchor:"hotspot",hotspot:n,overrides:r,layouts:e}})},ky=function(e,t,n,r,o,i,u){var a,c,s,f,d,m,g,p,h,v,b=Sy(e,n);return(c=b,f=r,d=o,m=u,g=t,p=s=n,h=(0,(a=e).fetch)(p).map(g),v=Ty(s,a),h.map(function(e){return e.bind(function(e){return w.from(ug.sketch(l(l({},d.menu()),{uid:Ko(""),data:e,highlightImmediately:m===$b.HighlightFirst,onOpenMenu:function(e,t){var n=v().getOrDie();ls.position(n,c,t),Bs.decloak(f)},onOpenSubmenu:function(e,t,n){var r=v().getOrDie();ls.position(r,{anchor:"submenu",item:t},n),Bs.decloak(f)},onRepositionMenu:function(e,t,n){var r=v().getOrDie();ls.position(r,c,t),V(n,function(e){ls.position(r,{anchor:"submenu",item:e.triggeringItem},e.triggeredMenu)})},onEscape:function(){return Om.focus(s),Bs.close(f),w.some(!0)}})))})})).map(function(e){return e.fold(function(){Bs.isOpen(r)&&Bs.close(r)},function(e){Bs.cloak(r),Bs.open(r,e),i(r)}),r})},Oy=function(e,t,n,r,o,i,u){return Bs.close(r),ty(r)},_y=function(e,t,n,r,o,i){var u=gy.getCoupled(n,"sandbox");return(Bs.isOpen(u)?Oy:ky)(e,t,n,u,r,o,i)},Ty=function(e,t){return e.getSystem().getByUid(t.uid+"-"+py()).map(function(e){return function(){return ae.value(e)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return ae.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(e)}})})},Ey=function(e){Bs.getState(e).each(function(e){ug.repositionMenus(e)})},Ay=function(e,t,n){var r=Cu(),o=Ty(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:r.id,role:"listbox"}},behaviours:rl(e.sandboxBehaviours,[Qs.config({store:{mode:"memory",initialValue:t}}),Bs.config({onOpen:function(o,i){var u=Sy(e,t);r.link(t.element),e.matchWidth&&function(e,t,n){var r=cf.getCurrent(t).getOr(t),o=Ji(e.element);n?Oi(r.element,"min-width",o+"px"):Yi.set(r.element,o)}(u.hotspot,i,e.useMinWidth),e.onOpen(u,o,i),void 0!==n&&void 0!==n.onOpen&&n.onOpen(o,i)},onClose:function(e,o){r.unlink(t.element),void 0!==n&&void 0!==n.onClose&&n.onClose(e,o)},isPartOf:function(e,n,r){return Su(n,r)||Su(t,r)},getAttachPoint:function(){return o().getOrDie()}}),cf.config({find:function(e){return Bs.getState(e).bind(function(e){return cf.getCurrent(e)})}}),Ba.config({channels:l(l({},Ls({isExtraPart:a})),zs({doReposition:Ey}))})])}},Ry=function(e){var t=gy.getCoupled(e,"sandbox");Ey(t)},Ny=function(){return[Ht("sandboxClasses",[]),nl("sandboxBehaviours",[cf,Ba,Bs,Qs])]},By=n([_t("dom"),_t("fetch"),Lu("onOpen"),Fu("onExecute"),Ht("getHotspot",w.some),Ht("getAnchorOverrides",n({})),lc(),Zs("dropdownBehaviours",[Lm,gy,gm,Om]),_t("toggleClass"),Ht("eventOrder",{}),Pt("lazySink"),Ht("matchWidth",!1),Ht("useMinWidth",!1),Pt("role")].concat(Ny())),Dy=n([Tl({schema:[Pu()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),hy()]),Py=tf({name:"Dropdown",configFields:By(),partFields:Dy(),factory:function(t,n,r,o){var i,u=function(e){Bs.getState(e).each(function(e){ug.highlightPrimary(e)})},a={expand:function(n){Lm.isOn(n)||_y(t,function(e){return e},n,o,e,$b.HighlightNone).get(e)},open:function(n){Lm.isOn(n)||_y(t,function(e){return e},n,o,e,$b.HighlightFirst).get(e)},isOpen:Lm.isOn,close:function(n){Lm.isOn(n)&&_y(t,function(e){return e},n,o,e,$b.HighlightFirst).get(e)},repositionMenus:function(e){Lm.isOn(e)&&Ry(e)}},c=function(e,t){return Mr(e),w.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:tl(t.dropdownBehaviours,[Lm.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),gy.config({others:{sandbox:function(e){return Ay(t,e,{onOpen:function(){return Lm.on(e)},onClose:function(){return Lm.off(e)}})}}}),gm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(e,t){var n;return Py.isOpen(e)?(n=gy.getCoupled(e,"sandbox"),u(n)):Py.open(e),w.some(!0)},onEscape:function(e,t){return Py.isOpen(e)?(Py.close(e),w.some(!0)):w.none()}}),Om.config({})]),events:zm(w.some(function(n){_y(t,function(e){return e},n,o,u,$b.HighlightFirst).get(e)})),eventOrder:l(l({},t.eventOrder),((i={})[dr()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:a,domModification:{attributes:l(l({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(e){return{role:e}})),"button"===t.dom.tag?{type:_e(t.dom,"attributes").bind(function(e){return _e(e,"type")}).getOr("button")}:{})}}},apis:{open:function(e,t){return e.open(t)},expand:function(e,t){return e.expand(t)},close:function(e,t){return e.close(t)},isOpen:function(e,t){return e.isOpen(t)},repositionMenus:function(e,t){return e.repositionMenus(t)}}}),My=Ea({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return zr([Hr(ir(),c)])},exhibit:function(){return ai({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Iy=jo("color-input-change"),Ly=jo("color-swatch-change"),Fy=jo("color-picker-cancel"),zy=function(e,t,n){return{hue:e,saturation:t,value:n}},Hy=jo("rgb-hex-update"),Vy=jo("slider-update"),jy=jo("palette-update"),Uy=El({schema:[_t("dom")],name:"label"}),Wy=function(e){return El({name:e+"-edge",overrides:function(t){return t.model.manager.edgeActions[e].fold(function(){return{}},function(e){return{events:zr([Ur(jn(),function(t,n,r){return e(t,r)},[t]),Ur(Gn(),function(t,n,r){return e(t,r)},[t]),Ur($n(),function(t,n,r){r.mouseIsDown.get()&&e(t,r)},[t])])}})}})},qy=Wy("top-left"),Gy=Wy("top"),$y=Wy("top-right"),Xy=Wy("right"),Ky=Wy("bottom-right"),Yy=Wy("bottom"),Jy=Wy("bottom-left"),Qy=[Uy,Wy("left"),Xy,Gy,Yy,qy,$y,Jy,Ky,_l({name:"thumb",defaults:n({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:zr([qr(jn(),e,"spectrum"),qr(Un(),e,"spectrum"),qr(Wn(),e,"spectrum"),qr(Gn(),e,"spectrum"),qr($n(),e,"spectrum"),qr(Kn(),e,"spectrum")])}}}),_l({schema:[Kt("mouseIsDown",function(){return Yt(!1)})],name:"spectrum",overrides:function(e){var t=e.model.manager,n=function(n,r){return t.getValueFromEvent(r).map(function(r){return t.setValueFrom(n,e,r)})};return{behaviours:_a([gm.config({mode:"special",onLeft:function(n){return t.onLeft(n,e)},onRight:function(n){return t.onRight(n,e)},onUp:function(n){return t.onUp(n,e)},onDown:function(n){return t.onDown(n,e)}}),Om.config({})]),events:zr([jr(jn(),n),jr(Un(),n),jr(Gn(),n),jr($n(),function(t,r){e.mouseIsDown.get()&&n(t,r)})])}}})],Zy=n("slider.change.value"),ex=function(e){var t=e.event.raw;return-1===t.type.indexOf("touch")?void 0!==t.clientX?w.some(t).map(function(e){return Gi(e.clientX,e.clientY)}):w.none():void 0!==t.touches&&1===t.touches.length?w.some(t.touches[0]).map(function(e){return Gi(e.clientX,e.clientY)}):w.none()},tx=function(e){return e.model.minX},nx=function(e){return e.model.minY},rx=function(e){return e.model.minX-1},ox=function(e){return e.model.minY-1},ix=function(e){return e.model.maxX},ux=function(e){return e.model.maxY},ax=function(e){return e.model.maxX+1},cx=function(e){return e.model.maxY+1},sx=function(e,t,n){return t(e)-n(e)},lx=function(e){return sx(e,ix,tx)},fx=function(e){return sx(e,ux,nx)},dx=function(e){return lx(e)/2},mx=function(e){return fx(e)/2},gx=function(e){return e.stepSize},px=function(e){return e.snapToGrid},hx=function(e){return e.snapStart},vx=function(e){return e.rounded},bx=function(e,t){return void 0!==e[t+"-edge"]},yx=function(e){return bx(e,"left")},xx=function(e){return bx(e,"right")},wx=function(e){return bx(e,"top")},Cx=function(e){return bx(e,"bottom")},Sx=function(e){return e.model.value.get()},kx=function(e){return{x:e}},Ox=function(e){return{y:e}},_x=function(e,t){return{x:e,y:t}},Tx=function(e,t){Pr(e,Zy(),{value:t})},Ex=function(e,t,n,r){return e<t?e:n<e?n:e===t?t-1:Math.max(t,e-r)},Ax=function(e,t,n,r){return n<e?e:e<t?t:e===n?n+1:Math.min(n,e+r)},Rx=function(e,t,n){return Math.max(t,Math.min(n,e))},Nx=function(e){var t=e.min,n=e.max,r=e.range,o=e.value,i=e.step,u=e.snap,a=e.snapStart,c=e.rounded,s=e.minBound,l=e.maxBound,f=e.screenRange,d=e.hasMinEdge?t-1:t,m=e.hasMaxEdge?n+1:n;if(o<s)return d;if(l<o)return m;var g,p,h,v,b,y=(b=s,Math.min(l,Math.max(o,b))-b),x=Rx(y/f*r+t,d,m);return u&&t<=x&&x<=n?(g=x,p=t,h=n,v=i,a.fold(function(){var e=Math.round((g-p)/v)*v;return Rx(p+e,p-1,h+1)},function(e){var t=Math.round((g-e)%v/v),n=Math.floor((g-e)/v),r=Math.floor((h-e)/v),o=e+Math.min(r,n+t)*v;return Math.max(e,o)})):c?Math.round(x):x},Bx=function(e){var t=e.min,n=e.value;return n<t?e.hasMinEdge?0:e.centerMinEdge:e.max<n?e.hasMaxEdge?e.maxBound:e.centerMaxEdge:(n-t)/e.range*e.maxOffset},Dx="left",Px=function(e){return e.element.dom.getBoundingClientRect()},Mx=function(e,t){return e[t]},Ix=function(e){var t=Px(e);return Mx(t,Dx)},Lx=function(e){var t=Px(e);return Mx(t,"right")},Fx=function(e){var t=Px(e);return Mx(t,"top")},zx=function(e){var t=Px(e);return Mx(t,"bottom")},Hx=function(e){var t=Px(e);return Mx(t,"width")},Vx=function(e){var t=Px(e);return Mx(t,"height")},jx=function(e,t,n){return(e+t)/2-n},Ux=function(e,t){var n=Px(e),r=Px(t),o=Mx(n,Dx),i=Mx(n,"right"),u=Mx(r,Dx);return jx(o,i,u)},Wx=function(e,t){var n=Px(e),r=Px(t),o=Mx(n,"top"),i=Mx(n,"bottom"),u=Mx(r,"top");return jx(o,i,u)},qx=function(e,t){Pr(e,Zy(),{value:t})},Gx=function(e){return{x:e}},$x=function(e,t,n){var r={min:tx(t),max:ix(t),range:lx(t),value:n,step:gx(t),snap:px(t),snapStart:hx(t),rounded:vx(t),hasMinEdge:yx(t),hasMaxEdge:xx(t),minBound:Ix(e),maxBound:Lx(e),screenRange:Hx(e)};return Nx(r)},Xx=function(e){return function(t,n){return r=t,i=(0<e?Ax:Ex)(Sx(o=n).x,tx(o),ix(o),gx(o)),qx(r,Gx(i)),w.some(i).map(c);var r,o,i}},Kx=function(e,t,n,r,o,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=n,s=r,l=o,f=Hx(u=t),d=s.bind(function(e){return w.some(Ux(e,u))}).getOr(0),m=l.bind(function(e){return w.some(Ux(e,u))}).getOr(f),g={min:tx(a),max:ix(a),range:lx(a),value:c,hasMinEdge:yx(a),hasMaxEdge:xx(a),minBound:Ix(u),minOffset:0,maxBound:Lx(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Bx(g));return Ix(t)-Ix(e)+p},Yx=Xx(-1),Jx=Xx(1),Qx=w.none,Zx=w.none,ew={"top-left":w.none(),top:w.none(),"top-right":w.none(),right:w.some(function(e,t){Tx(e,kx(ax(t)))}),"bottom-right":w.none(),bottom:w.none(),"bottom-left":w.none(),left:w.some(function(e,t){Tx(e,kx(rx(t)))})},tw=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=$x(e,t,n),o=Gx(r);return qx(e,o),r},setToMin:function(e,t){var n=tx(t);qx(e,Gx(n))},setToMax:function(e,t){var n=ix(t);qx(e,Gx(n))},findValueOfOffset:$x,getValueFromEvent:function(e){return ex(e).map(function(e){return e.left})},findPositionOfValue:Kx,setPositionFromValue:function(e,t,n,r){var o=Sx(n),i=Kx(e,r.getSpectrum(e),o.x,r.getLeftEdge(e),r.getRightEdge(e),n),u=Ji(t.element)/2;Oi(t.element,"left",i-u+"px")},onLeft:Yx,onRight:Jx,onUp:Qx,onDown:Zx,edgeActions:ew}),nw=function(e,t){Pr(e,Zy(),{value:t})},rw=function(e){return{y:e}},ow=function(e,t,n){var r={min:nx(t),max:ux(t),range:fx(t),value:n,step:gx(t),snap:px(t),snapStart:hx(t),rounded:vx(t),hasMinEdge:wx(t),hasMaxEdge:Cx(t),minBound:Fx(e),maxBound:zx(e),screenRange:Vx(e)};return Nx(r)},iw=function(e){return function(t,n){return r=t,i=(0<e?Ax:Ex)(Sx(o=n).y,nx(o),ux(o),gx(o)),nw(r,rw(i)),w.some(i).map(c);var r,o,i}},uw=function(e,t,n,r,o,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=n,s=r,l=o,f=Vx(u=t),d=s.bind(function(e){return w.some(Wx(e,u))}).getOr(0),m=l.bind(function(e){return w.some(Wx(e,u))}).getOr(f),g={min:nx(a),max:ux(a),range:fx(a),value:c,hasMinEdge:wx(a),hasMaxEdge:Cx(a),minBound:Fx(u),minOffset:0,maxBound:zx(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Bx(g));return Fx(t)-Fx(e)+p},aw=w.none,cw=w.none,sw=iw(-1),lw=iw(1),fw={"top-left":w.none(),top:w.some(function(e,t){Tx(e,Ox(ox(t)))}),"top-right":w.none(),right:w.none(),"bottom-right":w.none(),bottom:w.some(function(e,t){Tx(e,Ox(cx(t)))}),"bottom-left":w.none(),left:w.none()},dw=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=ow(e,t,n),o=rw(r);return nw(e,o),r},setToMin:function(e,t){var n=nx(t);nw(e,rw(n))},setToMax:function(e,t){var n=ux(t);nw(e,rw(n))},findValueOfOffset:ow,getValueFromEvent:function(e){return ex(e).map(function(e){return e.top})},findPositionOfValue:uw,setPositionFromValue:function(e,t,n,r){var o=Sx(n),i=uw(e,r.getSpectrum(e),o.y,r.getTopEdge(e),r.getBottomEdge(e),n),u=Ui(t.element)/2;Oi(t.element,"top",i-u+"px")},onLeft:aw,onRight:cw,onUp:sw,onDown:lw,edgeActions:fw}),mw=function(e,t){Pr(e,Zy(),{value:t})},gw=function(e,t){return{x:e,y:t}},pw=function(e,t){return function(n,r){return i=n,u=r,a=0<e?Ax:Ex,s=(o=t)?Sx(u).x:a(Sx(u).x,tx(u),ix(u),gx(u)),l=o?a(Sx(u).y,nx(u),ux(u),gx(u)):Sx(u).y,mw(i,gw(s,l)),w.some(s).map(c);var o,i,u,a,s,l}},hw=ex,vw=pw(-1,!1),bw=pw(1,!1),yw=pw(-1,!0),xw=pw(1,!0),ww={"top-left":w.some(function(e,t){Tx(e,_x(rx(t),ox(t)))}),top:w.some(function(e,t){Tx(e,_x(dx(t),ox(t)))}),"top-right":w.some(function(e,t){Tx(e,_x(ax(t),ox(t)))}),right:w.some(function(e,t){Tx(e,_x(ax(t),mx(t)))}),"bottom-right":w.some(function(e,t){Tx(e,_x(ax(t),cx(t)))}),bottom:w.some(function(e,t){Tx(e,_x(dx(t),cx(t)))}),"bottom-left":w.some(function(e,t){Tx(e,_x(rx(t),cx(t)))}),left:w.some(function(e,t){Tx(e,_x(rx(t),mx(t)))})},Cw=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var r=$x(e,t,n.left),o=ow(e,t,n.top),i=gw(r,o);return mw(e,i),i},setToMin:function(e,t){var n=tx(t),r=nx(t);mw(e,gw(n,r))},setToMax:function(e,t){var n=ix(t),r=ux(t);mw(e,gw(n,r))},getValueFromEvent:hw,setPositionFromValue:function(e,t,n,r){var o=Sx(n),i=Kx(e,r.getSpectrum(e),o.x,r.getLeftEdge(e),r.getRightEdge(e),n),u=uw(e,r.getSpectrum(e),o.y,r.getTopEdge(e),r.getBottomEdge(e),n),a=Ji(t.element)/2,c=Ui(t.element)/2;Oi(t.element,"left",i-a+"px"),Oi(t.element,"top",u-c+"px")},onLeft:vw,onRight:bw,onUp:yw,onDown:xw,edgeActions:ww}),Sw=tf({name:"Slider",configFields:[Ht("stepSize",1),Ht("onChange",e),Ht("onChoose",e),Ht("onInit",e),Ht("onDragStart",e),Ht("onDragEnd",e),Ht("snapToGrid",!1),Ht("rounded",!0),Pt("snapStart"),Tt("model",ht("mode",{x:[Ht("minX",0),Ht("maxX",100),Kt("value",function(e){return Yt(e.mode.minX)}),_t("getInitialValue"),Vu("manager",tw)],y:[Ht("minY",0),Ht("maxY",100),Kt("value",function(e){return Yt(e.mode.minY)}),_t("getInitialValue"),Vu("manager",dw)],xy:[Ht("minX",0),Ht("maxX",100),Ht("minY",0),Ht("maxY",100),Kt("value",function(e){return Yt({x:e.mode.minX,y:e.mode.minY})}),_t("getInitialValue"),Vu("manager",Cw)]})),Zs("sliderBehaviours",[gm,Qs]),Kt("mouseIsDown",function(){return Yt(!1)})],partFields:Qy,factory:function(e,t,n,r){var o,i=function(t){return Vl(t,e,"thumb")},u=function(t){return Vl(t,e,"spectrum")},a=function(t){return Hl(t,e,"left-edge")},s=function(t){return Hl(t,e,"right-edge")},l=function(t){return Hl(t,e,"top-edge")},f=function(t){return Hl(t,e,"bottom-edge")},d=e.model,m=d.manager,g=function(t,n){m.setPositionFromValue(t,n,e,{getLeftEdge:a,getRightEdge:s,getTopEdge:l,getBottomEdge:f,getSpectrum:u})},p=function(t,n){d.value.set(n);var r=i(t);return g(t,r),e.onChange(t,r,n),w.some(!0)},h=function(t){var n=e.mouseIsDown.get();e.mouseIsDown.set(!1),n&&Hl(t,e,"thumb").each(function(n){var r=d.value.get();e.onChoose(t,n,r)})},v=function(t,n){n.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,i(t))},b=function(t,n){n.stop(),e.onDragEnd(t,i(t)),h(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:tl(e.sliderBehaviours,[gm.config({mode:"special",focusIn:function(t){return Hl(t,e,"spectrum").map(gm.focusIn).map(c)}}),Qs.config({store:{mode:"manual",getValue:function(e){return d.value.get()}}}),Ba.config({channels:((o={})[Ms()]={onReceive:h},o)})]),events:zr([jr(Zy(),function(e,t){p(e,t.event.value)}),Kr(function(t,n){var r=d.getInitialValue();d.value.set(r);var o=i(t);g(t,o);var a=u(t);e.onInit(t,o,a,d.value.get())}),jr(jn(),v),jr(Wn(),b),jr(Gn(),v),jr(Kn(),b)]),apis:{resetToMin:function(t){m.setToMin(t,e)},resetToMax:function(t){m.setToMax(t,e)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),kw=[Zs("formBehaviours",[Qs])],Ow=function(e){return"<alloy.field."+e+">"},_w=function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:tl(e.formBehaviours,[Qs.config({store:{mode:"manual",getValue:function(t){var n=Ul(t,e);return we(n,function(e,t){return e().bind(function(e){var n,r;return n=cf.getCurrent(e),r=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Fo(e.element)),n.fold(function(){return ae.error(r)},ae.value)}).map(Qs.getValue)})},setValue:function(t,n){xe(n,function(n,r){Hl(t,e,r).each(function(e){cf.getCurrent(e).each(function(e){Qs.setValue(e,n)})})})}}})]),apis:{getField:function(t,n){return Hl(t,e,n).bind(cf.getCurrent)}}}},Tw={getField:ri(function(e,t,n){return e.getField(t,n)}),sketch:function(e){var t,n=(t=[],{field:function(e,n){return t.push(e),Ml("form",Ow(e),n)},record:function(){return t}}),r=e(n),o=n.record(),i=H(o,function(e){return _l({name:e,pname:Ow(e)})});return Yl("form",kw,i,_w,r)}},Ew=jo("valid-input"),Aw=jo("invalid-input"),Rw=jo("validating-input"),Nw="colorcustom.rgb.",Bw=function(){return cf.config({find:w.some})},Dw=function(e){return cf.config({find:e.getOpt})},Pw=function(e){return cf.config({find:function(t){return go(t.element,e).bind(function(e){return t.getSystem().getByDom(e).toOptional()})}})},Mw={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Iw=function(e){return Mw[e]},Lw=tinymce.util.Tools.resolve("tinymce.Resource"),Fw=tinymce.util.Tools.resolve("tinymce.util.Tools"),zw=Qe([Ht("preprocess",r),Ht("postprocess",r)]),Hw=function(e,t,n){return Qs.config(Be({store:{mode:"manual",getValue:t,setValue:n}},e.map(function(e){return{store:{initialValue:e}}}).getOr({})))},Vw=function(e,t){var n=mt("RepresentingConfigs.memento processors",zw,t);return Qs.config({store:{mode:"manual",getValue:function(t){var r=e.get(t),o=Qs.getValue(r);return n.postprocess(o)},setValue:function(t,r){var o=n.preprocess(r),i=e.get(t);Qs.setValue(i,o)}}})},jw=Hw,Uw=function(e){return function(e,t,n){return Hw(e,function(e){return t(e.element)},function(e,t){return n(e.element,t)})}(e,Ro,No)},Ww=function(e){return Qs.config({store:{mode:"memory",initialValue:e}})},qw=jo("alloy-fake-before-tabstop"),Gw=jo("alloy-fake-after-tabstop"),$w=function(e){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:_a([Om.config({ignore:!0}),_b.config({})])}},Xw=function(e){return{dom:{tag:"div",classes:["tox-navobj"]},components:[$w([qw]),e,$w([Gw])],behaviours:_a([Pw(1)])}},Kw=function(e,t){Pr(e,Zn(),{raw:{which:9,shiftKey:t}})},Yw=function(e,t){var n=t.element;hi(n,qw)?Kw(e,!0):hi(n,Gw)&&Kw(e,!1)},Jw=function(e){return cb(e,["."+qw,"."+Gw].join(","),a)},Qw=!(Nn().browser.isIE()||Nn().browser.isEdge()),Zw=function(e,t){return nC(document.createElement("canvas"),e,t)},eC=function(e){var t=Zw(e.width,e.height);return tC(t).drawImage(e,0,0),t},tC=function(e){return e.getContext("2d")},nC=function(e,t,n){return e.width=t,e.height=n,e},rC=function(e){return e.naturalWidth||e.width},oC=function(e){return e.naturalHeight||e.height},iC=window.Promise?window.Promise:(vy=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Cy(e,xy(aC,this),xy(cC,this))},by=window,yy=vy.immediateFn||"function"==typeof by.setImmediate&&by.setImmediate||function(e){return setTimeout(e,1)},xy=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(t,n)}},wy=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Cy=function(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(o){if(r)return;r=!0,n(o)}},vy.prototype.catch=function(e){return this.then(null,e)},vy.prototype.then=function(e,t){var n=this;return new vy(function(r,o){uC.call(n,new lC(e,t,r,o))})},vy.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Array.prototype.slice.call(1===e.length&&wy(e[0])?e[0]:e);return new vy(function(e,t){if(0===n.length)return e([]);for(var r=n.length,o=function(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,function(e){o(i,e)},t)}n[i]=u,0==--r&&e(n)}catch(p){t(p)}},i=0;i<n.length;i++)o(i,n[i])})},vy.resolve=function(e){return e&&"object"==typeof e&&e.constructor===vy?e:new vy(function(t){t(e)})},vy.reject=function(e){return new vy(function(t,n){n(e)})},vy.race=function(e){return new vy(function(t,n){for(var r=0,o=e;r<o.length;r++)o[r].then(t,n)})},vy);function uC(e){var t=this;null!==this._state?yy(function(){var n,r=t._state?e.onFulfilled:e.onRejected;if(null!==r){try{n=r(t._value)}catch(g){return void e.reject(g)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)}):this._deferreds.push(e)}function aC(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void Cy(xy(t,e),xy(aC,this),xy(cC,this))}this._state=!0,this._value=e,sC.call(this)}catch(g){cC.call(this,g)}}function cC(e){this._state=!1,this._value=e,sC.call(this)}function sC(){for(var e=0,t=this._deferreds;e<t.length;e++)uC.call(this,t[e]);this._deferreds=[]}function lC(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}var fC,dC,mC,gC,pC,hC,vC,bC=function(e,t,n){return t=t||"image/png",A(HTMLCanvasElement.prototype.toBlob)?new iC(function(r,o){e.toBlob(function(e){e?r(e):o()},t,n)}):function(e){return new iC(function(t,n){(function(e){var t=e.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return w.none();for(var r=n[1],o=atob(t[1]),i=o.length,u=Math.ceil(i/1024),a=new Array(u),c=0;c<u;++c){for(var s=1024*c,l=Math.min(1024+s,i),f=new Array(l-s),d=s,m=0;d<l;++m,++d)f[m]=o[d].charCodeAt(0);a[c]=new Uint8Array(f)}return w.some(new Blob(a,{type:r}))})(e).fold(function(){n("uri is not base64: "+e)},t)})}(e.toDataURL(t,n))},yC=function(e,t,r){var o=n(t.type),i=n(r),u=function(t,n){return e.then(function(e){return r=(r=t)||"image/png",e.toDataURL(r,n);var r})};return{getType:o,toBlob:function(){return iC.resolve(t)},toDataURL:i,toBase64:function(){return r.split(",")[1]},toAdjustedBlob:function(t,n){return e.then(function(e){return bC(e,t,n)})},toAdjustedDataURL:u,toAdjustedBase64:function(e,t){return u(e,t).then(function(e){return e.split(",")[1]})},toCanvas:function(){return e.then(eC)}}},xC=function(e,t){return bC(e,t).then(function(t){return yC(iC.resolve(e),t,e.toDataURL())})},wC=function(e,t,n){var r="string"==typeof e?parseFloat(e):e;return n<r?r=n:r<t&&(r=t),r},CC=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],SC=function(e,t){for(var n,r=[],o=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)r[u]=t[u+5*i];for(u=0;u<5;u++){for(var a=n=0;a<5;a++)n+=e[u+5*a]*r[a];o[u+5*i]=n}}return o},kC=function(e,t){return e.toCanvas().then(function(n){return OC(n,e.getType(),t)})},OC=function(e,t,n){var r=tC(e),o=function(e,t){for(var n,r,o,i,u=e.data,a=t[0],c=t[1],s=t[2],l=t[3],f=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],x=t[13],w=t[14],C=t[15],S=t[16],k=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)u[T]=(n=u[T])*a+(r=u[T+1])*c+(o=u[T+2])*s+(i=u[T+3])*l+f,u[T+1]=n*d+r*m+o*g+i*p+h,u[T+2]=n*v+r*b+o*y+i*x+w,u[T+3]=n*C+r*S+o*k+i*O+_;return e}(r.getImageData(0,0,e.width,e.height),n);return r.putImageData(o,0,0),xC(e,t)},_C=function(e){return function(t,n){return kC(t,e([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n))}},TC=(fC=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(e){return kC(e,fC)}),EC=_C(function(e,t){return t=wC(255*t,-255,255),SC(e,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}),AC=_C(function(e,t){var n;return t=wC(t,-1,1),n=(t*=100)<0?127+t/100*127:127*(n=0==(n=t%1)?CC[t]:CC[Math.floor(t)]*(1-n)+CC[Math.floor(t)+1]*n)+127,SC(e,[n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}),RC=(dC=[0,-1,0,-1,5,-1,0,-1,0],function(e){return n=dC,(t=e).toCanvas().then(function(e){return function(e,t,n){var r=tC(e),o=function(e,t,n){for(var r=function(e,t,n){return n<e?e=n:e<t&&(e=t),e},o=Math.round(Math.sqrt(n.length)),i=Math.floor(o/2),u=e.data,a=t.data,c=e.width,s=e.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<o;p++)for(var h=0;h<o;h++){var v=r(f+h-i,0,c-1),b=4*(r(l+p-i,0,s-1)*c+v),y=n[p*o+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=r(d,0,255),a[1+x]=r(m,0,255),a[2+x]=r(g,0,255)}return t}(r.getImageData(0,0,e.width,e.height),o=r.getImageData(0,0,e.width,e.height),n);return r.putImageData(o,0,0),xC(e,t)}(e,t.getType(),n)});var t,n}),NC=(mC=function(e,t){return 255*Math.pow(e/255,1-t)},function(e,t){return e.toCanvas().then(function(n){return function(e,t,n){for(var r=tC(e),o=new Array(256),i=0;i<o.length;i++)o[i]=mC(i,n);var u=function(e,t){for(var n=e.data,r=0;r<n.length;r+=4)n[r]=t[n[r]],n[r+1]=t[n[r+1]],n[r+2]=t[n[r+2]];return e}(r.getImageData(0,0,e.width,e.height),o);return r.putImageData(u,0,0),xC(e,t)}(n,e.getType(),t)})}),BC=function(e,t,n){var r=rC(e),o=oC(e),i=t/r,u=n/o,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=DC(e,i,u);return a?c.then(function(e){return BC(e,t,n)}):c},DC=function(e,t,n){return new iC(function(r){var o=rC(e),i=oC(e),u=Math.floor(o*t),a=Math.floor(i*n),c=Zw(u,a);tC(c).drawImage(e,0,0,o,i,0,0,u,a),r(c)})},PC=function(e){return TC(e)},MC=function(e){return RC(e)},IC=function(e,t){return NC(e,t)},LC=function(e,t){return EC(e,t)},FC=function(e,t){return AC(e,t)},zC=function(e,t){return r=t,(n=e).toCanvas().then(function(e){return function(e,t,n){var r=Zw(e.width,e.height),o=tC(r);return"v"===n?(o.scale(1,-1),o.drawImage(e,0,-r.height)):(o.scale(-1,1),o.drawImage(e,-r.width,0)),xC(r,t)}(e,n.getType(),r)});var n,r},HC=function(e,t){return r=t,(n=e).toCanvas().then(function(e){return function(e,t,n){var r=Zw(e.width,e.height),o=tC(r),i=0,u=0;return 90!==(n=n<0?360+n:n)&&270!==n||nC(r,r.height,r.width),90!==n&&180!==n||(i=r.width),270!==n&&180!==n||(u=r.height),o.translate(i,u),o.rotate(n*Math.PI/180),o.drawImage(e,0,0),xC(r,t)}(e,n.getType(),r)});var n,r},VC=function(e,t){return l({dom:{tag:"span",innerHtml:e,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},jC=function(e,t){return VC(Sg(e,t),{})},UC=function(e,t){return VC(Sg(e,t),{behaviours:_a([ym.config({})])})},WC=function(e,t,n){return{dom:{tag:"span",innerHtml:n.translate(e),classes:[t+"__select-label"]},behaviours:_a([ym.config({})])}},qC=jo("toolbar.button.execute"),GC=((gC={})[dr()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],gC),$C=jo("update-menu-text"),XC=jo("update-menu-icon"),KC=function(t,n,r){var i=Yt(e),u=t.text.map(function(e){return wg(WC(e,n,r.providers))}),a=t.icon.map(function(e){return wg(UC(e,r.providers.icons))}),c=function(e,t){var n=Qs.getValue(e);return Om.focus(n),Pr(n,"keydown",{raw:t.event.raw}),Py.close(n),w.some(!0)},s=t.role.fold(function(){return{}},function(e){return{role:e}}),f=t.tooltip.fold(function(){return{}},function(e){var t=r.providers.translate(e);return{title:t,"aria-label":t}});return wg(Py.sketch(l(l(l({},t.uid?{uid:t.uid}:{}),s),{dom:{tag:"button",classes:[n,n+"--select"].concat(H(t.classes,function(e){return n+"--"+e})),attributes:l({},f)},components:Xh([a.map(function(e){return e.asSpec()}),u.map(function(e){return e.asSpec()}),w.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:Sg("chevron-down",r.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:_a(d(t.dropdownBehaviours,[Vh(function(){return t.disabled||r.providers.isDisabled()}),zh(),My.config({}),ym.config({}),xm("dropdown-events",[qh(t,i),Gh(t,i)]),xm("menubutton-update-display-text",[jr($C,function(e,t){u.bind(function(t){return t.getOpt(e)}).each(function(e){ym.set(e,[Ii(r.providers.translate(t.event.text))])})}),jr(XC,function(e,t){a.bind(function(t){return t.getOpt(e)}).each(function(e){ym.set(e,[UC(t.event.icon,r.providers.icons)])})})])])),eventOrder:Be(GC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:_a([gm.config({mode:"special",onLeft:c,onRight:c})]),lazySink:r.getSink,toggleClass:n+"--active",parts:{menu:bp(0,0,t.presets)},fetch:function(e){return ey(o(t.fetch,e))}}))).asSpec()},YC=function(e){return"separator"===e.type},JC={type:"separator"},QC=function(e,t){var n=function(e,t){var n=q(e,function(e,n){return k(n)?""===n?e:"|"===n?0<e.length&&!YC(e[e.length-1])?e.concat([JC]):e:Te(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n])},[]);return 0<n.length&&YC(n[n.length-1])&&n.pop(),n}(k(e)?e.split(" "):e,t);return W(n,function(e,n){var r=function(e,t){return Te(e,"getSubmenuItems")?(r=t,o=(n=e).getSubmenuItems(),i=QC(o,r),{item:n,menus:Be(i.menus,je(n.value,i.items)),expansions:Be(i.expansions,je(n.value,n.value))}):{item:e,menus:{},expansions:{}};var n,r,o,i}(function(e){if(YC(e))return e;var t=_e(e,"value").getOrThunk(function(){return jo("generated-menu-item")});return Be({value:t},e)}(n),t);return{menus:Be(e.menus,r.menus),items:[r.item].concat(e.items),expansions:Be(e.expansions,r.expansions)}},{menus:{},expansions:{},items:[]})},ZC=function(e,t,n,r){var o=jo("primary-menu"),i=QC(e,n.shared.providers.menuItems());if(0===i.items.length)return w.none();var u=nb(o,i.items,t,n,r),a=we(i.menus,function(e,r){return nb(r,e,t,n,!1)}),c=Be(a,je(o,u));return w.from(ug.tieredData(o,c,i.expansions))},eS=function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)},setActive:function(t){var n=e.element;t?(gi(n,"tox-tbtn--enabled"),Do(n,"aria-pressed",!0)):(pi(n,"tox-tbtn--enabled"),Lo(n,"aria-pressed"))},isActive:function(){return hi(e.element,"tox-tbtn--enabled")}}},tS=function(e,t,n,r){return KC({text:e.text,icon:e.icon,tooltip:e.tooltip,role:r,fetch:function(t,r){e.fetch(function(e){r(ZC(e,op.CLOSE_ON_EXECUTE,n,!1))})},onSetup:e.onSetup,getApi:eS,columns:1,presets:"normal",classes:[],dropdownBehaviours:[_b.config({})]},t,n.shared)},nS=function(e,t,n){return function(r){r(H(e,function(e){var r,o,i=e.text.fold(function(){return{}},function(e){return{text:e}});return l(l({type:e.type,active:!1},i),{onAction:function(e){var r=!e.isActive();e.setActive(r),o.storage.set(r),n.shared.getSink().each(function(e){t().getOpt(e).each(function(e){Pa(e.element),Pr(e,Mb,{name:o.name,value:o.storage.get()})})})},onSetup:(r=o=e,function(e){e.setActive(r.storage.get())})})}))}},rS=function(e,t,n,r,o,i){void 0===n&&(n=[]);var u=t.fold(function(){return{}},function(e){return{action:e}}),a=l({buttonBehaviours:_a([Vh(function(){return e.disabled||i.isDisabled()}),zh(),_b.config({}),xm("button press",[Vr("click"),Vr("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Be(a,{dom:r});return Be(c,{components:o})},oS=function(e,t,n,r){void 0===r&&(r=[]);var o={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(function(e){return{"aria-label":n.translate(e),title:n.translate(e)}}).getOr({})},i=e.icon.map(function(e){return jC(e,n.icons)}),u=Xh([i]);return rS(e,t,r,o,u,n)},iS=function(e,t,n,r){void 0===r&&(r=[]);var o=oS(e,w.some(t),n,r);return xg.sketch(o)},uS=function(e,t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=n.translate(e.text),u=e.icon?e.icon.map(function(e){return jC(e,n.icons)}):w.none(),a=u.isSome()?Xh([u]):[],c=u.isSome()?{}:{innerHtml:i},s=d(e.primary||e.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],e.borderless?["tox-button--naked"]:[],o),f=l(l({tag:"button",classes:s},c),{attributes:{title:i}});return rS(e,t,r,f,a,n)},aS=function(e,t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=uS(e,w.some(t),n,r,o);return xg.sketch(i)},cS=function(e,t){return function(n){"custom"===t?Pr(n,Mb,{name:e,value:{}}):"submit"===t?Dr(n,Ib):"cancel"===t?Dr(n,Pb):console.error("Unknown button type: ",t)}},sS=function(t,n,r){if("menu"===n){var o=t,i=l(l({},t),{onSetup:function(n){return n.setDisabled(t.disabled),e},fetch:nS(o.items,function(){return u},r)}),u=wg(tS(i,"tox-tbtn",r,w.none()));return u.asSpec()}if("custom"===(s=n)||"cancel"===s||"submit"===s){var a=cS(t.name,n),c=l(l({},t),{borderless:!1});return aS(c,a,r.shared.providers,[])}var s;console.error("Unknown footer button type: ",n)},lS=n([Ht("field1Name","field1"),Ht("field2Name","field2"),zu("onLockedChange"),Mu(["lockClass"]),Ht("locked",!1),nl("coupledFieldBehaviours",[cf,Qs])]),fS=function(e,t){return _l({factory:Sb,name:e,overrides:function(e){return{fieldBehaviours:_a([xm("coupled-input-behaviour",[jr(tr(),function(n){Hl(n,e,t).bind(cf.getCurrent).each(function(t){Hl(n,e,"lock").each(function(r){Lm.isOn(r)&&e.onLockedChange(n,t,r)})})})])])}}})},dS=n([fS("field1","field2"),fS("field2","field1"),_l({factory:xg,schema:[_t("dom")],name:"lock",overrides:function(e){return{buttonBehaviours:_a([Lm.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])}}})]),mS=tf({name:"FormCoupledInputs",configFields:lS(),partFields:dS(),factory:function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,behaviours:rl(e.coupledFieldBehaviours,[cf.config({find:w.some}),Qs.config({store:{mode:"manual",getValue:function(t){var n=ql(t,e,["field1","field2"]),r={};return r[e.field1Name]=Qs.getValue(n.field1()),r[e.field2Name]=Qs.getValue(n.field2()),r},setValue:function(t,n){var r=ql(t,e,["field1","field2"]);Ee(n,e.field1Name)&&Qs.setValue(r.field1(),n[e.field1Name]),Ee(n,e.field2Name)&&Qs.setValue(r.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Hl(t,e,"field1")},getField2:function(t){return Hl(t,e,"field2")},getLock:function(t){return Hl(t,e,"lock")}}}},apis:{getField1:function(e,t){return e.getField1(t)},getField2:function(e,t){return e.getField2(t)},getLock:function(e,t){return e.getLock(t)}}}),gS=function(e){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return ae.error(e);var n=parseFloat(t[1]);return ae.value({value:n,unit:t[2]})},pS=function(e,t){var n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(e){return Object.prototype.hasOwnProperty.call(n,e)};return e.unit===t?w.some(e.value):r(e.unit)&&r(t)?w.some(n[e.unit]===n[t]?e.value:e.value/n[e.unit]*n[t]):w.none()},hS=function(e){return w.none()},vS=function(e,t){var n=hS,r=jo("ratio-event"),o=mS.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Sg("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Sg("unlock",t.icons)}}],buttonBehaviours:_a([lh.config({disabled:function(){return e.disabled||t.isDisabled()}}),zh(),_b.config({})])}),i=function(e){return{dom:{tag:"div",classes:["tox-form__group"]},components:e}},u=function(n){return Sb.parts.field({factory:Wb,inputClasses:["tox-textfield"],inputBehaviours:_a([lh.config({disabled:function(){return e.disabled||t.isDisabled()}}),zh(),_b.config({}),xm("size-input-events",[jr(Jn(),function(e,t){Pr(e,r,{isField1:n})}),jr(nr(),function(t,n){Pr(t,Bb,{name:e.name})})])]),selectOnFocus:!1})},a=function(e){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}},c=mS.parts.field1(i([Sb.parts.label(a("Width")),u(!0)])),s=mS.parts.field2(i([Sb.parts.label(a("Height")),u(!1)]));return mS.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(e,t,r){gS(Qs.getValue(e)).each(function(e){n(e).each(function(e){var n,r,o,i;Qs.setValue(t,(-1!==(i=(n=e).value.toFixed((r=n.unit)in(o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4})?o[r]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+n.unit))})})},coupledFieldBehaviours:_a([lh.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){mS.getField1(e).bind(Sb.getField).each(lh.disable),mS.getField2(e).bind(Sb.getField).each(lh.disable),mS.getLock(e).each(lh.disable)},onEnabled:function(e){mS.getField1(e).bind(Sb.getField).each(lh.enable),mS.getField2(e).bind(Sb.getField).each(lh.enable),mS.getLock(e).each(lh.enable)}}),zh(),xm("size-input-events2",[jr(r,function(e,t){var r=t.event.isField1,o=r?mS.getField1(e):mS.getField2(e),i=r?mS.getField2(e):mS.getField1(e),u=o.map(Qs.getValue).getOr(""),a=i.map(Qs.getValue).getOr("");n=function(e,t){var n,r,o,i=gS(e).toOptional();return r=gS(t).toOptional(),o=function(e,t){return pS(e,t.unit).map(function(e){return t.value/e}).map(function(e){return n=e,r=t.unit,function(e){return pS(e,r).map(function(e){return{value:e*n,unit:r}})};var n,r}).getOr(hS)},((n=i).isSome()&&r.isSome()?w.some(o(n.getOrDie(),r.getOrDie())):w.none()).getOr(hS)}(u,a)})])])})},bS={undo:n(jo("undo")),redo:n(jo("redo")),zoom:n(jo("zoom")),back:n(jo("back")),apply:n(jo("apply")),swap:n(jo("swap")),transform:n(jo("transform")),tempTransform:n(jo("temp-transform")),transformApply:n(jo("transform-apply"))},yS=n("save-state"),xS=n("disable"),wS=n("enable"),CS={formActionEvent:Mb,saveState:yS,disable:xS,enable:wS},SS=tinymce.util.Tools.resolve("tinymce.geom.Rect"),kS=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),OS=tinymce.util.Tools.resolve("tinymce.util.Observable"),_S=tinymce.util.Tools.resolve("tinymce.util.VK"),TS=function(e){var t,n;if(e.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]},ES=0,AS=function(e,t,n,r,o){return iS({name:e,icon:w.some(t),disabled:n,tooltip:w.some(e),primary:!1,borderless:!1},r,o)},RS=function(e,t){t?lh.enable(e):lh.disable(e)},NS=function(t,r){var o,i,u,a=function(t){var n,r,o,i,u=Yt(t),a=Yt(w.none()),c=(r=-1,{data:n=[],add:function(e){var t=n.splice(++r);return n.push(e),{state:e,removed:t}},undo:function(){if(o())return n[--r]},redo:function(){if(i())return n[++r]},canUndo:o=function(){return 0<r},canRedo:i=function(){return-1!==r&&r<n.length-1}});c.add(t);var s=function(e){u.set(e)},l=function(e){return{blob:e,url:URL.createObjectURL(e)}},f=function(e){URL.revokeObjectURL(e.url)},d=function(){a.get().each(f),a.set(w.none())},m=function(e){var t=l(e);s(t);var n=c.add(t).removed;return Fw.each(n,f),t.url};return{getBlobState:function(){return u.get()},setBlobState:s,addBlobState:m,getTempState:function(){return a.get().fold(function(){return u.get()},function(e){return e})},updateTempState:function(e){var t=l(e);return d(),a.set(w.some(t)),t.url},addTempState:function(e){var t=l(e);return a.set(w.some(t)),t.url},applyTempState:function(t){return a.get().fold(e,function(e){m(e.blob),t()})},destroyTempState:d,undo:function(){var e=c.undo();return s(e),e.url},redo:function(){var e=c.redo();return s(e),e.url},getHistoryStates:function(){return{undoEnabled:c.canUndo(),redoEnabled:c.canRedo()}}}}(t.currentState),c=function(e){var t=a.getHistoryStates();v.updateButtonUndoStates(e,t.undoEnabled,t.redoEnabled),Pr(e,CS.formActionEvent,{name:CS.saveState(),value:t.undoEnabled})},s=function(e){return e.toBlob()},l=function(e){Pr(e,CS.formActionEvent,{name:CS.disable(),value:{}})},f=function(e){b.getApplyButton(e).each(function(e){lh.enable(e)}),Pr(e,CS.formActionEvent,{name:CS.enable(),value:{}})},d=function(e,t){return l(e),h.updateSrc(e,t)},m=function(e,t,n,r,o){return l(e),function(e){return t=e,new iC(function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t)}).then(function(t){return yC(function(e){return t=e,new iC(function(e,n){var r=URL.createObjectURL(t),o=new Image,i=function(){o.removeEventListener("load",u),o.removeEventListener("error",a)},u=function(){i(),e(o)},a=function(){i(),n("Unable to load data of type "+t.type+": "+r)};o.addEventListener("load",u),o.addEventListener("error",a),o.src=r,o.complete&&setTimeout(u,0)}).then(function(e){!function(e){URL.revokeObjectURL(e.src)}(e);var t=Zw(rC(e),oC(e));return tC(t).drawImage(e,0,0),t});var t}(e),e,t)});var t}(t).then(n).then(s).then(r).then(function(t){return d(e,t).then(function(t){return c(e),o(),f(e),t})}).catch(function(t){return console.log(t),f(e),t})},g=function(e,t,n){var r=a.getBlobState().blob;m(e,r,t,function(e){return a.updateTempState(e)},n)},p=function(e){var t=a.getBlobState().url;return a.destroyTempState(),c(e),t},h=function(t){var n=wg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),r=Yt(1),o=Yt(w.none()),i=Yt({x:0,y:0,w:1,h:1}),u=Yt({x:0,y:0,w:1,h:1}),a=function(e,t){l.getOpt(e).each(function(e){var u=r.get(),a=Ji(e.element),c=Ui(e.element),s=t.dom.naturalWidth*u,l=t.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};_i(t,m),n.getOpt(e).each(function(e){_i(e.element,m)}),o.get().each(function(e){var t=i.get();e.setRect({x:t.x*u+f,y:t.y*u+d,w:t.w*u,h:t.h*u}),e.setClampRect({x:f,y:d,w:s,h:l}),e.setViewPortRect({x:0,y:0,w:a,h:c})})})},c=function(e,t){var n,o=Zt("img");return Do(o,"src",t),n=o.dom,new Pg(function(e){var t=function(){n.removeEventListener("load",t),e(n)};n.complete?e(n):n.addEventListener("load",t)}).then(function(){return l.getOpt(e).map(function(e){var t=Li({element:o});ym.replaceAt(e,1,w.some(t));var n=u.get(),c={x:0,y:0,w:o.dom.naturalWidth,h:o.dom.naturalHeight};u.set(c);var s,f=SS.inflate(c,-20,-20);return i.set(f),n.w===c.w&&n.h===c.h||(s=o,l.getOpt(e).each(function(e){var t=Ji(e.element),n=Ui(e.element),o=Math.min(t/s.dom.naturalWidth,n/s.dom.naturalHeight);r.set(1<=o?1:o)})),a(e,o),o})})},s=yb.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:_a([xm("image-panel-crop-events",[Kr(function(t){l.getOpt(t).each(function(t){var n=function(e,t,n,r,o){var i,u="tox-",a="tox-crid-"+ES++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}},f=function(t,r,o,i){var u,a=r.x,c=r.y,s=r.w,f=r.h;(s+=o*t.deltaW)<20&&(s=20),(f+=i*t.deltaH)<20&&(f=20),u=e=SS.clamp({x:a+=o*t.deltaX,y:c+=i*t.deltaY,w:s,h:f},n,"move"===t.name),u=l(n,u),p.fire("updateRect",{rect:u}),g(u)},d=function(e){var n=function(e,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),kS("#"+a+"-"+e,r).css({left:t.x,top:t.y,width:t.w,height:t.h})};Fw.each(c,function(t){kS("#"+a+"-"+t.name,r).css({left:e.w*t.xMul+e.x,top:e.h*t.yMul+e.y})}),n("top",{x:t.x,y:t.y,w:t.w,h:e.y-t.y}),n("right",{x:e.x+e.w,y:e.y,w:t.w-e.x-e.w+t.x,h:e.h}),n("bottom",{x:t.x,y:e.y+e.h,w:t.w,h:t.h-e.y-e.h+t.y}),n("left",{x:t.x,y:e.y,w:e.x-t.x,h:e.h}),n("move",e)},m=function(t){d(e=t)},g=function(e){var t,r;m({x:(r=e).x+(t=n).x,y:r.y+t.y,w:r.w,h:r.h})};kS('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),Fw.each(s,function(e){kS("#"+a,r).append('<div id="'+a+"-"+e+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')}),Fw.each(c,function(e){kS("#"+a,r).append('<div id="'+a+"-"+e.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false" title="'+e.label+'">')}),i=Fw.map(c,function(t){var n;return function(e,t){var n,r,o,i,u=t.document||document,a=u.getElementById(t.handle||e),c=function(e){if(TS(e),e.button!==r)return s(e);e.deltaX=e.screenX-o,e.deltaY=e.screenY-i,e.preventDefault(),t.drag(e)},s=function(e){TS(e),kS(u).off("mousemove touchmove",c).off("mouseup touchend",s),n.remove(),t.stop&&t.stop(e)};return kS(a).on("mousedown touchstart",function(e){var l,f,d,m,g,p,h,v,b,y,x=(l=u,g=(f=Math.max)((d=l.documentElement).scrollWidth,(m=l.body).scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v});TS(e),e.preventDefault(),r=e.button;var w=a;o=e.screenX,i=e.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,n=kS("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),kS(u).on("mousemove touchmove",c).on("mouseup touchend",s),t.start(e)}),{destroy:function(){kS(a).off()}}}(a,{document:r.ownerDocument,handle:a+"-"+t.name,start:function(){n=e},drag:function(e){f(t,n,e.deltaX,e.deltaY)}})}),d(e),kS(r).on("focusin focusout",function(e){kS(e.target).attr("aria-grabbed","focus"===e.type?"true":"false")}),kS(r).on("keydown",function(t){var n;Fw.each(c,function(e){if(t.target.id===a+"-"+e.name)return n=e,!1});var r=function(e,t,r,o,i){e.stopPropagation(),e.preventDefault(),f(n,r,o,i)};switch(t.keyCode){case _S.LEFT:r(t,0,e,-10,0);break;case _S.RIGHT:r(t,0,e,10,0);break;case _S.UP:r(t,0,e,0,-10);break;case _S.DOWN:r(t,0,e,0,10);break;case _S.ENTER:case _S.SPACEBAR:t.preventDefault(),o()}});var p=Fw.extend({toggleVisibility:function(e){var t=Fw.map(c,function(e){return"#"+a+"-"+e.name}).concat(Fw.map(s,function(e){return"#"+a+"-"+e})).join(",");e?kS(t,r).show():kS(t,r).hide()},setClampRect:function(t){n=t,d(e)},setRect:m,getInnerRect:function(){return l(n,e)},setInnerRect:g,setViewPortRect:function(n){t=n,d(e)},destroy:function(){Fw.each(i,function(e){e.destroy()}),i=[]}},OS);return p}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t.element.dom,e);n.toggleVisibility(!1),n.on("updateRect",function(e){var t=e.rect,n=r.get(),o={x:Math.round(t.x/n),y:Math.round(t.y/n),w:Math.round(t.w/n),h:Math.round(t.h/n)};i.set(o)}),o.set(w.some(n))})})])])}],containerBehaviours:_a([ym.config({}),xm("image-panel-events",[Kr(function(e){c(e,t)})])])}),l=wg(s);return{memContainer:l,updateSrc:c,zoom:function(e,t){var n=r.get(),o=0<t?Math.min(2,n+.1):Math.max(.1,n-.1);r.set(o),l.getOpt(e).each(function(e){var t=e.components()[1].element;a(e,t)})},showCrop:function(){o.get().each(function(e){e.toggleVisibility(!0)})},hideCrop:function(){o.get().each(function(e){e.toggleVisibility(!1)})},getRect:function(){return i.get()},getMeasurements:function(){var e=u.get();return{width:e.w,height:e.h}}}}(t.currentState.url),v=(i=wg(AS("Undo","undo",!0,function(e){Pr(e,bS.undo(),{direction:1})},o=r)),u=wg(AS("Redo","redo",!0,function(e){Pr(e,bS.redo(),{direction:1})},o)),{container:yb.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[i.asSpec(),u.asSpec(),AS("Zoom in","zoom-in",!1,function(e){Pr(e,bS.zoom(),{direction:1})},o),AS("Zoom out","zoom-out",!1,function(e){Pr(e,bS.zoom(),{direction:-1})},o)]}),updateButtonUndoStates:function(e,t,n){i.getOpt(e).each(function(e){RS(e,t)}),u.getOpt(e).each(function(e){RS(e,n)})}}),b=function(t,r){var o=function(e,t,n,o){return wg(aS({name:e,text:e,disabled:n,primary:o,icon:w.none(),borderless:!1},t,r))},i=function(e,t,n,o){return wg(iS({name:e,icon:w.some(e),tooltip:w.some(t),disabled:o,primary:!1,borderless:!1},n,r))},u=function(e,t){e.map(function(e){var n=e.get(t);n.hasConfigured(lh)&&lh.disable(n)})},a=function(e,t){e.map(function(e){var n=e.get(t);n.hasConfigured(lh)&&lh.enable(n)})},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=e,l=function(e,t,n){Pr(e,t,n)},f=function(e){return Dr(e,CS.disable())},d=function(e){return Dr(e,CS.enable())},m=function(e,t){f(e),l(e,bS.transform(),{transform:t}),d(e)},g=function(e){return function(){Q.getOpt(e).each(function(e){ym.set(e,[Y])})}},p=function(e,t){f(e),l(e,bS.transformApply(),{transform:t,swap:g(e)}),d(e)},h=function(){return o("Back",function(e){return l(e,bS.back(),{swap:g(e)})},!1,!1)},v=function(){return wg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:_a([lh.config({})])})},b=function(){return o("Apply",function(e){return l(e,bS.apply(),{swap:g(e)})},!0,!0)},y=[h(),v(),o("Apply",function(e){p(e,function(e){var n=t.getRect();return function(e,t,n,r,o){return u=t,a=n,c=r,s=o,(i=e).toCanvas().then(function(e){return function(e,t,n,r,o,i){var u=Zw(o,i);return tC(u).drawImage(e,-n,-r),xC(u,t)}(e,i.getType(),u,a,c,s)});var i,u,a,c,s}(e,n.x,n.y,n.w,n.h)}),t.hideCrop()},!1,!0)],x=yb.sketch({dom:c,components:y.map(function(e){return e.asSpec()}),containerBehaviours:_a([xm("image-tools-crop-buttons-events",[jr(CS.disable(),function(e,t){u(y,e)}),jr(CS.enable(),function(e,t){a(y,e)})])])}),C=wg(vS({name:"size",label:w.none(),constrain:!0,disabled:!1},r)),S=[h(),v(),C,v(),o("Apply",function(e){C.getOpt(e).each(function(t){var n,r,o=Qs.getValue(t),i=parseInt(o.width,10),u=parseInt(o.height,10),a=(n=i,r=u,function(e){return function(e,t,n){return o=t,i=n,(r=e).toCanvas().then(function(e){return BC(e,o,i).then(function(e){return xC(e,r.getType())})});var r,o,i}(e,n,r)});p(e,a)})},!1,!0)],k=yb.sketch({dom:c,components:S.map(function(e){return e.asSpec()}),containerBehaviours:_a([xm("image-tools-resize-buttons-events",[jr(CS.disable(),function(e,t){u(S,e)}),jr(CS.enable(),function(e,t){a(S,e)})])])}),O=function(e,t){return function(n){return e(n,t)}},_=O(zC,"h"),T=O(zC,"v"),E=O(HC,-90),A=O(HC,90),R=function(e,t){var n,r;r=t,f(n=e),l(n,bS.tempTransform(),{transform:r}),d(n)},N=[h(),v(),i("flip-horizontally","Flip horizontally",function(e){R(e,_)},!1),i("flip-vertically","Flip vertically",function(e){R(e,T)},!1),i("rotate-left","Rotate counterclockwise",function(e){R(e,E)},!1),i("rotate-right","Rotate clockwise",function(e){R(e,A)},!1),v(),b()],B=yb.sketch({dom:c,components:N.map(function(e){return e.asSpec()}),containerBehaviours:_a([xm("image-tools-fliprotate-buttons-events",[jr(CS.disable(),function(e,t){u(N,e)}),jr(CS.enable(),function(e,t){a(N,e)})])])}),D=function(e,t,o,i,u){var a=Sw.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:r.translate(e)}}),c=Sw.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=Sw.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return wg(Sw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:u,getInitialValue:n({x:i})},components:[a,c,s],sliderBehaviours:_a([Om.config({})]),onChoose:t}))},P=function(e,t,n,r,o){var i=function(e,t,n,r,o){return[h(),(i=t,D(e,function(e,t,n){var r=O(i,n.x/100);m(e,r)},n,r,o)),b()];var i}(e,t,n,r,o);return yb.sketch({dom:c,components:i.map(function(e){return e.asSpec()}),containerBehaviours:_a([xm("image-tools-filter-panel-buttons-events",[jr(CS.disable(),function(e,t){u(i,e)}),jr(CS.enable(),function(e,t){a(i,e)})])])})},M=[h(),v(),b()],I=yb.sketch({dom:c,components:M.map(function(e){return e.asSpec()})}),L=P("Brightness",LC,-100,0,100),F=P("Contrast",FC,-100,0,100),z=P("Gamma",IC,-100,0,100),H=function(e){return D(e,function(e,t,n){var r=V.getOpt(e),o=U.getOpt(e),i=j.getOpt(e);r.each(function(t){o.each(function(n){i.each(function(r){var o,i,u,a=Qs.getValue(t).x/100,c=Qs.getValue(r).x/100,s=Qs.getValue(n).x/100,l=(o=a,i=c,u=s,function(e){return function(e,t,n,r){return kC(e,(o=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],u=n,a=r,i=wC(i=t,0,2),u=wC(u,0,2),a=wC(a,0,2),SC(o,[i,0,0,0,0,0,u,0,0,0,0,0,a,0,0,0,0,0,1,0,0,0,0,0,1])));var o,i,u,a}(e,o,i,u)});m(e,l)})})})},0,100,200)},V=H("R"),j=H("G"),U=H("B"),W=[h(),V,j,U,b()],q=yb.sketch({dom:c,components:W.map(function(e){return e.asSpec()})}),G=function(e,t,n){return function(r){l(r,bS.swap(),{transform:t,swap:function(){Q.getOpt(r).each(function(t){ym.set(t,[e]),n(t)})}})}},$=w.some(MC),X=w.some(PC),K=[i("crop","Crop",G(x,w.none(),function(e){t.showCrop()}),!1),i("resize","Resize",G(k,w.none(),function(e){C.getOpt(e).each(function(e){var n=t.getMeasurements();Qs.setValue(e,{width:n.width,height:n.height})})}),!1),i("orientation","Orientation",G(B,w.none(),s),!1),i("brightness","Brightness",G(L,w.none(),s),!1),i("sharpen","Sharpen",G(I,$,s),!1),i("contrast","Contrast",G(F,w.none(),s),!1),i("color-levels","Color levels",G(q,w.none(),s),!1),i("gamma","Gamma",G(z,w.none(),s),!1),i("invert","Invert",G(I,X,s),!1)],Y=yb.sketch({dom:c,components:K.map(function(e){return e.asSpec()})}),J=yb.sketch({dom:{tag:"div"},components:[Y],containerBehaviours:_a([ym.config({})])}),Q=wg(J);return{memContainer:Q,getApplyButton:function(e){return Q.getOpt(e).map(function(e){var t=e.components()[0];return t.components()[t.components().length-1]})}}}(h,r);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[b.memContainer.asSpec(),h.memContainer.asSpec(),v.container],behaviours:_a([Qs.config({store:{mode:"manual",getValue:function(){return a.getBlobState()}}}),xm("image-tools-events",[jr(bS.undo(),function(e,t){var n=a.undo();d(e,n).then(function(t){f(e),c(e)})}),jr(bS.redo(),function(e,t){var n=a.redo();d(e,n).then(function(t){f(e),c(e)})}),jr(bS.zoom(),function(e,t){h.zoom(e,t.event.direction)}),jr(bS.back(),function(e,t){var n,r;r=p(n=e),d(n,r).then(function(e){f(n)}),(0,t.event.swap)(),h.hideCrop()}),jr(bS.apply(),function(e,t){a.applyTempState(function(){p(e),(0,t.event.swap)()})}),jr(bS.transform(),function(t,n){return g(t,n.event.transform,e)}),jr(bS.tempTransform(),function(t,n){return r=t,o=n.event.transform,i=a.getTempState().blob,void m(r,i,o,function(e){return a.addTempState(e)},e);var r,o,i}),jr(bS.transformApply(),function(e,t){return n=e,r=t.event.transform,o=t.event.swap,i=a.getBlobState().blob,void m(n,i,r,function(e){var t=a.addBlobState(e);return p(n),t},o);var n,r,o,i}),jr(bS.swap(),function(e,t){v.updateButtonUndoStates(e,!1,!1);var n=t.event.swap;t.event.transform.fold(function(){n()},function(t){g(e,t,n)})})]),Bw()])}},BS=function(e){return!Te(e,"items")},DS="data-value",PS=function(e,t,n,r){return H(n,function(n){return BS(n)?{type:"togglemenuitem",text:n.text,value:n.value,active:n.value===r,onAction:function(){Qs.setValue(e,n.value),Pr(e,Bb,{name:t}),Om.focus(e)}}:{type:"nestedmenuitem",text:n.text,getSubmenuItems:function(){return PS(e,t,n.items,r)}}})},MS=function(e,t){return oe(e,function(e){return BS(e)?rf(e.value===t,e):MS(e.items,t)})},IS=ef({name:"HtmlSelect",configFields:[_t("options"),Zs("selectBehaviours",[Om,Qs]),Ht("selectClasses",[]),Ht("selectAttributes",{}),Pt("data")],factory:function(e,t){var n=H(e.options,function(e){return{dom:{tag:"option",value:e.value,innerHtml:e.text}}}),r=e.data.map(function(e){return je("initialValue",e)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:tl(e.selectBehaviours,[Om.config({}),Qs.config({store:l({mode:"manual",getValue:function(e){return Pi(e.element)},setValue:function(t,n){G(e.options,function(e){return e.value===n}).isSome()&&Mi(t.element,n)}},r)})])}}}),LS=function(e,t){var r=e.label.map(function(e){return Nb(e,t)}),o=[lh.config({disabled:function(){return e.disabled||t.isDisabled()}}),zh(),gm.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(e){return Dr(e,Ib),w.some(!0)}}),xm("textfield-change",[jr(tr(),function(t,n){Pr(t,Bb,{name:e.name})}),jr(lr(),function(t,n){Pr(t,Bb,{name:e.name})})]),_b.config({})],i=e.validation.map(function(e){return fy.config({getRoot:function(e){return so(e.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=Qs.getValue(t),r=e.validator(n);return ty(!0===r?ae.value(n):ae.error(r))},validateOnLoad:e.validateOnLoad}})}).toArray(),u=e.placeholder.fold(n({}),function(e){return{placeholder:t.translate(e)}}),a=e.inputMode.fold(n({}),function(e){return{inputmode:e}}),c=l(l({},u),a),s=Sb.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:c,inputClasses:[e.classname],inputBehaviours:_a(X([o,i])),selectOnFocus:!1,factory:Wb}),f=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),d=[lh.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){Sb.getField(e).each(lh.disable)},onEnabled:function(e){Sb.getField(e).each(lh.enable)}}),zh()];return Eb(r,s,f,d)},FS=Object.freeze({__proto__:null,events:function(e,t){var n=e.stream.streams.setup(e,t);return zr([jr(e.event,n),Yr(function(){return t.cancel()})].concat(e.cancelEvent.map(function(e){return[jr(e,function(){return t.cancel()})]}).getOr([])))}}),zS=function(e){var t=Yt(null);return ii({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(e){t.set(e)},cancel:function(){var e=t.get();null!==e&&e.cancel()}})},HS=Object.freeze({__proto__:null,throttle:zS,init:function(e){return e.stream.streams.state(e)}}),VS=[Tt("stream",ht("mode",{throttle:[_t("delay"),Ht("stopEvent",!0),Vu("streams",{setup:function(e,t){var n=e.stream,r=_g(e.onStream,n.delay);return t.setTimer(r),function(e,t){r.throttle(e,t),n.stopEvent&&t.stop()}},state:zS})]})),Ht("event","input"),Pt("cancelEvent"),zu("onStream")],jS=Ea({fields:VS,name:"streaming",active:FS,state:HS}),US=function(e,t,n){var r=Qs.getValue(n);Qs.setValue(t,r),qS(t)},WS=function(e,t){var n=e.element,r=Pi(n),o=n.dom;"number"!==Po(n,"type")&&t(o,r)},qS=function(e){WS(e,function(e,t){return e.setSelectionRange(t.length,t.length)})},GS=n("alloy.typeahead.itemexecute"),$S=n([Pt("lazySink"),_t("fetch"),Ht("minChars",5),Ht("responseTime",1e3),Lu("onOpen"),Ht("getHotspot",w.some),Ht("getAnchorOverrides",n({})),Ht("layouts",w.none()),Ht("eventOrder",{}),Xt("model",{},[Ht("getDisplayText",function(e){return void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value}),Ht("selectsOver",!0),Ht("populateFromBrowse",!0)]),Lu("onSetValue"),Fu("onExecute"),Lu("onItemExecute"),Ht("inputClasses",[]),Ht("inputAttributes",{}),Ht("inputStyles",{}),Ht("matchWidth",!0),Ht("useMinWidth",!1),Ht("dismissOnBlur",!0),Mu(["openClass"]),Pt("initialData"),Zs("typeaheadBehaviours",[Om,Qs,jS,gm,Lm,gy]),Kt("previewing",function(){return Yt(!0)})].concat(Vb()).concat(Ny())),XS=n([Tl({schema:[Pu()],name:"menu",overrides:function(e){return{fakeFocus:!0,onHighlight:function(t,n){e.previewing.get()?t.getSystem().getByUid(e.uid).each(function(r){(function(e,t,n){if(e.selectsOver){var r=Qs.getValue(t),o=e.getDisplayText(r),i=Qs.getValue(n);return 0===e.getDisplayText(i).indexOf(o)?w.some(function(){var e;US(0,t,n),e=o.length,WS(t,function(t,n){return t.setSelectionRange(e,n.length)})}):w.none()}return w.none()})(e.model,r,n).fold(function(){return bf.dehighlight(t,n)},function(e){return e()})}):t.getSystem().getByUid(e.uid).each(function(t){e.model.populateFromBrowse&&US(0,t,n)}),e.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(e.uid).toOptional().map(function(e){return Pr(e,GS(),{item:n}),!0})},onHover:function(t,n){e.previewing.set(!1),t.getSystem().getByUid(e.uid).each(function(t){e.model.populateFromBrowse&&US(0,t,n)})}}}})]),KS=tf({name:"Typeahead",configFields:$S(),partFields:XS(),factory:function(t,n,r,o){var i=function(n,r,i){t.previewing.set(!1);var u=gy.getCoupled(n,"sandbox");Bs.isOpen(u)?cf.getCurrent(u).each(function(e){bf.getHighlighted(e).fold(function(){i(e)},function(){Fr(u,e.element,"keydown",r)})}):ky(t,a(n),n,u,o,function(e){cf.getCurrent(e).each(i)},$b.HighlightFirst).get(e)},u=jb(t),a=function(e){return function(t){return t.map(function(t){var n=Oe(t.menus),r=K(n,function(e){return U(e.items,function(e){return"item"===e.type})});return Qs.getState(e).update(H(r,function(e){return e.data})),t})}},c=[Om.config({}),Qs.config({onSetValue:t.onSetValue,store:l({mode:"dataset",getDataKey:function(e){return Pi(e.element)},getFallbackEntry:function(e){return{value:e,meta:{}}},setValue:function(e,n){Mi(e.element,t.model.getDisplayText(n))}},t.initialData.map(function(e){return je("initialValue",e)}).getOr({}))}),jS.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,r){var i,u=gy.getCoupled(n,"sandbox");Om.isFocused(n)&&Pi(n.element).length>=t.minChars&&(i=cf.getCurrent(u).bind(function(e){return bf.getHighlighted(e).map(Qs.getValue)}),t.previewing.set(!0),ky(t,a(n),n,u,o,function(e){cf.getCurrent(u).each(function(e){i.fold(function(){t.model.selectsOver&&bf.highlightFirst(e)},function(t){bf.highlightBy(e,function(e){return Qs.getValue(e).value===t.value}),bf.getHighlighted(e).orThunk(function(){return bf.highlightFirst(e),w.none()})})})},$b.HighlightFirst).get(e))},cancelEvent:vr()}),gm.config({mode:"special",onDown:function(e,t){return i(e,t,bf.highlightFirst),w.some(!0)},onEscape:function(e){var t=gy.getCoupled(e,"sandbox");return Bs.isOpen(t)?(Bs.close(t),w.some(!0)):w.none()},onUp:function(e,t){return i(e,t,bf.highlightLast),w.some(!0)},onEnter:function(e){var n=gy.getCoupled(e,"sandbox"),r=Bs.isOpen(n);if(r&&!t.previewing.get())return cf.getCurrent(n).bind(function(e){return bf.getHighlighted(e)}).map(function(t){return Pr(e,GS(),{item:t}),!0});var o=Qs.getValue(e);return Dr(e,vr()),t.onExecute(n,e,o),r&&Bs.close(n),w.some(!0)}}),Lm.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),gy.config({others:{sandbox:function(e){return Ay(t,e,{onOpen:function(){return Lm.on(e)},onClose:function(){return Lm.off(e)}})}}}),xm("typeaheadevents",[Qr(function(n){var r=e;_y(t,a(n),n,o,r,$b.HighlightFirst).get(e)}),jr(GS(),function(e,n){var r=gy.getCoupled(e,"sandbox");US(0,e,n.event.item),Dr(e,vr()),t.onItemExecute(e,r,n.event.item,Qs.getValue(e)),Bs.close(r),qS(e)})].concat(t.dismissOnBlur?[jr(sr(),function(e){var t=gy.getCoupled(e,"sandbox");Ia(t.element).isNone()&&Bs.close(t)})]:[]))];return{uid:t.uid,dom:Ub(Be(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:l(l({},u),tl(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}}}),YS=function(e){return l(l({},e),{toCached:function(){return YS(e.toCached())},bindFuture:function(t){return YS(e.bind(function(e){return e.fold(function(e){return ty(ae.error(e))},function(e){return t(e)})}))},bindResult:function(t){return YS(e.map(function(e){return e.bind(t)}))},mapResult:function(t){return YS(e.map(function(e){return e.map(t)}))},mapError:function(t){return YS(e.map(function(e){return e.mapError(t)}))},foldResult:function(t,n){return e.map(function(e){return e.fold(t,n)})},withTimeout:function(t,n){return YS(ey(function(r){var o=!1,i=setTimeout(function(){o=!0,r(ae.error(n()))},t);e.get(function(e){o||(clearTimeout(i),r(e))})}))}})},JS={type:"separator"},QS=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:e}},ZS=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:e}},ek=function(e,t){return r=e,n=U(t,function(e){return e.type===r}),H(n,QS);var n,r},tk=function(e,t){var n=e.toLowerCase();return U(t,function(e){return cn((void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text).toLowerCase(),n)||cn(e.value.toLowerCase(),n)})},nk=jo("aria-invalid"),rk=function(t,n,r){var o,i,u,a,c,s=n.shared.providers,f=function(e){var n=Qs.getValue(e);r.addToHistory(n.value,t.filetype)},d=Sb.parts.field({factory:KS,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":nk,type:"url"},minChars:0,responseTime:0,fetch:function(e){var o=function(e,t,n){var r=Qs.getValue(t),o=void 0!==r.meta.text?r.meta.text:r.value;return n.getLinkInformation().fold(function(){return[]},function(t){var r,i,u,a,c=tk(o,(r=n.getHistory(e),H(r,function(e){return ZS(e,e)})));return"file"===e?(i=[c,tk(o,ek("header",t.targets)),tk(o,X([(a=t,w.from(a.anchorTop).map(function(e){return ZS("<top>",e)}).toArray()),ek("anchor",t.targets),(u=t,w.from(u.anchorBottom).map(function(e){return ZS("<bottom>",e)}).toArray())]))],q(i,function(e,t){return 0===e.length||0===t.length?e.concat(t):e.concat(JS,t)},[])):c})}(t.filetype,e,r),i=ZC(o,op.BUBBLE_TO_SANDBOX,n,!1);return ty(i)},getHotspot:function(e){return b.getOpt(e)},onSetValue:function(t,n){t.hasConfigured(fy)&&fy.run(t).get(e)},typeaheadBehaviours:_a(X([r.getValidationHandler().map(function(e){return fy.config({getRoot:function(e){return so(e.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(e,t){g.getOpt(e).each(function(e){Do(e.element,"title",s.translate(t))})}},validator:{validate:function(n){var r=Qs.getValue(n);return YS(ey(function(n){e({type:t.filetype,url:r.value},function(e){var t,r;"invalid"===e.status?(t=ae.error(e.message),n(t)):(r=ae.value(e.message),n(r))})}))},validateOnLoad:!1}})}).toArray(),[lh.config({disabled:function(){return t.disabled||s.isDisabled()}}),_b.config({}),xm("urlinput-events",X(["file"===t.filetype?[jr(tr(),function(e){Pr(e,Bb,{name:t.name})})]:[],[jr(nr(),function(e){Pr(e,Bb,{name:t.name}),f(e)}),jr(lr(),function(e){Pr(e,Bb,{name:t.name}),f(e)})]]))]])),eventOrder:((o={})[tr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(e){return e.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:bp(0,0,"normal")},onExecute:function(e,t,n){Pr(t,Ib,{})},onItemExecute:function(e,n,r,o){f(e),Pr(e,Bb,{name:t.name})}}),m=t.label.map(function(e){return Nb(e,s)}),g=wg((i="invalid",u=w.some(nk),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:Sg(a,s.icons),attributes:l({title:s.translate(c),"aria-live":"polite"},u.fold(function(){return{}},function(e){return{id:e}}))}})),p=wg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=r.getUrlPicker(t.filetype),v=jo("browser.url.event"),b=wg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,p.asSpec()],behaviours:_a([lh.config({disabled:function(){return t.disabled||s.isDisabled()}})])}),y=wg(aS({name:t.name,icon:w.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},function(e){return Dr(e,v)},s,[],["tox-browse-url"]));return Sb.sketch({dom:Rb([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:X([[b.asSpec()],h.map(function(){return y.asSpec()}).toArray()])}]),fieldBehaviours:_a([lh.config({disabled:function(){return t.disabled||s.isDisabled()},onDisabled:function(e){Sb.getField(e).each(lh.disable),y.getOpt(e).each(lh.disable)},onEnabled:function(e){Sb.getField(e).each(lh.enable),y.getOpt(e).each(lh.enable)}}),zh(),xm("url-input-events",[jr(v,function(e){cf.getCurrent(e).each(function(n){var r=Qs.getValue(n),o=l({fieldname:t.name},r);h.each(function(r){r(o).get(function(r){Qs.setValue(n,r),Pr(e,Bb,{name:t.name})})})})})])])})},ok=function(e){return function(t,n,r){return _e(n,"name").fold(function(){return e(n,r)},function(o){return t.field(o,e(n,r))})}},ik={bar:ok(function(e,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:H(e.items,t.shared.interpreter)}}),collection:ok(function(e,t){return function(e,t){var n,o,i=e.label.map(function(e){return Nb(e,t)}),u=function(e){return function(t,n){wu(n.event.target,"[data-collection-item-value]").each(function(r){e(t,n,r,Po(r,"data-collection-item-value"))})}},a=u(function(n,r,o,i){r.stop(),t.isDisabled()||Pr(n,Mb,{name:e.name,value:i})}),c=[jr(Yn(),u(function(e,t,n){Pa(n)})),jr(rr(),a),jr(gr(),a),jr(Jn(),u(function(e,t,n){xu(e.element,"."+fp).each(function(e){pi(e,fp)}),gi(n,fp)})),jr(Qn(),u(function(e){xu(e.element,"."+fp).each(function(e){pi(e,fp)})})),Qr(u(function(t,n,r,o){Pr(t,Mb,{name:e.name,value:o})}))],s=function(e,t){return H(Fc(e.element,".tox-collection__item"),t)},l=Sb.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:r},behaviours:_a([lh.config({disabled:t.isDisabled,onDisabled:function(e){s(e,function(e){gi(e,"tox-collection__item--state-disabled"),Do(e,"aria-disabled",!0)})},onEnabled:function(e){s(e,function(e){pi(e,"tox-collection__item--state-disabled"),Lo(e,"aria-disabled")})}}),zh(),ym.config({}),Qs.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,r){var o,i,u,a;o=n,i=H(r,function(n){var r=Yp.translate(n.text),o=1===e.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",i='<div class="tox-collection__item-icon">'+n.icon+"</div>",u={_:" "," - ":" ","-":" "},a=r.replace(/\_| \- |\-/g,function(e){return u[e]});return'<div class="tox-collection__item'+(t.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Tb.encodeAllRaw(n.value)+'" title="'+a+'" aria-label="'+a+'">'+i+o+"</div>"}),u="auto"!==e.columns&&1<e.columns?z(i,e.columns):[i],a=H(u,function(e){return'<div class="tox-collection__group">'+e.join("")+"</div>"}),No(o.element,a.join("")),"auto"===e.columns&&zp(n,5,"tox-collection__item").each(function(e){gm.setGridSize(n,e.numRows,e.numColumns)}),Dr(n,Hb)}}),_b.config({}),gm.config((o=e.columns,1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+up}})),xm("collection-events",c)]),eventOrder:((n={})[dr()]=["disabling","alloy.base.behaviour","collection-events"],n)});return Eb(i,l,["tox-form__group--collection"],[])}(e,t.shared.providers)}),alertbanner:ok(function(e,t){return yb.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+(n=e).level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Sg(n.icon,(r=t.shared.providers).icons),attributes:{title:r.translate(n.iconTooltip)}},action:function(e){Pr(e,Mb,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:r.translate(n.text)}}]});var n,r}),input:ok(function(e,t){return r=t.shared.providers,LS({name:(n=e).name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:w.none(),maximized:n.maximized},r);var n,r}),textarea:ok(function(e,t){return r=t.shared.providers,LS({name:(n=e).name,multiline:!0,label:n.label,inputMode:w.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:w.none(),maximized:n.maximized},r);var n,r}),label:ok(function(e,t){return o={dom:{tag:"label",innerHtml:(r=t.shared).providers.translate((n=e).label),classes:["tox-label"]}},i=H(n.items,r.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[o].concat(i),behaviours:_a([Bw(),ym.config({}),Uw(w.none()),gm.config({mode:"acyclic"})])};var n,r,o,i}),iframe:(pC=function(e,t){return function(e,t){var n,r,o=Qw&&e.sandboxed,i=l(l({},e.label.map(function(e){return{title:e}}).getOr({})),o?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(n=o,r=Yt(""),{getValue:function(e){return r.get()},setValue:function(e,t){var o;n?Do(e.element,"srcdoc",t):(Do(e.element,"src","javascript:''"),(o=e.element.dom.contentWindow.document).open(),o.write(t),o.close()),r.set(t)}}),a=e.label.map(function(e){return Nb(e,t)}),c=Sb.parts.field({factory:{sketch:function(e){return Xw({uid:e.uid,dom:{tag:"iframe",attributes:i},behaviours:_a([_b.config({}),Om.config({}),jw(w.none(),u.getValue,u.setValue)])})}}});return Eb(a,c,["tox-form__group--stretched"],[])}(e,t.shared.providers)},function(e,t,n){var r=Be(t,{source:"dynamic"});return ok(pC)(e,r,n)}),button:ok(function(e,t){return function(e,t){var n,r,o=cS(e.name,"custom");return n=w.none(),r=Sb.parts.field(l({factory:xg},uS(e,w.some(o),t,[Ww(""),Bw()]))),Eb(n,r,[],[])}(e,t.shared.providers)}),checkbox:ok(function(e,t){return n=e,o=t.shared.providers,i=Qs.config({store:{mode:"manual",getValue:function(e){return e.element.dom.checked},setValue:function(e,t){e.element.dom.checked=t}}}),u=function(e){return e.element.dom.click(),w.some(!0)},a=Sb.parts.field({factory:{sketch:r},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:_a([Bw(),lh.config({disabled:function(){return n.disabled||o.isDisabled()}}),_b.config({}),Om.config({}),i,gm.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),xm("checkbox-events",[jr(nr(),function(e,t){Pr(e,Bb,{name:n.name})})])])}),c=Sb.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(n.label)},behaviours:_a([My.config({})])}),l=wg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(e){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e],innerHtml:Sg("checked"===e?"selected":"unselected",o.icons)}}})("checked"),s("unchecked")]}),Sb.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:_a([lh.config({disabled:function(){return n.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(e){Sb.getField(e).each(lh.disable)},onEnabled:function(e){Sb.getField(e).each(lh.enable)}}),zh()])});var n,o,i,u,a,c,s,l}),colorinput:ok(function(t,n){return function(t,n,r){var o,i,u=Sb.parts.field({factory:Wb,inputClasses:["tox-textfield"],onSetValue:function(t){return fy.run(t).get(e)},inputBehaviours:_a([lh.config({disabled:n.providers.isDisabled}),zh(),_b.config({}),fy.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(e){return so(e.element)},notify:{onValid:function(e){var t=Qs.getValue(e);Pr(e,Iy,{color:t})}},validator:{validateOnLoad:!1,validate:function(e){var t=Qs.getValue(e);if(0===t.length)return ty(ae.value(!0));var n=Zt("span");Oi(n,"background-color",t);var r=Ri(n,"background-color").fold(function(){return ae.error("blah")},function(e){return ae.value(t)});return ty(r)}}})]),selectOnFocus:!1}),c=t.label.map(function(e){return Nb(e,n.providers)}),s=function(e,t){Pr(e,Ly,{value:t})},l=wg((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[ca,aa,da]},onLtr:function(){return[aa,ca,da]}},components:[],fetch:jv(r.getColors(),r.hasCustomColors()),columns:r.getColorCols(),presets:"color",onItemAction:function(e,t){l.getOpt(e).each(function(e){"custom"===t?r.colorPicker(function(t){t.fold(function(){return Dr(e,Fy)},function(t){s(e,t),Fv(t)})},"#ffffff"):s(e,"remove"===t?"":t)})}},Py.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:_a([Vh((i=n).providers.isDisabled),zh(),My.config({}),_b.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(e){return ey(function(e){return o.fetch(e)}).map(function(t){return w.from(rb(Be($v(jo("menu-value"),t,function(t){o.onItemAction(e,t)},o.columns,o.presets,op.CLOSE_ON_EXECUTE,a,i.providers),{movement:Kv(o.columns,o.presets)})))})},parts:{menu:bp(0,0,o.presets)}})));return Sb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:c.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[u,l.asSpec()]}]),fieldBehaviours:_a([xm("form-field-events",[jr(Iy,function(e,n){l.getOpt(e).each(function(e){Oi(e.element,"background-color",n.event.color)}),Pr(e,Bb,{name:t.name})}),jr(Ly,function(e,t){Sb.getField(e).each(function(n){Qs.setValue(n,t.event.value),cf.getCurrent(e).each(Om.focus)})}),jr(Fy,function(e,t){Sb.getField(e).each(function(t){cf.getCurrent(e).each(Om.focus)})})])])})}(t,n.shared,n.colorinput)}),colorpicker:ok(function(t){var r=function(t,r){return ef({name:"ColourPicker",configFields:[_t("dom"),Ht("onValidHex",e),Ht("onInvalidHex",e)],factory:function(o){var i,u,a,c,s,f=function(t,n,r,o){var i=function(r,o,i,u,a){var c,s,f=t(Nw+"range"),d=[Sb.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Sb.parts.field({data:a,factory:Wb,inputAttributes:l({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:_a([(c=o,s=r,fy.config({invalidClass:n("invalid"),notify:{onValidate:function(e){Pr(e,Rw,{type:c})},onValid:function(e){Pr(e,Ew,{type:c,value:Qs.getValue(e)})},onInvalid:function(e){Pr(e,Aw,{type:c,value:Qs.getValue(e)})}},validator:{validate:function(e){var n=Qs.getValue(e),r=s(n)?ae.value(!0):ae.error(t("aria.input.invalid"));return ty(r)},validateOnLoad:!1}})),_b.config({})]),onSetValue:function(t){fy.isInvalid(t)&&fy.run(t).get(e)}})],m="hex"!==o?[Sb.parts["aria-descriptor"]({text:f})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},u=function(e,t){Qs.setValue(e,{red:t.red,green:t.green,blue:t.blue})},a=wg({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(e,t){a.getOpt(e).each(function(e){Oi(e.element,"background-color","#"+t.value)})};return ef({factory:function(){var e={red:Yt(w.some(255)),green:Yt(w.some(255)),blue:Yt(w.some(255)),hex:Yt(w.some("ffffff"))},s=function(t){return e[t].get()},l=function(t,n){e[t].set(n)},f=function(e){var t=e.green,n=e.blue;l("red",w.some(e.red)),l("green",w.some(t)),l("blue",w.some(n))},d=function(e,t){var n=t.event;"hex"!==n.type?l(n.type,w.none()):o(e)},m=function(e,t){var n=t.event;"hex"===n.type?function(e,t){r(e);var n=dv(t);l("hex",w.some(t));var o=_v(n);u(e,o),f(o),Pr(e,Hy,{hex:n}),c(e,n)}(e,n.value):function(e,t,n){var r=parseInt(n,10);l(t,w.some(r)),s("red").bind(function(e){return s("green").bind(function(t){return s("blue").map(function(n){return Sv(e,t,n,1)})})}).each(function(t){var n,r,o=(n=e,r=vv(t),Tw.getField(n,"hex").each(function(e){Om.isFocused(e)||Qs.setValue(n,{hex:r.value})}),r);c(e,o)})}(e,n.type,n.value)},g=function(e){return{label:t(Nw+e+".label"),description:t(Nw+e+".description")}},p=g("red"),h=g("green"),v=g("blue"),b=g("hex");return Be(Tw.sketch(function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",Sb.sketch(i(kv,"red",p.label,p.description,255))),e.field("green",Sb.sketch(i(kv,"green",h.label,h.description,255))),e.field("blue",Sb.sketch(i(kv,"blue",v.label,v.description,255))),e.field("hex",Sb.sketch(i(pv,"hex",b.label,b.description,"ffffff"))),a.asSpec()],formBehaviours:_a([fy.config({invalidClass:n("form-invalid")}),xm("rgb-form-events",[jr(Ew,m),jr(Aw,d),jr(Rw,d)])])}}),{apis:{updateHex:function(e,t){var n,r;Qs.setValue(e,{hex:t.value}),n=e,r=_v(t),u(n,r),f(r),c(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(e,t,n){e.updateHex(t,n)}},extraApis:{}})}(t,r,o.onValidHex,o.onInvalidHex),d=function(e,t){var r=Sw.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),o=Sw.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(e,t){var n,r,o=e.width,i=e.height,u=e.getContext("2d");null!==u&&(u.fillStyle=t,u.fillRect(0,0,o,i),(n=u.createLinearGradient(0,0,o,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=n,u.fillRect(0,0,o,i),(r=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),r.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=r,u.fillRect(0,0,o,i))};return ef({factory:function(e){var u=n({x:0,y:0}),a=_a([cf.config({find:w.some}),Om.config({})]);return Sw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[r,o],onChange:function(e,t,n){Pr(e,jy,{value:n})},onInit:function(e,t,n,r){i(n.element.dom,Ev(Av))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(e,t,n){var r,o;r=n,o=t.components()[0].element.dom,i(o,Ev(r))}},extraApis:{}})}(0,r),m={paletteRgba:Yt(Av)},g=wg(d.sketch({})),p=wg(f.sketch({})),h=function(e,t){p.getOpt(e).each(function(e){f.updateHex(e,t)})},v=function(e,t,n){V(n,function(n){n(e,t)})};return{uid:o.uid,dom:o.dom,components:[g.asSpec(),(a=r,c=Sw.parts.spectrum({dom:{tag:"div",classes:[a("hue-slider-spectrum")],attributes:{role:"presentation"}}}),s=Sw.parts.thumb({dom:{tag:"div",classes:[a("hue-slider-thumb")],attributes:{role:"presentation"}}}),Sw.sketch({dom:{tag:"div",classes:[a("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:n({y:0})},components:[c,s],sliderBehaviours:_a([Om.config({})]),onChange:function(e,t,n){Pr(e,Vy,{value:n})}})),p.asSpec()],behaviours:_a([xm("colour-picker-events",[jr(jy,(u=[h],function(e,t){var n,r,o,i,a,c,s,l,f,d=t.event.value,g=(i=o=0,a=(n=m.paletteRgba.get()).red/255,c=n.green/255,s=n.blue/255,(l=Math.min(a,Math.min(c,s)))===(f=Math.max(a,Math.max(c,s)))?zy(0,0,100*(i=l)):(o=60*((o=a===l?3:s===l?1:5)-(a===l?c-s:s===l?a-c:s-a)/(f-l)),r=(f-l)/f,i=f,zy(Math.round(o),Math.round(100*r),Math.round(100*i)))),p=zy(g.hue,d.x,100-d.y),h=Ov(p),b=vv(h);v(e,b,u)})),jr(Vy,(i=[function(e,t){g.getOpt(e).each(function(e){var n=_v(t);m.paletteRgba.set(n),d.setRgba(e,n)})},h],function(e,t){var n,r,o=(n=zy((100-t.event.value.y)/100*360,100,100),r=Ov(n),vv(r));v(e,o,i)}))]),cf.config({find:function(e){return p.getOpt(e)}}),gm.config({mode:"acyclic"})])}}})}(Iw,function(e){return"tox-"+e}),o=wg(r.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(e){Pr(e,Mb,{name:"hex-valid",value:!0})},onInvalidHex:function(e){Pr(e,Mb,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:_a([Qs.config({store:{mode:"manual",getValue:function(e){var t=o.get(e);return cf.getCurrent(t).bind(function(e){return Qs.getValue(e).hex}).map(function(e){return"#"+e}).getOr("")},setValue:function(e,t){var n=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),r=o.get(e);cf.getCurrent(r).fold(function(){console.log("Can not find form")},function(e){Qs.setValue(e,{hex:w.from(n[1]).getOr("")}),Tw.getField(e,"hex").each(function(e){Dr(e,tr())})})}}}),Bw()])}}),dropzone:ok(function(e,t){return function(e,t){var n=function(e,t){t.stop()},r=function(e){return function(t,n){V(e,function(e){e(t,n)})}},o=function(e,t){lh.isDisabled(e)||u(e,t.event.raw.dataTransfer.files)},i=function(e,t){u(e,t.event.raw.target.files)},u=function(n,r){var o,i;Qs.setValue(n,(o=r,i=Fw.explode(t.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),U(re(o),function(e){return L(i,function(t){return sn(e.name.toLowerCase(),"."+t.toLowerCase())})}))),Pr(n,Bb,{name:e.name})},a=wg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:_a([xm("input-file-events",[$r(rr()),$r(gr())])])}),c=e.label.map(function(e){return Nb(e,t)}),s=Sb.parts.field({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:_a([Ww([]),Bw(),lh.config({}),Lm.config({toggleClass:"dragenter",toggleOnExecute:!1}),xm("dropzone-events",[jr("dragenter",r([n,Lm.toggle])),jr("dragleave",r([n,Lm.toggle])),jr("dragover",n),jr("drop",r([n,o])),jr(nr(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},xg.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(e){a.get(e).element.dom.click()},buttonBehaviours:_a([_b.config({}),Vh(t.isDisabled),zh()])})]}]}}}});return Eb(c,s,["tox-form__group--stretched"],[])}(e,t.shared.providers)}),grid:ok(function(e,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+(n=e).columns+"col"]},components:H(n.items,t.shared.interpreter)};var n}),listbox:ok(function(t,r){return u=(i=r).shared.providers,a=te((o=t).items).filter(BS),c=o.label.map(function(e){return Nb(e,u)}),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Sb.parts.field({dom:{},factory:{sketch:function(t){return KC({uid:t.uid,text:a.map(function(e){return e.text}),icon:w.none(),tooltip:o.label,role:w.none(),fetch:function(e,t){var n=PS(e,o.name,o.items,Qs.getValue(e));t(ZC(n,op.CLOSE_ON_EXECUTE,i,!1))},onSetup:n(e),getApi:n({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[_b.config({}),Qs.config({store:{mode:"manual",initialValue:a.map(function(e){return e.value}).getOr(""),getValue:function(e){return Po(e.element,DS)},setValue:function(e,t){MS(o.items,t).each(function(t){Do(e.element,DS,t.value),Pr(e,$C,{text:t.text})})}}})]},"tox-listbox",i.shared)}}})]},Sb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:X([c.toArray(),[s]]),fieldBehaviours:_a([lh.config({disabled:n(o.disabled),onDisabled:function(e){Sb.getField(e).each(lh.disable)},onEnabled:function(e){Sb.getField(e).each(lh.enable)}})])});var o,i,u,a,c,s}),selectbox:ok(function(e,t){return r=t.shared.providers,o=H((n=e).items,function(e){return{text:r.translate(e.text),value:e.value}}),i=n.label.map(function(e){return Nb(e,r)}),u=Sb.parts.field({dom:{},selectAttributes:{size:n.size},options:o,factory:IS,selectBehaviours:_a([lh.config({disabled:function(){return n.disabled||r.isDisabled()}}),_b.config({}),xm("selectbox-change",[jr(nr(),function(e,t){Pr(e,Bb,{name:n.name})})])])}),a=1<n.size?w.none():w.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Sg("chevron-down",r.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:X([[u],a.toArray()])},Sb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:X([i.toArray(),[c]]),fieldBehaviours:_a([lh.config({disabled:function(){return n.disabled||r.isDisabled()},onDisabled:function(e){Sb.getField(e).each(lh.disable)},onEnabled:function(e){Sb.getField(e).each(lh.enable)}}),zh()])});var n,r,o,i,u,a,c}),sizeinput:ok(function(e,t){return vS(e,t.shared.providers)}),urlinput:ok(function(e,t){return rk(e,t,t.urlinput)}),customeditor:ok(function(e){var t=Yt(w.none()),n=wg({dom:{tag:e.tag}}),r=Yt(w.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:_a([xm("custom-editor-events",[Kr(function(o){n.getOpt(o).each(function(n){(Object.prototype.hasOwnProperty.call(e,"init")?e.init(n.element.dom):Lw.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(e){r.get().each(function(t){e.setValue(t)}),r.set(w.none()),t.set(w.some(e))})})})]),Qs.config({store:{mode:"manual",getValue:function(){return t.get().fold(function(){return r.get().getOr("")},function(e){return e.getValue()})},setValue:function(e,n){t.get().fold(function(){r.set(w.some(n))},function(e){return e.setValue(n)})}}}),Bw()]),components:[n.asSpec()]}}),htmlpanel:ok(function(e){return yb.sketch("presentation"===e.presets?{dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}:{dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:_a([_b.config({}),Om.config({})])})}),imagetools:ok(function(e,t){return NS(e,t.shared.providers)}),table:ok(function(e,t){return r=t.shared.providers,u=function(e){return{dom:{tag:"td",innerHtml:r.translate(e)}}},a=function(e){return{dom:{tag:"tr"},components:H(e,u)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=(n=e).header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:H(i,function(e){return{dom:{tag:"th",innerHtml:r.translate(e)}}})}]}),(o=n.cells,{dom:{tag:"tbody"},components:H(o,a)})],behaviours:_a([_b.config({}),Om.config({})])};var n,r,o,i,u,a}),panel:ok(function(e,t){return{dom:{tag:"div",classes:(n=e).classes},components:H(n.items,t.shared.interpreter)};var n})},uk={field:function(e,t){return t}},ak=function(e,t,n){var r=Be(n,{shared:{interpreter:function(t){return ck(e,t,r)}}});return ck(e,t,r)},ck=function(e,t,n){return _e(ik,t.type).fold(function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t},function(r){return r(e,t,n)})},sk={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},lk=function(e,t,n){var r=ec(-12,12,sk),o={maxHeightFunction:Ja()};return function(){return n()?{anchor:"node",root:yo(e()),node:w.from(e()),bubble:r,layouts:{onRtl:function(){return[hg]},onLtr:function(){return[pg]}},overrides:o}:{anchor:"hotspot",hotspot:t(),bubble:r,layouts:{onRtl:function(){return[aa]},onLtr:function(){return[ca]}},overrides:o}}},fk=function(e,t,n){return function(){return n()?{anchor:"node",root:yo(e()),node:w.from(e()),layouts:{onRtl:function(){return[vg]},onLtr:function(){return[vg]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[da]},onLtr:function(){return[da]}}}}},dk=function(e,t,n){var r,o,i,u=Nh(e),a=function(){return tn(e.getContentAreaContainer())},c=function(){return u||!n()};return{inlineDialog:lk(a,t,c),banner:fk(a,t,c),cursor:(o=e,function(){return{anchor:"selection",root:i(),getSelection:function(){var e=o.selection.getRng();return w.some(Ec.range(tn(e.startContainer),e.startOffset,tn(e.endContainer),e.endOffset))}}}),node:(r=i=function(){return tn(e.getBody())},function(e){return{anchor:"node",root:r(),node:e}})}},mk=function(e){return{colorPicker:function(e,t){Gv(o)(e,t)},hasCustomColors:function(){return Iv(r)},getColors:function(){return Lv(n)},getColorCols:(t=n=r=o=e,function(){return zv(t)})};var t,n,r,o},gk=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],pk=function(e){return q(e,function(e,t){if(Te(t,"items")){var n=pk(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(Te(t,"inline")||Te(t,"block")||Te(t,"selector")){var r="custom-"+(k(t.name)?t.name:t.title.toLowerCase());return{customFormats:e.customFormats.concat([{name:r,format:t}]),formats:e.formats.concat([{title:t.title,format:r,icon:t.icon}])}}return l(l({},e),{formats:e.formats.concat(t)})},{customFormats:[],formats:[]})},hk=function(e){return w.from(e.getParam("style_formats")).filter(_).map(function(t){var n,r,o,i=(n=e,r=pk(t),o=function(e){V(e,function(e){n.formatter.has(e.name)||n.formatter.register(e.name,e.format)})},n.formatter?o(r.customFormats):n.on("init",function(){o(r.customFormats)}),r.formats);return e.getParam("style_formats_merge",!1,"boolean")?gk.concat(i):i}).getOr(gk)},vk=function(e,t,n){var r={type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)};return Be(e,r)},bk=function(e,t,n,r){var o=function(t){return H(t,function(t){var i,u,a,c,s,l=be(t);if(Ee(t,"items")){var f=o(t.items);return Be(Be(t,{type:"submenu"}),{getStyleItems:function(){return f}})}return Ee(t,"format")?vk(t,n,r):1===l.length&&I(l,"title")?Be(t,{type:"separator"}):(c={type:"formatter",format:a="custom-"+(u=k((i=t).name)?i.name:jo(i.title)),isSelected:n(a),getStylePreview:r(a)},s=Be(i,c),e.formatter.register(u,s),s)})};return o(t)},yk=Fw.trim,xk=function(e){return function(t){if(E(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}},wk=xk("true"),Ck=xk("false"),Sk=function(e,t,n,r,o){return{type:e,title:t,url:n,level:r,attach:o}},kk=function(e){return e.innerText||e.textContent},Ok=function(e){return(t=e)&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&Tk(e);var t},_k=function(e){return e&&/^(H[1-6])$/.test(e.nodeName)},Tk=function(e){return function(e){for(;e=e.parentNode;){var t=e.contentEditable;if(t&&"inherit"!==t)return wk(e)}return!1}(e)&&!Ck(e)},Ek=function(e){return _k(e)&&Tk(e)},Ak=function(e){var t,n,r=(t=e).id?t.id:jo("h");return Sk("header",kk(e),"#"+r,_k(n=e)?parseInt(n.nodeName.substr(1),10):0,function(){e.id=r})},Rk=function(t){var n=t.id||t.name,r=kk(t);return Sk("anchor",r||"#"+n,"#"+n,0,e)},Nk=function(e){return 0<yk(e.title).length},Bk=function(e){var t=function(e){return H(Fc(tn(e),"h1,h2,h3,h4,h5,h6,a:not([href])"),function(e){return e.dom})}(e);return U(H(U(t,Ek),Ak).concat(H(U(t,Ok),Rk)),Nk)},Dk="tinymce-url-history",Pk=function(e){return k(e)&&/^https?/.test(e)},Mk=function(e){return O(e)&&ke(e,function(e){return!(_(t=e)&&t.length<=5&&Y(t,Pk));var t}).isNone()},Ik=function(){var e,t=Nv.getItem(Dk);if(null===t)return{};try{e=JSON.parse(t)}catch(g){if(g instanceof SyntaxError)return console.log("Local storage "+Dk+" was not valid JSON",g),{};throw g}return Mk(e)?e:(console.log("Local storage "+Dk+" was not valid format",e),{})},Lk=function(e){var t=Ik();return Object.prototype.hasOwnProperty.call(t,e)?t[e]:[]},Fk=function(e,t){var n,r,o;Pk(e)&&(n=Ik(),r=Object.prototype.hasOwnProperty.call(n,t)?n[t]:[],o=U(r,function(t){return t!==e}),n[t]=[e].concat(o).slice(0,5),function(e){if(!Mk(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));Nv.setItem(Dk,JSON.stringify(e))}(n))},zk=function(e){return!!e},Hk=function(e){return we(Fw.makeMap(e,/[, ]/),zk)},Vk=function(e){return w.from(e.getParam("file_picker_callback")).filter(A)},jk=function(e){return w.from(e).filter(k).getOrUndefined()},Uk=function(e){return{getHistory:Lk,addToHistory:Fk,getLinkInformation:function(){return!1===(t=e).getParam("typeahead_urls")?w.none():w.some({targets:Bk(t.getBody()),anchorTop:jk(t.getParam("anchor_top","#top")),anchorBottom:jk(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return function(e){return w.from(void 0===(n=(t=e).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):n);var t,n}(e)},getUrlPicker:function(t){return function(e,t){var n,r,o,i,u=(r=w.some((n=e).getParam("file_picker_types")).filter(zk),o=w.some(n.getParam("file_browser_callback_types")).filter(zk),i=r.or(o).map(Hk),Vk(n).fold(a,function(e){return i.fold(c,function(e){return 0<be(e).length&&e})}));return T(u)?u?Vk(e):w.none():u[t]?Vk(e):w.none()}(n=e,r=t).map(function(e){return function(t){return ey(function(o){var i=l({filetype:r,fieldname:t.fieldname},w.from(t.meta).getOr({}));e.call(n,function(e,t){if(!k(e))throw new Error("Expected value to be string");if(void 0!==t&&!O(t))throw new Error("Expected meta to be a object");o({value:e,meta:t})},t.value,i)})}});var n,r}}},Wk=function(e,t,n){var r,o,i=Yt(!1),u={isPositionedAtTop:function(){return"top"===r.get()},getDockingMode:(r=Yt(Ah(t)?"bottom":"top")).get,setDockingMode:r.set},a={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Yp.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(e){return ck(uk,e,a)},anchors:dk(t,n,u.isPositionedAtTop),header:u,getSink:function(){return ae.value(e)}},urlinput:Uk(t),styleselect:function(e){var t=function(t){return function(){return e.formatter.match(t)}},n=function(t){return function(){var n=e.formatter.get(t);return void 0!==n?w.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):w.none()}},r=function(e){var t=e.items;return void 0!==t&&0<t.length?K(t,r):[e.format]},o=Yt([]),i=Yt([]),u=Yt([]),a=Yt([]),c=Yt(!1);return e.on("PreInit",function(u){var a=hk(e),c=bk(e,a,t,n);o.set(c),i.set(K(c,r))}),e.on("addStyleModifications",function(o){var i=bk(e,o.items,t,n);u.set(i),c.set(o.replace),a.set(K(i,r))}),{getData:function(){var e=c.get()?[]:o.get(),t=u.get();return e.concat(t)},getFlattenedKeys:function(){var e=c.get()?[]:i.get(),t=a.get();return e.concat(t)}}}(t),colorinput:mk(t),dialog:{isDraggableModal:(o=t,function(){return o.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(e){return i.set(e)}};return a},qk=n(function(e,t){var n,r,o;n=e,r=Math.floor(t),o=Yi.max(n,r,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),Oi(n,"max-width",o+"px")}),Gk="contexttoolbar-hide",$k=n([_t("dom"),Ht("shell",!0),Zs("toolbarBehaviours",[ym])]),Xk=n([El({name:"groups",overrides:function(){return{behaviours:_a([ym.config({})])}}})]),Kk=tf({name:"Toolbar",configFields:$k(),partFields:Xk(),factory:function(e,t,n,r){var o=function(t){return e.shell?w.some(t):Hl(t,e,"groups")},i=e.shell?{behaviours:[ym.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:i.components,behaviours:tl(e.toolbarBehaviours,i.behaviours),apis:{setGroups:function(e,t){o(e).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(e){ym.set(e,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),Yk=function(e,t,n){return{within:e,extra:t,withinWidth:n}},Jk=function(e,t,r){var o,i=(o=function(e,t){var n=r(e);return w.some({element:e,start:t,finish:t+n,width:n})},q(e,function(e,t){return o(t,e.len).fold(n(e),function(t){return{len:t.finish,list:e.list.concat([t])}})},{len:0,list:[]}).list),u=U(i,function(e){return e.finish<=t}),a=W(u,function(e,t){return e+t.width},0);return{within:u,extra:i.slice(u.length),withinWidth:a}},Qk=function(e){return H(e,function(e){return e.element})},Zk=function(e,t){var n=H(t,function(e){return Hi(e)});Kk.setGroups(e,n)},eO=function(e,t,n){var r=Vl(e,t,"primary"),o=gy.getCoupled(e,"overflowGroup");Oi(r.element,"visibility","hidden");var i=t.builtGroups.get().concat([o]),u=oe(i,function(e){return Ia(e.element).bind(function(t){return e.getSystem().getByDom(t).toOptional()})});n([]),Zk(r,i);var a=function(e,t,n,r){var o,i,u,a,c,s,l,f,d=(0===(o=Jk(t,e,n)).extra.length?w.some(o):w.none()).getOrThunk(function(){return Jk(t,e-n(r),n)}),m=d.within,g=d.extra,p=d.withinWidth;return 1===g.length&&g[0].width<=n(r)?(l=p,f=Qk(m.concat(g)),Yk(f,[],l)):1<=g.length?(u=g,a=r,c=p,s=Qk(m).concat([a]),Yk(s,Qk(u),c)):(i=p,Yk(Qk(m),[],i))}(Ji(r.element),t.builtGroups.get(),function(e){return Ji(e.element)},o);0===a.extra.length?(ym.remove(r,o),n([])):(Zk(r,a.within),n(a.extra)),Bi(r.element,"visibility"),Di(r.element),u.each(Om.focus)},tO=n([Zs("splitToolbarBehaviours",[gy]),Kt("builtGroups",function(){return Yt([])})]),nO=n([Mu(["overflowToggledClass"]),Ft("getOverflowBounds"),_t("lazySink"),Kt("overflowGroups",function(){return Yt([])})].concat(tO())),rO=n([_l({factory:Kk,schema:$k(),name:"primary"}),Tl({schema:$k(),name:"overflow"}),Tl({name:"overflow-button"}),Tl({name:"overflow-group"})]),oO=n([Mu(["toggledClass"]),_t("lazySink"),Rt("fetch"),Ft("getBounds"),zt("fireDismissalEventInstead",[Ht("event",Or())]),lc()]),iO=n([Tl({name:"button",overrides:function(e){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:_a([Lm.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Tl({factory:Kk,schema:$k(),name:"toolbar",overrides:function(e){return{toolbarBehaviours:_a([gm.config({mode:"cyclic",onEscape:function(t){return Hl(t,e,"button").each(Om.focus),w.none()}})])}}})]),uO=function(e,t){var n=gy.getCoupled(e,"toolbarSandbox");Bs.isOpen(n)?Bs.close(n):Bs.open(n,t.toolbar())},aO=function(e,t,n,r){var o=n.getBounds.map(function(e){return e()}),i=n.lazySink(e).getOrDie();ls.positionWithinBounds(i,{anchor:"hotspot",hotspot:e,layouts:r,overrides:{maxWidthFunction:qk()}},t,o)},cO=function(e,t,n,r,o){Kk.setGroups(t,o),aO(e,t,n,r),Lm.on(e)},sO=tf({name:"FloatingToolbarButton",factory:function(e,t,n,r){return l(l({},xg.sketch(l(l({},r.button()),{action:function(e){uO(e,r)},buttonBehaviours:rl({dump:r.button().buttonBehaviours},[gy.config({others:{toolbarSandbox:function(t){return r=t,o=n,i=e,{dom:{tag:"div",attributes:{id:(u=Cu()).id}},behaviours:_a([gm.config({mode:"special",onEscape:function(e){return Bs.close(e),w.some(!0)}}),Bs.config({onOpen:function(e,t){i.fetch().get(function(e){cO(r,t,i,o.layouts,e),u.link(r.element),gm.focusIn(t)})},onClose:function(){Lm.off(r),Om.focus(r),u.unlink(r.element)},isPartOf:function(e,t,n){return Su(t,n)||Su(r,n)},getAttachPoint:function(){return i.lazySink(r).getOrDie()}}),Ba.config({channels:l(l({},Ls(l({isExtraPart:a},i.fireDismissalEventInstead.map(function(e){return{fireEventInstead:{event:e.event}}}).getOr({})))),zs({doReposition:function(){Bs.getState(gy.getCoupled(r,"toolbarSandbox")).each(function(e){aO(r,e,i,o.layouts)})}}))})])};var r,o,i,u}}})])}))),{apis:{setGroups:function(t,r){Bs.getState(gy.getCoupled(t,"toolbarSandbox")).each(function(o){cO(t,o,e,n.layouts,r)})},reposition:function(t){Bs.getState(gy.getCoupled(t,"toolbarSandbox")).each(function(r){aO(t,r,e,n.layouts)})},toggle:function(e){uO(e,r)},getToolbar:function(e){return Bs.getState(gy.getCoupled(e,"toolbarSandbox"))},isOpen:function(e){return Bs.isOpen(gy.getCoupled(e,"toolbarSandbox"))}}})},configFields:oO(),partFields:iO(),apis:{setGroups:function(e,t,n){e.setGroups(t,n)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getToolbar:function(e,t){return e.getToolbar(t)},isOpen:function(e,t){return e.isOpen(t)}}}),lO=n([_t("items"),Mu(["itemSelector"]),Zs("tgroupBehaviours",[gm])]),fO=n([Al({name:"items",unit:"item"})]),dO=tf({name:"ToolbarGroup",configFields:lO(),partFields:fO(),factory:function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,behaviours:tl(e.tgroupBehaviours,[gm.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),mO=function(e){return H(e,function(e){return Hi(e)})},gO=function(e,t,n){eO(e,n,function(r){n.overflowGroups.set(r),t.getOpt(e).each(function(e){sO.setGroups(e,mO(r))})})},pO=tf({name:"SplitFloatingToolbar",configFields:nO(),partFields:rO(),factory:function(e,t,n,r){var o=wg(sO.sketch({fetch:function(){return ey(function(t){t(mO(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[ca,aa]},onRtl:function(){return[aa,ca]},onBottomLtr:function(){return[la,sa]},onBottomRtl:function(){return[sa,la]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:r["overflow-button"](),toolbar:r.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:tl(e.splitToolbarBehaviours,[gy.config({others:{overflowGroup:function(){return dO.sketch(l(l({},r["overflow-group"]()),{items:[o.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(H(n,t.getSystem().build)),gO(t,o,e)},refresh:function(t){return gO(t,o,e)},toggle:function(e){o.getOpt(e).each(function(e){sO.toggle(e)})},isOpen:function(e){return o.getOpt(e).map(sO.isOpen).getOr(!1)},reposition:function(e){o.getOpt(e).each(function(e){sO.reposition(e)})},getOverflow:function(e){return o.getOpt(e).bind(sO.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)},getOverflow:function(e,t){return e.getOverflow(t)}}}),hO=function(e,t){return t.getAnimationRoot.fold(function(){return e.element},function(t){return t(e)})},vO=function(e){return e.dimension.property},bO=function(e,t){return e.dimension.getDimension(t)},yO=function(e,t){var n=hO(e,t);bi(n,[t.shrinkingClass,t.growingClass])},xO=function(e,t){pi(e.element,t.openClass),gi(e.element,t.closedClass),Oi(e.element,vO(t),"0px"),Di(e.element)},wO=function(e,t){pi(e.element,t.closedClass),gi(e.element,t.openClass),Bi(e.element,vO(t))},CO=function(e,t,n,r){n.setCollapsed(),Oi(e.element,vO(t),bO(t,e.element)),Di(e.element),yO(e,t),xO(e,t),t.onStartShrink(e),t.onShrunk(e)},SO=function(e,t,n,r){var o=r.getOrThunk(function(){return bO(t,e.element)});n.setCollapsed(),Oi(e.element,vO(t),o),Di(e.element);var i=hO(e,t);pi(i,t.growingClass),gi(i,t.shrinkingClass),xO(e,t),t.onStartShrink(e)},kO=function(e,t,n){var r=bO(t,e.element);("0px"===r?CO:SO)(e,t,n,w.some(r))},OO=function(e,t,n){var r=hO(e,t),o=hi(r,t.shrinkingClass),i=bO(t,e.element);wO(e,t);var u=bO(t,e.element);(o?function(){Oi(e.element,vO(t),i),Di(e.element)}:function(){xO(e,t)})(),pi(r,t.shrinkingClass),gi(r,t.growingClass),wO(e,t),Oi(e.element,vO(t),u),n.setExpanded(),t.onStartGrow(e)},_O=function(e,t,n){var r=hO(e,t);return!0===hi(r,t.growingClass)},TO=function(e,t,n){var r=hO(e,t);return!0===hi(r,t.shrinkingClass)},EO=Object.freeze({__proto__:null,refresh:function(e,t,n){var r;n.isExpanded()&&(Bi(e.element,vO(t)),r=bO(t,e.element),Oi(e.element,vO(t),r))},grow:function(e,t,n){n.isExpanded()||OO(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&kO(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&CO(e,t,n,w.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:_O,isShrinking:TO,isTransitioning:function(e,t,n){return _O(e,t)||TO(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?kO:OO)(e,t,n)},disableTransitions:yO}),AO=Object.freeze({__proto__:null,exhibit:function(e,t,n){return ai(t.expanded?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:je(t.dimension.property,"0px")})},events:function(e,t){return zr([Xr(or(),function(n,r){r.event.raw.propertyName===e.dimension.property&&(yO(n,e),t.isExpanded()&&Bi(n.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))})])}}),RO=[_t("closedClass"),_t("openClass"),_t("shrinkingClass"),_t("growingClass"),Pt("getAnimationRoot"),Lu("onShrunk"),Lu("onStartShrink"),Lu("onGrown"),Lu("onStartGrow"),Ht("expanded",!1),Tt("dimension",ht("property",{width:[Vu("property","width"),Vu("getDimension",function(e){return Ji(e)+"px"})],height:[Vu("property","height"),Vu("getDimension",function(e){return Ui(e)+"px"})]}))],NO=Ea({fields:RO,name:"sliding",active:AO,apis:EO,state:Object.freeze({__proto__:null,init:function(e){var t=Yt(e.expanded);return ii({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:o(t.set,!1),setExpanded:o(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),BO=n([Mu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Lu("onOpened"),Lu("onClosed")].concat(tO())),DO=n([_l({factory:Kk,schema:$k(),name:"primary"}),_l({factory:Kk,schema:$k(),name:"overflow",overrides:function(e){return{toolbarBehaviours:_a([NO.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:function(t){Hl(t,e,"overflow-button").each(function(e){Lm.off(e),Om.focus(e)}),e.onClosed(t)},onGrown:function(t){gm.focusIn(t),e.onOpened(t)},onStartGrow:function(t){Hl(t,e,"overflow-button").each(Lm.on)}}),gm.config({mode:"acyclic",onEscape:function(t){return Hl(t,e,"overflow-button").each(Om.focus),w.some(!0)}})])}}}),Tl({name:"overflow-button",overrides:function(e){return{buttonBehaviours:_a([Lm.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Tl({name:"overflow-group"})]),PO=function(e,t){Hl(e,t,"overflow-button").bind(function(){return Hl(e,t,"overflow")}).each(function(n){MO(e,t),NO.toggleGrow(n)})},MO=function(e,t){Hl(e,t,"overflow").each(function(n){eO(e,t,function(e){var t=H(e,function(e){return Hi(e)});Kk.setGroups(n,t)}),Hl(e,t,"overflow-button").each(function(e){NO.hasGrown(n)&&Lm.on(e)}),NO.refresh(n)})},IO=tf({name:"SplitSlidingToolbar",configFields:BO(),partFields:DO(),factory:function(e,t,n,r){var o="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:tl(e.splitToolbarBehaviours,[gy.config({others:{overflowGroup:function(e){return dO.sketch(l(l({},r["overflow-group"]()),{items:[xg.sketch(l(l({},r["overflow-button"]()),{action:function(t){Dr(e,o)}}))]}))}}}),xm("toolbar-toggle-events",[jr(o,function(t){PO(t,e)})])]),apis:{setGroups:function(t,n){var r;r=H(n,t.getSystem().build),e.builtGroups.set(r),MO(t,e)},refresh:function(t){return MO(t,e)},toggle:function(t){return PO(t,e)},isOpen:function(t){return Hl(t,e,"overflow").map(NO.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)}}}),LO=n(jo("toolbar-height-change")),FO=function(e){var t=e.title.fold(function(){return{}},function(e){return{attributes:{title:e}}});return{dom:l({tag:"div",classes:["tox-toolbar__group"]},t),components:[dO.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:_a([_b.config({}),Om.config({})])}},zO=function(e){return dO.sketch(FO(e))},HO=function(e,t){var n=Kr(function(t){var n=H(e.initGroups,zO);Kk.setGroups(t,n)});return _a([Uh(e.providers.isDisabled),zh(),gm.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),xm("toolbar-events",[n])])},VO=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":FO({title:w.none(),items:[]}),"overflow-button":oS({name:"more",icon:w.some("more-drawer"),disabled:!1,tooltip:w.some("More..."),primary:!1,borderless:!1},w.none(),e.providers)},splitToolbarBehaviours:HO(e,t)}},jO=function(e){var t=VO(e),n=pO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return pO.sketch(l(l({},t),{lazySink:e.getSink,getOverflowBounds:function(){var t=e.moreDrawerData.lazyHeader().element,n=fu(t),r=ao(t),o=fu(r),i=Math.max(r.dom.scrollHeight,o.height);return su(n.x+4,o.y,n.width-8,i)},parts:l(l({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},UO=function(e){var t=IO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=IO.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=VO(e);return IO.sketch(l(l({},r),{components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(e){e.getSystem().broadcastOn([LO()],{type:"opened"})},onClosed:function(e){e.getSystem().broadcastOn([LO()],{type:"closed"})}}))},WO=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return Kk.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===np.scrolling?["tox-toolbar--scrolling"]:[])},components:[Kk.parts.groups({})],toolbarBehaviours:HO(e,t)})},qO=Qe([Et("type"),Tt("items",et([at([Et("name"),Dt("items",xt)]),xt]))].concat(jg)),GO=[Lt("text"),Lt("tooltip"),Lt("icon"),Rt("fetch"),Gt("onSetup",function(){return e})],$O=Qe(d([Et("type")],GO)),XO=function(e){return ft("menubutton",$O,e)},KO=Qe([Et("type"),Lt("tooltip"),Lt("icon"),Lt("text"),Ft("select"),Rt("fetch"),Gt("onSetup",function(){return e}),Wt("presets","normal",["normal","color","listpreview"]),Ht("columns",1),Rt("onAction"),Rt("onItemAction")]),YO=Object.freeze({__proto__:null,events:function(e,t){var n=function(n,r){e.updateState.each(function(e){var o=e(n,r);t.set(o)}),e.renderComponents.each(function(e){var o=e(r,t.get()),i=H(o,n.getSystem().build);gs(n,i)})};return zr([jr(fr(),function(t,r){var o=r;o.universal||I(o.channels,e.channel)&&n(t,o.data)}),Kr(function(t,r){e.initialData.each(function(e){n(t,e)})})])}}),JO=Object.freeze({__proto__:null,getState:function(e,t,n){return n}}),QO=[_t("channel"),Pt("renderComponents"),Pt("updateState"),Pt("initialData")],ZO=Ea({fields:QO,name:"reflecting",active:YO,apis:JO,state:Object.freeze({__proto__:null,init:function(){var e=Yt(w.none());return{readState:function(){return e.get().fold(function(){return"none"},function(e){return e})},get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(w.none())}}}})}),e_=n([_t("toggleClass"),_t("fetch"),zu("onExecute"),Ht("getHotspot",w.some),Ht("getAnchorOverrides",n({})),lc(),zu("onItemExecute"),Pt("lazySink"),_t("dom"),Lu("onOpen"),Zs("splitDropdownBehaviours",[gy,gm,Om]),Ht("matchWidth",!1),Ht("useMinWidth",!1),Ht("eventOrder",{}),Pt("role")].concat(Ny())),t_=_l({factory:xg,schema:[_t("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:_a([Om.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(Mr)},buttonBehaviours:_a([Lm.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])}}}),n_=_l({factory:xg,schema:[_t("dom")],name:"button",defaults:function(){return{buttonBehaviours:_a([Om.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(function(n){e.onExecute(n,t)})}}}}),r_=n([t_,n_,El({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[_t("text")],name:"aria-descriptor"}),Tl({schema:[Pu()],name:"menu",defaults:function(e){return{onExecute:function(t,n){t.getSystem().getByUid(e.uid).each(function(r){e.onItemExecute(r,t,n)})}}}}),hy()]),o_=tf({name:"SplitDropdown",configFields:e_(),partFields:r_(),factory:function(t,n,r,o){var i,u=function(e){cf.getCurrent(e).each(function(e){bf.highlightFirst(e),gm.focusIn(e)})},a=function(n){_y(t,function(e){return e},n,o,u,$b.HighlightFirst).get(e)},c=function(e){var n=Vl(e,t,"button");return Mr(n),w.some(!0)},s=l(l({},zr([Kr(function(e,n){Hl(e,t,"aria-descriptor").each(function(t){var n=jo("aria");Do(t.element,"id",n),Do(e.element,"aria-describedby",n)})})])),zm(w.some(a)));return{uid:t.uid,dom:t.dom,components:n,apis:{repositionMenus:function(e){Lm.isOn(e)&&Ry(e)}},eventOrder:l(l({},t.eventOrder),((i={})[dr()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:tl(t.splitDropdownBehaviours,[gy.config({others:{sandbox:function(e){var n=Vl(e,t,"arrow");return Ay(t,e,{onOpen:function(){Lm.on(n),Lm.on(e)},onClose:function(){Lm.off(n),Lm.off(e)}})}}}),gm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(e){return a(e),w.some(!0)}}),Om.config({}),Lm.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(e,t){return e.repositionMenus(t)}}}),i_=function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},u_=function(e){return{setActive:function(t){Lm.set(e,t)},isActive:function(){return Lm.isOn(e)},isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)}}},a_=function(e,t){return e.map(function(e){return{"aria-label":t.translate(e),title:t.translate(e)}}).getOr({})},c_=jo("focus-button"),s_=["checklist","ordered-list"],l_=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],f_=function(e,t,n,r,o,i){var u,a=function(e){return Yp.isRtl()&&I(s_,e)?e+"-rtl":e},c=Yp.isRtl()&&e.exists(function(e){return I(l_,e)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:a_(n,i)},components:Xh([e.map(function(e){return jC(a(e),i.icons)}),t.map(function(e){return WC(e,"tox-tbtn",i)})]),eventOrder:((u={})[Gn()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:_a([Uh(i.isDisabled),zh(),xm("common-button-display-events",[jr(Gn(),function(e,t){t.event.prevent(),Dr(e,c_)})])].concat(r.map(function(n){return ZO.config({channel:n,initialData:{icon:e,text:t},renderComponents:function(e,t){return Xh([e.icon.map(function(e){return jC(a(e),i.icons)}),e.text.map(function(e){return WC(e,"tox-tbtn",i)})])}})}).toArray()).concat(o.getOr([])))}},d_=function(t,n,r){var o,i=Yt(e),u=f_(t.icon,t.text,t.tooltip,w.none(),w.none(),r);return xg.sketch({dom:u.dom,components:u.components,eventOrder:GC,buttonBehaviours:_a([xm("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Qr(function(e,t){Wh(o,e)(function(t){Pr(e,qC,{buttonApi:t}),o.onAction(t)})})),qh(n,i),Gh(n,i)]),Uh(function(){return t.disabled||r.isDisabled()}),zh()].concat(n.toolbarButtonBehaviours))})},m_=function(e,t,n){return d_(e,{toolbarButtonBehaviours:[].concat(0<n.length?[xm("toolbarButtonWith",n)]:[]),getApi:i_,onSetup:e.onSetup},t)},g_=function(e,t,n){return Be(d_(e,{toolbarButtonBehaviours:[ym.config({}),Lm.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<n.length?[xm("toolbarToggleButtonWith",n)]:[]),getApi:u_,onSetup:e.onSetup},t))},p_=function(e,t){return jr(qC,function(n,r){var o,i=e.get(n),u=(o=i,{hide:function(){return Dr(o,hr())},getValue:function(){return Qs.getValue(o)}});t.onAction(u,r.event.buttonApi)})},h_=function(t,n){var r,o,u,a,c=t.label.fold(function(){return{}},function(e){return{"aria-label":e}}),s=wg(Wb.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:c,selectOnFocus:!0,inputBehaviours:_a([gm.config({mode:"special",onEnter:function(e){return d.findPrimary(e).map(function(e){return Mr(e),!0})},onLeft:function(e,t){return t.cut(),w.none()},onRight:function(e,t){return t.cut(),w.none()}})])})),d=(r=s,u=n,a=H(o=t.commands,function(t){return wg(function(t,n,r){var o,i,u,a,c,s,d,m,g,p,h={backstage:{shared:{providers:r}}};return"contextformtogglebutton"===n.type?(s=t,m=h,g=f((d=n).original,["primary"]),p=dt($g(l(l({},g),{type:"togglebutton",onAction:e}))),g_(p,m.backstage.shared.providers,[p_(s,d)])):(o=t,u=h,a=f((i=n).original,["primary"]),c=dt(Wg(l(l({},a),{type:"button",onAction:e}))),m_(c,u.backstage.shared.providers,[p_(o,i)]))}(r,t,u))}),{asSpecs:function(){return H(a,function(e){return e.asSpec()})},findPrimary:function(e){return oe(o,function(t,n){return t.primary?w.from(a[n]).bind(function(t){return t.getOpt(e)}).filter(i(lh.isDisabled)):w.none()})}});return[{title:w.none(),items:[s.asSpec()]},{title:w.none(),items:d.asSpecs()}]},v_=function(e,t){var n,r,o,i=iu(window),u=lu(tn(e.getContentAreaContainer())),a=bh(e)||yh(e)||wh(e),c=(n=u,r=i,{x:o=Math.max(r.x,n.x),width:Math.min(n.right-o,r.width-(o-r.x))}),s=c.x,l=c.width;if(e.inline&&!a)return su(s,i.y,l,i.height);var f=function(e,t,n,r){var o=tn(e.getContainer()),i=xu(o,".tox-editor-header").getOr(o),u=lu(i),a=r&&!(u.y>=t.bottom);if(e.inline&&a)return{y:Math.max(u.bottom,n.y),bottom:n.bottom};if(e.inline&&!a)return{y:n.y,bottom:Math.min(u.y,n.bottom)};var c=lu(o);return a?{y:Math.max(u.bottom,n.y),bottom:Math.min(c.bottom,n.bottom)}:{y:Math.max(c.y,n.y),bottom:Math.min(u.y,n.bottom)}}(e,u,i,t.header.isPositionedAtTop()),d=f.y;return su(s,d,l,f.bottom-d)},b_=function(e,t){var n=U(t,function(t){return t.predicate(e.dom)}),r=j(n,function(e){return"contexttoolbar"===e.type});return{contextToolbars:r.pass,contextForms:r.fail}},y_=jo("forward-slide"),x_=jo("backward-slide"),w_=jo("change-slide-event"),C_="tox-pop--resizing",S_=function(e,t,n){var r,o,i,u,a,c=n.dataset;return{items:(r=t,o=n,i=function(e,t,n,i){var a=r.shared.providers.translate(e.title);if("separator"===e.type)return w.some({type:"separator",text:a});if("submenu"!==e.type)return w.some(l({type:"togglemenuitem",text:a,icon:e.icon,active:e.isSelected(i),disabled:n,onAction:o.onAction(e)},e.getStylePreview().fold(function(){return{}},function(e){return{meta:{style:e}}})));var c=K(e.getStyleItems(),function(e){return u(e,t,i)});return 0===t&&c.length<=0?w.none():w.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return K(e.getStyleItems(),function(e){return u(e,t,i)})}})},u=function(e,t,n){var r="formatter"===e.type&&o.isInvalid(e);return 0===t?r?[]:i(e,t,!1,n).toArray():i(e,t,r,n).toArray()},{validateItems:a=function(e){var t=o.getCurrentValue(),n=o.shouldHide?0:1;return K(e,function(e){return u(e,n,t)})},getFetch:function(e,t){return function(n,r){var o=t(),i=a(o);r(ZC(i,op.CLOSE_ON_EXECUTE,e,!1))}}}),getStyleItems:"basic"===c.type?function(){return H(c.data,function(e){return vk(e,n.isSelectedFor,n.getPreviewFor)})}:c.getData}},k_=function(t,n,r){var o=S_(0,n,r),i=o.items,u=o.getStyleItems;return KC({text:r.icon.isSome()?w.none():w.some(""),icon:r.icon,tooltip:w.from(r.tooltip),role:w.none(),fetch:i.getFetch(n,u),onSetup:function(n){return r.setInitialValue.each(function(e){return e(n.getComponent())}),r.nodeChangeHandler.map(function(e){var r=e(n.getComponent());return t.on("NodeChange",r),function(){t.off("NodeChange",r)}}).getOr(e)},getApi:function(e){return{getComponent:function(){return e}}},columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(vC=hC=hC||{})[vC.SemiColon=0]="SemiColon",vC[vC.Space=1]="Space";var O_,__,T_,E_,A_,R_,N_=function(e,t,n,r){var o,i;return{type:"basic",data:(i=e.getParam(t,n,"string"),o=r===hC.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),H(o,function(e){var t=e,n=e,r=e.split("=");return 1<r.length&&(t=r[0],n=r[1]),{title:t,format:n}}))}},B_=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],D_=function(e){var t=function(t){var n=G(B_,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(e){return e.title.toLowerCase()});Pr(t,XC,{icon:"align-"+n})},n=w.some(function(e){return function(){return t(e)}}),r=w.some(t),o={type:"basic",data:B_};return{tooltip:"Align",icon:w.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:w.none,getPreviewFor:function(e){return function(){return w.none()}},onAction:function(t){return function(){return G(B_,function(e){return e.format===t.format}).each(function(t){return e.execCommand(t.command)})}},setInitialValue:r,nodeChangeHandler:n,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},P_=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],M_=function(e){var t=e.split(/\s*,\s*/);return H(t,function(e){return e.replace(/^['"]+|['"]+$/g,"")})},I_=function(e){var t=function(){var t=function(e){return e?M_(e)[0]:""},n=e.queryCommandValue("FontName"),r=i.data,o=n?n.toLowerCase():"";return{matchOpt:G(r,function(e){var n=e.format;return n.toLowerCase()===o||t(n).toLowerCase()===t(o).toLowerCase()}).orThunk(function(){return function(e){var t;return 0===e.indexOf("-apple-system")&&(t=M_(e.toLowerCase()),Y(P_,function(e){return-1<t.indexOf(e.toLowerCase())}))}(o)?w.from({title:"System Font",format:o}):w.none()}),font:n}},n=function(e){var n=t(),r=n.font,o=n.matchOpt.fold(function(){return r},function(e){return e.title});Pr(e,$C,{text:o})},r=w.some(function(e){return function(){return n(e)}}),o=w.some(n),i=N_(e,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",hC.SemiColon);return{tooltip:"Fonts",icon:w.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(e){return function(){return w.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}})}},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontName",!1,t.format)})}},setInitialValue:o,nodeChangeHandler:r,dataset:i,shouldHide:!1,isInvalid:a}},L_={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},F_={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},z_=function(e){var t=function(){var t=w.none(),n=c.data,r=e.queryCommandValue("FontSize");if(r)for(var o=function(e){var o=function(e,t){return/[0-9.]+px$/.test(e)?(n=72*parseInt(e,10)/96,r=Math.pow(10,t||0),Math.round(n*r)/r+"pt"):_e(F_,e).getOr(e);var n,r}(r,e),i=_e(L_,o).getOr("");t=G(n,function(e){return e.format===r||e.format===o||e.format===i})},i=3;t.isNone()&&0<=i;i--)o(i);return{matchOpt:t,size:r}},r=n(w.none),o=function(e){var n=t(),r=n.size,o=n.matchOpt.fold(function(){return r},function(e){return e.title});Pr(e,$C,{text:o})},i=w.some(function(e){return function(){return o(e)}}),u=w.some(o),c=N_(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",hC.Space);return{tooltip:"Font sizes",icon:w.none(),isSelectedFor:function(e){return function(t){return t.exists(function(t){return t.format===e})}},getPreviewFor:r,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},setInitialValue:u,nodeChangeHandler:i,dataset:c,shouldHide:!1,isInvalid:a}},H_=function(e,t){var n=t(),r=H(n,function(e){return e.format});return w.from(e.formatter.closest(r)).bind(function(e){return G(n,function(t){return t.format===e})}).orThunk(function(){return rf(e.formatter.match("p"),{title:"Paragraph",format:"p"})})},V_=function(e){var t=Yt(w.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(w.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(w.some(e))}}},j_=function(){return V_(function(e){return e.destroy()})},U_=function(){return V_(function(e){return e.unbind()})},W_=function(e,t){return function(n){var r=U_(),o=function(){n.setActive(e.formatter.match(t));var o=e.formatter.formatChanged(t,n.setActive);r.set(o)};return e.initialized?o():e.on("init",o),r.clear}},q_=function(e){return function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})}}},G_=function(e){var t=function(t){var n=H_(e,function(){return o.data}).fold(function(){return"Paragraph"},function(e){return e.title});Pr(t,$C,{text:n})},n=w.some(function(e){return function(){return t(e)}}),r=w.some(t),o=N_(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",hC.SemiColon);return{tooltip:"Blocks",icon:w.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:w.none,getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return w.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))})}},onAction:q_(e),setInitialValue:r,nodeChangeHandler:n,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},$_=function(e,t){var n=function(t){var n=function(e){var t=e.items;return void 0!==t&&0<t.length?K(t,n):[{title:e.title,format:e.format}]},r=K(hk(e),n),o=H_(e,function(){return r}).fold(function(){return"Paragraph"},function(e){return e.title});Pr(t,$C,{text:o})},r=w.some(function(e){return function(){return n(e)}}),o=w.some(n);return{tooltip:"Formats",icon:w.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:w.none,getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return void 0!==n?w.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):w.none()}},onAction:q_(e),setInitialValue:o,nodeChangeHandler:r,shouldHide:e.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!e.formatter.canApply(t.format)},dataset:t}},X_=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],K_=function(e,t){return function(n,r,o){var i=e(n).mapError(function(e){return gt(e)}).getOrDie();return t(i,r,o)}},Y_={button:K_(Wg,function(e,t){return m_(e,t.backstage.shared.providers,[])}),togglebutton:K_($g,function(e,t){return g_(e,t.backstage.shared.providers,[])}),menubutton:K_(XO,function(e,t){return tS(e,"tox-tbtn",t.backstage,w.none())}),splitbutton:K_(function(e){return ft("SplitButton",KO,e)},function(t,n){return function(t,n){var r,o,i,u,c=jo("channel-update-split-dropdown-display"),s=function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){return lh.set(e,t)},setIconFill:function(t,n){xu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(e){Do(e,"fill",n)})},setIconStroke:function(t,n){xu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(e){Do(e,"stroke",n)})},setActive:function(t){Do(e.element,"aria-pressed",t),xu(e.element,"span").each(function(n){e.getSystem().getByDom(n).each(function(e){return Lm.set(e,t)})})},isActive:function(){return xu(e.element,"span").exists(function(t){return e.getSystem().getByDom(t).exists(Lm.isOn)})}}},f=Yt(e),d={getApi:s,onSetup:t.onSetup};return o_.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:l({"aria-pressed":!1},a_(t.tooltip,n.providers))},onExecute:function(e){t.onAction(s(e))},onItemExecute:function(e,t,n){},splitDropdownBehaviours:_a([jh(n.providers.isDisabled),zh(),xm("split-dropdown-events",[jr(c_,Om.focus),qh(d,f),Gh(d,f)]),My.config({})]),eventOrder:((r={})[Sr()]=["alloy.base.behaviour","split-dropdown-events"],r),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(o=s,i=t,u=n.providers,function(e){return ey(function(e){return i.fetch(e)}).map(function(t){return w.from(rb(Be($v(jo("menu-value"),t,function(t){i.onItemAction(o(e),t)},i.columns,i.presets,op.CLOSE_ON_EXECUTE,i.select.getOr(a),u),{movement:Kv(i.columns,i.presets),menuBehaviours:Hp("auto"!==i.columns?[]:[Kr(function(e,t){zp(e,4,gp(i.presets)).each(function(t){gm.setGridSize(e,t.numRows,t.numColumns)})})])})))})}),parts:{menu:bp(0,0,t.presets)},components:[o_.parts.button(f_(t.icon,t.text,w.none(),w.some(c),w.some([Lm.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),o_.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Sg("chevron-down",n.providers.icons)},buttonBehaviours:_a([jh(n.providers.isDisabled),zh()])}),o_.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)}),grouptoolbarbutton:K_(function(e){return ft("GroupToolbarButton",qO,e)},function(e,t,n){var r,o,i,u,a,c=n.ui.registry.getAll().buttons,s=((r={})[cc]=t.backstage.shared.header.isPositionedAtTop()?ku.TopToBottom:ku.BottomToTop,r);switch(kh(n)){case np.floating:return i=function(e){return Q_(n,{buttons:c,toolbar:e,allowToolbarGroups:!1},t,w.none())},u=s,sO.sketch({lazySink:(a=t.backstage.shared).getSink,fetch:function(){return ey(function(e){e(H(i(o.items),zO))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:f_((o=e).icon,o.text,o.tooltip,w.none(),w.none(),a.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:u}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(e,t){return n=e,o=l({type:"advanced"},(r=t.backstage).styleselect),k_(n,r,$_(n,o));var n,r,o},fontsizeSelectButton:function(e,t){return k_(n=e,t.backstage,z_(n));var n},fontSelectButton:function(e,t){return k_(n=e,t.backstage,I_(n));var n},formatButton:function(e,t){return k_(n=e,t.backstage,G_(n));var n},alignMenuButton:function(e,t){return k_(n=e,t.backstage,D_(n));var n}},J_={styleselect:Y_.styleSelectButton,fontsizeselect:Y_.fontsizeSelectButton,fontselect:Y_.fontSelectButton,formatselect:Y_.formatButton,align:Y_.alignMenuButton},Q_=function(e,t,n,r){var o=function(e){var t,n,r,o=e.toolbar;return!1===o?[]:void 0===o||!0===o?(n=e.buttons,r=H(X_,function(e){var t=U(e.items,function(e){return Te(n,e)||Te(J_,e)});return{name:e.name,items:t}}),U(r,function(e){return 0<e.items.length})):k(o)?(t=o.split("|"),H(t,function(e){return{items:e.trim().split(" ")}})):N(o,function(e){return Te(e,"name")&&Te(e,"items")})?o:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(t),i=H(o,function(o){var i=K(o.items,function(o){return 0===o.trim().length?[]:function(e,t,n,r,o,i){return _e(t,n.toLowerCase()).orThunk(function(){return i.bind(function(e){return oe(e,function(e){return _e(t,e+n.toLowerCase())})})}).fold(function(){return _e(J_,n.toLowerCase()).map(function(t){return t(e,o)}).orThunk(function(){return w.none()})},function(t){return"grouptoolbarbutton"!==t.type||r?(u=o,a=e,_e(Y_,(i=t).type).fold(function(){return console.error("skipping button defined by",i),w.none()},function(e){return w.some(e(i,u,a))})):(console.warn("Ignoring the '"+n+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),w.none());var i,u,a})}(e,t.buttons,o,t.allowToolbarGroups,n,r).toArray()});return{title:w.from(e.translate(o.name)),items:i}});return U(i,function(e){return 0<e.items.length})},Z_={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},eT={maxHeightFunction:Ja(),maxWidthFunction:qk()},tT={onLtr:function(){return[fa,da,sa,aa,la,ca,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[fa,da,la,ca,sa,aa,vg,bg,hg,gg,pg,mg]}},nT={onLtr:function(){return[da,aa,ca,sa,la,fa,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[da,ca,aa,la,sa,fa,vg,bg,hg,gg,pg,mg]}},rT=function(t,n,r,o){var i,u,a=Nn().deviceType.isTouch,c=zi((i={sink:r,onEscape:function(){return t.focus(),w.some(!0)}},u=Yt([]),ag.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(e){u.set([]),ag.getContent(e).each(function(e){Bi(e.element,"visibility")}),pi(e.element,C_),Bi(e.element,"width")},inlineBehaviours:_a([xm("context-toolbar-events",[Xr(or(),function(e,t){pi(e.element,C_),Bi(e.element,"width")}),jr(w_,function(e,t){var n=e.element;Bi(n,"width");var r=Ji(n);ag.setContent(e,t.event.contents),gi(n,C_);var o=Ji(n);Oi(n,"width",r+"px"),ag.getContent(e).each(function(e){t.event.focus.bind(function(e){return Pa(e),Ia(n)}).orThunk(function(){return gm.focusIn(e),Ma(bo(n))})}),yg.setTimeout(function(){Oi(e.element,"width",o+"px")},0)}),jr(y_,function(e,t){ag.getContent(e).each(function(t){u.set(u.get().concat([{bar:t,focus:Ma(bo(e.element))}]))}),Pr(e,w_,{contents:t.event.forwardContents,focus:w.none()})}),jr(x_,function(e,t){ne(u.get()).each(function(t){u.set(u.get().slice(0,u.get().length-1)),Pr(e,w_,{contents:Hi(t.bar),focus:t.focus})})})]),gm.config({mode:"special",onEscape:function(e){return ne(u.get()).fold(function(){return i.onEscape()},function(t){return Dr(e,x_),w.some(!0)})}})]),lazySink:function(){return ae.value(i.sink)}}))),s=function(){return v_(t,o.backstage.shared)},f=function(){if(a()&&o.backstage.isContextMenuOpen())return!0;var e,n,r,i,u=(e=h.get().filter(function(e){return xi(tn(e))}).map(function(e){return e.getBoundingClientRect()}).getOrThunk(function(){return t.selection.getRng().getBoundingClientRect()}),n=t.inline?nu().top:fu(tn(t.getBody())).y,{y:e.top+n,bottom:e.bottom+n}),c=s();return r=u.bottom,i=c.bottom,!(Math.max(u.y,c.y)<=Math.min(r,i))},d=function(){p.set(w.none()),ag.hide(c)},m=function(){ag.hide(c)},g=function(){p.get().each(function(e){var t=c.element;Bi(t,"display"),f()?Oi(t,"display","none"):ls.positionWithinBounds(r,e,c,w.some(s()))})},p=Yt(w.none()),h=Yt(w.none()),v=Yt(null),b=function(e){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:_a([gm.config({mode:"acyclic"}),xm("pop-dialog-wrap-events",[Kr(function(e){t.shortcuts.add("ctrl+F9","focus statusbar",function(){return gm.focusIn(e)})}),Yr(function(e){t.shortcuts.remove("ctrl+F9")})])])}},y=Pe(function(){return function(e,t){var n={},r=[],o=[],i={},u={},a=function(e,a){var c=dt(ft("ContextForm",ep,a));(n[e]=c).launch.map(function(n){i["form:"+e]=l(l({},a.launch),{type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:function(){t(c)}})}),"editor"===c.scope?o.push(c):r.push(c),u[e]=c},c=be(e);return V(c,function(t){var n=e[t];"contextform"===n.type?a(t,n):"contexttoolbar"===n.type&&function(e,t){ft("ContextToolbar",tp,t).each(function(n){"editor"===t.scope?o.push(n):r.push(n),u[e]=n})}(t,n)}),{forms:n,inNodeScope:r,inEditorScope:o,lookupTable:u,formNavigators:i}}(n,function(e){var t=x([e]);Pr(c,y_,{forwardContents:b(t)})})}),x=function(e){var n=t.ui.registry.getAll().buttons,r=y(),i=l(l({},n),r.formNavigators),u=kh(t)===np.scrolling?np.scrolling:np.default,a=X(H(e,function(e){return"contexttoolbar"===e.type?Q_(t,{buttons:i,toolbar:e.items,allowToolbarGroups:!1},o,w.some(["form:"])):h_(e,o.backstage.shared.providers)}));return WO({type:u,uid:jo("context-toolbar"),initGroups:a,onEscape:w.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};t.on("contexttoolbar-show",function(e){var n=y();_e(n.lookupTable,e.toolbarKey).each(function(n){C([n],e.target===t?w.none():w.some(e)),ag.getContent(c).each(gm.focusIn)})});var C=function(e,t){var n,r,i,u;k(),a()&&o.backstage.isContextMenuOpen()||(n=x(e),r=t.map(tn),i=function(e,t){var n,r,i="node"===e?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor();return Be(i,(n=e,r=a(),"line"===n?{bubble:ec(12,0,Z_),layouts:{onLtr:function(){return[ma]},onRtl:function(){return[ga]}},overrides:eT}:{bubble:ec(0,12,Z_),layouts:r?nT:tT,overrides:eT}))}(e[0].position,r),p.set(w.some(i)),h.set(t),Bi(u=c.element,"display"),ag.showWithinBounds(c,i,b(n),function(){return w.some(s())}),f()&&Oi(u,"display","none"))},S=function(){var e,n,r,o,i,u,a;t.hasFocus()&&(e=y(),n=e,i=tn((r=t).getBody()),u=function(e){return Pn(e,i)},a=tn(r.selection.getNode()),(u(o=a)||Mn(i,o)?function(e,t,n){var r=b_(e,t);if(0<r.contextForms.length)return w.some({elem:e,toolbars:[r.contextForms[0]]});var o=b_(e,n);if(0<o.contextForms.length)return w.some({elem:e,toolbars:[o.contextForms[0]]});if(0<r.contextToolbars.length||0<o.contextToolbars.length){var i=function(e){if(e.length<=1)return e;var t=function(t){return L(e,function(e){return e.position===t})},n=function(t){return U(e,function(e){return e.position===t})},r=t("selection"),o=t("node");if(r||o){if(o&&r){var i=n("node"),u=H(n("selection"),function(e){return l(l({},e),{position:"node"})});return i.concat(u)}return n(r?"selection":"node")}return n("line")}(r.contextToolbars.concat(o.contextToolbars));return w.some({elem:e,toolbars:i})}return w.none()}(a,n.inNodeScope,n.inEditorScope).orThunk(function(){return function(e,t,n){return e(t)?w.none():Ln(t,function(e){var t=b_(e,n.inNodeScope),r=t.contextForms,o=0<r.length?r:function(e){if(e.length<=1)return e;var t=function(t){return G(e,function(e){return e.position===t})};return t("selection").orThunk(function(){return t("node")}).orThunk(function(){return t("line")}).map(function(e){return e.position}).fold(function(){return[]},function(t){return U(e,function(e){return e.position===t})})}(t.contextToolbars);return 0<o.length?w.some({elem:e,toolbars:o}):w.none()},e)}(u,a,n)}):w.none()).fold(d,function(e){C(e.toolbars,w.some(e.elem.dom))}))},k=function(){var e=v.get();null!==e&&(yg.clearTimeout(e),v.set(null))},O=function(){k(),v.set(yg.setEditorTimeout(t,S,0))};t.on("init",function(){t.on(Gk,m),t.on("ScrollContent ScrollWindow longpress",g),t.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){O()}),t.on("focusout",function(e){yg.setEditorTimeout(t,function(){Ia(r.element).isNone()&&Ia(c.element).isNone()&&d()},0)}),t.on("SwitchMode",function(){t.mode.isReadOnly()&&d()}),t.on("AfterProgressState",function(e){e.state?d():t.hasFocus()&&O()}),t.on("NodeChange",function(t){Ia(c.element).fold(O,e)})})},oT=Xl,iT=Nl,uT=n([Ht("shell",!1),_t("makeItem"),Ht("setupItem",e),nl("listBehaviours",[ym])]),aT=El({name:"items",overrides:function(){return{behaviours:_a([ym.config({})])}}}),cT=n([aT]),sT=tf({name:n("CustomList")(),configFields:uT(),partFields:cT(),factory:function(e,t,n,r){var o=e.shell?{behaviours:[ym.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:o.components,behaviours:tl(e.listBehaviours,o.behaviours),apis:{setItems:function(t,n){(function(t){return e.shell?w.some(t):Hl(t,e,"items")})(t).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(r){var o=ym.contents(r),i=n.length,u=i-o.length,a=0<u?F(u,function(){return e.makeItem()}):[],c=o.slice(i);V(c,function(e){return ym.remove(r,e)}),V(a,function(e){return ym.append(r,e)});var s=ym.contents(r);V(s,function(r,o){e.setupItem(t,r,n[o],o)})})}}}},apis:{setItems:function(e,t,n){e.setItems(t,n)}}}),lT=n([]),fT=Object.freeze({__proto__:null,setup:e,isDocked:a,getBehaviours:lT}),dT=function(e){return(Ri(e,"position").is("fixed")?w.none():fo(e)).orThunk(function(){var t=Zt("span");return so(e).bind(function(e){Oo(e,t);var n=fo(t);return Eo(t),n})})},mT=function(e){return dT(e).map(Xi).getOrThunk(function(){return Gi(0,0)})},gT=Ae([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),pT=function(e,t){var n=e.element;gi(n,t.transitionClass),pi(n,t.fadeOutClass),gi(n,t.fadeInClass),t.onShow(e)},hT=function(e,t){var n=e.element;gi(n,t.transitionClass),pi(n,t.fadeInClass),gi(n,t.fadeOutClass),t.onHide(e)},vT=function(e,t,n){return Y(e,function(e){switch(e){case"bottom":return t.bottom<=n.bottom;case"top":return t.y>=n.y}})},bT=function(e,t){return t.getInitialPosition().map(function(t){return su(t.bounds.x,t.bounds.y,Ji(e),Ui(e))})},yT=function(e,t,n){return n.getInitialPosition().bind(function(r){switch(n.setInitialPosition(w.none()),r.position){case"static":return w.some(gT.static());case"absolute":var o=dT(e).map(lu).getOrThunk(function(){return lu(wi())});return w.some(gT.absolute(Fa("absolute",_e(r.style,"left").map(function(e){return t.x-o.x}),_e(r.style,"top").map(function(e){return t.y-o.y}),_e(r.style,"right").map(function(e){return o.right-t.right}),_e(r.style,"bottom").map(function(e){return o.bottom-t.bottom}))));default:return w.none()}})},xT=function(e,t){V(["left","right","top","bottom","position"],function(t){return Bi(e.element,t)}),t.onUndocked(e)},wT=function(e,t,n){za(e.element,n),("fixed"===n.position?t.onDocked:t.onUndocked)(e)},CT=function(e,t,n,r,o){void 0===o&&(o=!1),t.contextual.each(function(t){t.lazyContext(e).each(function(i){var u,a,c=(u=i).y<(a=r).bottom&&u.bottom>a.y;c!==n.isVisible()&&(n.setVisible(c),o&&!c?(vi(e.element,[t.fadeOutClass]),t.onHide(e)):(c?pT:hT)(e,t))})})},ST=function(e,t,n){var r,o,i,u,a;e.getSystem().isConnected()&&(i=n,u=(o=t).lazyViewport(r=e),(a=i.isDocked())&&CT(r,o,i,u),function(e,t,n){var r,o,i,u=e.element;return Ri(u,"position").is("fixed")?(o=t,bT(r=u,i=n).filter(function(e){return vT(i.getModes(),e,o)}).bind(function(e){return yT(r,e,i)})):function(e,t,n){var r=lu(e);if(vT(n.getModes(),r,t))return w.none();!function(e,t,n){n.setInitialPosition(w.some({style:function(e){var t={},n=e.dom;if(yi(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t}(e),position:Ei(e,"position")||"static",bounds:t}))}(e,r,n);var o=du(),i=t.y-o.y,u=o.bottom-t.bottom,a=r.y<=t.y;return w.some(gT.fixed(Fa("fixed",w.some(r.x-o.x),a?w.some(i):w.none(),w.none(),a?w.none():w.some(u))))}(u,t,n)}(r,u,i).each(function(e){i.setDocked(!a),e.fold(function(){return xT(r,o)},function(e){return wT(r,o,e)},function(e){CT(r,o,i,u,!0),wT(r,o,e)})}))},kT=function(t,n,r){r.isDocked()&&function(t,n,r){var o,i,u=t.element;r.setDocked(!1),bT(i=t.element,o=r).bind(function(e){return yT(i,e,o)}).each(function(r){r.fold(function(){return xT(t,n)},function(e){return wT(t,n,e)},e)}),r.setVisible(!0),n.contextual.each(function(e){bi(u,[e.fadeInClass,e.fadeOutClass,e.transitionClass]),e.onShow(t)}),ST(t,n,r)}(t,n,r)},OT=Object.freeze({__proto__:null,refresh:ST,reset:kT,isDocked:function(e,t,n){return n.isDocked()},getModes:function(e,t,n){return n.getModes()},setModes:function(e,t,n,r){return n.setModes(r)}}),_T=Object.freeze({__proto__:null,events:function(e,t){return zr([Xr(or(),function(n,r){e.contextual.each(function(e){hi(n.element,e.transitionClass)&&(bi(n.element,[e.transitionClass,e.fadeInClass]),(t.isVisible()?e.onShown:e.onHidden)(n)),r.stop()})}),jr(wr(),function(n,r){ST(n,e,t)}),jr(Cr(),function(n,r){kT(n,e,t)})])}}),TT=[zt("contextual",[Et("fadeInClass"),Et("fadeOutClass"),Et("transitionClass"),Rt("lazyContext"),Lu("onShow"),Lu("onShown"),Lu("onHide"),Lu("onHidden")]),Gt("lazyViewport",du),$t("modes",["top","bottom"],xt),Lu("onDocked"),Lu("onUndocked")],ET=Ea({fields:TT,name:"docking",active:_T,apis:OT,state:Object.freeze({__proto__:null,init:function(e){var t=Yt(!1),n=Yt(!0),r=Yt(w.none()),o=Yt(e.modes);return ii({isDocked:t.get,setDocked:t.set,getInitialPosition:r.get,setInitialPosition:r.set,isVisible:n.get,setVisible:n.set,getModes:o.get,setModes:o.set,readState:function(){return"docked:  "+t.get()+", visible: "+n.get()+", modes: "+o.get().join(",")}})}})}),AT={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},RT="tox-tinymce--toolbar-sticky-on",NT="tox-tinymce--toolbar-sticky-off",BT=function(e){var t=e.element;so(t).each(function(n){var r,o,i="padding-"+ET.getModes(e)[0];ET.isDocked(e)?(r=Ji(n),Oi(t,"width",r+"px"),Oi(n,i,Wi(o=t)+(parseInt(Ei(o,"margin-top"),10)||0)+(parseInt(Ei(o,"margin-bottom"),10)||0)+"px")):(Bi(t,"width"),Bi(n,i))})},DT=function(e,t){t?(pi(e,AT.fadeOutClass),vi(e,[AT.transitionClass,AT.fadeInClass])):(pi(e,AT.fadeInClass),vi(e,[AT.fadeOutClass,AT.transitionClass]))},PT=function(e,t){var n=tn(e.getContainer());t?(gi(n,RT),pi(n,NT)):(gi(n,NT),pi(n,RT))},MT=function(e,t){var n,r=Yt(w.none()),o=t.getSink,i=function(e){o().each(function(t){return e(t.element)})},u=function(t){e.inline||BT(t),PT(e,ET.isDocked(t)),t.getSystem().broadcastOn([Ps()],{}),o().each(function(e){return e.getSystem().broadcastOn([Ps()],{})})},a=e.inline?[]:[Ba.config({channels:((n={})[LO()]={onReceive:BT},n)})];return d([Om.config({}),ET.config({contextual:l({lazyContext:function(t){var n=Wi(t.element),r=e.inline?e.getContentAreaContainer():e.getContainer(),o=lu(tn(r)),i=o.height-n,u=o.y+(I(ET.getModes(t),"top")?0:n);return w.some(su(o.x,u,o.width,i))},onShow:function(){i(function(e){return DT(e,!0)})},onShown:function(e){i(function(e){return bi(e,[AT.transitionClass,AT.fadeInClass])}),r.get().each(function(t){var n,o,i;n=e.element,i=io(o=t),Ma(i).filter(function(e){return!Pn(o,e)}).filter(function(e){return Pn(e,tn(i.dom.body))||Mn(n,e)}).each(function(){return Pa(o)}),r.set(w.none())})},onHide:function(e){var t;r.set((t=o,Ia(e.element).orThunk(function(){return t().toOptional().bind(function(e){return Ia(e.element)})}))),i(function(e){return DT(e,!1)})},onHidden:function(){i(function(e){return bi(e,[AT.transitionClass])})}},AT),modes:[t.header.getDockingMode()],onDocked:u,onUndocked:u})],a)},IT=Object.freeze({__proto__:null,setup:function(e,t,n){e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",function(){n().each(ET.reset)}),e.on("ResizeWindow ResizeEditor",function(){n().each(BT)}),e.on("SkinLoaded",function(){n().each(function(e){ET.isDocked(e)?ET.reset(e):ET.refresh(e)})}),e.on("FullscreenStateChanged",function(){n().each(ET.reset)})),e.on("AfterScrollIntoView",function(e){n().each(function(t){ET.refresh(t);var n,r,o,i,u,a,c,s,l,f,d,m,g,p,h,v,b=t.element;cd(b)&&(n=e,i=(o=io(r=b)).dom.defaultView.innerHeight,u=nu(o),a=tn(n.elm),c=fu(a),s=Ui(a),f=(l=c.y)+s,d=Xi(r),m=Ui(r),p=(g=d.top)+m,h=Math.abs(g-u.top)<2,v=Math.abs(p-(u.top+i))<2,h&&l<p?ru(u.left,l-m,o):v&&g<f&&ru(u.left,l-i+s+m,o))})}),e.on("PostRender",function(){PT(e,!1)})},isDocked:function(e){return e().map(ET.isDocked).getOr(!1)},getBehaviours:MT}),LT=ef({factory:function(e,t){var n={focus:gm.focusIn,setMenus:function(e,n){var r=H(n,function(e){var n=XO({type:"menubutton",text:e.text,fetch:function(t){t(e.getItems())}}).mapError(function(e){return gt(e)}).getOrDie();return tS(n,"tox-mbtn",t.backstage,w.some("menuitem"))});ym.set(e,r)}};return{uid:e.uid,dom:e.dom,components:[],behaviours:_a([ym.config({}),xm("menubar-events",[Kr(function(t){e.onSetup(t)}),jr(Yn(),function(e,t){xu(e.element,".tox-mbtn--active").each(function(n){wu(t.event.target,".tox-mbtn").each(function(t){Pn(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(e){Py.expand(e),Py.close(n),Om.focus(e)})})})})}),jr(Tr(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(e){Py.isOpen(n)&&(Py.expand(e),Py.close(n))})})})]),gm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return e.onEscape(t),w.some(!0)}}),_b.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[_t("dom"),_t("uid"),_t("onEscape"),_t("backstage"),Ht("onSetup",e)],apis:{focus:function(e,t){e.focus(t)},setMenus:function(e,t,n){e.setMenus(t,n)}}}),FT="container",zT=[Zs("slotBehaviours",[])],HT=function(e){return"<alloy.field."+e+">"},VT=function(e,t){var n,r=function(t){return Wl(e)},o=function(t,n){return function(r,o){return Hl(r,e,o).map(function(e){return t(e,o)}).getOr(n)}},i=function(e,t){return"true"!==Po(e.element,"aria-hidden")},u=o(i,!1),a=o(function(e,t){var n;i(e)&&(Oi(n=e.element,"display","none"),Do(n,"aria-hidden","true"),Pr(e,Er(),{name:t,visible:!1}))}),c=o(function(e,t){var n;i(e)||(Bi(n=e.element,"display"),Lo(n,"aria-hidden"),Pr(e,Er(),{name:t,visible:!0}))}),s={getSlotNames:r,getSlot:function(t,n){return Hl(t,e,n)},isShowing:u,hideSlot:n=a,hideAllSlots:function(e){return function(e,t){V(t,function(t){return n(e,t)})}(e,r())},showSlot:c};return{uid:e.uid,dom:e.dom,components:t,behaviours:el(e.slotBehaviours),apis:s}},jT=we({getSlotNames:function(e,t){return e.getSlotNames(t)},getSlot:function(e,t,n){return e.getSlot(t,n)},isShowing:function(e,t,n){return e.isShowing(t,n)},hideSlot:function(e,t,n){return e.hideSlot(t,n)},hideAllSlots:function(e,t){return e.hideAllSlots(t)},showSlot:function(e,t,n){return e.showSlot(t,n)}},ri),UT=l(l({},jT),{sketch:function(e){var t,n=(t=[],{slot:function(e,n){return t.push(e),Ml(FT,HT(e),n)},record:function(){return t}}),r=e(n),o=n.record(),i=H(o,function(e){return _l({name:e,pname:HT(e)})});return Yl(FT,zT,i,VT,r)}}),WT=Qe([Lt("icon"),Lt("tooltip"),Gt("onShow",e),Gt("onHide",e),Gt("onSetup",function(){return e})]),qT=function(e){return{element:function(){return e.element.dom}}},GT=function(t,n){var r=H(be(n),function(e){var t=dt(ft("sidebar",WT,n[e]));return{name:e,getApi:qT,onSetup:t.onSetup,onShow:t.onShow,onHide:t.onHide}});return H(r,function(n){var o=Yt(e);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Hp([qh(n,o),Gh(n,o),jr(Er(),function(e,t){var n=t.event;G(r,function(e){return e.name===n.name}).each(function(t){(n.visible?t.onShow:t.onHide)(t.getApi(e))})})])})})},$T=function(e){return cf.getCurrent(e).bind(function(e){return NO.isGrowing(e)||NO.hasGrown(e)?cf.getCurrent(e).bind(function(e){return G(UT.getSlotNames(e),function(t){return UT.isShowing(e,t)})}):w.none()})},XT=jo("FixSizeEvent"),KT=jo("AutoSizeEvent"),YT=function(e){var t,n,r=Qt(e),o=mo(r),i=(n=void 0!==(t=r).dom.attributes?t.dom.attributes:[],q(n,function(e,t){var n;return"class"===t.name?e:l(l({},e),((n={})[t.name]=t.value,n))},{})),u=Array.prototype.slice.call(r.dom.classList,0),a=0===o.length?{}:{innerHtml:Ro(r)};return l({tag:Zr(r),classes:u,attributes:i},a)},JT=iT.optional({factory:LT,name:"menubar",schema:[_t("backstage")]}),QT=iT.optional({factory:{sketch:function(e){return sT.sketch({uid:e.uid,dom:e.dom,listBehaviours:_a([gm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return WO({type:e.type,uid:jo("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:function(){return e.onEscape(),w.some(!0)}})},setupItem:function(e,t,n,r){Kk.setGroups(t,n)},shell:!0})}},name:"multiple-toolbar",schema:[_t("dom"),_t("onEscape")]}),ZT=iT.optional({factory:{sketch:function(e){var t;return((t=e).type===np.sliding?UO:t.type===np.floating?jO:WO)({type:e.type,uid:e.uid,onEscape:function(){return e.onEscape(),w.some(!0)},cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes})}},name:"toolbar",schema:[_t("dom"),_t("onEscape"),_t("getSink")]}),eE=iT.optional({factory:{sketch:function(e){return{uid:e.uid,dom:e.dom,components:e.components,behaviours:_a((e.sticky?MT:lT)(e.editor,e.sharedBackstage))}}},name:"header",schema:[_t("dom")]}),tE=iT.optional({name:"socket",schema:[_t("dom")]}),nE=iT.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:_a([_b.config({}),Om.config({}),NO.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(e){cf.getCurrent(e).each(UT.hideAllSlots),Dr(e,KT)},onGrown:function(e){Dr(e,KT)},onStartGrow:function(e){Pr(e,XT,{width:Ri(e.element,"width").getOr("")})},onStartShrink:function(e){Pr(e,XT,{width:Ji(e.element)+"px"})}}),ym.config({}),cf.config({find:function(e){var t=ym.contents(e);return te(t)}})])}],behaviours:_a([Pw(0),xm("sidebar-sliding-events",[jr(XT,function(e,t){Oi(e.element,"width",t.event.width)}),jr(KT,function(e,t){Bi(e.element,"width")})])])}}},name:"sidebar",schema:[_t("dom")]}),rE=iT.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:_a([ym.config({})]),components:[]}}},name:"throbber",schema:[_t("dom")]}),oE=tf({name:"OuterContainer",factory:function(e,t,n){var r={getSocket:function(t){return oT.getPart(t,e,"socket")},setSidebar:function(t,n){oT.getPart(t,e,"sidebar").each(function(e){return function(e,t){cf.getCurrent(e).each(function(e){return ym.set(e,[(n=t,UT.sketch(function(e){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:GT(e,n),slotBehaviours:Hp([Kr(function(e){return UT.hideAllSlots(e)})])}}))]);var n})}(e,n)})},toggleSidebar:function(t,n){oT.getPart(t,e,"sidebar").each(function(e){return t=n,void cf.getCurrent(e).each(function(e){cf.getCurrent(e).each(function(n){NO.hasGrown(e)?UT.isShowing(n,t)?NO.shrink(e):(UT.hideAllSlots(n),UT.showSlot(n,t)):(UT.hideAllSlots(n),UT.showSlot(n,t),NO.grow(e))})});var t})},whichSidebar:function(t){return oT.getPart(t,e,"sidebar").bind($T).getOrNull()},getHeader:function(t){return oT.getPart(t,e,"header")},getToolbar:function(t){return oT.getPart(t,e,"toolbar")},setToolbar:function(t,n){oT.getPart(t,e,"toolbar").each(function(e){e.getApis().setGroups(e,n)})},setToolbars:function(t,n){oT.getPart(t,e,"multiple-toolbar").each(function(e){sT.setItems(e,n)})},refreshToolbar:function(t){oT.getPart(t,e,"toolbar").each(function(e){return e.getApis().refresh(e)})},toggleToolbarDrawer:function(t){oT.getPart(t,e,"toolbar").each(function(e){var t,n;n=function(t){return t(e)},null!=(t=e.getApis().toggle)?w.some(n(t)):w.none()})},isToolbarDrawerToggled:function(t){return oT.getPart(t,e,"toolbar").bind(function(e){return w.from(e.getApis().isOpen).map(function(t){return t(e)})}).getOr(!1)},getThrobber:function(t){return oT.getPart(t,e,"throbber")},focusToolbar:function(t){oT.getPart(t,e,"toolbar").orThunk(function(){return oT.getPart(t,e,"multiple-toolbar")}).each(function(e){gm.focusIn(e)})},setMenubar:function(t,n){oT.getPart(t,e,"menubar").each(function(e){LT.setMenus(e,n)})},focusMenubar:function(t){oT.getPart(t,e,"menubar").each(function(e){LT.focus(e)})}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},configFields:[_t("dom"),_t("behaviours")],partFields:[eE,JT,ZT,QT,tE,nE,rE],apis:{getSocket:function(e,t){return e.getSocket(t)},setSidebar:function(e,t,n){e.setSidebar(t,n)},toggleSidebar:function(e,t,n){e.toggleSidebar(t,n)},whichSidebar:function(e,t){return e.whichSidebar(t)},getHeader:function(e,t){return e.getHeader(t)},getToolbar:function(e,t){return e.getToolbar(t)},setToolbar:function(e,t,n){var r=H(n,zO);e.setToolbar(t,r)},setToolbars:function(e,t,n){var r=H(n,function(e){return H(e,zO)});e.setToolbars(t,r)},refreshToolbar:function(e,t){return e.refreshToolbar(t)},toggleToolbarDrawer:function(e,t){e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(e,t){return e.isToolbarDrawerToggled(t)},getThrobber:function(e,t){return e.getThrobber(t)},setMenubar:function(e,t,n){e.setMenubar(t,n)},focusMenubar:function(e,t){e.focusMenubar(t)},focusToolbar:function(e,t){e.focusToolbar(t)}}}),iE={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},uE=function(e){return"string"==typeof e?e.split(" "):e},aE=function(e,t){var n=l(l({},iE),t.menus),r=0<be(t.menus).length,o=uE(void 0===t.menubar||!0===t.menubar?"file edit view insert format tools table help":!1===t.menubar?"":t.menubar),i=U(o,function(e){return r&&t.menus.hasOwnProperty(e)&&t.menus[e].hasOwnProperty("items")||iE.hasOwnProperty(e)}),u=H(i,function(r){var o,i,u,a=n[r];return o={title:a.title,items:uE(a.items)},i=t,u=e.getParam("removed_menuitems","").split(/[ ,]/),{text:o.title,getItems:function(){return K(o.items,function(e){var t=e.toLowerCase();return 0===t.trim().length||L(u,function(e){return e===t})?[]:"separator"===t||"|"===t?[{type:"separator"}]:i.menuItems[t]?[i.menuItems[t]]:[]})}}});return U(u,function(e){return 0<e.getItems().length&&L(e.getItems(),function(e){return"separator"!==e.type})})},cE=function(e){var t=function(){e._skinLoaded=!0,e.fire("SkinLoaded")};return function(){e.initialized?t():e.on("init",t)}},sE=function(e,t,n){return new Pg(function(r,o){n.load(t,r,o),e.on("remove",function(){return n.unload(t)})})},lE=function(e,t){var n;return n=tn(e.getElement()),xo(n).isSome()?sE(e,t+"/skin.shadowdom.min.css",Kp.DOM.styleSheetLoader):Pg.resolve()},fE=function(e,t){var n,r,o,i,u,a=(o=(n=t).getParam("skin"),i=n.getParam("skin_url"),!1!==o&&(r=o||"oxide",i=i?n.documentBaseURI.toAbsolute(i):fh.baseURL+"/skins/ui/"+r),i);a&&t.contentCSS.push(a+(e?"/content.inline":"/content")+".min.css"),0==(!1===t.getParam("skin"))&&k(a)?Pg.all([sE(u=t,a+"/skin.min.css",u.ui.styleSheetLoader),lE(t,a)]).then(cE(t),function(e,t){return function(){return e.fire("SkinLoadError",{message:"Skin could not be loaded"})}}(t)):cE(t)()},dE=o(fE,!1),mE=o(fE,!0),gE=function(e,t,n,r){var o,i=t.outerContainer,u=n.toolbar,a=n.buttons;N(u,k)?(o=u.map(function(t){return Q_(e,{toolbar:t,buttons:a,allowToolbarGroups:n.allowToolbarGroups},{backstage:r},w.none())}),oE.setToolbars(i,o)):oE.setToolbar(i,Q_(e,n,{backstage:r},w.none()))},pE=Nn(),hE=pE.os.isiOS()&&pE.os.version.major<=12,vE=Object.freeze({__proto__:null,render:function(e,t,n,r,o){var i=Yt(0),u=t.outerContainer;dE(e);var a=tn(o.targetNode),c=yo(bo(a));ws(a,t.mothership,So),xs(c,t.uiMothership),e.on("PostRender",function(){gE(e,t,n,r),i.set(e.getWin().innerWidth),oE.setMenubar(u,aE(e,n)),oE.setSidebar(u,n.sidebar),function(e,t){var n=e.dom,r=e.getWin(),o=e.getDoc().documentElement,i=Yt(Gi(r.innerWidth,r.innerHeight)),u=Yt(Gi(o.offsetWidth,o.offsetHeight)),a=function(){var t=i.get();t.left===r.innerWidth&&t.top===r.innerHeight||(i.set(Gi(r.innerWidth,r.innerHeight)),Rv(e))},c=function(){var t=e.getDoc().documentElement,n=u.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(u.set(Gi(t.offsetWidth,t.offsetHeight)),Rv(e))},s=function(t){return e.fire("ScrollContent",t)};n.bind(r,"resize",a),n.bind(r,"scroll",s);var l=ub(tn(e.getBody()),"load",c),f=t.uiMothership.element;e.on("hide",function(){Oi(f,"display","none")}),e.on("show",function(){Bi(f,"display")}),e.on("NodeChange",c),e.on("remove",function(){l.unbind(),n.unbind(r,"resize",a),n.unbind(r,"scroll",s),r=null})}(e,t)});var s,l,f,d=oE.getSocket(u).getOrDie("Could not find expected socket element");hE&&(_i(d.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),l=function(){e.fire("ScrollContent")},f=null,s=ib(d.element,"scroll",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===f&&(f=setTimeout(function(){l.apply(null,e),f=null},20))}),e.on("remove",s.unbind)),Fh(e,t),e.addCommand("ToggleSidebar",function(t,n){oE.toggleSidebar(u,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return oE.whichSidebar(u)});var m=kh(e);return m!==np.sliding&&m!==np.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var n=e.getWin().innerWidth;n!==i.get()&&(oE.refreshToolbar(t.outerContainer),i.set(n))}),{iframeContainer:d.element.dom,editorContainer:u.element.dom,api:{enable:function(){Lh(t,!1)},disable:function(){Lh(t,!0)},isDisabled:function(){return lh.isDisabled(u)}}}}}),bE=function(e){return/^[0-9\.]+(|px)$/i.test(""+e)?w.some(parseInt(""+e,10)):w.none()},yE=function(e){return R(e)?e+"px":e},xE=function(e,t,n){var r=t.filter(function(t){return e<t}),o=n.filter(function(t){return t<e});return r.or(o).getOr(e)},wE=function(e){var t=mh(e),n=gh(e),r=hh(e);return bE(t).map(function(e){return xE(e,n,r)})},CE=function(e,t){var n=lu(e);return{pos:t?n.y:n.bottom,bounds:n}},SE=Object.freeze({__proto__:null,render:function(e,t,n,r,o){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=Yt(null),s=tn(o.targetNode),l=function(e,t,n,r,o){var i=n.uiMothership,u=n.outerContainer,a=Kp.DOM,c=Nh(e),s=Ph(e),l=hh(e).or(wE(e)),f=r.shared.header,d=f.isPositionedAtTop,m=kh(e),g=m===np.sliding||m===np.floating,p=Yt(!1),h=function(){return p.get()&&!e.removed},v=function(e){return g?e.fold(function(){return 0},function(e){return 1<e.components().length?Ui(e.components()[1].element):0}):0},b=function(){i.broadcastOn([Ps()],{})},y=function(e){var n,r,i,a,f,m;void 0===e&&(e=!1),h()&&(c||(n=l.getOrThunk(function(){var e=bE(Ei(wi(),"margin-left")).getOr(0);return Ji(wi())-Xi(t).left+e}),Oi(o.get().element,"max-width",n+"px")),g&&oE.refreshToolbar(u),c||(r=oE.getToolbar(u),i=v(r),a=lu(t),f=d()?Math.max(a.y-Ui(o.get().element)+i,0):a.bottom,_i(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=o.get(),e?ET.reset(m):ET.refresh(m)),b())},x=function(n){var r,i;void 0===n&&(n=!0),!c&&s&&h()&&(r=f.getDockingMode(),(i=function(n){switch(Eh(e)){case Ch.auto:var r=oE.getToolbar(u),o=v(r),i=Ui(n.element)-o,a=lu(t);if(a.y>i)return"top";var c=ao(t),s=Math.max(c.dom.scrollHeight,Ui(c));return a.bottom<s-i||du().bottom<a.bottom-i?"bottom":"top";case Ch.bottom:return"bottom";case Ch.top:default:return"top"}}(o.get()))!==r&&(function(e){var t=o.get();ET.setModes(t,[e]),f.setDockingMode(e);var n=d()?ku.TopToBottom:ku.BottomToTop;Do(t.element,cc,n)}(i),n&&y(!0)))};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Oi(u.element,"display","flex"),a.addClass(e.getBody(),"mce-edit-focus"),Bi(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),n.outerContainer&&(Oi(u.element,"display","none"),a.removeClass(e.getBody(),"mce-edit-focus")),Oi(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}}(e,s,t,r,c),f=e.getParam("toolbar_persist",!1,"boolean");mE(e);var d=function(){var o;c.get()?l.show():(c.set(oE.getHeader(a).getOrDie()),o=Bh(e),xs(o,i),xs(o,u),gE(e,t,n,r),oE.setMenubar(a,aE(e,n)),l.show(),function(e,t,n,r){var o=Yt(CE(t,n.isPositionedAtTop())),i=function(r){var i=CE(t,n.isPositionedAtTop()),u=i.pos,a=i.bounds,c=o.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;o.set({pos:u,bounds:a}),f&&Rv(e,r),n.isVisible()&&(s!==u?n.update(!0):f&&(n.updateMode(),n.repositionPopups()))};r||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",function(){return n.update(!0)}),e.on("NodeChange keydown",function(e){yg.requestAnimationFrame(function(){return i(e)})}),e.on("ScrollWindow",function(){return n.updateMode()});var u=U_();u.set(ub(tn(e.getBody()),"load",i)),e.on("remove",function(){u.clear()})}(e,s,l,f),e.nodeChanged())};return e.on("show",d),e.on("hide",l.hide),f||(e.on("focus",d),e.on("blur",l.hide)),e.on("init",function(){(e.hasFocus()||f)&&d()}),Fh(e,t),{editorContainer:a.element.dom,api:{show:function(){l.show()},hide:function(){l.hide()},enable:function(){Lh(t,!1)},disable:function(){Lh(t,!0)},isDisabled:function(){return lh.isDisabled(a)}}}}}),kE={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},OE=(__="[eE][+-]?[0-9]+",E_=["Infinity",(O_="[0-9]+")+"\\."+(T_=function(e){return"(?:"+e+")?"})(O_)+T_(__),"\\."+O_+T_(__),O_+T_(__)].join("|"),new RegExp("^([+-]?(?:"+E_+"))(.*)$")),_E=function(e){return function(e,t){return w.from(OE.exec(e)).bind(function(e){var n,r=Number(e[1]),o=e[2];return n=o,L(t,function(e){return L(kE[e],function(e){return n===e})})?w.some({value:r,unit:o}):w.none()})}(e,["fixed","relative","empty"]).map(function(e){return e.value+e.unit}).getOr(e)},TE=function(e){var t=e.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),n=new Map,r=j_(),o=function(){var t=_E(e.queryCommandValue("LineHeight"));w.from(n.get(t)).fold(function(){return r.clear()},function(e){r.set({destroy:function(){e.setActive(!1)}}),e.setActive(!0)})};return e.on("nodeChange",o),H(t,function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return n.set(_E(i),a),u+1===t.length&&o(),function(){0===u&&(e.off("nodeChange",o),r.clear())}},onAction:function(){return e.execCommand("LineHeight",!1,i)}}})},EE=function(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}},AE=function(e,t,n){var r=function(){return!!t.undoManager&&t.undoManager[n]()},o=function(){e.setDisabled(t.mode.isReadOnly()||!r())};return e.setDisabled(!r()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},RE=function(e,t){return{anchor:"makeshift",x:e,y:t}},NE=function(e){return"longpress"===e.type||0===e.type.indexOf("touch")},BE=function(e,t){return"contextmenu"===t.type||"longpress"===t.type?e.inline?function(e){if(NE(e)){var t=e.touches[0];return RE(t.pageX,t.pageY)}return RE(e.pageX,e.pageY)}(t):function(e,t){var n,r=Kp.DOM.getPos(e);return RE((n=t).x+r.x,n.y+r.y)}(e.getContentAreaContainer(),function(e){if(NE(e)){var t=e.touches[0];return RE(t.clientX,t.clientY)}return RE(e.clientX,e.clientY)}(t)):DE(e)},DE=function(e){return{anchor:"selection",root:tn(e.selection.getNode())}},PE=function(e){return{anchor:"node",node:w.some(tn(e.selection.getNode())),root:tn(e.getBody())}},ME=function(e,t,n,r,o,i){var u=n(),a=i?PE(e):BE(e,t);ZC(u,op.CLOSE_ON_EXECUTE,r,!1).map(function(e){t.preventDefault(),ag.showMenuAt(o,a,{menu:{markers:hp("normal")},data:e})})},IE={onLtr:function(){return[da,aa,ca,sa,la,fa,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[da,ca,aa,la,sa,fa,vg,bg,hg,gg,pg,mg]}},LE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},FE=function(e,t,n,r,o,i){var u,a=Nn(),c=a.os.isiOS(),s=a.os.isOSX(),f=a.os.isAndroid(),d=a.deviceType.isTouch(),m=function(){var u=n();!function(e,t,n,r,o,i,u){var a,c,s=i?PE(e):(a=e,c=t,l({bubble:ec(0,12,LE),layouts:IE,overrides:{maxWidthFunction:qk(),maxHeightFunction:Ja()}},BE(a,c)));ZC(n,op.CLOSE_ON_EXECUTE,r,!0).map(function(n){t.preventDefault(),ag.showMenuWithinBounds(o,s,{menu:{markers:hp("normal"),highlightImmediately:u},data:n,type:"horizontal"},function(){return w.some(v_(e,r.shared))}),e.fire(Gk)})}(e,t,u,r,o,i,!(f||c||s&&d))};!s&&!c||i?(f&&!i&&e.selection.setCursorLocation(t.target,0),m()):(u=function(){!function(e){var t=e.selection.getRng(),n=function(){yg.setEditorTimeout(e,function(){e.selection.setRng(t)},10),i()};e.once("touchend",n);var r=function(e){e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",r,!0);var o=function(){return i()};e.once("longpresscancel",o);var i=function(){e.off("touchend",n),e.off("longpresscancel",o),e.off("mousedown",r)}}(e),m()},function(e,t){var n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;var r=t.touches[0],o=n.getRng();return Vc(e.getWin(),Ec.domRange(o)).exists(function(e){return e.left<=r.clientX&&e.right>=r.clientX&&e.top<=r.clientY&&e.bottom>=r.clientY})}(e,t)?u():(e.once("selectionchange",u),e.once("touchend",function(){return e.off("selectionchange",u)})))},zE=function(e){return"string"==typeof e?e.split(/[ ,]/):e},HE=function(e){return e.getParam("contextmenu_never_use_native",!1,"boolean")},VE=function(e){return k(e)?"|"===e:"separator"===e.type},jE={type:"separator"},UE=function(e){var t,n=function(e){return{text:e.text,icon:e.icon,disabled:e.disabled,shortcut:e.shortcut}};if(k(e))return e;switch(e.type){case"separator":return jE;case"submenu":return l(l({type:"nestedmenuitem"},n(e)),{getSubmenuItems:function(){var t=e.getSubmenuItems();return k(t)?t:H(t,UE)}});default:return l(l({type:"menuitem"},n(e)),{onAction:(t=e.onAction,function(){return t()})})}},WE=function(e,t){if(0===t.length)return e;var n=ne(e).filter(function(e){return!VE(e)}).fold(function(){return[]},function(e){return[jE]});return e.concat(n).concat(t).concat([jE])},qE=function(e,t){return"longpress"!==t.type&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType)},GE=function(e,t){return qE(e,t)?e.selection.getStart(!0):t.target},$E=function(e,t,n){var r=Nn().deviceType.isTouch,o=zi(ag.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return e.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:_a([xm("dismissContextMenu",[jr(Or(),function(t,n){Bs.close(t),e.focus()})])])})),i=function(e){return ag.hide(o)},u=function(t){var i;HE(e)&&t.preventDefault(),t.ctrlKey&&!HE(e)||!1===e.getParam("contextmenu")||(i=function(e,t){var n=e.getParam("contextmenu_avoid_overlap","","string");if(qE(e,t))return!0;if(n){var r=GE(e,t);return cb(tn(r),n)}return!1}(e,t),(r()?FE:ME)(e,t,function(){var n,r,o,i=GE(e,t),u=e.ui.registry.getAll(),a=function(e){return n=(t=e).ui.registry.getAll().contextMenus,w.from(t.getParam("contextmenu")).map(zE).getOrThunk(function(){return U(zE("link linkchecker image imagetools table spellchecker configurepermanentpen"),function(e){return Te(n,e)})});var t,n}(e);return n=u.contextMenus,r=i,0<(o=q(a,function(e,t){return _e(n,t.toLowerCase()).map(function(t){var n=t.update(r);if(k(n))return WE(e,n.split(" "));if(0<n.length){var o=H(n,UE);return WE(e,o)}return e}).getOrThunk(function(){return e.concat([t])})},[])).length&&VE(o[o.length-1])&&o.pop(),o},n,o,i))};e.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");e.on(t,i),e.on("longpress contextmenu",u)})},XE=Ae([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),KE=function(e){return function(t){return t.translate(-e.left,-e.top)}},YE=function(e){return function(t){return t.translate(e.left,e.top)}},JE=function(e){return function(t,n){return q(e,function(e,t){return t(e)},Gi(t,n))}},QE=function(e,t,n){return e.fold(JE([YE(n),KE(t)]),JE([KE(t)]),JE([]))},ZE=function(e,t,n){return e.fold(JE([YE(n)]),JE([]),JE([YE(t)]))},eA=function(e,t,n){return e.fold(JE([]),JE([KE(n)]),JE([YE(t),KE(n)]))},tA=function(e,t,n){var r=e.fold(function(e,t){return{position:w.some("absolute"),left:w.some(e+"px"),top:w.some(t+"px")}},function(e,t){return{position:w.some("absolute"),left:w.some(e-n.left+"px"),top:w.some(t-n.top+"px")}},function(e,t){return{position:w.some("fixed"),left:w.some(e+"px"),top:w.some(t+"px")}});return l({right:w.none(),bottom:w.none()},r)},nA=function(e,t,n,r){var o=function(e,o){return function(i,u){var a=e(t,n,r);return o(i.getOr(a.left),u.getOr(a.top))}};return e.fold(o(eA,rA),o(ZE,oA),o(QE,iA))},rA=XE.offset,oA=XE.absolute,iA=XE.fixed,uA=function(e,t){var n=Po(e,t);return function(e){return void 0===e}(n)?NaN:parseInt(n,10)},aA=function(e,t,n,r){return oe(e,function(e){var o,i,u,a,c,s,l;return o=e.sensor,i=e.range.left,u=e.range.top,s=ZE(t,a=n,c=r),l=ZE(o,a,c),Math.abs(s.left-l.left)<=i&&Math.abs(s.top-l.top)<=u?w.some({output:nA(e.output,t,n,r),extra:e.extra}):w.none()})},cA=function(e,t,n,r,o){var i=t.getSnapPoints(e);return aA(i,n,r,o).orThunk(function(){return q(i,function(e,t){var i,u,a,c,s,l,f,d=(i=t.sensor,c=ZE(n,u=r,a=o),s=ZE(i,u,a),l=Math.abs(c.left-s.left),f=Math.abs(c.top-s.top),Gi(l,f));return e.deltas.fold(function(){return{deltas:w.some(d),snap:w.some(t)}},function(n){return(d.left+d.top)/2<=(n.left+n.top)/2?{deltas:w.some(d),snap:w.some(t)}:e})},{deltas:w.none(),snap:w.none()}).snap.map(function(e){return{output:nA(e.output,n,r,o),extra:e.extra}})})},sA=function(e,t,n,r,o){var i=t.getSnapPoints(e);return aA(i,n,r,o)},lA=Object.freeze({__proto__:null,snapTo:function(e,t,n,r){var o,i,u,a,c,s,l=t.getTarget(e.element);t.repositionTarget&&(o=io(e.element),i=nu(o),u=mT(l),a={coord:nA((s=r).output,s.output,i,u),extra:s.extra},c=tA(a.coord,0,u),Ti(l,c))}}),fA="data-initial-z-index",dA=function(e,t){var n;e.getSystem().addToGui(t),so((n=t).element).filter(to).each(function(e){Ri(e,"z-index").each(function(t){Do(e,fA,t)}),Oi(e,"z-index",Ei(n.element,"z-index"))})},mA=function(e){so(e.element).filter(to).each(function(e){Mo(e,fA).fold(function(){return Bi(e,"z-index")},function(t){return Oi(e,"z-index",t)}),Lo(e,fA)}),e.getSystem().removeFromGui(e)},gA=function(e,t,n){return e.getSystem().build(yb.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}))},pA=zt("snaps",[_t("getSnapPoints"),Lu("onSensor"),_t("leftAttr"),_t("topAttr"),Ht("lazyViewport",du),Ht("mustSnap",!1)]),hA=[Ht("useFixed",a),_t("blockerClass"),Ht("getTarget",r),Ht("onDrag",e),Ht("repositionTarget",!0),Ht("onDrop",e),Gt("getBounds",du),pA],vA=function(e,t){return{bounds:e.getBounds(),height:Wi(t.element),width:Qi(t.element)}},bA=function(e,t,n,r,o){var i=n.update(r,o),u=n.getStartData().getOrThunk(function(){return vA(t,e)});i.each(function(n){var r,o,i,a,c,s,l,f,d,m,g;i=u,a=n,g=(o=t).getTarget((r=e).element),o.repositionTarget&&(c=io(r.element),s=nu(c),l=mT(g),f=function(e){return t=Ri(e,"left"),n=Ri(e,"top"),r=Ri(e,"position"),o=function(e,t,n){return("fixed"===n?iA:rA)(parseInt(e,10),parseInt(t,10))},(t.isSome()&&n.isSome()&&r.isSome()?w.some(o(t.getOrDie(),n.getOrDie(),r.getOrDie())):w.none()).getOrThunk(function(){var t=Xi(e);return oA(t.left,t.top)});var t,n,r,o}(g),d=function(e,t,n,r,o,i,u){var a,c,s,l,f,d,m,g,p,h=t.fold(function(){var e,t,u=(e=i.left,t=i.top,n.fold(function(n,r){return rA(n+e,r+t)},function(n,r){return oA(n+e,r+t)},function(n,r){return iA(n+e,r+t)})),a=QE(u,r,o);return iA(a.left,a.top)},function(t){var u=function(e,t,n,r,o,i){var u,a,c,s=function(e,t,n,r){return u=uA(i=e.element,(o=t).leftAttr),a=uA(i,o.topAttr),(isNaN(u)||isNaN(a)?w.none():w.some(Gi(u,a))).fold(function(){return n},function(e){return iA(e.left+r.left,e.top+r.top)});var o,i,u,a}(e,t,n,r),l=(t.mustSnap?cA:sA)(e,t,s,o,i),f=QE(s,o,i);return Do(c=e.element,(u=t).leftAttr,(a=f).left+"px"),Do(c,u.topAttr,a.top+"px"),l.fold(function(){return{coord:iA(f.left,f.top),extra:w.none()}},function(e){return{coord:e.output,extra:e.extra}})}(e,t,n,i,r,o);return u.extra.each(function(n){t.onSensor(e,n)}),u.coord});return f=(l=u).bounds,d=ZE(a=h,c=r,s=o),m=$a(d.left,f.x,f.x+f.width-l.width),g=$a(d.top,f.y,f.y+f.height-l.height),p=oA(m,g),a.fold(function(){var e=eA(p,c,s);return rA(e.left,e.top)},function(){return p},function(){var e=QE(p,c,s);return iA(e.left,e.top)})}(r,o.snaps,f,s,l,a,i),m=tA(d,0,l),Ti(g,m)),o.onDrag(r,g,a)})},yA=function(e,t,n,r){t.each(mA),n.snaps.each(function(t){!function(e,t){var n,r;Lo(r=e.element,(n=t).leftAttr),Lo(r,n.topAttr)}(e,t)});var o=n.getTarget(e.element);r.reset(),n.onDrop(e,o)},xA=function(e){return function(t,n){var r=function(e){n.setStartData(vA(t,e))};return zr(d([jr(wr(),function(e){n.getStartData().each(function(){return r(e)})})],e(t,n,r)))}},wA=Object.freeze({__proto__:null,getData:function(e){return w.from(Gi(e.x,e.y))},getDelta:function(e,t){return Gi(t.left-e.left,t.top-e.top)}}),CA=function(e,t,n){return[jr(Gn(),function(r,o){var i,u,a,c,s;0===o.event.raw.button&&(o.stop(),a={drop:i=function(){return yA(r,w.some(c),e,t)},delayDrop:(u=sb(i,200)).schedule,forceDrop:i,move:function(n){u.cancel(),bA(r,e,t,wA,n)}},c=gA(r,e.blockerClass,(s=a,zr([jr(Gn(),s.forceDrop),jr(Kn(),s.drop),jr($n(),function(e,t){s.move(t.event)}),jr(Xn(),s.delayDrop)]))),n(r),dA(r,c))})]},SA=d(hA,[Vu("dragger",{handlers:xA(CA)})]),kA=Object.freeze({__proto__:null,getData:function(e){var t,n=e.raw.touches;return 1===n.length?w.some(Gi((t=n[0]).clientX,t.clientY)):w.none()},getDelta:function(e,t){return Gi(t.left-e.left,t.top-e.top)}}),OA=function(t,n,r){var o=Yt(w.none());return[jr(jn(),function(i,u){u.stop();var a,c=function(){yA(i,o.get(),t,n),o.set(w.none())},s=gA(i,t.blockerClass,(a={drop:c,delayDrop:e,forceDrop:c,move:function(e){bA(i,t,n,kA,e)}},zr([jr(jn(),a.forceDrop),jr(Wn(),a.drop),jr(qn(),a.drop),jr(Un(),function(e,t){a.move(t.event)})])));o.set(w.some(s)),r(i),dA(i,s)}),jr(Un(),function(e,r){r.stop(),bA(e,t,n,kA,r.event)}),jr(Wn(),function(e,r){r.stop(),yA(e,o.get(),t,n),o.set(w.none())}),jr(qn(),function(e){yA(e,o.get(),t,n),o.set(w.none())})]},_A=d(hA,[Vu("dragger",{handlers:xA(OA)})]),TA=d(hA,[Vu("dragger",{handlers:xA(function(e,t,n){return d(CA(e,t,n),OA(e,t,n))})})]),EA=Ra({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:SA,touch:_A,mouseOrTouch:TA}),name:"dragging",active:{events:function(e,t){return e.dragger.handlers(e,t)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:w.from(e.extra)}}},state:Object.freeze({__proto__:null,init:function(){var e=w.none(),t=w.none(),r=n({});return ii({readState:r,reset:function(){e=w.none(),t=w.none()},update:function(t,n){return t.getData(n).bind(function(n){return r=t,o=n,i=e.map(function(e){return r.getDelta(e,o)}),e=w.some(o),i;var r,o,i})},getStartData:function(){return t},setStartData:function(e){t=w.some(e)}})}}),apis:lA}),AA=function(e,t,n,r,o,i){return e.fold(function(){return EA.snap({sensor:oA(n-20,r-20),range:Gi(o,i),output:oA(w.some(n),w.some(r)),extra:{td:t}})},function(e){var o=n-20,i=r-20,u=e.element.dom.getBoundingClientRect();return EA.snap({sensor:oA(o,i),range:Gi(40,40),output:oA(w.some(n-u.width/2),w.some(r-u.height/2)),extra:{td:t}})})},RA=function(e,t,n){return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(e,r){var o,i,u=r.td;o=t.get(),i=u,o.exists(function(e){return Pn(e,i)})||(t.set(w.some(u)),n(u))},mustSnap:!0}},NA=function(e){return wg(xg.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:_a([EA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),My.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},BA=function(e,t){var n=Yt([]),r=Yt([]),o=Yt(!1),i=Yt(w.none()),u=Yt(w.none()),a=function(e){var n=fu(e);return AA(f.getOpt(t),e,n.x,n.y,n.width,n.height)},c=function(e){var n=fu(e);return AA(d.getOpt(t),e,n.right,n.bottom,n.width,n.height)},s=RA(function(){return H(n.get(),a)},i,function(t){u.get().each(function(n){e.fire("TableSelectorChange",{start:t,finish:n})})}),l=RA(function(){return H(r.get(),c)},u,function(t){i.get().each(function(n){e.fire("TableSelectorChange",{start:n,finish:t})})}),f=NA(s),d=NA(l),m=zi(f.asSpec()),g=zi(d.asSpec()),p=function(t,n,r,o){var i=r(n);EA.snapTo(t,i),function(t,n,r,o){var i=n.dom.getBoundingClientRect();Bi(t.element,"display");var u=co(tn(e.getBody())).dom.innerHeight,a=r(i),c=o(i,u);(a||c)&&Oi(t.element,"display","none")}(t,n,function(e){return e[o]<0},function(e,t){return e[o]>t})},h=function(e){return p(m,e,a,"top")},v=function(e){return p(g,e,c,"bottom")};Nn().deviceType.isTouch()&&(e.on("TableSelectionChange",function(e){o.get()||(ps(t,m),ps(t,g),o.set(!0)),i.set(w.some(e.start)),u.set(w.some(e.finish)),e.otherCells.each(function(t){n.set(t.upOrLeftCells),r.set(t.downOrRightCells),h(e.start),v(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",function(){i.get().each(h),u.get().each(v)}),e.on("TableSelectionClear",function(){o.get()&&(bs(m),bs(g),o.set(!1)),i.set(w.none()),u.set(w.none())}))};(R_=A_=A_||{})[R_.None=0]="None",R_[R_.Both=1]="Both",R_[R_.Vertical=2]="Vertical";var DA,PA,MA=function(e,t){var n,r,o,i,u,a;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var n,r,o,i,u,a=[];return e.getParam("elementpath",!0,"boolean")&&a.push(function(e,t,n){return t.delimiter||(t.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:_a([gm.config({mode:"flow",selector:"div[role=button]"}),lh.config({disabled:n.isDisabled}),zh(),_b.config({}),ym.config({}),xm("elementPathEvents",[Kr(function(r,o){e.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return gm.focusIn(r)}),e.on("NodeChange",function(o){var i,u,a=function(t){for(var n=[],r=t.length;0<r--;){var o=t[r];if(1===o.nodeType&&!function(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1}(o)){var i=e.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(i.isDefaultPrevented()||n.push({name:i.name,element:o}),i.isPropagationStopped())break}}return n}(o.parents);ym.set(r,0<a.length?(i=H(a||[],function(t,r){return xg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":r,"tab-index":-1,"aria-level":r+1},innerHtml:t.name},action:function(n){e.focus(),e.selection.select(t.element),e.nodeChanged()},buttonBehaviours:_a([Vh(n.isDisabled),zh()])})}),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},q(i.slice(1),function(e,t){var n=e;return n.push(u),n.push(t),n},[i[0]])):[])})})])]),components:[]}}(e,{},t)),e.hasPlugin("wordcount")&&a.push((n=e,i=function(e,t,n){return ym.set(e,[Ii(r.translate(["{0} "+n,t[n]]))])},xg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:_a([Vh((r=t).isDisabled),zh(),_b.config({}),ym.config({}),Qs.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),xm("wordcount-events",[Qr(function(e){var t=Qs.getValue(e),n="words"===t.mode?"characters":"words";Qs.setValue(e,{mode:n,count:t.count}),i(e,t.count,n)}),Kr(function(e){n.on("wordCountUpdate",function(t){var n=Qs.getValue(e).mode;Qs.setValue(e,{mode:n,count:t.wordCount}),i(e,t.wordCount,n)})})])]),eventOrder:((o={})[dr()]=["disabling","alloy.base.behaviour","wordcount-events"],o)}))),e.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=Yp.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),r=!(n=e).hasPlugin("autoresize"),(a=!1===(o=n.getParam("resize",r))?A_.None:"both"===o?A_.Both:A_.Vertical)!==A_.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:Sg("resize-handle",t.icons)},behaviours:_a([EA.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,r){!function(e,t,n){var r,o,i,u,a,c,s=tn(e.getContainer()),l=(r=e,o=t,i=n,u=Ui(s),a=Ji(s),(c={}).height=xE(u+o.top,ph(r),vh(r)),i===A_.Both&&(c.width=xE(a+o.left,gh(r),hh(r))),c);xe(l,function(e,t){return Oi(s,t,yE(e)),0}),e.fire("ResizeEditor")}(e,r,i)},blockerClass:"tox-blocker"})])})),u)}},IA=function(t){var n,r,o,i,u=t.inline,a=u?SE:vE,c=Ph(t)?IT:fT,s=w.none(),f=Nn(),d=f.browser.isIE()?["tox-platform-ie"]:[],m=f.deviceType.isTouch()?["tox-platform-touch"]:[],g=Ah(t),p=Bh(t),h=Yp.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:((n={})[cc]=g?ku.BottomToTop:ku.TopToBottom,n)},b=function(){return s.bind(oE.getHeader)},y=zi((r=Pn(wi(),p)&&"grid"===Ei(p,"display"),o={dom:l({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(d).concat(m)},h),behaviours:_a([ls.config({useFixed:function(){return c.isDocked(b)}})])},i={dom:{styles:{width:document.body.clientWidth+"px"}},events:zr([jr(Cr(),function(){Oi(fe.element,"width",document.body.clientWidth+"px")})])},Be(o,r?i:{}))),x=function(){return ae.value(y)},C=wg({dom:{tag:"div",classes:["tox-anchorbar"]}}),S=function(){return s.bind(function(e){return oE.getThrobber(e)}).getOrDie("Could not find throbber element")},k=Wk(y,t,function(){return s.bind(function(e){return C.getOpt(e)}).getOrDie("Could not find a anchor bar element")}),O=oE.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:k,onEscape:function(){t.focus()}}),_=kh(t),T=oE.parts.toolbar(l({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:k.shared.providers,onEscape:function(){t.focus()},type:_,lazyToolbar:function(){return s.bind(function(e){return oE.getToolbar(e)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return b().getOrDie("Could not find header element")}},v)),E=oE.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:k.shared.providers,onEscape:function(){t.focus()},type:_}),A=oE.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),N=oE.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),B=oE.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:k}),D=t.getParam("statusbar",!0,"boolean")&&!u?w.some(MA(t,k.shared.providers)):w.none(),P={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[A,N]},M=wh(t),I=yh(t),L=bh(t),F=oE.parts.header({dom:l({tag:"div",classes:["tox-editor-header"]},v),components:X([L?[O]:[],M?[E]:I?[T]:[],Nh(t)?[]:[C.asSpec()]]),sticky:Ph(t),editor:t,sharedBackstage:k.shared}),z=X([g?[]:[F],u?[]:[P],g?[F]:[]]),H=X([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],u?[]:D.toArray(),[B]]),j=Dh(t),U=l(l({role:"application"},Yp.isRtl()?{dir:"rtl"}:{}),j?{"aria-hidden":"true"}:{}),W=zi(oE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(u?["tox-tinymce-inline"]:[]).concat(g?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(d),styles:l({visibility:"hidden"},j?{opacity:"0",border:"0"}:{}),attributes:U},components:H,behaviours:_a([zh(),lh.config({disableClass:"tox-tinymce--disabled"}),gm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));s=w.some(W),t.shortcuts.add("alt+F9","focus menubar",function(){oE.focusMenubar(W)}),t.shortcuts.add("alt+F10","focus toolbar",function(){oE.focusToolbar(W)}),t.addCommand("ToggleToolbarDrawer",function(){oE.toggleToolbarDrawer(W)}),t.addQueryStateHandler("ToggleToolbarDrawer",function(){return oE.isToolbarDrawerToggled(W)});var q,G,$,K,Y,J,Q,Z,ee,te,ne,re,oe,ie,ue,ce,se,le=xb(W),fe=xb(y);return q=t,G=le,$=fe,K=function(e,t){V([G,$],function(n){n.broadcastEvent(e,t)})},Y=function(e,t){V([G,$],function(n){n.broadcastOn([e],t)})},J=function(e){return Y(Ds(),{target:e.target})},Q=ib(tn(document),"touchstart",J),Z=ib(tn(document),"touchmove",function(e){return K(yr(),e)}),ee=ib(tn(document),"touchend",function(e){return K(xr(),e)}),te=ib(tn(document),"mousedown",J),ne=ib(tn(document),"mouseup",function(e){0===e.raw.button&&Y(Ms(),{target:e.target})}),re=function(e){return Y(Ds(),{target:tn(e.target)})},oe=function(e){0===e.button&&Y(Ms(),{target:tn(e.target)})},ie=function(e){return K(wr(),ab(e))},ue=function(e){Y(Ps(),{}),K(Cr(),ab(e))},ce=function(){return Y(Ps(),{})},se=function(e){e.state&&Y(Ds(),{target:tn(q.getContainer())})},q.on("PostRender",function(){q.on("click",re),q.on("tap",re),q.on("mouseup",oe),q.on("ScrollWindow",ie),q.on("ResizeWindow",ue),q.on("ResizeEditor",ce),q.on("AfterProgressState",se)}),q.on("remove",function(){q.off("click",re),q.off("tap",re),q.off("mouseup",oe),q.off("ScrollWindow",ie),q.off("ResizeWindow",ue),q.off("ResizeEditor",ce),q.off("AfterProgressState",se),te.unbind(),Q.unbind(),Z.unbind(),ee.unbind(),ne.unbind()}),q.on("detach",function(){Cs(G),Cs($),G.destroy(),$.destroy()}),{mothership:le,uiMothership:fe,backstage:k,renderUI:function(){var e,n,r,o,i,u,s,f;c.setup(t,k.shared,b),function(e,t){var n,r,o,i;!function(e){Fw.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return e.execCommand(t.cmd)},icon:t.icon,onSetup:W_(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return e.execCommand("JustifyNone")},icon:"align-none"})}(e),function(e){var t;(function(e){var t,n;!function(e){Fw.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:W_(e,t.name),onAction:EE(e,t.name)})});for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:W_(e,n),onAction:EE(e,n)})}}(e),t=e,Fw.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(e){t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)}})}),n=e,Fw.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(e){n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return n.execCommand(e.action)},onSetup:W_(n,e.name)})})})(e),t=e,Fw.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(e){t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:function(){return t.execCommand(e.action)}})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:EE(t,"code")})}(e),function(e,t){var n,r,o,i,u,a,c,s,f,d,m,g,p,h;o=S_(0,r=t,D_(n=e)),n.ui.registry.addNestedMenuItem("align",{text:r.shared.providers.translate("Align"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),a=S_(0,u=t,I_(i=e)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=e,f=l({type:"advanced"},(s=t).styleselect),d=S_(0,s,$_(c,f)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return d.items.validateItems(d.getStyleItems())}}),g=S_(0,t,G_(m=e)),m.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),h=S_(0,t,z_(p=e)),p.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})}(e,t),function(e){var t,n;(t=e).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(e){return AE(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(e){return AE(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}}),(n=e).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(e){return AE(e,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(e){return AE(e,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(e),function(e){!function(e){e.addCommand("mceApplyTextcolor",function(t,n){var r,o,i;o=t,i=n,(r=e).undoManager.transact(function(){r.focus(),r.formatter.apply(o,{value:i}),r.nodeChanged()})}),e.addCommand("mceRemoveTextcolor",function(t){var n,r;r=t,(n=e).undoManager.transact(function(){n.focus(),n.formatter.remove(r,{value:null},null,!0),n.nodeChanged()})})}(e);var t=Yt(null),n=Yt(null);Wv(e,"forecolor","forecolor","Text color",t),Wv(e,"backcolor","hilitecolor","Background color",n),qv(e,"forecolor","forecolor","Text color"),qv(e,"backcolor","hilitecolor","Background color")}(e),(r=n=e).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return r.execCommand("mceToggleVisualAid")}}),(o=n).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(e){return function(e,t){e.setActive(t.hasVisual);var n=function(t){e.setActive(t.hasVisual)};return t.on("VisualAid",n),function(){return t.off("VisualAid",n)}}(e,o)},onAction:function(){o.execCommand("mceToggleVisualAid")}}),(i=e).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(e){return function(e,t){e.setDisabled(!t.queryCommandState("outdent"));var n=function(){e.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}(e,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),function(e){var t,n;(t=e).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return TE(t)}}),(n=e).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(e){return e(TE(n))}})}(e)}(t,k),$E(t,x,k),n=(e=t).ui.registry.getAll().sidebars,V(be(n),function(t){var r=n[t],o=function(){return w.from(e.queryCommandValue("ToggleSidebar")).is(t)};e.ui.registry.addToggleButton(t,{icon:r.icon,tooltip:r.tooltip,onAction:function(n){e.execCommand("ToggleSidebar",!1,t),n.setActive(o())},onSetup:function(t){var n=function(){return t.setActive(o())};return e.on("ToggleSidebar",n),function(){e.off("ToggleSidebar",n)}}})}),r=t,o=S,i=k.shared,u=Yt(!1),s=Yt(w.none()),f=function(e){e!==u.get()&&(function(e,t,n){var r=e.element;!0===t?(ym.set(e,[{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:YT('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:_a([gm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Om.config({})])}]),Bi(r,"display"),Lo(r,"aria-hidden")):(ym.set(e,[]),Oi(r,"display","none"),Do(r,"aria-hidden","true"))}(o(),e,i.providers),u.set(e),r.fire("AfterProgressState",{state:e}))},r.on("ProgressState",function(e){var t;s.get().each(yg.clearTimeout),R(e.time)?(t=yg.setEditorTimeout(r,function(){return f(e.state)},e.time),s.set(w.some(t))):(f(e.state),s.set(w.none()))}),we(t.getParam("toolbar_groups",{},"object"),function(e,n){t.ui.registry.addGroupToolbarButton(n,e)});var d,m=t.ui.registry.getAll(),g=m.buttons,p=m.menuItems,h=m.contextToolbars,v=m.sidebars,C=xh(t),O={menuItems:p,menus:(d=t.getParam("menu"))?we(d,function(e){return l(l({},e),{items:e.items})}):{},menubar:t.getParam("menubar"),toolbar:C.getOrThunk(function(){return t.getParam("toolbar",!0)}),allowToolbarGroups:_===np.floating,buttons:g,sidebar:v};rT(t,h,y,{backstage:k}),BA(t,y);var T=t.getElement(),E=function(){var e,n=yE(function(e){var t,n,r,o;return(n=dh(t=e),r=ph(t),o=vh(t),bE(n).map(function(e){return xE(e,r,o)})).getOr(dh(e))}(t)),r=yE(wE(e=t).getOr(mh(e)));return t.inline||(Ni("div","width",r)&&Oi(W.element,"width",r),Ni("div","height",n)?Oi(W.element,"height",n):Oi(W.element,"height","200px")),n}();return a.render(t,{mothership:le,uiMothership:fe,outerContainer:W},O,k,{targetNode:T,height:E})},getUi:function(){return{channels:{broadcastAll:fe.broadcast,broadcastOn:fe.broadcastOn,register:e}}}}},LA=n([_t("lazySink"),Pt("dragBlockClass"),Gt("getBounds",du),Ht("useTabstopAt",c),Ht("eventOrder",{}),Zs("modalBehaviours",[gm]),Fu("onExecute"),Hu("onEscape")]),FA={sketch:r},zA=n([El({name:"draghandle",overrides:function(e,t){return{behaviours:_a([EA.config({mode:"mouse",getTarget:function(e){return yu(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])}}}),_l({schema:[_t("dom")],name:"title"}),_l({factory:FA,schema:[_t("dom")],name:"close"}),_l({factory:FA,schema:[_t("dom")],name:"body"}),El({factory:FA,schema:[_t("dom")],name:"footer"}),Tl({factory:{sketch:function(e,t){return l(l({},e),{dom:t.dom,components:t.components})}},schema:[Ht("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ht("components",[])],name:"blocker"})]),HA=Object.freeze({__proto__:null,block:function(e,t,n,r){Do(e.element,"aria-busy",!0);var o=t.getRoot(e).getOr(e),i=_a([gm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Om.config({})]),u=r(o,i),a=o.getSystem().build(u);ym.append(o,Hi(a)),a.hasConfigured(gm)&&gm.focusIn(a),n.isBlocked()||t.onBlock(e),n.blockWith(function(){return ym.remove(o,a)})},unblock:function(e,t,n){Lo(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()}}),VA=[Gt("getRoot",w.none),Lu("onBlock"),Lu("onUnblock")],jA=Ea({fields:VA,name:"blocking",apis:HA,state:Object.freeze({__proto__:null,init:function(){var e=j_();return ii({readState:e.isSet,blockWith:function(t){e.set({destroy:t})},clear:e.clear,isBlocked:e.isSet})}})}),UA=tf({name:"ModalDialog",configFields:LA(),partFields:zA(),factory:function(e,t,n,o){var i,u=Yt(w.none()),a=jo("modal-events"),c=l(l({},e.eventOrder),((i={})[Sr()]=[a].concat(e.eventOrder["alloy.system.attached"]||[]),i));return{uid:e.uid,dom:e.dom,components:t,apis:{show:function(t){u.set(w.some(t));var n=e.lazySink(t).getOrDie(),r=o.blocker(),i=n.getSystem().build(l(l({},r),{components:r.components.concat([Hi(t)]),behaviours:_a([Om.config({}),xm("dialog-blocker-events",[Xr(Jn(),function(){gm.focusIn(t)})])])}));ps(n,i),gm.focusIn(t)},hide:function(e){u.set(w.none()),so(e.element).each(function(t){e.getSystem().getByDom(t).each(function(e){bs(e)})})},getBody:function(t){return Vl(t,e,"body")},getFooter:function(t){return Vl(t,e,"footer")},setIdle:function(e){jA.unblock(e)},setBusy:function(e,t){jA.block(e,t)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:tl(e.modalBehaviours,[ym.config({}),gm.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),jA.config({getRoot:u.get}),xm(a,[Kr(function(t){var n,o,i,u,a,c;n=t.element,o=Vl(t,e,"title").element,i=Mo(n,"id").fold(function(){var e=jo("dialog-label");return Do(o,"id",e),e},r),Do(n,"aria-labelledby",i),u=t.element,a=Vl(t,e,"body").element,c=w.from(Po(u,"id")).fold(function(){var e=jo("dialog-describe");return Do(a,"id",e),e},r),Do(u,"aria-describedby",c)})])])}},apis:{show:function(e,t){e.show(t)},hide:function(e,t){e.hide(t)},getBody:function(e,t){return e.getBody(t)},getFooter:function(e,t){return e.getFooter(t)},setBusy:function(e,t,n){e.setBusy(t,n)},setIdle:function(e,t){e.setIdle(t)}}}),WA=Qe([Et("type"),Et("name")].concat(Bp)),qA=wt,GA=[ot("name","name",ze(function(){return jo("button-name")}),xt),Lt("icon"),Wt("align","end",["start","end"]),qt("primary",!1),qt("disabled",!1)],$A=d(GA,[Et("text")]),XA=d([At("type",["submit","cancel","custom"])],$A),KA=d([At("type",["menu"]),Lt("text"),Lt("tooltip"),Lt("icon"),Dt("items",WA)],GA),YA=ht("type",{submit:XA,cancel:XA,custom:XA,menu:KA}),JA=[Et("type"),Et("text"),At("level",["info","warn","error","success"]),Et("icon"),Ht("url","")],QA=Qe(JA),ZA=[Et("type"),Et("text"),qt("disabled",!1),qt("primary",!1),ot("name","name",ze(function(){return jo("button-name")}),xt),Lt("icon"),qt("borderless",!1)],eR=Qe(ZA),tR=[Et("type"),Et("name"),Et("label"),qt("disabled",!1)],nR=Qe(tR),rR=wt,oR=[Et("type"),Et("name")],iR=oR.concat([Lt("label")]),uR=iR.concat([Ht("columns","auto")]),aR=Qe(uR),cR=at([Et("value"),Et("text"),Et("icon")]),sR=Qe(iR),lR=xt,fR=Qe(iR),dR=xt,mR=oR.concat([Ut("tag","textarea"),Et("scriptId"),Et("scriptUrl"),Vt("settings",void 0,kt)]),gR=oR.concat([Ut("tag","textarea"),Rt("init")]),pR=st(function(e){return ft("customeditor.old",Je(gR),e).orThunk(function(){return ft("customeditor.new",Je(mR),e)})}),hR=xt,vR=Qe(iR),bR=Ze(ut),yR=function(e){return[Et("type"),Tt("columns",yt),e]},xR=[Et("type"),Et("html"),Wt("presets","presentation",["presentation","document"])],wR=Qe(xR),CR=iR.concat([qt("sandboxed",!0)]),SR=Qe(CR),kR=xt,OR=iR.concat([Tt("currentState",Qe([_t("blob"),Et("url")]))]),_R=Qe(OR),TR=iR.concat([Lt("inputMode"),Lt("placeholder"),qt("maximized",!1),qt("disabled",!1)]),ER=Qe(TR),AR=xt,RR=[Et("text"),Et("value")],NR=[Et("text"),Dt("items",(DA=function(){return BR},PA=Pe(function(){return DA()}),{extract:function(e,t,n){return PA().extract(e,t,n)},toString:function(){return PA().toString()}}))],BR=et([Qe(RR),Qe(NR)]),DR=iR.concat([Dt("items",BR),qt("disabled",!1)]),PR=Qe(DR),MR=xt,IR=iR.concat([Bt("items",[Et("text"),Et("value")]),jt("size",1),qt("disabled",!1)]),LR=Qe(IR),FR=xt,zR=iR.concat([qt("constrain",!0),qt("disabled",!1)]),HR=Qe(zR),VR=Qe([Et("width"),Et("height")]),jR=[Et("type"),Dt("header",xt),Dt("cells",Ze(xt))],UR=Qe(jR),WR=iR.concat([Lt("placeholder"),qt("maximized",!1),qt("disabled",!1)]),qR=Qe(WR),GR=xt,$R=iR.concat([Wt("filetype","file",["image","media","file"]),Ht("disabled",!1)]),XR=Qe($R),KR=Qe([Et("value"),Ht("meta",{})]),YR=function(e){return ot("items","items",Le(),Ze(st(function(t){return ft("Checking item of "+e,JR,t).fold(function(e){return ae.error(gt(e))},function(e){return ae.value(e)})})))},JR=ct(function(){return pt("type",{alertbanner:QA,bar:Qe((t=YR("bar"),[Et("type"),t])),button:eR,checkbox:nR,colorinput:sR,colorpicker:fR,dropzone:vR,grid:Qe(yR(YR("grid"))),iframe:SR,input:ER,listbox:PR,selectbox:LR,sizeinput:HR,textarea:qR,urlinput:XR,customeditor:pR,htmlpanel:wR,imagetools:_R,collection:aR,label:Qe((e=YR("label"),[Et("type"),Et("label"),e])),table:UR,panel:ZR});var e,t}),QR=[Et("type"),Ht("classes",[]),Dt("items",JR)],ZR=Qe(QR),eN=[ot("name","name",ze(function(){return jo("tab-name")}),xt),Et("title"),Dt("items",JR)],tN=[Et("type"),Bt("tabs",eN)],nN=Qe(tN),rN=$A,oN=YA,iN=Qe([Et("title"),Tt("body",pt("type",{panel:ZR,tabpanel:nN})),Ut("size","normal"),Dt("buttons",oN),Ht("initialData",{}),Gt("onAction",e),Gt("onChange",e),Gt("onSubmit",e),Gt("onClose",e),Gt("onCancel",e),Ht("onTabChange",e)]),uN=Qe(d([At("type",["cancel","custom"])],rN)),aN=Qe([Et("title"),Et("url"),It("height"),It("width"),Mt("buttons",Ze(uN)),Gt("onAction",e),Gt("onCancel",e),Gt("onClose",e),Gt("onMessage",e)]),cN=function(e){return O(e)?[e].concat(K(Oe(e),cN)):_(e)?K(e,cN):[]},sN=function(e){return k(e.type)&&k(e.name)},lN={checkbox:rR,colorinput:lR,colorpicker:dR,dropzone:bR,input:AR,iframe:kR,sizeinput:VR,selectbox:FR,listbox:MR,size:VR,textarea:GR,urlinput:KR,customeditor:hR,collection:cR,togglemenuitem:qA},fN=function(e){var t=U(cN(e),sN),n=K(t,function(e){return w.from(lN[e.type]).fold(function(){return[]},function(t){return[Tt(e.name,t)]})});return Qe(n)},dN=function(e){return{internalDialog:dt(ft("dialog",iN,e)),dataValidator:fN(e),initialData:e.initialData}},mN={open:function(e,t){var n=dN(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(e,t){return e(dt(ft("dialog",aN,t)))},redial:dN},gN=function(e){var t=[],n={};return xe(e,function(e,r){e.fold(function(){t.push(r)},function(e){n[r]=e})}),0<t.length?ae.error(t):ae.value(n)},pN=ef({name:"TabButton",configFields:[Ht("uid",void 0),_t("value"),ot("dom","dom",He(function(){return{attributes:{role:"tab",id:jo("aria"),"aria-selected":"false"}}}),vt()),Pt("action"),Ht("domModification",{}),Zs("tabButtonBehaviours",[Om,gm,Qs]),_t("view")],factory:function(e,t){return{uid:e.uid,dom:e.dom,components:e.components,events:zm(e.action),behaviours:tl(e.tabButtonBehaviours,[Om.config({}),gm.config({mode:"execution",useSpace:!0,useEnter:!0}),Qs.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}}}),hN=n([_t("tabs"),_t("dom"),Ht("clickToDismiss",!1),Zs("tabbarBehaviours",[bf,gm]),Mu(["tabClass","selectedClass"])]),vN=Al({factory:pN,name:"tabs",unit:"tab",overrides:function(t){var n=function(e,t){bf.dehighlight(e,t),Pr(e,Rr(),{tabbar:e,button:t})},r=function(e,t){bf.highlight(e,t),Pr(e,Ar(),{tabbar:e,button:t})};return{action:function(o){var i=o.getSystem().getByUid(t.uid).getOrDie(),u=bf.isHighlighted(i,o);(u&&t.clickToDismiss?n:u?e:r)(i,o)},domModification:{classes:[t.markers.tabClass]}}}}),bN=n([vN]),yN=tf({name:"Tabbar",configFields:hN(),partFields:bN(),factory:function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:tl(e.tabbarBehaviours,[bf.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:function(e,t){Do(t.element,"aria-selected","true")},onDehighlight:function(e,t){Do(t.element,"aria-selected","false")}}),gm.config({mode:"flow",getInitial:function(e){return bf.getHighlighted(e).map(function(e){return e.element})},selector:"."+e.markers.tabClass,executeOnMove:!0})])}}}),xN=ef({name:"Tabview",configFields:[Zs("tabviewBehaviours",[ym])],factory:function(e,t){return{uid:e.uid,dom:e.dom,behaviours:tl(e.tabviewBehaviours,[ym.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),wN=n([Ht("selectFirst",!0),Lu("onChangeTab"),Lu("onDismissTab"),Ht("tabs",[]),Zs("tabSectionBehaviours",[])]),CN=_l({factory:yN,schema:[_t("dom"),Nt("markers",[_t("tabClass"),_t("selectedClass")])],name:"tabbar",defaults:function(e){return{tabs:e.tabs}}}),SN=_l({factory:xN,name:"tabview"}),kN=n([CN,SN]),ON=tf({name:"TabSection",configFields:wN(),partFields:kN(),factory:function(e,t,n,r){var o=function(t,n){Hl(t,e,"tabbar").each(function(e){n(e).each(Mr)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:el(e.tabSectionBehaviours),events:zr(X([e.selectFirst?[Kr(function(e,t){o(e,bf.getFirst)})]:[],[jr(Ar(),function(t,n){var r,o;o=Qs.getValue(r=n.event.button),Hl(r,e,"tabview").each(function(t){G(e.tabs,function(e){return e.value===o}).each(function(n){var o=n.view();Mo(r.element,"id").each(function(e){Do(t.element,"aria-labelledby",e)}),ym.set(t,o),e.onChangeTab(t,r,o)})})}),jr(Rr(),function(t,n){e.onDismissTab(t,n.event.button)})]])),apis:{getViewItems:function(t){return Hl(t,e,"tabview").map(function(e){return ym.contents(e)}).getOr([])},showTab:function(e,t){o(e,function(e){var n=bf.getCandidates(e);return G(n,function(e){return Qs.getValue(e)===t}).filter(function(t){return!bf.isHighlighted(e,t)})})}}}},apis:{getViewItems:function(e,t){return e.getViewItems(t)},showTab:function(e,t,n){e.showTab(t,n)}}}),_N=function(e,t){Oi(e,"height",t+"px"),Nn().browser.isIE()?Bi(e,"flex-basis"):Oi(e,"flex-basis",t+"px")},TN=function(e,t,n){yu(e,'[role="dialog"]').each(function(e){xu(e,'[role="tablist"]').each(function(r){n.get().map(function(n){return Oi(t,"height","0"),Oi(t,"flex-basis","0"),Math.min(n,(i=t,u=r,a=ao(o=e).dom,c=yu(o,".tox-dialog-wrap").getOr(o),s="fixed"===Ei(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=Ui(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+Ji(u)?Math.max(Ui(u),l):l,d=parseInt(Ei(o,"margin-top"),10)||0,m=parseInt(Ei(o,"margin-bottom"),10)||0,s-(Ui(o)+d+m-f)));var o,i,u,a,c,s,l,f,d,m}).each(function(e){_N(t,e)})})})},EN=function(e){return xu(e,'[role="tabpanel"]')},AN=function(e){var t;return{smartTabHeight:(t=Yt(w.none()),{extraEvents:[Kr(function(n){var r=n.element;EN(r).each(function(o){var i;Oi(o,"visibility","hidden"),n.getSystem().getByDom(o).toOptional().each(function(n){var r,i,u,a=(i=o,u=n,H(r=e,function(e,t){ym.set(u,r[t].view());var n=i.dom.getBoundingClientRect();return ym.set(u,[]),n.height})),c=te(Z(a,function(e,t){return t<e?-1:e<t?1:0}));t.set(c)}),TN(r,o,t),Bi(o,"visibility"),i=n,te(e).each(function(e){return ON.showTab(i,e.value)}),yg.requestAnimationFrame(function(){TN(r,o,t)})})}),jr(Cr(),function(e){var n=e.element;EN(n).each(function(e){TN(n,e,t)})}),jr(Hb,function(e,n){var r=e.element;EN(r).each(function(e){var n=Ma(bo(e));Oi(e,"visibility","hidden");var o=Ri(e,"height").map(function(e){return parseInt(e,10)});Bi(e,"height"),Bi(e,"flex-basis");var i=e.dom.getBoundingClientRect().height;o.forall(function(e){return e<i})?(t.set(w.from(i)),TN(r,e,t)):o.each(function(t){_N(e,t)}),Bi(e,"visibility"),n.each(Pa)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},RN="send-data-to-section",NN="send-data-to-view",BN=jo("update-dialog"),DN=jo("update-title"),PN=jo("update-body"),MN=jo("update-footer"),IN=jo("body-send-message"),LN=function(e,t,n,r){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:l(l({},t.map(function(e){return{id:e}}).getOr({})),r?{"aria-live":"polite"}:{})},components:[],behaviours:_a([Pw(0),ZO.config({channel:PN,updateState:function(e,t){return w.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(e){switch(e.body.type){case"tabpanel":return[(u=e.body,a=n,c=Yt({}),s=function(e){var t=Qs.getValue(e),n=gN(t).getOr({}),r=c.get(),o=Be(r,n);c.set(o)},l=function(e){var t=c.get();Qs.setValue(e,t)},f=Yt(null),d=H(u.tabs,function(e){return{value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:a.shared.providers.translate(e.title)},view:function(){return[Tw.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"]},components:H(e.items,function(e){return ak(t,e,a)}),formBehaviours:_a([gm.config({mode:"acyclic",useTabstopAt:i(Jw)}),xm("TabView.form.events",[Kr(l),Yr(s)]),Ba.config({channels:Ue([{key:RN,value:{onReceive:s}},{key:NN,value:{onReceive:l}}])})])}})]}}}),m=AN(d).smartTabHeight,ON.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(e,t,n){var r=Qs.getValue(t);Pr(e,zb,{name:r,oldName:f.get()}),f.set(r)},tabs:d,components:[ON.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[yN.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:_a([_b.config({})])}),ON.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:_a([xm("tabpanel",m.extraEvents),gm.config({mode:"acyclic"}),cf.config({find:function(e){return te(ON.getViewItems(e))}}),Qs.config({store:{mode:"manual",getValue:function(e){return e.getSystem().broadcastOn([RN],{}),c.get()},setValue:function(e,t){c.set(t),e.getSystem().broadcastOn([NN],{})}}})])}))];default:return[(t=e.body,r=n,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(o=wg(Tw.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:H(t.items,function(t){return ak(e,t,r)})}}))).asSpec()]}],behaviours:_a([gm.config({mode:"acyclic",useTabstopAt:i(Jw)}),Dw(o),Vw(o,{postprocess:function(e){return gN(e).fold(function(e){return console.error(e),{}},function(e){return e})}})])})]}var t,r,o,u,a,c,s,l,f,d,m},initialData:e})])}},FN=Jh.deviceType.isTouch(),zN=function(e,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}},HN=function(e,t){return UA.parts.close(xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:_a([_b.config({})])}))},VN=function(){return UA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},jN=function(e,t){return UA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:YT("<p>"+t.translate(e)+"</p>")}]}]})},UN=function(e){return UA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e})},WN=function(e,t){return[yb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),yb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},qN=function(e){var t,n="tox-dialog",r=n+"-wrap",o=r+"__backdrop",i=n+"__disable-scroll";return UA.sketch({lazySink:e.lazySink,onEscape:function(t){return e.onEscape(t),w.some(!0)},useTabstopAt:function(e){return!Jw(e)},dom:{tag:"div",classes:[n].concat(e.extraClasses),styles:l({position:"relative"},e.extraStyles)},components:d([e.header,e.body],e.footer.toArray()),parts:{blocker:{dom:YT('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:FN?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:r,modalBehaviours:_a(d([Om.config({}),xm("dialog-events",e.dialogEvents.concat([Xr(Jn(),function(e,t){gm.focusIn(e)})])),xm("scroll-lock",[Kr(function(){gi(wi(),i)}),Yr(function(){pi(wi(),i)})])],e.extraBehaviours)),eventOrder:l(((t={})[dr()]=["dialog-events"],t[Sr()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[kr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),e.eventOrder)})},GN=function(e){return xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Sg("close",e.icons)}}],action:function(e){Dr(e,Pb)}})},$N=function(e,t,n){var r=function(e){return[Ii(n.translate(e.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:l({},t.map(function(e){return{id:e}}).getOr({}))},components:r(e),behaviours:_a([ZO.config({channel:DN,renderComponents:r})])}},XN=function(){return{dom:YT('<div class="tox-dialog__draghandle"></div>')}},KN=function(e,t){return n={title:t.shared.providers.translate(e),draggable:t.dialog.isDraggableModal()},r=t.shared.providers,o=UA.parts.title($N(n,w.none(),r)),i=UA.parts.draghandle(XN()),u=UA.parts.close(GN(r)),a=[o].concat(n.draggable?[i]:[]).concat([u]),yb.sketch({dom:YT('<div class="tox-dialog__header"></div>'),components:a});var n,r,o,i,u,a},YN=function(e,t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:YT('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},JN=function(e,t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){UA.setBusy(e(),function(e,r){return YN(n.message,r,t)})},onUnblock:function(){UA.setIdle(e())}}},QN=function(e,t,n,r){var o;return zi(qN(l(l({},e),{lazySink:r.shared.getSink,extraBehaviours:d([ZO.config({channel:BN,updateState:function(e,t){return w.some(t)},initialData:t}),Ww({})],e.extraBehaviours),onEscape:function(e){Dr(e,Pb)},dialogEvents:n,eventOrder:((o={})[fr()]=[ZO.name(),Ba.name()],o[Sr()]=["scroll-lock",ZO.name(),"messages","dialog-events","alloy.base.behaviour"],o[kr()]=["alloy.base.behaviour","dialog-events","messages",ZO.name(),"scroll-lock"],o)})))},ZN=function(e){return H(e,function(e){return"menu"===e.type?(n=H((t=e).items,function(e){var t=Yt(!1);return l(l({},e),{storage:t})}),l(l({},t),{items:n})):e;var t,n})},eB=function(e){return q(e,function(e,t){return"menu"!==t.type?e:q(t.items,function(e,t){return e[t.name]=t.storage,e},e)},{})},tB=function(e,t){return[Gr(Jn(),Yw),e(Db,function(e,n){t.onClose(),n.onClose()}),e(Pb,function(e,t,n,r){t.onCancel(e),Dr(r,Db)}),jr(Fb,function(e,n){return t.onUnblock()}),jr(Lb,function(e,n){return t.onBlock(n.event)})]},nB=function(e,t,n){var r=function(t,n){return jr(t,function(t,r){o(t,function(o,i){n(e(),o,r.event,t)})})},o=function(e,t){ZO.getState(e).get().each(function(n){t(n.internalDialog,e)})};return d(tB(r,t),[r(Ib,function(e,t){return t.onSubmit(e)}),r(Bb,function(e,t,n){t.onChange(e,{name:n.name})}),r(Mb,function(e,t,r,o){var i=function(){return gm.focusIn(o)},u=function(e){return Io(e,"disabled")||Mo(e,"aria-disabled").exists(function(e){return"true"===e})},a=bo(o.element),c=Ma(a);t.onAction(e,{name:r.name,value:r.value}),Ma(a).fold(i,function(e){u(e)||c.exists(function(t){return Mn(e,t)&&u(t)})?i():n().toOptional().filter(function(t){return!Mn(t.element,e)}).each(i)})}),r(zb,function(e,t,n){t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})}),Yr(function(t){var n=e();Qs.setValue(t,n.getData())})])},rB=function(e,t){var n=t.map(function(e){return e.footerButtons}).getOr([]),r=j(n,function(e){return"start"===e.align}),o=function(e,t){return yb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:H(t,function(e){return e.memento.asSpec()})})};return[o("start",r.pass),o("end",r.fail)]},oB=function(e,t){return{dom:YT('<div class="tox-dialog__footer"></div>'),components:[],behaviours:_a([ZO.config({channel:MN,initialData:e,updateState:function(e,n){var r=H(n.buttons,function(e){var n,r=wg(sS(n=e,n.type,t));return{name:e.name,align:e.align,memento:r}});return w.some({lookupByName:function(e,t){return n=e,o=t,G(r,function(e){return e.name===o}).bind(function(e){return e.memento.getOpt(n)});var n,o},footerButtons:r})},renderComponents:rB})])}},iB=oB,uB=function(e,t){return UA.parts.footer(oB(e,t))},aB=function(e,t){if(e.getRoot().getSystem().isConnected()){var n=cf.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return Tw.getField(n,t).fold(function(){var r=e.getFooter();return ZO.getState(r).get().bind(function(e){return e.lookupByName(n,t)})},function(e){return w.some(e)})}return w.none()},cB=function(e,t,n){var r=function(t){var n=e.getRoot();n.getSystem().isConnected()&&t(n)},o={getData:function(){var t=e.getRoot(),r=t.getSystem().isConnected()?e.getFormWrapper():t,o=Qs.getValue(r),i=we(n,function(e){return e.get()});return l(l({},o),i)},setData:function(t){r(function(r){var i,u,a=o.getData(),c=l(l({},a),t),s=(i=c,u=e.getRoot(),ZO.getState(u).get().map(function(e){return dt(ft("data",e.dataValidator,i))}).getOr(i)),f=e.getFormWrapper();Qs.setValue(f,s),xe(n,function(e,t){Te(c,t)&&e.set(c[t])})})},disable:function(t){aB(e,t).each(lh.disable)},enable:function(t){aB(e,t).each(lh.enable)},focus:function(t){aB(e,t).each(Om.focus)},block:function(e){if(!k(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r(function(t){Pr(t,Lb,{message:e})})},unblock:function(){r(function(e){Dr(e,Fb)})},showTab:function(t){r(function(n){var r=e.getBody();ZO.getState(r).get().exists(function(e){return e.isTabPanel()})&&cf.getCurrent(r).each(function(e){ON.showTab(e,t)})})},redial:function(e){r(function(n){var r=t(e);n.getSystem().broadcastOn([BN],r),n.getSystem().broadcastOn([DN],r.internalDialog),n.getSystem().broadcastOn([PN],r.internalDialog),n.getSystem().broadcastOn([MN],r.internalDialog),o.setData(r.initialData)})},close:function(){r(function(e){Dr(e,Db)})}};return o},sB=tinymce.util.Tools.resolve("tinymce.util.URI"),lB=["insertContent","setContent","execCommand","close","block","unblock"],fB=function(e){return O(e)&&-1!==lB.indexOf(e.mceAction)},dB=function(e){var t,n,r,o,u=e.backstage,a=e.editor,c=Ph(a),s=(n=(t=e).backstage.shared,{open:function(e,r){var o=function(){UA.hide(c),r()},i=wg(sS({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:w.none()},"cancel",t.backstage)),u=VN(),a=HN(o,n.providers),c=zi(qN({lazySink:function(){return n.getSink()},header:zN(u,a),body:jN(e,n.providers),footer:w.some(UN(WN([],[i.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[jr(Pb,o)],eventOrder:{}}));UA.show(c);var s=i.get(c);Om.focus(s)}}),f=(o=(r=e).backstage.shared,{open:function(e,t){var n=function(e){UA.hide(s),t(e)},i=wg(sS({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:w.none()},"submit",r.backstage)),u=sS({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:w.none()},"cancel",r.backstage),a=VN(),c=HN(function(){return n(!1)},o.providers),s=zi(qN({lazySink:function(){return o.getSink()},header:zN(a,c),body:jN(e,o.providers),footer:w.some(UN(WN([],[u,i.asSpec()]))),onEscape:function(){return n(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[jr(Pb,function(){return n(!1)}),jr(Ib,function(){return n(!0)})],eventOrder:{}}));UA.show(s);var l=i.get(s);Om.focus(l)}}),m=function(e,t,n,r){return mN.open(function(e,o,i){var s,f,m,g=dt(ft("data",i,o)),p=(s=Yt(w.none()),{clear:function(){return s.set(w.none())},set:function(e){return s.set(w.some(e))},isSet:function(){return s.get().isSome()},on:function(e){return s.get().each(e)}}),h=u.shared.header.isPositionedAtTop(),v=function(){return p.on(function(e){ag.reposition(e),ET.refresh(e)})},b=function(e,t,n,r){var o,i,u,a,c,s,l,f=jo("dialog-label"),d=jo("dialog-content"),m=wg((u={title:e.internalDialog.title,draggable:!0},a=f,c=n.shared.providers,yb.sketch({dom:YT('<div class="tox-dialog__header"></div>'),components:[$N(u,w.some(a),c),XN(),GN(c)],containerBehaviours:_a([EA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(e){return wu(e,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),g=wg((s=n,l=r,LN({body:e.internalDialog.body},w.some(d),s,l))),p=ZN(e.internalDialog.buttons),h=eB(p),v=wg(iB({buttons:p},n)),b=nB(function(){return x},{onBlock:function(e){jA.block(y,function(t,r){return YN(e.message,r,n.shared.providers)})},onUnblock:function(){jA.unblock(y)},onClose:function(){return t.closeWindow()}},n.shared.getSink),y=zi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((o={role:"dialog"})["aria-labelledby"]=f,o["aria-describedby"]=""+d,o)},eventOrder:((i={})[fr()]=[ZO.name(),Ba.name()],i[dr()]=["execute-on-form"],i[Sr()]=["reflecting","execute-on-form"],i),behaviours:_a([gm.config({mode:"cyclic",onEscape:function(e){return Dr(e,Db),w.some(!0)},useTabstopAt:function(e){return!Jw(e)&&("button"!==Zr(e)||"disabled"!==Po(e,"disabled"))}}),ZO.config({channel:BN,updateState:function(e,t){return w.some(t)},initialData:e}),Om.config({}),xm("execute-on-form",b.concat([Xr(Jn(),function(e,t){gm.focusIn(e)})])),jA.config({getRoot:function(){return w.some(y)}}),ym.config({}),Ww({})]),components:[m.asSpec(),g.asSpec(),v.asSpec()]}),x=cB({getRoot:function(){return y},getFooter:function(){return v.get(y)},getBody:function(){return g.get(y)},getFormWrapper:function(){var e=g.get(y);return cf.getCurrent(e).getOr(e)}},t.redial,h);return{dialog:y,instanceApi:x}}({dataValidator:i,initialData:g,internalDialog:e},{redial:mN.redial,closeWindow:function(){p.on(ag.hide),a.off("ResizeEditor",v),p.clear(),n(b.instanceApi)}},u,r),y=zi(ag.sketch(l(l({lazySink:u.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:_a(d([xm("window-manager-inline-events",[jr(Or(),function(e,t){Dr(b.dialog,Pb)})])],(f=a,m=h,c&&m?[]:[ET.config({contextual:{lazyContext:function(){return w.some(lu(tn(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(e,t){return cb(n=t,".tox-alert-dialog")||cb(n,".tox-confirm-dialog");var n}})));return p.set(y),ag.showWithin(y,t,Hi(b.dialog),w.some(wi())),c&&h||(ET.refresh(y),a.on("ResizeEditor",v)),b.instanceApi.setData(g),gm.focusIn(b.dialog),b.instanceApi},e)};return{open:function(e,t,n){return void 0!==t&&"toolbar"===t.inline?m(e,u.shared.anchors.inlineDialog(),n,t.ariaAttrs):void 0!==t&&"cursor"===t.inline?m(e,u.shared.anchors.cursor(),n,t.ariaAttrs):function(e,t){return mN.open(function(e,n,r){var o=n,i=function(e,t,n){var r,o,i=KN(e.internalDialog.title,n),u=(r=n,o=LN({body:e.internalDialog.body},w.none(),r,!1),UA.parts.body(o)),a=ZN(e.internalDialog.buttons),c=eB(a),s=uB({buttons:a},n),l=nB(function(){return g},JN(function(){return m},n.shared.providers,t),n.shared.getSink),f=function(e){switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(e.internalDialog.size),d={header:i,body:u,footer:w.some(s),extraClasses:f,extraBehaviours:[],extraStyles:{}},m=QN(d,e,l,n),g=cB({getRoot:function(){return m},getBody:function(){return UA.getBody(m)},getFooter:function(){return UA.getFooter(m)},getFormWrapper:function(){var e=UA.getBody(m);return cf.getCurrent(e).getOr(e)}},t.redial,c);return{dialog:m,instanceApi:g}}({dataValidator:r,initialData:o,internalDialog:e},{redial:mN.redial,closeWindow:function(){UA.hide(i.dialog),t(i.instanceApi)}},u);return UA.show(i.dialog),i.instanceApi.setData(o),i.instanceApi},e)}(e,n)},openUrl:function(e,t){return function(e,t){return mN.openUrl(function(e){var n=function(e,t,n,r){var o,u,a,c,s=KN(e.title,r),f=(u={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Xw({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:_a([_b.config({}),Om.config({})])})]}],behaviours:_a([gm.config({mode:"acyclic",useTabstopAt:i(Jw)})])},UA.parts.body(u)),m=e.buttons.bind(function(e){return 0===e.length?w.none():w.some(uB({buttons:e},r))}),g=function(e,t){var n=function(e,t){return jr(e,function(e,n){r(e,function(r,o){t(S,r,n.event,e)})})},r=function(e,t){ZO.getState(e).get().each(function(n){t(n,e)})};return d(tB(n,t),[n(Mb,function(e,t,n){t.onAction(e,{name:n.name})})])}(0,JN(function(){return C},r.shared.providers,t)),p=l(l({},e.height.fold(function(){return{}},function(e){return{height:e+"px","max-height":e+"px"}})),e.width.fold(function(){return{}},function(e){return{width:e+"px","max-width":e+"px"}})),h=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],v=new sB(e.url,{base_uri:new sB(window.location.href)}),b=v.protocol+"://"+v.host+(v.port?":"+v.port:""),y=Yt(w.none()),x=[xm("messages",[Kr(function(){var t=ib(tn(window),"message",function(t){var r,o;v.isSameOrigin(new sB(t.raw.origin))&&(fB(r=t.raw.data)?function(e,t,n){switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":var r=!!T(n.ui)&&n.ui;e.execCommand(n.cmd,r,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock()}}(n,S,r):!fB(o=r)&&O(o)&&Te(o,"mceAction")&&e.onMessage(S,r))});y.set(w.some(t))}),Yr(function(){y.get().each(function(e){return e.unbind()})})]),Ba.config({channels:((o={})[IN]={onReceive:function(e,t){xu(e.element,"iframe").each(function(e){e.dom.contentWindow.postMessage(t,b)})}},o)})],C=QN({header:s,body:f,footer:m,extraClasses:h,extraBehaviours:x,extraStyles:p},e,g,r),S=(c=function(e){a.getSystem().isConnected()&&e(a)},{block:function(e){if(!k(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");c(function(t){Pr(t,Lb,{message:e})})},unblock:function(){c(function(e){Dr(e,Fb)})},close:function(){c(function(e){Dr(e,Db)})},sendMessage:function(e){c(function(t){t.getSystem().broadcastOn([IN],e)})}});return{dialog:a=C,instanceApi:S}}(e,{closeWindow:function(){UA.hide(n.dialog),t(n.instanceApi)}},a,u);return UA.show(n.dialog),n.instanceApi},e)}(e,t)},alert:function(e,t){s.open(e,function(){t()})},close:function(e){e.close()},confirm:function(e,t){f.open(e,function(e){t(e)})}}};s.add("silver",function(t){var r=IA(t),o=r.uiMothership,i=r.backstage,u=r.renderUI,a=r.getUi;!function(t,r){var o=Yt(w.none()),i=Yt(!1),u=zi(ag.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:_a([xm("dismissAutocompleter",[jr(Or(),function(){return s()})])]),lazySink:r.getSink})),a=function(){return o.get().isSome()},c=function(){a()&&ag.hide(u)},s=function(){var e;a()&&(e=o.get().map(function(e){return e.element}),Ag(e.getOr(tn(t.selection.getNode()))).each(Ao),c(),o.set(w.none()),i.set(!1))},f=Pe(function(){return function(e){var t,n,r=e.ui.registry.getAll().popups,o=we(r,function(e){return ft("Autocompleter",Vg,e).fold(function(e){throw new Error(gt(e))},function(e){return e})}),i=(t=Se(o,function(e){return e.ch}),n={},V(t,function(e){n[e]={}}),be(n)),u=Oe(o);return{dataset:o,triggerChars:i,lookupByChar:function(e){return U(u,function(t){return t.ch===e})}}}(t)}),d=function(m){var g;g=m,o.get().map(function(e){return Dg(t.dom,t.selection.getRng(),e.triggerChar).bind(function(e){return Fg(t,f,e,g)})}).getOrThunk(function(){return function(e,t){var n,r,o=t(),i=e.selection.getRng();return n=e.dom,r=i,oe(o.triggerChars,function(e){return Dg(n,r,e)}).bind(function(n){return Fg(e,t,n)})}(t,f)}).fold(s,function(f){var m,g;m=f.context,a()||(g=function(e,t){return Ag(tn(e.selection.getNode())).getOrThunk(function(){var n=Qt('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Oo(n,tn(t.extractContents())),t.insertNode(n.dom),so(n).each(function(e){return e.dom.normalize()}),function(e,t){var n=function(e){for(var r=mo(e),o=r.length-1;0<=o;o--){var i=r[o];if(t(i))return w.some(i);var u=n(i);if(u.isSome())return u}return w.none()};return n(e)}(n,Lc).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===Zr(n=t)?1:Mc(n).fold(function(){return mo(n).length},function(e){return e.length}))}),n})}(t,m.range),o.set(w.some({triggerChar:m.triggerChar,element:g,matchLength:m.text.length})),i.set(!1)),f.lookupData.then(function(a){o.get().map(function(o){var m,g,p,h,v=f.context;o.triggerChar===v.triggerChar&&(g=v.triggerChar,h=oe(p=a,function(e){return w.from(e.columns)}).getOr(1),0<(m=K(p,function(o){return function(t,r,o,i,u,a,c){var s=1===i,f=!s||Cp(t);return nf(H(t,function(t){switch(t.type){case"separator":return ft("Autocompleter.Separator",zg,t).fold(Sp,function(e){return w.some(Zv(e))});case"cardmenuitem":return ft("cardmenuitem",Dp,t).fold(Sp,function(e){return w.some(function(e,t,n,r){var o={dom:ov(!1,e.label),optComponents:[w.some({dom:{tag:"div",classes:[dp,mp]},components:lv(e.items,r)})]};return Kh({data:Yh(l({text:w.none()},e)),disabled:e.disabled,getApi:function(e){return{isDisabled:function(){return lh.isDisabled(e)},setDisabled:function(t){lh.set(e,t),V(Fc(e.element,"*"),function(n){e.getSystem().getByDom(n).each(function(e){e.hasConfigured(lh)&&lh.set(e,t)})})}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:w.from(r.itemBehaviours).getOr([])},o,t,n.providers)}(l(l({},e),{onAction:function(t){e.onAction(t),o(e.value,e.meta)}}),u,a,{itemBehaviours:cv(e.meta,a),cardText:{matchText:r,highlightOn:c}}))});case"autocompleteitem":default:return ft("Autocompleter.Item",Hg,t).fold(Sp,function(t){return w.some(function(t,r,o,i,u,a,c,s){void 0===s&&(s=!0);var l=av({presets:"normal",textContent:w.none(),htmlContent:o?t.text.map(function(e){return sv(e,r)}):w.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:w.none(),checkMark:w.none(),caret:w.none(),value:t.value},c.providers,s,t.icon);return Kh({data:Yh(t),disabled:t.disabled,getApi:n({}),onAction:function(e){return u(t.value,t.meta)},onSetup:n(e),triggersSubmenu:!1,itemBehaviours:cv(t.meta,c)},l,a,c.providers)}(t,r,s,0,o,u,a,f))})}}))}(o.items,o.matchText,function(e,n){var r=t.selection.getRng();Dg(t.dom,r,g).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var r=t.range,u={hide:function(){s()},reload:function(e){c(),d(e)}};i.set(!0),o.onAction(u,r,e,n),i.set(!1)})},h,op.BUBBLE_TO_SANDBOX,r,o.highlightOn)})).length?function(e,n,r,o){e.matchLength=n.text.length;var i,a,c,s,l,f,d,m=oe(r,function(e){return w.from(e.columns)}).getOr(1);ag.showAt(u,{anchor:"node",root:tn(t.getBody()),node:w.from(e.element)},tg.sketch((i=Op("autocompleter-value",!0,o,m,"normal"),a=m,s="normal",l=((c=_h.ContentFocus)===_h.ContentFocus?Hf:zf)(),f=Kv(a,s),d=hp(s),{dom:i.dom,components:i.components,items:i.items,value:i.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===_h.ContentFocus,focusManager:l,menuBehaviours:Hp("auto"!==a?[]:[Kr(function(e,t){zp(e,4,d.item).each(function(t){gm.setGridSize(e,t.numRows,t.numColumns)})})])}))),ag.getContent(u).each(bf.highlightFirst)}(o,v,a,m):(10<=v.text.length-o.matchLength?s:c)())})})})},m={onKeypress:_g(function(e){27!==e.which&&d()},50),cancelIfNecessary:s,isMenuOpen:function(){return ag.isOpen(u)},isActive:a,isProcessingAction:i.get,getView:function(){return ag.getContent(u)}};!1===t.hasPlugin("rtc")&&function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var n=function(e,t){Pr(e,Zn(),{raw:t})};t.on("keydown",function(t){var r=function(){return e.getView().bind(bf.getHighlighted)};8===t.which&&e.onKeypress.throttle(t),e.isActive()&&(27===t.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===t.which?(r().each(Mr),t.preventDefault()):40===t.which?(r().fold(function(){e.getView().each(bf.highlightFirst)},function(e){n(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||r().each(function(e){n(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==t.which&&38!==t.which&&40!==t.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&Ag(tn(t.element)).isNone()&&e.cancelIfNecessary()})}(m,t)}(t,i.shared);var c=dB({editor:t,backstage:i});return{renderUI:u,getWindowManagerImpl:n(c),getNotificationManagerImpl:function(){return function(e,t,n){var r=t.backstage;return{open:function(e,o){var i=!e.closeButton&&e.timeout&&(0<e.timeout||e.timeout<0),u=function(){o(),ag.hide(c)},a=zi(Og.sketch({text:e.text,level:I(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:w.from(e.icon),closeButton:!i,onAction:u,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),c=zi(ag.sketch(l({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},r.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return n.add(c),0<e.timeout&&yg.setTimeout(function(){u()},e.timeout),{close:u,moveTo:function(e,t){ag.showAt(c,{anchor:"makeshift",x:e,y:t},Hi(a))},moveRel:function(e,n){var r,o;"banner"!==n?(r=function(e){switch(e){case"bc-bc":return bg;case"tc-tc":return vg;case"tc-bc":return fa;case"bc-tc":default:return da}}(n),o={anchor:"node",root:wi(),node:w.some(tn(e)),layouts:{onRtl:function(){return[r]},onLtr:function(){return[r]}}},ag.showAt(c,o,Hi(a))):ag.showAt(c,t.backstage.shared.anchors.banner(),Hi(a))},text:function(e){Og.updateText(a,e)},settings:e,getEl:function(){return a.element.dom},progressBar:{value:function(e){Og.updateProgress(a,e)}}}},close:function(e){e.close()},reposition:function(e){var t;V(e,function(e){return e.moveTo(0,0)}),0<(t=e).length&&(te(t).each(function(e){return e.moveRel(null,"banner")}),V(t,function(e,n){0<n&&e.moveRel(t[n-1].getEl(),"bc-tc")}))},getArgs:function(e){return e.settings}}}(0,{backstage:i},o)},ui:a()}})}(),function(){"use strict";var e,t,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.util.VK"),u=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},a=function(e){return function(t){return typeof t===e}},c=u("string"),s=u("array"),l=function(t){return e===t},f=a("boolean"),d=a("function"),m=function(e){var t=e.getParam("link_assume_external_targets",!1);return f(t)&&t?1:!c(t)||"http"!==t&&"https"!==t?0:t},g=function(e){return e.getParam("default_link_target")},p=function(e){return e.getParam("target_list",!0)},h=function(e){return e.getParam("rel_list",[],"array")},v=function(e){return e.getParam("allow_unsafe_link_target",!1,"boolean")},b=function(){},y=function(e){return function(){return e}},x=y(!1),w=y(!(e=null)),C=function(){return S},S=(t=function(e){return e.isNone()},{fold:function(e,t){return e()},is:x,isSome:x,isNone:w,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:r,orThunk:n,map:C,each:b,bind:C,exists:x,forall:w,filter:C,equals:t,equals_:t,toArray:function(){return[]},toString:y("none()")}),k=function(e){var t=y(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:w,isNone:x,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return k(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:S},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(x,function(t){return n(e,t)})}};return o},O={some:k,none:C,from:function(e){return null==e?S:k(e)}},_=Array.prototype.indexOf,T=Array.prototype.push,E=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!s(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);T.apply(t,e[n])}return t},A=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return O.none()},R=function(e,t){return e?O.some(t):O.none()},N=tinymce.util.Tools.resolve("tinymce.util.Tools"),B=function(e){return c(e.value)?e.value:""},D=function(e,t){var n=[];return N.each(e,function(e){var r,o,i,u=c((r=e).text)?r.text:c(r.title)?r.title:"";void 0!==e.menu?(o=D(e.menu,t),n.push({text:u,items:o})):(i=t(e),n.push({text:u,value:i}))}),n},P=function(e){return void 0===e&&(e=B),function(t){return O.from(t).map(function(t){return D(t,e)})}},M=function(e){return P(B)(e)},I=P,L=function(e,t){return function(n){return{name:e,type:"listbox",label:t,items:n}}},F=B,z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},H=Object.keys,V=Object.hasOwnProperty,j=function(e,t){return V.call(e,t)},U=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),W=function(e){return e&&"a"===e.nodeName.toLowerCase()},q=function(e){return W(e)&&!!X(e)},G=function(e,t){if(e.collapsed)return[];for(var n=e.cloneContents(),r=new U(n.firstChild,n),o=[],i=n.firstChild;t(i)&&o.push(i),i=r.next(););return o},$=function(e){return/^\w+:/i.test(e)},X=function(e){return e.getAttribute("data-mce-href")||e.getAttribute("href")},K=function(e,t){var n,r=["noopener"],o=e?e.split(/\s+/):[],i=function(e){return e.filter(function(e){return-1===N.inArray(r,e)})},u=t?0<(n=i(n=o)).length?n.concat(r):r:i(o);return 0<u.length?N.trim(u.sort().join(" ")):""},Y=function(e,t){return t=t||e.selection.getNode(),ee(t)?e.dom.select("a[href]",t)[0]:e.dom.getParent(t,"a[href]")},J=function(e,t){return(t?t.innerText||t.textContent:e.getContent({format:"text"})).replace(/\uFEFF/g,"")},Q=function(e){return 0<N.grep(e,q).length},Z=function(e){var t=e.schema.getTextInlineElements();return 0===G(e.selection.getRng(),function(e){return 1===e.nodeType&&!W(e)&&!j(t,e.nodeName.toLowerCase())}).length},ee=function(e){return e&&"FIGURE"===e.nodeName&&/\bimage\b/i.test(e.className)},te=function(e,t){var n,r,o,i=z({},t);return 0<h(e).length||!1!==v(e)||(n=K(i.rel,"_blank"===i.target),i.rel=n||null),O.from(i.target).isNone()&&!1===p(e)&&(i.target=g(e)),i.href=(r=i.href,"http"!==(o=m(e))&&"https"!==o||$(r)?r:o+"://"+r),i},ne=function(e,t,n){var r,o,i,u,a,c,s;e.hasPlugin("rtc",!0)?e.execCommand("createlink",!1,(o=(r=n).class,i=r.href,u=r.rel,a=r.target,c=r.text,s=r.title,function(e,t){var n,r={};return function(e,t,n,r){!function(e,t){for(var n=H(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}}(e,function(e,o){(t(e,o)?n:r)(e,o)})}(e,function(e,t){return!1===l(e)},(n=r,function(e,t){n[t]=e}),b),r}({class:o.getOrNull(),href:i,rel:u.getOrNull(),target:a.getOrNull(),text:c.getOrNull(),title:s.getOrNull()}))):function(e,t,n){var r=e.selection.getNode(),o=Y(e,r),i=te(e,function(e){return t=function(t,n){return e[n].each(function(e){t[n]=0<e.length?e:null}),t},n={href:e.href},function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n])}(["title","rel","class","target"],function(e){n=t(n,e)}),n;var t,n}(n));e.undoManager.transact(function(){var u,a,c,s,l,f,d;n.href===t.href&&t.attach(),o?(e.focus(),l=e,f=o,d=i,n.text.each(function(e){f.hasOwnProperty("innerText")?f.innerText=e:f.textContent=e}),l.dom.setAttribs(f,d),l.selection.select(f)):(u=e,c=n.text,s=i,ee(a=r)?ie(u,a,s):c.fold(function(){u.execCommand("mceInsertLink",!1,s)},function(e){u.insertContent(u.dom.createHTML("a",s,u.dom.encode(e)))}))})}(e,t,n)},re=function(e){e.hasPlugin("rtc",!0)?e.execCommand("unlink"):function(e){e.undoManager.transact(function(){var t,n,r,o,i,u,a,c=e.selection.getNode();ee(c)?oe(e,c):(n=(t=e).dom,o=(r=t.selection).getBookmark(),i=r.getRng().cloneRange(),u=n.getParent(i.startContainer,"a[href]",t.getBody()),a=n.getParent(i.endContainer,"a[href]",t.getBody()),u&&i.setStartBefore(u),a&&i.setEndAfter(a),r.setRng(i),t.execCommand("unlink"),r.moveToBookmark(o)),e.focus()})}(e)},oe=function(e,t){var n,r=e.dom.select("img",t)[0];!r||(n=e.dom.getParents(r,"a[href]",t)[0])&&(n.parentNode.insertBefore(r,n),e.dom.remove(n))},ie=function(e,t,n){var r,o=e.dom.select("img",t)[0];o&&(r=e.dom.create("a",n),o.parentNode.insertBefore(r,o),r.appendChild(o))},ue=function(e,t){return A(t,function(t){return function(e){return j(t=e,"items")&&null!=t.items;var t}(t)?ue(e,t.items):R(t.value===e,t)})},ae=tinymce.util.Tools.resolve("tinymce.util.Delay"),ce=tinymce.util.Tools.resolve("tinymce.util.Promise"),se=function(e){var t=e.href;return 0<t.indexOf("@")&&-1===t.indexOf("/")&&-1===t.indexOf("mailto:")?O.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(e){return z(z({},e),{href:"mailto:"+t})}}):O.none()},le=function(e,t){return A([se,(n=m(e),r=e.getParam("link_default_protocol","http","string"),function(e){var t=e.href;return 1===n&&!$(t)||0===n&&/^\s*www(\.|\d\.)/i.test(t)?O.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(e){return z(z({},e),{href:r+"://"+t})}}):O.none()})],function(e){return e(t)}).fold(function(){return ce.resolve(t)},function(n){return new ce(function(r){var o,i,u,a;i=n.message,u=function(e){r(e?n.preprocess(t):t)},a=(o=e).selection.getRng(),ae.setEditorTimeout(o,function(){o.windowManager.confirm(i,function(e){o.selection.setRng(a),u(e)})})})});var n,r},fe=function(e){var t=function(e,t){return E(function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}(e,function(e){var t=e.name||e.id;return t?[{text:t,value:"#"+t}]:[]}))}(e.dom.select("a:not([href])"));return 0<t.length?O.some([{text:"None",value:""}].concat(t)):O.none()},de=function(e){var t=e.getParam("link_class_list",[],"array");return 0<t.length?M(t):O.none()},me=tinymce.util.Tools.resolve("tinymce.util.XHR"),ge=function(e,t){var n=h(e);if(0<n.length){var r=t.is("_blank");return(!1===v(e)?I(function(e){return K(F(e),r)}):M)(n)}return O.none()},pe=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],he=function(e){var t=p(e);return s(t)?M(t).orThunk(function(){return O.some(pe)}):!1===t?O.none():O.some(pe)},ve=function(e,t,n){var r=e.getAttrib(t,n);return null!==r&&0<r.length?O.some(r):O.none()},be=function(e,t){return e.dom.getParent(t,"a[href]")},ye=function(e){return be(e,e.selection.getStart())},xe=function(e,t){var n,r;t&&(n=X(t),/^#/.test(n)?(r=e.$(n)).length&&e.selection.scrollIntoView(r[0],!0):function(e){var t=document.createElement("a");t.target="_blank",t.href=e,t.rel="noreferrer noopener";var n,r,o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n=t,r=o,document.body.appendChild(n),n.dispatchEvent(r),document.body.removeChild(n)}(t.href))},we=function(e){return function(){!function(e){var t,n;(n=Y(t=e),function(e,t){return function(e){var t=function(t){return e.convertURL(t.value||t.url,"href")},n=e.getParam("link_list");return new ce(function(e){c(n)?me.send({url:n,success:function(t){return e(function(t){try{return O.some(JSON.parse(t))}catch(e){return O.none()}}(t))},error:function(t){return e(O.none())}}):d(n)?n(function(t){return e(O.some(t))}):e(O.from(n))}).then(function(e){return e.bind(I(t)).map(function(e){return 0<e.length?[{text:"None",value:""}].concat(e):e})})}(e).then(function(n){var r,o,i,u,a,c,s,l,f=(o=t,i=(r=e).dom,u=Z(r)?O.some(J(r.selection,o)):O.none(),a=o?O.some(i.getAttrib(o,"href")):O.none(),c=o?O.from(i.getAttrib(o,"target")):O.none(),s=ve(i,o,"rel"),l=ve(i,o,"class"),{url:a,text:u,title:ve(i,o,"title"),target:c,rel:s,linkClass:l});return{anchor:f,catalogs:{targets:he(e),rels:ge(e,f.target),classes:de(e),anchor:fe(e),link:n},optNode:O.from(t),flags:{titleEnabled:e.getParam("link_title",!0,"boolean")}}})}(t,n)).then(function(t){var n,r,o,i,u,a,c,s,l,f,d,m,p;return i=function(e){var t=e.getData();if(!t.url.value)return re(n),void e.close();var o=function(e){return O.from(t[e]).filter(function(t){return!r.anchor[e].is(t)})},i={href:t.url.value,text:o("text"),target:o("target"),rel:o("rel"),class:o("linkClass"),title:o("title")},u={href:t.url.value,attach:void 0!==t.url.meta&&t.url.meta.attach?t.url.meta.attach:b};le(n,i).then(function(e){ne(n,u,e)}),e.close()},u=n=e,l=(o=r=t).anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),f=o.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],a=O.from(g(u)),d={url:{value:s=(c=o.anchor).url.getOr(""),meta:{original:{value:s}}},text:c.text.getOr(""),title:c.title.getOr(""),anchor:s,link:s,rel:c.rel.getOr(""),target:c.target.or(a).getOr(""),linkClass:c.linkClass.getOr("")},p=function(e,t){var n={text:e.text,title:e.title};return{onChange:function(e,r){var o=r.name;return"url"===o?function(e){var t,r=R(n.text.length<=0,O.from((t=e.url).meta.text).getOr(t.value)),o=R(n.title.length<=0,O.from(e.url.meta.title).getOr(""));return r.isSome()||o.isSome()?O.some(z(z({},r.map(function(e){return{text:e}}).getOr({})),o.map(function(e){return{title:e}}).getOr({}))):O.none()}(e()):function(e,t){return-1<_.call(["anchor","link"],t)}(0,o)?function(e,r){var o,i,u=(o=t,("link"===(i=r.name)?o.link:"anchor"===i?o.anchor:O.none()).getOr([]));return function(e,t,n,r){var o=r[t],i=0<e.length;return void 0!==o?ue(o,n).map(function(t){return{url:{value:t.value,meta:{text:i?e:t.text,attach:b}},text:i?e:t.text}}):O.none()}(n.text,r.name,u,e)}(e(),r):(("text"===o||"title"===o)&&(n[o]=e()[o]),O.none())}}}(d,m=o.catalogs),{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:E([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],l,f,function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([m.anchor.map(L("anchor","Anchors")),m.rels.map(L("rel","Rel")),m.targets.map(L("target","Open link in...")),m.link.map(L("link","Link list")),m.classes.map(L("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d,onChange:function(e,t){p.onChange(e.getData,{name:t.name}).each(function(t){e.setData(t)})},onSubmit:i}}).then(function(t){e.windowManager.open(t)})}(e)}},Ce=function(e){return function(){xe(e,ye(e))}},Se=function(e){e.on("click",function(t){var n=be(e,t.target);n&&i.metaKeyPressed(t)&&(t.preventDefault(),xe(e,n))}),e.on("keydown",function(t){var n,r=ye(e);r&&13===t.keyCode&&!0===(n=t).altKey&&!1===n.shiftKey&&!1===n.ctrlKey&&!1===n.metaKey&&(t.preventDefault(),xe(e,r))})},ke=function(e,t){return e.on("NodeChange",t),function(){return e.off("NodeChange",t)}},Oe=function(e){return function(t){return ke(e,function(){t.setActive(!e.mode.isReadOnly()&&null!==Y(e,e.selection.getNode()))})}},_e=function(e){return function(t){var n=function(){return t.setDisabled(null===Y(e,e.selection.getNode()))};return n(),ke(e,n)}},Te=function(e){return function(t){var n=function(t){return Q(t)||(n=e.selection.getRng(),0<G(n,q).length);var n},r=e.dom.getParents(e.selection.getStart());return t.setDisabled(!n(r)),ke(e,function(e){return t.setDisabled(!n(e.parents))})}};o.add("link",function(e){var t,n,r,o,i,u,a;(t=e).ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:we(t),onSetup:Oe(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Ce(t),onSetup:_e(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return re(t)},onSetup:Te(t)}),(n=e).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Ce(n),onSetup:_e(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:we(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return re(n)},onSetup:Te(n)}),(r=e).ui.registry.addContextMenu("link",{update:function(e){return Q(r.dom.getParents(e,"a"))?"link unlink openlink":"link"}}),i=function(e){var t=o.selection.getNode();return e.setDisabled(!Y(o,t)),b},(o=e).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Oe(o)},label:"Link",predicate:function(e){return!!Y(o,e)&&o.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var e=Y(o);return e?X(e):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(e){var t=o.selection.getNode();return e.setActive(!!Y(o,t)),Oe(o)(e)},onAction:function(e){var t,n,r=Y(o),i=e.getValue();r?o.undoManager.transact(function(){o.dom.setAttrib(r,"href",i),o.selection.collapse(!1),e.hide()}):(t={href:i,attach:b},n=Z(o)?O.some(J(o.selection,r)).filter(function(e){return 0<e.length}).or(O.from(i)):O.none(),ne(o,t,{href:i,text:n,title:O.none(),rel:O.none(),target:O.none(),class:O.none()}),e.hide())}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:i,onAction:function(e){re(o),e.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:i,onAction:function(e){Ce(o)(),e.hide()}}]}),Se(e),(u=e).addCommand("mceLink",function(){u.getParam("link_quicklink",!1,"boolean")?u.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):we(u)()}),(a=e).addShortcut("Meta+K","",function(){a.execCommand("mceLink")})})}(),function(){"use strict";var e,t,n,r,o=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){},a=function(e){return function(){return e}},c=a(!1),s=a(!0),l=function(){return f},f=(e=function(e){return e.isNone()},{fold:function(e,t){return e()},is:c,isSome:c,isNone:s,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:n,orThunk:t,map:l,each:u,bind:l,exists:c,forall:s,filter:l,equals:e,equals_:e,toArray:function(){return[]},toString:a("none()")}),d=function(e){var t=a(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:s,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(c,function(t){return n(e,t)})}};return o},m={some:d,none:l,from:function(e){return null==e?f:d(e)}},g=function(e){return!(null===(t=e)||void 0===t);var t},p=Array.prototype.slice,h=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},v=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o],o);return r},b=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},y="function"==typeof Array.from?Array.from:function(e){return p.call(e)},x=function(){var e=o(m.none());return{clear:function(){return e.set(m.none())},set:function(t){return e.set(m.some(t))},isSet:function(){return e.get().isSome()},on:function(t){return e.get().each(t)}}},w=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},C=tinymce.util.Tools.resolve("tinymce.Env"),S=tinymce.util.Tools.resolve("tinymce.util.Delay"),k=tinymce.util.Tools.resolve("tinymce.util.Promise"),O=tinymce.util.Tools.resolve("tinymce.util.VK"),_=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},T=tinymce.util.Tools.resolve("tinymce.util.Tools"),E=function(e){return e.getParam("paste_data_images",!1)},A=function(e){return e.getParam("paste_retain_style_properties")},R=function(e){return e.getParam("validate")},N=function(e){return e.getParam("paste_data_images",!1,"boolean")},B=function(e){return T.explode(e.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},D="x-tinymce/html",P="\x3c!-- "+D+" --\x3e",M=function(e){return-1!==e.indexOf(P)},I=tinymce.util.Tools.resolve("tinymce.html.Entities"),L=tinymce.util.Tools.resolve("tinymce.html.DomParser"),F=tinymce.util.Tools.resolve("tinymce.html.Serializer"),z=tinymce.util.Tools.resolve("tinymce.html.Node"),H=tinymce.util.Tools.resolve("tinymce.html.Schema"),V=function(e,t){return T.each(t,function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])}),e},j=function(e){return V(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?" ":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},U=function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)},W=function(e,t){return{content:e,cancelled:t}},q=function(e,t){return e.insertContent(t,{merge:e.getParam("paste_merge_formats",!0),paste:!0}),!0},G=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},$=function(e,t){return G(t)&&h(B(e),function(e){return n=t.toLowerCase(),r="."+e.toLowerCase(),w(n,r,n.length-r.length);var n,r})},X=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!G(t)||(o=t,i=n,(r=e).undoManager.extra(function(){i(r,o)},function(){r.execCommand("mceInsertLink",!1,o)}),0));var r,o,i},K=function(e,t,n){return!!$(e,t)&&(o=t,i=n,(r=e).undoManager.extra(function(){i(r,o)},function(){r.insertContent('<img src="'+o+'">')}),!0);var r,o,i},Y=function(e){return"\n"===e||"\r"===e},J=function(e,t,n,r){var o=function(e,t,n){var r,o,i=U(t);return function(e,t,n,r){var o,i,u,a,c,s=e.fire("PastePreProcess",{content:t,internal:n,wordContent:r}),l=function(e,t){var n=L({},e.schema);n.addNodeFilter("meta",function(e){T.each(e,function(e){e.remove()})});var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return F({validate:R(e)},e.schema).serialize(r)}(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?(i=n,u=r,a=(o=e).dom.create("div",{style:"display:none"},l),c=o.fire("PastePostProcess",{node:a,internal:i,wordContent:u}),W(c.node.innerHTML,c.isDefaultPrevented())):W(l,s.isDefaultPrevented())}(e,i?(o=t,(r=e).getParam("paste_enable_default_filters",!0)?function(e,t){var n,r=A(e);r&&(n=T.makeMap(r.split(/[, ]/))),t=V(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return 0<t.length?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var o=e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody"),i=H({valid_elements:o,valid_children:"-li[p]"});T.each(i.elements,function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))});var u=L({},i);u.addAttributeFilter("style",function(t){for(var r,o=t.length;o--;)(r=t[o]).attr("style",function(e,t,n,r){var o,i={},u=e.dom.parseStyle(r);return T.each(u,function(u,a){switch(a){case"mso-list":(o=/\w+ \w+([0-9]+)/i.exec(r))&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(u)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":a="text-align";break;case"vert-align":a="vertical-align";break;case"font-color":case"mso-foreground":a="color";break;case"mso-background":case"mso-highlight":a="background";break;case"font-weight":case"font-style":return void("normal"!==u&&(i[a]=u));case"mso-element":if(/^(comment|comment-list)$/i.test(u))return void n.remove()}0!==a.indexOf("mso-comment")?0!==a.indexOf("mso-")&&("all"===A(e)||t&&t[a])&&(i[a]=u):n.remove()}),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new z("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new z("i",1))),(i=e.dom.serializeStyle(i,n.name))||null}(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()}),u.addAttributeFilter("class",function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)}),u.addNodeFilter("del",function(e){for(var t=e.length;t--;)e[t].remove()}),u.addNodeFilter("a",function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=(n=n.split("#")[1])&&"#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()});var a=u.parse(t);return e.getParam("paste_convert_word_fake_lists",!0)&&function(e){for(var t,n,r=1,o=function(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)for(;t+=o(e),e=e.next;);return t},i=function(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0},u=function(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)for(;u(e),e=e.next;);},a=function(e,o,a){var c=e._listLevel||r;c!==r&&(t=c<r?t&&t.parent.parent:(n=t,null)),t&&t.name===o?t.append(e):(n=n||t,t=new z(o,1),1<a&&t.attr("start",""+a),e.wrap(t)),e.name="li",r<c&&n&&n.lastChild.append(t),r=c,u(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)},c=[],s=e.firstChild;null!=s;)if(c.push(s),null!==(s=s.walk()))for(;void 0!==s&&s.parent!==e;)s=s.walk();for(var l=0;l<c.length;l++)if("p"===(e=c[l]).name&&e.firstChild){var f=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(f)){a(e,"ul");continue}if(function(e){var t;return e=e.replace(/^[\u00a0 ]+/,""),T.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],function(n){if(n.test(e))return!(t=!0)}),t}(f)){var d=/([0-9]+)\./.exec(f),m=1;d&&(m=parseInt(d[1],10)),a(e,"ol",m);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}(a),F({validate:R(e)},i).serialize(a)}(r,o):o):t,n,i)}(e,t,n);!1===o.cancelled&&function(e,t,n){var r,o;n||!1===e.getParam("smart_paste",!0)?q(e,t):(r=e,o=t,T.each([X,K,q],function(e){return!0!==e(r,o,q)}))}(e,o.content,r)},Q=function(e,t,n){var r=n||M(t);J(e,t.replace(P,""),r,!1)},Z=function(e,t){var n,r,o,i=e.dom.encode(t).replace(/\r\n/g,"\n"),u=function(e,t){var n,r,o,i=(n=e.getParam("paste_tab_spaces",4,"number"))<=0?"":new Array(n+1).join(" "),u=t.replace(/\t/g,i);return(o={pcIsSpace:!(r=function(e,t){return-1!==" \f\t\v".indexOf(t)||" "===t?e.pcIsSpace||""===e.str||e.str.length===u.length-1||(r=e.str.length+1)<(n=u).length&&0<=r&&Y(n[r])?{pcIsSpace:!1,str:e.str+" "}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:Y(t),str:e.str+t};var n,r}),str:""},b(u,function(e){o=r(o,e)}),o).str}(e,i),a=(n=u,r=e.getParam("forced_root_block"),o=e.getParam("forced_root_block_attrs"),r?function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n,r=[],o="<"+e;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&r.push(n+'="'+I.encodeAllRaw(t[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"}(t,n),i="</"+t+">",u=T.map(r,function(e){return e.split(/\n/).join("<br />")});return 1===u.length?u[0]:T.map(u,function(e){return o+e+i}).join("")}(n,!0===r?"p":r,o):n.replace(/\r?\n/g,"<br>"));J(e,a,!1,!0)},ee=function(e){var t,n={};if(e&&(!e.getData||(t=e.getData("Text"))&&0<t.length&&-1===t.indexOf("data:text/mce-internal,")&&(n["text/plain"]=t),e.types))for(var o=0;o<e.types.length;o++){var i=e.types[o];try{n[i]=e.getData(i)}catch(r){n[i]=""}}return n},te=function(e,t){return t in e&&0<e[t].length},ne=function(e){return te(e,"text/html")||te(e,"text/plain")},re=(r=0,function(){return"mceclip"+r++}),oe=function(e,t,n){var r,o,i,u,a="paste"===t.type?t.clipboardData:t.dataTransfer;if(N(e)&&a){var c=(r=e,i=(o=a).items?v(y(o.items),function(e){return e.getAsFile()}):[],u=o.files?y(o.files):[],function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}(0<i.length?i:u,function(e){var t=B(e);return function(e){return w(e.type,"image/",0)&&h(t,function(t){return n=t.toLowerCase(),(T.hasOwn(r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},n)?"image/"+r[n]:"image/"+n)===e.type;var n,r})}}(r)));if(0<c.length)return t.preventDefault(),function(e){return k.all(v(e,function(e){return new k(function(t){var n=g(e.getAsFile)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)})}))}(c).then(function(t){n&&e.selection.setRng(n),b(t,function(t){!function(e,t){var n,r,o,i,u,a,c,s,l,f,d=(n=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(t.uri))?{type:n[1],data:decodeURIComponent(n[2])}:{type:null,data:null},m=d.data,p=d.type,h=re(),v=t.blob,b=new Image;b.src=t.uri,l=b,!(f=e.getParam("images_dataimg_filter"))||f(l)?(a=void 0,(o=(r=e.editorUpload.blobCache).getByData(m,p))?a=o:(u=(i=e.getParam("images_reuse_filename")&&g(v.name))?(c=e,s=v.name.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i),g(s)?c.dom.encode(s[1]):null):h,a=r.create(h,v,m,u,i?v.name:void 0),r.add(a)),Q(e,'<img src="'+a.blobUri()+'">',!1)):Q(e,'<img src="'+t.uri+'">',!1)}(e,t)})}),!0}return!1},ie=function(e){return O.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},ue=function(e){return C.ie&&e.inline?document.body:e.getBody()},ae=function(e){return e.dom.get("mcepastebin")},ce=function(e,t){var n,r=ae(e);return(n=r)&&"mcepastebin"===n.id&&function(e,t){return t===e}(t,r.innerHTML)},se=function(e,t,n,r){!function(e,t,n){if(r=e,!1!==C.iOS||"function"!=typeof(null==r?void 0:r.setData))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(D,t),!0}catch(o){return!1}var r}(e.clipboardData,t.html,t.text)?n(t.html,r):(e.preventDefault(),r())},le=function(e){return function(t,n){var r=P+t,o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var u=e.selection.getRng();i.focus();var a=e.dom.createRng();a.selectNodeContents(i),e.selection.setRng(a),S.setTimeout(function(){e.selection.setRng(u),o.parentNode.removeChild(o),n()},0)}},fe=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},de=function(e){return!e.selection.isCollapsed()||!!(t=e).dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody());var t},me=function(e){var t,n;e.on("cut",(t=e,function(e){de(t)&&se(e,fe(t),le(t),function(){var e;C.browser.isChrome()||C.browser.isFirefox()?(e=t.selection.getRng(),S.setEditorTimeout(t,function(){t.selection.setRng(e),t.execCommand("Delete")},0)):t.execCommand("Delete")})})),e.on("copy",(n=e,function(e){de(n)&&se(e,fe(n),le(n),u)}))},ge=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),pe=function(e,t){return ge.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},he=function(e,t){e.focus(),e.selection.setRng(t)},ve=function(e,t){e.on("PastePreProcess",function(n){n.content=t(e,n.content,n.internal,n.wordContent)})},be=function(e,t){if(!U(t))return t;var n=[];T.each(e.schema.getBlockElements(),function(e,t){n.push(t)});var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=V(t,[[r,"$1"]]),V(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])},ye=function(e,t,n,r){if(r||n)return t;var o,i,u,a=e.getParam("paste_webkit_styles");return!1===e.getParam("paste_remove_styles_if_webkit",!0)||"all"===a?t:(a&&(o=a.split(/[, ]/)),t=(t=o?(i=e.dom,u=e.selection.getNode(),t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(e,t,n,r){var a=i.parseStyle(i.decode(n)),c={};if("none"===o)return t+r;for(var s=0;s<o.length;s++){var l=a[o[s]],f=i.getStyle(u,o[s],!0);/color/.test(o[s])&&(l=i.toHex(l),f=i.toHex(f)),f!==l&&(c[o[s]]=l)}return(c=i.serializeStyle(c,"span"))?t+' style="'+c+'"'+r:t+r})):t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")).replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(e,t,n,r){return t+' style="'+n+'"'+r}))},xe=function(e,t){e.$("a",t).find("font,u").each(function(t,n){e.dom.remove(n,!0)})},we=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}};i.add("paste",function(e){if(0==(!!e.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0))){var t=o(!1),n=o(e.getParam("paste_as_text",!1)?"text":"html"),r=(f=n,d=function(e){var t=o(null),n="%MCEPASTEBIN%";return{create:function(){return function(e,t,n){var r=e.dom,o=e.getBody();t.set(e.selection.getRng());var i=e.dom.add(ue(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},"%MCEPASTEBIN%");(C.ie||C.gecko)&&r.setStyle(i,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(i,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),function(e,t,n){var r;ue(r=e)!==r.getBody()&&e.dom.bind(t,"paste keyup",function(t){ce(e,"%MCEPASTEBIN%")||e.fire("paste")})}(e,i),i.focus(),e.selection.select(i,!0)}(e,t)},remove:function(){return function(e,t){if(ae(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(e,t)},getEl:function(){return ae(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=T.grep(ue(e).childNodes,function(e){return"mcepastebin"===e.id}),r=n.shift();T.each(n,function(e){t(r,e)});for(var o=e.dom.select("div[id=mcepastebin]",r),i=o.length-1;0<=i;i--){var u=e.dom.create("div");r.insertBefore(u,o[i]),t(u,o[i])}return r?r.innerHTML:""}(e)},getLastRng:function(){return t.get()},isDefault:function(){return ce(e,n)},isDefaultContent:function(e){return e===n}}}(l=e),l.on("PreInit",function(){return function(e,t,n){var r;(function(e,t,n){var r,o=x(),i=x();e.on("keyup",i.clear),e.on("keydown",function(n){var u=function(e){ie(e)&&!e.isDefaultPrevented()&&t.remove()};if(ie(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&C.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o.set(n),i.set(!0),C.ie&&r)return n.preventDefault(),void e.fire("paste",{ieFake:!0});t.remove(),t.create(),e.once("keyup",u),e.once("paste",function(){e.off("keyup",u)})}});var u=function(e,n,r,o,i){var u;te(n,"text/html")?u=n["text/html"]:(u=t.getHtml(),i=i||M(u),t.isDefaultContent(u)&&(o=!0)),u=j(u),t.remove();var a,c,s,l,f,d,m,g,p=!1===i&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(u),h=$(e,u);u.length&&(!p||h)||(o=!0),(o||h)&&(u=te(n,"text/plain")&&p?n["text/plain"]:(a=u,c=H(),s=L({},c),l="",f=c.getShortEndedElements(),d=T.makeMap("script noscript style textarea video audio iframe object"," "),m=c.getBlockElements(),g=function(e){var t=e.name,n=e;if("br"!==t){if("wbr"!==t)if(f[t]&&(l+=" "),d[t])l+=" ";else{if(3===e.type&&(l+=e.value),!e.shortEnded&&(e=e.firstChild))for(;g(e),e=e.next;);m[t]&&n.next&&(l+="\n","p"===t&&(l+="\n"))}}else l+="\n"},a=V(a,[/<!\[[^\]]+\]>/g]),g(s.parse(a)),l)),t.isDefaultContent(u)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?Z(e,u):Q(e,u,i)};e.on("paste",function(a){var c=o.isSet()||i.isSet();c&&o.clear();var s,l=ee(a.clipboardData||e.getDoc().dataTransfer),f="text"===n.get()||r,d=te(l,D);r=!1,a.isDefaultPrevented()||(s=a.clipboardData,-1!==navigator.userAgent.indexOf("Android")&&s&&s.items&&0===s.items.length)||!ne(l)&&oe(e,a,t.getLastRng()||e.selection.getRng())?t.remove():(c||a.preventDefault(),!C.ie||c&&!a.ieFake||te(l,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",function(e){e.stopPropagation()}),e.getDoc().execCommand("Paste",!1,null),l["text/html"]=t.getHtml()),te(l,"text/html")?(a.preventDefault(),d=d||M(l["text/html"]),u(e,l,c,f,d)):S.setEditorTimeout(e,function(){u(e,l,c,f,d)},0))})})(e,t,n),e.parser.addNodeFilter("img",function(t,n,o){var i,u=function(e){e.attr("data-mce-object")||r===C.transparentSrc||e.remove()};if(!N(e)&&(i=o).data&&!0===i.data.paste)for(var a=t.length;a--;)(r=t[a].attr("src"))&&(0!==r.indexOf("webkit-fake-url")&&(e.getParam("allow_html_data_urls",!1,"boolean")||0!==r.indexOf("data:"))||u(t[a]))})}(l,d,f)}),{pasteFormat:f,pasteHtml:function(e,t){return Q(l,e,t)},pasteText:function(e){return Z(l,e)},pasteImageData:function(e,t){return oe(l,e,t)},getDataTransferItems:ee,hasHtmlOrText:ne,hasContentType:te});return a=e,C.webkit&&ve(a,ye),C.ie&&(ve(a,be),s=xe,(c=a).on("PastePostProcess",function(e){s(c,e.node)})),(i=e).ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return i.execCommand("mceTogglePlainTextPaste")},onSetup:we(i,u=r)}),i.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:function(){return i.execCommand("mceTogglePlainTextPaste")},onSetup:we(i,u)}),function(e,t){e.addCommand("mceTogglePlainTextPaste",function(){var n,r;n=e,"text"===(r=t).pasteFormat.get()?(r.pasteFormat.set("html"),_(n,!1)):(r.pasteFormat.set("text"),_(n,!0)),n.focus()}),e.addCommand("mceInsertClipboardContent",function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)})}(e,r),function(e){var t=e.plugins.paste,n=e.getParam("paste_preprocess");n&&e.on("PastePreProcess",function(e){n.call(t,t,e)});var r=e.getParam("paste_postprocess");r&&e.on("PastePostProcess",function(e){r.call(t,t,e)})}(e),me(e),function(e,t,n){e.getParam("paste_block_drop",!1)&&e.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),E(e)||e.on("drop",function(e){var t=e.dataTransfer;t&&t.files&&0<t.files.length&&e.preventDefault()}),e.on("drop",function(r){var o,i,u,a,c=pe(e,r);r.isDefaultPrevented()||n.get()||(o=t.getDataTransferItems(r.dataTransfer),i=t.hasContentType(o,D),(!t.hasHtmlOrText(o)||(u=o["text/plain"])&&0===u.indexOf("file://"))&&t.pasteImageData(r,c)||!c||!e.getParam("paste_filter_drop",!0)||(a=o["mce-internal"]||o["text/html"]||o["text/plain"])&&(r.preventDefault(),S.setEditorTimeout(e,function(){e.undoManager.transact(function(){o["mce-internal"]&&e.execCommand("Delete"),he(e,c),a=j(a),o["text/html"]?t.pasteHtml(a,i):t.pasteText(a)})})))}),e.on("dragstart",function(e){n.set(!0)}),e.on("dragover dragend",function(t){E(e)&&!1===n.get()&&(t.preventDefault(),he(e,pe(e,t))),"dragend"===t.type&&n.set(!1)})}(e,r,t),{clipboard:r,quirks:void 0}}var i,u,a,c,s,l,f,d})}(),function(){"use strict";var e=function(){},t=function(e){return function(){return e}},n=function(e){return e};function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var o,i,u,a=function(e){return function(t){return!e(t)}},c=t(!1),s=t(!0),l=function(){return f},f=(o=function(e){return e.isNone()},{fold:function(e,t){return e()},is:c,isSome:c,isNone:s,getOr:u=function(e){return e},getOrThunk:i=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:u,orThunk:i,map:l,each:e,bind:l,exists:c,forall:s,filter:l,equals:o,equals_:o,toArray:function(){return[]},toString:t("none()")}),d=function(e){var n=t(e),r=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:s,isNone:c,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:r,orThunk:r,map:function(t){return d(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(c,function(t){return n(e,t)})}};return i},m={some:d,none:l,from:function(e){return null==e?f:d(e)}},g=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},p=function(e){return function(t){return typeof t===e}},h=g("string"),v=g("object"),b=g("array"),y=p("boolean"),x=function(e){return!(null===(t=e)||void 0===t);var t},w=p("function"),C=p("number"),S=Array.prototype.slice,k=Array.prototype.indexOf,O=Array.prototype.push,_=function(e,t){return-1<k.call(e,t)},T=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},E=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},A=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o],o);return r},R=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},N=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},B=function(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,function(e){n=t(n,e)}),n},D=function(e,t,n){return R(e,function(e){n=t(n,e)}),n},P=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return m.some(i);if(n(i,r))break}return m.none()}(e,t,c)},M=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return m.some(n);return m.none()},I=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!b(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);O.apply(t,e[n])}return t},L=function(e,t){return I(A(e,t))},F=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0},z=function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},H=function(e){return[e]},V=function(e,t){return 0<=t&&t<e.length?m.some(e[t]):m.none()},j=function(e){return V(e,0)},U=function(e){return V(e,e.length-1)},W=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return m.none()},q=function(){return(q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function G(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var $,X=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},K=function(){return Y(0,0)},Y=function(e,t){return{major:e,minor:t}},J=function(e,t){var n=String(t).toLowerCase();return 0===e.length?K():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Y(r(1),r(2))}(e,n)},Q=K,Z=function(e,t){var n=String(t).toLowerCase();return P(e,function(e){return e.search(n)})},ee=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},te=function(e,t){return-1!==e.indexOf(t)},ne=function(e,t){return ee(e,t,0)},re=function(e,t){return ee(e,t,e.length-t.length)},oe=($=/^\s+|\s+$/g,function(e){return e.replace($,"")}),ie=function(e){return 0<e.length},ue=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ae=function(e){return function(t){return te(t,e)}},ce=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return te(e,"edge/")&&te(e,"chrome")&&te(e,"safari")&&te(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ue],search:function(e){return te(e,"chrome")&&!te(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return te(e,"msie")||te(e,"trident")}},{name:"Opera",versionRegexes:[ue,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ae("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ae("firefox")},{name:"Safari",versionRegexes:[ue,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(te(e,"safari")||te(e,"mobile/"))&&te(e,"applewebkit")}}],se=[{name:"Windows",search:ae("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return te(e,"iphone")||te(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ae("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ae("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ae("linux"),versionRegexes:[]},{name:"Solaris",search:ae("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ae("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ae("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],le={browsers:t(ce),oses:t(se)},fe="Firefox",de=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(fe),isSafari:n("Safari")}},me=function(){return de({current:void 0,version:Q()})},ge=de,pe=(t("Edge"),t("Chrome"),t("IE"),t("Opera"),t(fe),t("Safari"),"Windows"),he="Android",ve="Solaris",be="FreeBSD",ye="ChromeOS",xe=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(pe),isiOS:n("iOS"),isAndroid:n(he),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(ve),isFreeBSD:n(be),isChromeOS:n(ye)}},we=function(){return xe({current:void 0,version:Q()})},Ce=xe,Se=(t(pe),t("iOS"),t(he),t("Linux"),t("OSX"),t(ve),t(be),t(ye),function(e,n){var r,o,i,u,a,c,s,l,f,d,m,g,p=le.browsers(),h=le.oses(),v=function(e,t){return Z(e,t).map(function(e){var n=J(e.versionRegexes,t);return{current:e.name,version:n}})}(p,e).fold(me,ge),b=function(e,t){return Z(e,t).map(function(e){var n=J(e.versionRegexes,t);return{current:e.name,version:n}})}(h,e).fold(we,Ce);return{browser:v,os:b,deviceType:(o=v,i=e,u=n,a=(r=b).isiOS()&&!0===/ipad/i.test(i),c=r.isiOS()&&!a,s=r.isiOS()||r.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=o.isSafari()&&r.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:t(a),isiPhone:t(c),isTablet:t(f),isPhone:t(d),isTouch:t(l),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:t(m),isDesktop:t(g)})}}),ke=function(e){return window.matchMedia(e).matches},Oe=X(function(){return Se(navigator.userAgent,ke)}),_e=function(){return Oe()},Te=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Ee={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Te(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return Te(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return Te(n)},fromDom:Te,fromPoint:function(e,t,n){return m.from(e.dom.elementFromPoint(t,n)).map(Te)}},Ae=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Re=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Ne=function(e,t){return e.dom===t.dom},Be=function(e,t){return _e().browser.isIE()?function(e,t){return n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.dom.compareDocumentPosition(t.dom)&n);var n}(e,t):(n=e.dom)!==(r=t.dom)&&n.contains(r);var n,r},De=Ae,Pe=Object.keys,Me=Object.hasOwnProperty,Ie=function(e,t){for(var n=Pe(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},Le=function(e,t){return Fe(e,function(e,n){return{k:n,v:t(e,n)}})},Fe=function(e,t){var n={};return Ie(e,function(e,r){var o=t(e,r);n[o.k]=o.v}),n},ze=function(t,n){var r,o,i,u,a={};return r=n,u=a,o=function(e,t){u[t]=e},i=e,Ie(t,function(e,t){(r(e,t)?o:i)(e,t)}),a},He=function(e,t){var n=[];return Ie(e,function(e,r){n.push(t(e,r))}),n},Ve=function(e){return Pe(e).length},je=function(e,t){return Ue(e,t)?m.from(e[t]):m.none()},Ue=function(e,t){return Me.call(e,t)},We=function(e,t){return Ue(e,t)&&null!=e[t]},qe=["tfoot","thead","tbody","colgroup"],Ge=function(e,t,n){return{element:e,rowspan:t,colspan:n}},$e=function(e,t,n){return{element:e,cells:t,section:n}},Xe=function(e,t,n){return{element:e,isNew:t,isLocked:n}},Ke=function(e,t){return{cells:e,section:t}},Ye=("undefined"!=typeof window||Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),Je=function(e){return e.dom.nodeType},Qe=function(e){return function(t){return Je(t)===e}},Ze=function(e){return 8===Je(e)||"#comment"===Ye(e)},et=Qe(1),tt=Qe(3),nt=Qe(9),rt=Qe(11),ot=function(e){return function(t){return et(t)&&Ye(t)===e}},it=function(e){return Ee.fromDom(e.dom.ownerDocument)},ut=function(e){return nt(e)?e:it(e)},at=function(e){return m.from(e.dom.parentNode).map(Ee.fromDom)},ct=function(e,t){for(var n=w(t)?t:c,r=e.dom,o=[];null!=r.parentNode;){var i=r.parentNode,u=Ee.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},st=function(e){return m.from(e.dom.previousSibling).map(Ee.fromDom)},lt=function(e){return m.from(e.dom.nextSibling).map(Ee.fromDom)},ft=function(e){return A(e.dom.childNodes,Ee.fromDom)},dt=function(e,t){return m.from(e.dom.childNodes[t]).map(Ee.fromDom)},mt=w(Element.prototype.attachShadow)&&w(Node.prototype.getRootNode),gt=t(mt),pt=mt?function(e){return Ee.fromDom(e.dom.getRootNode())}:ut,ht=function(e){return Ee.fromDom(e.dom.host)},vt=function(e){var t=tt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return function(e){var t,n=pt(e);return rt(t=n)&&x(t.dom.host)?m.some(n):m.none()}(Ee.fromDom(t)).fold(function(){return o.body.contains(t)},(n=vt,r=ht,function(e){return n(r(e))}))},bt=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return Ee.fromDom(t)},yt=function(e,t){var n=[];return R(ft(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(yt(e,t))}),n},xt=function(e,t,n){return r=function(e){return Ae(e,t)},N(ct(e,n),r);var r},wt=function(e,t){return n=function(e){return Ae(e,t)},N(ft(e),n);var n},Ct=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Re(o)?[]:A(o.querySelectorAll(n),Ee.fromDom);var n,r,o};function St(e,t,n,r,o){return e(n,r)?m.some(n):w(o)&&o(n)?m.none():t(n,r,o)}var kt,Ot,_t=function(e,t,n){for(var r=e.dom,o=w(n)?n:c;r.parentNode;){var i=Ee.fromDom(r=r.parentNode);if(t(i))return m.some(i);if(o(i))break}return m.none()},Tt=function(e,t,n){return _t(e,function(e){return Ae(e,t)},n)},Et=function(e,t){return n=function(e){return Ae(e,t)},P(e.dom.childNodes,function(e){return n(Ee.fromDom(e))}).map(Ee.fromDom);var n},At=function(e,t){return n=t,o=void 0===(r=e)?document:r.dom,Re(o)?m.none():m.from(o.querySelector(n)).map(Ee.fromDom);var n,r,o},Rt=function(e,t,n){return St(Ae,Tt,e,t,n)},Nt=function(e,t,n){if(!(h(n)||y(n)||C(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Bt=function(e,t,n){Nt(e.dom,t,n)},Dt=function(e,t){var n=e.dom;Ie(t,function(e,t){Nt(n,t,e)})},Pt=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Mt=function(e,t){return m.from(Pt(e,t))},It=function(e,t){e.dom.removeAttribute(t)},Lt=function(e){return D(e.dom.attributes,function(e,t){return e[t.name]=t.value,e},{})},Ft=function(e){return void 0!==e.style&&w(e.style.getPropertyValue)},zt=function(e,t,n){if(!h(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ft(e)&&e.style.setProperty(t,n)},Ht=function(e,t,n){zt(e.dom,t,n)},Vt=function(e,t){var n=e.dom;Ie(t,function(e,t){zt(n,t,e)})},jt=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||vt(e)?r:Ut(n,t)},Ut=function(e,t){return Ft(e)?e.style.getPropertyValue(t):""},Wt=function(e,t){var n=Ut(e.dom,t);return m.from(n).filter(function(e){return 0<e.length})},qt=function(e,t){var n,r;r=t,Ft(n=e.dom)&&n.style.removeProperty(r),Mt(e,"style").map(oe).is("")&&It(e,"style")},Gt=function(e,t,n){return void 0===n&&(n=0),Mt(e,t).map(function(e){return parseInt(e,10)}).getOr(n)},$t=function(e,t){return Gt(e,t,1)},Xt=function(e){return 1<$t(e,"colspan")},Kt=function(e){return 1<$t(e,"rowspan")},Yt=function(e,t){return parseInt(jt(e,t),10)},Jt=t(10),Qt=t(10),Zt=function(e,t){return en(e,t,s)},en=function(e,t,n){return L(ft(e),function(e){return Ae(e,t)?n(e)?[e]:[]:en(e,t,n)})},tn=function(e,t){return function(e,t,n){return void 0===n&&(n=c),n(t)?m.none():_(e,Ye(t))?m.some(t):Tt(t,e.join(","),function(e){return Ae(e,"table")||n(e)})}(["td","th"],e,t)},nn=function(e){return Zt(e,"th,td")},rn=function(e){return Ae(e,"colgroup")?wt(e,"col"):L(an(e),function(e){return wt(e,"col")})},on=function(e,t){return Rt(e,"table",t)},un=function(e){return Zt(e,"tr")},an=function(e){return on(e).fold(t([]),function(e){return wt(e,"colgroup")})},cn=function(e,t){return A(e,function(e){if("colgroup"===Ye(e)){var n=A(rn(e),function(e){var t=Gt(e,"span",1);return Ge(e,1,t)});return $e(e,n,"colgroup")}return n=A(nn(e),function(e){var t=Gt(e,"rowspan",1),n=Gt(e,"colspan",1);return Ge(e,t,n)}),$e(e,n,t(e))})},sn=function(e){return at(e).map(function(e){var t=Ye(e);return _(qe,t)?t:"tbody"}).getOr("tbody")},ln=function(e){var t=un(e),n=G(an(e),t);return cn(n,sn)},fn=function(e,t,n){var r=e.cells,o=r.slice(0,t),i=r.slice(t),u=o.concat(n).concat(i);return gn(e,u)},dn=function(e,t,n){return fn(e,t,[n])},mn=function(e,t,n){e.cells[t]=n},gn=function(e,t){return Ke(t,e.section)},pn=function(e,t){var n=A(e.cells,t);return Ke(n,e.section)},hn=function(e,t){return e.cells[t]},vn=function(e,t){return hn(e,t).element},bn=function(e){return e.cells.length},yn=function(e){var t=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var u=e[o];(t(u)?n:r).push(u)}return{pass:n,fail:r}}(e,function(e){return"colgroup"===e.section});return{rows:t.fail,cols:t.pass}},xn="data-snooker-locked-cols",wn=function(e){return Mt(e,xn).bind(function(e){return m.from(e.match(/\d+/g))}).map(function(e){return z(e,s)})},Cn=function(e){var t,n=D(yn(e).rows,function(e,t){return R(t.cells,function(t,n){t.isLocked&&(e[n]=!0)}),e},{}),r=He(n,function(e,t){return parseInt(t,10)});return(t=S.call(r,0)).sort(void 0),t},Sn=function(e,t){return e+","+t},kn=function(e,t){var n=L(e.all,function(e){return e.cells});return N(n,t)},On=function(e){var t={},n=[],r={},o=j(e).map(function(e){return e.element}).bind(on).bind(wn).getOr({}),i=0,u=0,a=0;return R(e,function(e){var c,s,l;"colgroup"===e.section?(s={},l=0,R(e.cells,function(e){var t=e.colspan;E(t,function(n){var r=l+n;s[r]={element:e.element,colspan:t,column:r}}),l+=t}),r=s):(c=[],R(e.cells,function(e){for(var n=0;void 0!==t[Sn(a,n)];)n++;for(var r=We(o,n.toString()),i={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:a,column:n,isLocked:r},s=0;s<e.colspan;s++)for(var l=0;l<e.rowspan;l++){var f=n+s,d=Sn(a+l,f);t[d]=i,u=Math.max(u,f+1)}c.push(i)}),i++,n.push($e(e.element,c,e.section)),a++)}),{grid:{rows:i,columns:u},access:t,all:n,columns:r}},_n=function(e){var t=ln(e);return On(t)},Tn=On,En=function(e,t,n){var r=e.access[Sn(t,n)];return void 0!==r?m.some(r):m.none()},An=function(e,t,n){var r=kn(e,function(e){return n(t,e.element)});return 0<r.length?m.some(r[0]):m.none()},Rn=kn,Nn=function(e){return L(e.all,function(e){return e.cells})},Bn=function(e){return He(e.columns,function(e){return e})},Dn=function(e){return 0<Pe(e.columns).length},Pn=function(e,t){return m.from(e.columns[t])},Mn=function(e,t){return t.column<=e.finishCol&&t.column+t.colspan-1>=e.startCol&&t.row<=e.finishRow&&t.row+t.rowspan-1>=e.startRow},In=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},Ln=function(e,t,n){var r=An(e,t,Ne),o=An(e,n,Ne);return r.bind(function(e){return o.map(function(t){return n=e,r=t,{startRow:Math.min(n.row,r.row),startCol:Math.min(n.column,r.column),finishRow:Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,r.column+r.colspan-1)};var n,r})})},Fn=function(e,t,n){return Ln(e,t,n).map(function(t){var n=Rn(e,r(Mn,t));return A(n,function(e){return e.element})})},zn=function(e,t){return An(e,t,function(e,t){return Be(t,e)}).map(function(e){return e.element})},Hn=function(e,t,n,r,o){var i=Vn(e),u=Ne(e,n)?m.some(t):zn(i,t),a=Ne(e,o)?m.some(r):zn(i,r);return u.bind(function(e){return a.bind(function(t){return Fn(i,e,t)})})},Vn=_n,jn=function(e,t){at(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Un=function(e,t){lt(e).fold(function(){at(e).each(function(e){qn(e,t)})},function(e){jn(e,t)})},Wn=function(e,t){dt(e,0).fold(function(){qn(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},qn=function(e,t){e.dom.appendChild(t.dom)},Gn=function(e,t){jn(e,t),qn(t,e)},$n=function(e,t){R(t,function(n,r){Un(0===r?e:t[r-1],n)})},Xn=function(e,t){R(t,function(t){qn(e,t)})},Kn=function(e){e.dom.textContent="",R(ft(e),function(e){Yn(e)})},Yn=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Jn=function(e){var t,n=ft(e);0<n.length&&(t=e,R(n,function(e){jn(t,e)})),Yn(e)},Qn=(kt=tt,{get:function(e){if(!kt(e))throw new Error("Can only get text value of a text node");return Ot(e).getOr("")},getOption:Ot=function(e){return kt(e)?m.from(e.dom.nodeValue):m.none()},set:function(e,t){if(!kt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),Zn=function(e){return Qn.get(e)},er=function(e){return Qn.getOption(e)},tr=function(e,t){return Qn.set(e,t)},nr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function rr(){return{up:t({selector:Tt,closest:Rt,predicate:_t,all:ct}),down:t({selector:Ct,predicate:yt}),styles:t({get:jt,getRaw:Wt,set:Ht,remove:qt}),attrs:t({get:Pt,set:Bt,remove:It,copyTo:function(e,t){var n=Lt(e);Dt(t,n)}}),insert:t({before:jn,after:Un,afterAll:$n,append:qn,appendAll:Xn,prepend:Wn,wrap:Gn}),remove:t({unwrap:Jn,remove:Yn}),create:t({nu:Ee.fromTag,clone:function(e){return Ee.fromDom(e.dom.cloneNode(!1))},text:Ee.fromText}),query:t({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:st,nextSibling:lt}),property:t({children:ft,name:Ye,parent:at,document:function(e){return ut(e).dom},isText:tt,isComment:Ze,isElement:et,isSpecial:function(e){var t=Ye(e);return _(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getText:Zn,setText:tr,isBoundary:function(e){return!!et(e)&&("body"===Ye(e)||_(nr,Ye(e)))},isEmptyTag:function(e){return!!et(e)&&_(["br","img","hr","input"],Ye(e))},isNonEditable:function(e){return et(e)&&"false"===Pt(e,"contenteditable")}}),eq:Ne,is:De}}var or,ir,ur,ar,cr=function(e,t,n,o){void 0===o&&(o=c);var i=[t].concat(e.up().all(t)),u=[n].concat(e.up().all(n)),a=function(e){return M(e,o).fold(function(){return e},function(t){return e.slice(0,t+1)})},s=a(i),l=a(u),f=P(s,function(t){return T(l,r(e.eq,t))});return{firstpath:s,secondpath:l,shared:f}},sr=rr(),lr=function(e,t){return function(e,t,n){return 0<n.length?function(e,t,n,o){var i=t(e,n);return B(o,function(n,o){var i=t(e,o);return function(e,t,n){return t.bind(function(t){return n.filter(r(e.eq,t))})}(e,n,i)},i)}(e,t,(o=n)[0],o.slice(1)):m.none();var o}(sr,function(t,n){return e(n)},t)},fr=function(e){return Tt(e,"table")},dr=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||Ne(t,e)}};return Ne(e,t)?m.some({boxes:m.some([e]),start:e,finish:t}):fr(e).bind(function(o){return fr(t).bind(function(i){if(Ne(o,i))return m.some({boxes:(s=e,l=t,f=Vn(o),Fn(f,s,l)),start:e,finish:t});if(Be(o,i)){var u=0<(a=xt(t,"td,th",r(o))).length?a[a.length-1]:t;return m.some({boxes:Hn(o,e,o,t,i),start:e,finish:u})}if(Be(i,o)){var a,c=0<(a=xt(e,"td,th",r(i))).length?a[a.length-1]:e;return m.some({boxes:Hn(i,e,o,t,i),start:e,finish:c})}return cr(sr,e,t,void 0).shared.bind(function(u){return Rt(u,"table",n).bind(function(n){var u=xt(t,"td,th",r(n)),a=0<u.length?u[u.length-1]:t,c=xt(e,"td,th",r(n)),s=0<c.length?c[c.length-1]:e;return m.some({boxes:Hn(n,e,o,t,i),start:s,finish:a})})});var s,l,f})})},mr=function(e,t){var n=Ct(e,t);return 0<n.length?m.some(n):m.none()},gr=function(e,t,n){return At(e,t).bind(function(t){return At(e,n).bind(function(e){return lr(fr,[t,e]).map(function(n){return{first:t,last:e,table:n}})})})},pr=mr,hr=function(e){if(!b(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return R(e,function(r,o){var i=Pe(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!b(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:function(e){var r=Pe(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!F(t,function(e){return _(r,e)}))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:u,params:n})}}}}),n},vr=hr([{none:[]},{multiple:["elements"]},{single:["element"]}]),br=function(e,t,n,r){return e.fold(t,n,r)},yr=vr.none,xr=vr.multiple,wr=vr.single,Cr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Sr=function(e,t){return Ee.fromDom(e.dom.cloneNode(t))},kr=function(e){return Sr(e,!1)},Or=function(e){return Sr(e,!0)},_r=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Tr=function(e,t){return e?m.some(t):m.none()},Er=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=jt(n,e);return parseFloat(o)||0}return r},r=function(e,t){return D(t,function(t,n){var r=jt(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!C(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Ft(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return o<t?t-o:0}}},Ar=Er("width",function(e){return e.dom.offsetWidth}),Rr=function(e){return Ar.get(e)},Nr=function(e){return Ar.getOuter(e)},Br=function(e,t){void 0===t&&(t=s);var r=e.grid,o=E(r.columns,n),i=E(r.rows,n);return A(o,function(n){return Dr(function(){return L(i,function(t){return En(e,t,n).filter(function(e){return e.column===n}).toArray()})},function(e){return 1===e.colspan&&t(e.element)},function(){return En(e,0,n)})})},Dr=function(e,t,n){var r=e();return P(r,t).orThunk(function(){return m.from(r[0]).orThunk(n)}).map(function(e){return e.element})},Pr=function(e){var r=e.grid,o=E(r.rows,n),i=E(r.columns,n);return A(o,function(n){return Dr(function(){return L(i,function(r){return En(e,n,r).filter(function(e){return e.row===n}).fold(t([]),function(e){return[e]})})},function(e){return 1===e.rowspan},function(){return En(e,n,0)})})},Mr=function(e,t){return function(n){return"rtl"===Ir(n)?t:e}},Ir=function(e){return"rtl"===jt(e,"direction")?"rtl":"ltr"},Lr=Er("height",function(e){var t=e.dom;return vt(e)?t.getBoundingClientRect().height:t.offsetHeight}),Fr=function(e){return Lr.get(e)},zr=function(e){return Lr.getOuter(e)},Hr=function(e,t){return{left:e,top:t,translate:function(n,r){return Hr(e+n,t+r)}}},Vr=Hr,jr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Ur=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Vr(n.offsetLeft,n.offsetTop);var i=jr(null==r?void 0:r.pageYOffset,o.scrollTop),u=jr(null==r?void 0:r.pageXOffset,o.scrollLeft),a=jr(o.clientTop,n.clientTop),c=jr(o.clientLeft,n.clientLeft);return Wr(e).translate(u-c,i-a)},Wr=function(e){var t,n=e.dom,r=n.ownerDocument.body;return r===n?Vr(r.offsetLeft,r.offsetTop):vt(e)?(t=n.getBoundingClientRect(),Vr(t.left,t.top)):Vr(0,0)},qr=function(e,t){return{row:e,y:t}},Gr=function(e,t){return{col:e,x:t}},$r=function(e){return Ur(e).left+Nr(e)},Xr=function(e){return Ur(e).left},Kr=function(e,t){return Gr(e,Xr(t))},Yr=function(e,t){return Gr(e,$r(t))},Jr=function(e){return Ur(e).top},Qr=function(e,t){return qr(e,Jr(t))},Zr=function(e,t){return qr(e,Jr(t)+zr(t))},eo=function(e,t,n){if(0===n.length)return[];var r=A(n.slice(1),function(t,n){return t.map(function(t){return e(n,t)})}),o=n[n.length-1].map(function(e){return t(n.length-1,e)});return r.concat([o])},to={delta:n,positions:function(e){return eo(Qr,Zr,e)},edge:Jr},no=Mr({delta:n,edge:Xr,positions:function(e){return eo(Kr,Yr,e)}},{delta:function(e){return-e},edge:$r,positions:function(e){return eo(Yr,Kr,e)}}),ro={delta:function(e,t){return no(t).delta(e,t)},positions:function(e,t){return no(t).positions(e,t)},edge:function(e){return no(e).edge(e)}},oo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},io=(ir="[eE][+-]?[0-9]+",ar=["Infinity",(or="[0-9]+")+"\\."+(ur=function(e){return"(?:"+e+")?"})(or)+ur(ir),"\\."+or+ur(ir),or+ur(ir)].join("|"),new RegExp("^([+-]?(?:"+ar+"))(.*)$")),uo=function(){var e=_e().browser;return e.isIE()||e.isEdge()},ao=function(e,t,n){return r=jt(e,t),o=n,i=parseFloat(r),isNaN(i)?o:i;var r,o,i},co=function(e){return uo()?(n=(t=e).dom.getBoundingClientRect().width,"border-box"===jt(t,"box-sizing")?n:n-ao(t,"padding-left",0)-ao(t,"padding-right",0)-(ao(t,"border-left-width",0)+ao(t,"border-right-width",0))):ao(e,"width",Rr(e));var t,n},so=/(\d+(\.\d+)?)%/,lo=/(\d+(\.\d+)?)px|em/,fo=function(e,t){Ht(e,"width",t+"px")},mo=function(e,t){Ht(e,"width",t+"%")},go=function(e,t){Ht(e,"height",t+"px")},po=function(e){return Wt(e,"width").fold(function(){return m.from(Pt(e,"width"))},function(e){return m.some(e)})},ho=function(e,t){return e/t.pixelWidth()*100},vo=function(e,t){return po(e).fold(function(){var n=Rr(e);return ho(n,t)},function(n){return function(e,t,n){var r=so.exec(t);if(null!==r)return parseFloat(r[1]);var o=co(e);return ho(o,n)}(e,n,t)})},bo=function(e,t){return po(e).fold(function(){return co(e)},function(n){return function(e,t,n){var r=lo.exec(t);if(null!==r)return parseInt(r[1],10);var o=so.exec(t);return null===o?co(e):parseFloat(o[1])/100*n.pixelWidth()}(e,n,t)})},yo=function(e){return function(e){var t,n=Wt(t=e,"height").getOrThunk(function(){return function(e){return uo()?(n=(t=e).dom.getBoundingClientRect().height,"border-box"===jt(t,"box-sizing")?n:n-ao(t,"padding-top",0)-ao(t,"padding-bottom",0)-(ao(t,"border-top-width",0)+ao(t,"border-bottom-width",0))):ao(e,"height",Fr(e));var t,n}(t)+"px"});return n?function(e,t,n,r){var o,i,u,a,c,s=parseInt(e,10);return re(e,"%")&&"table"!==Ye(t)?(i=s,u=n,a=r,c=on(o=t).map(function(e){var t=u(e);return Math.floor(i/100*t)}).getOr(i),a(o,c),c):s}(n,e,Fr,go):Fr(e)}(t=e)/$t(t,"rowspan");var t},xo=function(e,t,n){Ht(e,"width",t+n)},wo=function(e){return function(e,t){var n=m.from(e.dom.offsetParent).map(Ee.fromDom).getOr(bt(it(e)));return t(e)/t(n)*100}(e,Rr)+"%"},Co=t(so),So=t(lo),ko=ot("col"),Oo=function(e,t,n){return Wt(e,t).fold(function(){return n(e)+"px"},function(e){return e})},_o=function(e,t){return Oo(e,"width",function(e){return ko(e)?Rr(e):bo(e,t)})},To=function(e){return Oo(e,"height",yo)},Eo=function(e,t){return Wt(e,t).isSome()},Ao=function(e,t,n,r,o,i){return e.filter(r).fold(function(){return i(function(e,t){if(t<0||t>=e.length-1)return m.none();var n=e[t].fold(function(){var n,r,o=(n=e.slice(0,t),(r=S.call(n,0)).reverse(),r);return W(o,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return m.some({value:e,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return W(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return m.some({value:e,delta:1})});return n.bind(function(e){return r.map(function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n})})}(n,t))},function(e){return o(e)})},Ro=function(e,t,n,r,o){var i=Br(e,function(e){return Eo(e,"width")}),u=Dn(e)?A(Bn(e),function(e){return m.from(e.element)}):i,c=[m.some(ro.edge(t))].concat(A(ro.positions(i,t),function(e){return e.map(function(e){return e.x})})),s=a(Xt);return A(u,function(e,t){return Ao(e,t,c,s,function(e){if(!ko(a=e)||Eo(a,"width"))return n(e,o);var u,a,l=null!=(u=i[t])?u:m.none();return Ao(l,t,c,s,function(e){return r(m.some(Rr(e)))},r)},r)})},No=function(e){return e.map(function(e){return e+"px"}).getOr("")},Bo=function(e,t,n){return Ro(e,t,bo,function(e){return e.getOrThunk(n.minCellWidth)},n)},Do=function(e,t,n,r,o){var i=Pr(e),u=[m.some(n.edge(t))].concat(A(n.positions(i,t),function(e){return e.map(function(e){return e.y})}));return A(i,function(e,t){return Ao(e,t,u,a(Kt),r,o)})},Po=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Mo=function(e,t){var n=Po(parseFloat(e)),r=Po(Rr(t));return{width:n.get,pixelWidth:r.get,getWidths:function(e,n){return Ro(e,t,vo,function(e){return e.fold(function(){return r.minCellWidth()},function(e){return e/r.pixelWidth()*100})},r=n);var r},getCellDelta:function(e){return e/r.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return Jt()/r.get()*100},setElementWidth:mo,adjustTableWidth:function(e){var o=n.get(),i=o+e/100*o;mo(t,i),n.set(i),r.set(Rr(t))},isRelative:!0,label:"percent"}},Io=function(e,t){var r=Po(e),o=r.get;return{width:o,pixelWidth:o,getWidths:function(e,n){return Bo(e,t,n)},getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(Jt(),e+t)-e]},minCellWidth:Jt,setElementWidth:fo,adjustTableWidth:function(e){var n=o()+e;fo(t,n),r.set(n)},isRelative:!1,label:"pixel"}},Lo=function(n){return po(n).fold(function(){return function(n){var r=function(){return Rr(n)},o=t(0);return{width:r,pixelWidth:r,getWidths:function(e,t){return Bo(e,n,t)},getCellDelta:o,singleColumnWidth:t([0]),minCellWidth:o,setElementWidth:e,adjustTableWidth:e,isRelative:!0,label:"none"}}(n)},function(e){return function(e,t){var n=Co().exec(t);if(null!==n)return Mo(n[1],e);var r=So().exec(t);if(null!==r){var o=parseInt(r[1],10);return Io(o,e)}var i=Rr(e);return Io(i,e)}(n,e)})},Fo=Io,zo=Mo,Ho=function(e){return"img"===Ye(e)?1:er(e).fold(function(){return ft(e).length},function(e){return e.length})},Vo=["img","br"],jo=function(e){return er(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf(" ")}).isSome()||_(Vo,Ye(e))},Uo=function(e){return t=jo,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=Ee.fromDom(e.childNodes[r]);if(t(o))return m.some(o);var i=n(e.childNodes[r]);if(i.isSome())return i}return m.none()})(e.dom);var t,n},Wo=function(e){return qo(e,jo)},qo=function(e,t){var n=function(e){for(var r=ft(e),o=r.length-1;0<=o;o--){var i=r[o];if(t(i))return m.some(i);var u=n(i);if(u.isSome())return u}return m.none()};return n(e)},Go={scope:["row","col"]},$o=function(){var e=Ee.fromTag("td");return qn(e,Ee.fromTag("br")),e},Xo=function(){return Ee.fromTag("col")},Ko=function(){return Ee.fromTag("colgroup")},Yo=function(e,t,n){var r=function(e,t){var n,r,o,i=(n=e,r=Ee.fromTag(t),o=Lt(n),Dt(r,o),r),u=ft(Or(e));return Xn(i,u),i}(e,t);return Ie(n,function(e,t){null===e?It(r,t):Bt(r,t,e)}),r},Jo=function(e){return e},Qo=function(e){return function(){return Ee.fromTag("tr",e.dom)}},Zo=function(e,t,n){var r=function(e,t){var n,r;r=t.dom,Ft(n=e.element.dom)&&Ft(r)&&(r.style.cssText=n.style.cssText),qt(t,"height"),1!==e.colspan&&qt(t,"width")};return{col:function(t){var n=it(t.element),o=Ee.fromTag(Ye(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:Ko,row:Qo(t),cell:function(t){var o,i,u,a,c,s=it(t.element),l=Ee.fromTag(Ye(t.element),s.dom),f=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<f.length?(i=l,u=f,Uo(o=t.element).map(function(e){var t=u.join(","),n=xt(e,t,function(e){return Ne(e,o)});return B(n,function(e,t){var n=kr(t);return It(n,"contenteditable"),qn(e,n),n},i)}).getOr(i)):l;return qn(d,Ee.fromTag("br")),r(t,l),a=t.element,c=l,Ie(Go,function(e,t){return Mt(a,t).filter(function(t){return _(e,t)}).each(function(e){return Bt(c,t,e)})}),e(t.element,l),l},replace:Yo,gap:$o}},ei=function(e){return{col:Xo,colgroup:Ko,row:Qo(e),cell:$o,replace:Jo,gap:$o}},ti=function(e){return A(e,Ee.fromDom)},ni=function(e){return e.nodeName.toLowerCase()},ri=function(e){return Ee.fromDom(e.getBody())},oi=function(e){return e.getBoundingClientRect().width},ii=function(e){return e.getBoundingClientRect().height},ui=function(e){return function(t){return Ne(t,ri(e))}},ai=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},ci=function(e){It(e,"data-mce-style");var t=function(e){return It(e,"data-mce-style")};R(nn(e),t),R(rn(e),t)},si=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return m.from(n).filter(ie)},li=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},fi=function(e){return Ee.fromDom(e.selection.getStart())},di=function(e){return br(e.get(),t([]),n,H)},mi={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},gi=function(e){return{element:e,mergable:m.none(),unmergable:m.none(),selection:[e]}},pi=function(e,t,n){return{element:n,mergable:(u=t,a=mi,br(e.get(),m.none,function(e){return e.length<=1?m.none():function(e,t,n){return gr(e,t,n).bind(function(t){var n=function(t){return Ne(e,t)},o="thead,tfoot,tbody,table",i=Tt(t.first,o,n),u=Tt(t.last,o,n);return i.bind(function(e){return u.bind(function(n){return Ne(e,n)?(o=t.first,i=t.last,function(e,t,n){return Ln(e,t,n).bind(function(t){return function(e,t){for(var n=!0,o=r(In,t),i=t.startRow;i<=t.finishRow;i++)for(var u=t.startCol;u<=t.finishCol;u++)n=n&&En(e,i,u).exists(o);return n?m.some(t):m.none()}(e,t)})}(Vn(t.table),o,i)):m.none();var o,i})})})}(u,a.firstSelectedSelector,a.lastSelectedSelector).map(function(t){return{bounds:t,cells:e}})},m.none)),unmergable:(o=function(e,t){return Mt(e,t).exists(function(e){return 1<parseInt(e,10)})},0<(i=di(e)).length&&F(i,function(e){return o(e,"rowspan")||o(e,"colspan")})?m.some(i):m.none()),selection:di(e)};var o,i,u,a},hi=function(t,n,r,o){t.on("BeforeGetContent",function(r){!0===r.selection&&br(n.get(),e,function(e){r.preventDefault(),on(e[0]).map(function(e){var t=function(e,t){var n,r,o,i,u,a,c,s,l,f=function(e){return Ae(e.element,t)},d=Or(e),m=ln(d),g=Lo(e),p=Tn(m),h=(r=f,o=(n=p).grid.columns,i=n.grid.rows,u=o,c=a=0,s=[],l=[],Ie(n.access,function(e){var t,n,o,f;s.push(e),r(e)&&(l.push(e),n=(t=e.row)+e.rowspan-1,f=(o=e.column)+e.colspan-1,t<i?i=t:a<n&&(a=n),o<u?u=o:c<f&&(c=f))}),{minRow:i,minCol:u,maxRow:a,maxCol:c,allCells:s,selectedCells:l}),v=en(d,"th,td",function(e){return Ae(e,"th:not([data-mce-selected]),td:not([data-mce-selected])")});return R(v,Yn),function(e,t,n,r){for(var o,i,u,a=t.grid.columns,c=t.grid.rows,s=0;s<c;s++)for(var l=!1,f=0;f<a;f++)s<n.minRow||s>n.maxRow||f<n.minCol||f>n.maxCol||(En(t,s,f).filter(r).isNone()?(o=l,i=e[s].element,u=Ee.fromTag("td"),qn(u,Ee.fromTag("br")),(o?qn:Wn)(i,u)):l=!0)}(m,p,h,f),function(e,t,n,r){Ie(n.columns,function(e){(e.column<t.minCol||e.column>t.maxCol)&&Yn(e.element)});var o=N(Zt(e,"tr"),function(e){return 0===e.dom.childElementCount});R(o,Yn),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||R(Zt(e,"th,td"),function(e){It(e,"rowspan"),It(e,"colspan")}),It(e,xn),It(e,"data-snooker-col-series"),Lo(e).adjustTableWidth(r)}(d,h,p,function(e,t,n,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=Bo(t,e,n),i=D(o,function(e,t){return e+t},0),u=D(o.slice(r.minCol,r.maxCol+1),function(e,t){return e+t},0)/i*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(u)}(e,_n(e),g,h)),d}(e,"[data-mce-selected]");return ci(t),[t]}).each(function(e){var n;r.content="text"===r.format?A(e,function(e){return e.dom.innerText}).join(""):(n=t,A(e,function(e){return n.selection.serializer.serialize(e.dom,{})}).join(""))})},e)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&m.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(n){var i=Ee.fromDom(n);on(i).each(function(n){var u,a,c,s,l=N((u=e.content,(a=document.createElement("div")).innerHTML=u,ft(Ee.fromDom(a))),function(e){return"meta"!==Ye(e)});1===l.length&&"table"===Ye(l[0])&&(e.preventDefault(),c=Ee.fromDom(t.getDoc()),s=ei(c),r.pasteCells(n,{element:i,clipboard:l[0],generators:s}).each(function(e){t.selection.setRng(e.rng),t.focus(),o.clear(n)}))})})})},vi=hr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),bi=q({},vi),yi=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},xi=function(e,t,n){var r=function(e,t){return Dn(e)?(o=t,i=Bn(e),A(i,function(e,t){return{element:e.element,width:o[t],colspan:e.colspan}})):(n=t,r=Nn(e),A(r,function(e){var t=yi(e.column,e.column+e.colspan,n);return{element:e.element,width:t,colspan:e.colspan}}));var n,r,o,i}(e,t);R(r,function(e){n.setElementWidth(e.element,e.width)})},wi=function(e,n,r,o,i){var u=_n(e),a=i.getCellDelta(n),c=i.getWidths(u,i),s=r===u.grid.columns-1,l=o.clampTableDelta(c,r,a,i.minCellWidth(),s),f=function(e,n,r,o,i){var u,a,c=e.slice(0),s=(a=n,0===(u=e).length?bi.none():1===u.length?bi.only(0):0===a?bi.left(0,1):a===u.length-1?bi.right(a-1,a):0<a&&a<u.length-1?bi.middle(a-1,a,a+1):bi.none()),l=t(A(c,t(0)));return s.fold(l,function(e){return o.singleColumnWidth(c[e],r)},function(e,t){return i.calcLeftEdgeDeltas(c,e,t,r,o.minCellWidth(),o.isRelative)},function(e,t,n){return i.calcMiddleDeltas(c,e,t,n,r,o.minCellWidth(),o.isRelative)},function(e,t){return i.calcRightEdgeDeltas(c,e,t,r,o.minCellWidth(),o.isRelative)})}(c,r,l,i,o),d=A(f,function(e,t){return e+c[t]});xi(u,d,i),o.resizeTable(i.adjustTableWidth,l,s)},Ci=function(e){return A(e,t(0))},Si=function(e,t,n,r,o){return o(e.slice(0,t)).concat(r).concat(o(e.slice(n)))},ki=function(e){return function(t,n,r,o){if(e(r)){var i=Math.max(o,t[n]-Math.abs(r)),u=Math.abs(i-t[n]);return 0<=r?u:-u}return r}},Oi=ki(function(e){return e<0}),_i=ki(s),Ti=function(){var e=function(e,t,n,r){var o=(100+n)/100,i=Math.max(r,(e[t]+n)/o);return A(e,function(e,n){return(n===t?i:e/o)-e})},t=function(t,n,r,o,i,u){return u?e(t,n,o,i):(s=r,l=Oi(a=t,c=n,o,i),Si(a,c,s+1,[l,0],Ci));var a,c,s,l};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Oi,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,o,i,u,a){return t(e,r,o,i,u,a)},calcRightEdgeDeltas:function(t,n,r,o,i,u){if(u)return e(t,r,o,i);var a=Oi(t,r,o,i);return Ci(t.slice(0,r)).concat([a])},calcRedestributedWidths:function(e,t,n,r){if(r){var o=(t+n)/t,i=A(e,function(e){return e/o});return{delta:100*o-100,newSizes:i}}return{delta:n,newSizes:e}}}},Ei=function(){var e=function(e,t,n,r,o){var i=_i(e,0<=r?n:t,r,o);return Si(e,t,n+1,[i,-i],Ci)};return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){if(o){if(0<=n)return n;var i=D(e,function(e,t){return e+t-r},0);return Math.max(-i,n)}return Oi(e,t,n,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,o,i,u){return e(t,r,o,i,u)},calcRightEdgeDeltas:function(e,n,r,o,i,u){return u?Ci(e):A(e,t(o/e.length))},calcRedestributedWidths:function(e,t,n,r){return{delta:0,newSizes:e}}}},Ai=function(e,n){var r=m.from(e.dom.documentElement).map(Ee.fromDom).getOr(e);return{parent:t(r),view:t(e),origin:t(Vr(0,0)),isResizable:n}},Ri=hr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Ni=function(e,t,n){var r=n.substring(0,n.length-e.length),o=parseFloat(r);return r===o.toString()?t(o):Ri.invalid(n)},Bi=q(q({},Ri),{from:function(e){return re(e,"%")?Ni("%",Ri.percent,e):re(e,"px")?Ni("px",Ri.pixels,e):Ri.invalid(e)}}),Di=function(e,n,r){var o,i,u=Bi.from(r),a=F(e,function(e){return"0px"===e})?(o=e.length,i=u.fold(function(){return t("")},function(e){return t(e/o+"px")},function(){return t(100/o+"%")}),E(o,i)):function(e,t,n){return e.fold(function(){return t},function(e){return o=(r=e)/n,A(t,function(e){return Bi.from(e).fold(function(){return e},function(e){return e*o+"px"},function(e){return e/100*r+"px"})});var r,o},function(e){return r=n,A(t,function(e){return Bi.from(e).fold(function(){return e},function(e){return e/r*100+"%"},function(e){return e+"%"})});var r})}(u,e,n);return Mi(a)},Pi=function(e,r){return 0===e.length?r:B(e,function(e,r){return Bi.from(r).fold(t(0),n,n)+e},0)},Mi=function(e){if(0===e.length)return e;var n,r,o=B(e,function(e,t){var n=Bi.from(t).fold(function(){return{value:t,remainder:0}},function(e){return t=e,{value:(n=Math.floor(t))+"px",remainder:t-n};var t,n},function(e){return{value:e+"%",remainder:0}});return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}},{output:[],remainder:0}),i=o.output;return i.slice(0,i.length-1).concat([(n=i[i.length-1],r=Math.round(o.remainder),Bi.from(n).fold(t(n),function(e){return e+r+"px"},function(e){return e+r+"%"}))])},Ii=Bi.from,Li=function(e){return Ii(e).fold(t("px"),t("px"),t("%"))},Fi=function(e,t,n,r){var o=_n(e),i=o.all,u=Nn(o),a=Bn(o);t.each(function(t){var n,i,c,s,l=Li(t),f=Rr(e),d=Ro(o,e,_o,No,r),m=Di(d,f,t);Dn(o)?(c=m,s=l,R(a,function(e,t){var n=Pi([c[t]],Jt());Ht(e.element,"width",n+s)})):(n=m,i=l,R(u,function(e){var t=n.slice(e.column,e.colspan+e.column),r=Pi(t,Jt());Ht(e.element,"width",r+i)})),Ht(e,"width",t)}),n.each(function(t){var n,r,a,c=Li(t),s=Fr(e),l=Do(o,e,to,To,No),f=Di(l,s,t);n=f,r=i,a=c,R(u,function(e){var t=n.slice(e.row,e.rowspan+e.row),r=Pi(t,Qt());Ht(e.element,"height",r+a)}),R(r,function(e,t){Ht(e.element,"height",n[t])}),Ht(e,"height",t)})},zi=function(e){return po(e).exists(function(e){return so.test(e)})},Hi=function(e){return po(e).exists(function(e){return lo.test(e)})},Vi=function(e){return po(e).isNone()},ji=wo,Ui=function(e){return _n(e).grid},Wi=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=N(t,function(t){return t!==e})},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};R(e,function(e,t){o[e]=n[t]}),R(t,function(e){e(o)})}}},qi=function(e){return{registry:Le(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:Le(e,function(e){return e.trigger})}},Gi=function(e){return e.slice(0).sort()},$i=function(e,t){var n=N(t,function(t){return!_(e,t)});0<n.length&&function(e){throw new Error("Unsupported keys for object: "+Gi(e).join(", "))}(n)},Xi=function(e){return function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(e,t){if(!b(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");R(t,function(t){if(!h(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})}("required",t),r=Gi(t),P(r,function(e,t){return t<r.length-1&&e===r[t+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")}),function(r){var o=Pe(r);F(t,function(e){return _(o,e)})||function(e,t){throw new Error("All required keys ("+Gi(e).join(", ")+") were not specified. Specified keys were: "+Gi(t).join(", ")+".")}(t,o),e(t,o);var i=N(t,function(e){return!n.validate(r[e],e)});return 0<i.length&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+Gi(e).join(", ")+") were not.")}(i,n.label),r}}($i,e,{validate:w,label:"function"})},Ki=Xi(["compare","extract","mutate","sink"]),Yi=Xi(["element","start","stop","destroy"]),Ji=Xi(["forceDrop","drop","move","delayDrop"]),Qi=function(e){var t,n,r=Ee.fromDom(function(e){if(gt()&&x(e.target)){var t=Ee.fromDom(e.target);if(et(t)&&function(e){return x(e.dom.shadowRoot)}(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return j(n)}}return m.from(e.target)}(e).getOr(e.target)),o=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},u=(t=i,n=o,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return{target:r,x:e.clientX,y:e.clientY,stop:o,prevent:i,kill:u,raw:e}},Zi=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},eu=s,tu=function(e,t,n){return function(e,t,n,o,i){var u,a,c=(u=n,a=o,function(e){u(e)&&a(Qi(e))});return e.dom.addEventListener(t,c,!1),{unbind:r(Zi,e,t,c,!1)}}(e,t,eu,n)},nu=Qi,ru=function(e){return void 0!==e.dom.classList},ou=function(e,t){ru(e)?e.dom.classList.add(t):function(e,t){return r=t,o=function(e,t){var n=Pt(e,"class");return void 0===n||""===n?[]:n.split(" ")}(n=e).concat([r]),Bt(n,"class",o.join(" ")),!0;var n,r,o}(e,t)},iu=function(e,t){return ru(e)&&e.dom.classList.contains(t)},uu=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},au=uu("ephox-dragster").resolve,cu=Ki({compare:function(e,t){return Vr(t.left-e.left,t.top-e.top)},extract:function(e){return m.some(Vr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=q({layerClass:au("blocker")},e),n=Ee.fromTag("div");return Bt(n,"role","presentation"),Vt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ou(n,au("blocker")),ou(n,t.layerClass),{element:function(){return n},destroy:function(){Yn(n)}}}(t),r=tu(n.element(),"mousedown",e.forceDrop),o=tu(n.element(),"mouseup",e.drop),i=tu(n.element(),"mousemove",e.move),u=tu(n.element(),"mouseout",e.delayDrop);return Yi({element:n.element,start:function(e){qn(e,n.element())},stop:function(){Yn(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),su=function(e){return"true"===Pt(e,"contenteditable")},lu=uu("ephox-snooker").resolve,fu=lu("resizer-bar"),du=lu("resizer-rows"),mu=lu("resizer-cols"),gu=function(e){var t=Ct(e.parent(),"."+fu);R(t,Yn)},pu=function(e,t,n){var r=e.origin();R(t,function(t){t.each(function(t){var o=n(r,t);ou(o,fu),qn(e.parent(),o)})})},hu=function(e,t){var n;gu(e),e.isResizable(t)&&function(e,t,n,r,o){var i,u=Ur(n),a=t.isResizable,c=0<r.length?to.positions(r,n):[],s=0<c.length?(i=a,L(e.all,function(e,t){return i(e.element)?[t]:[]})):[];!function(e,t,n,r){pu(e,t,function(e,t){var o,i,u,a,c,s=(o=t.row,i=n.left-e.left,u=t.y-e.top,a=r,c=Ee.fromTag("div"),Vt(c,{position:"absolute",left:i+"px",top:u-3.5+"px",height:"7px",width:a+"px"}),Dt(c,{"data-row":o,role:"presentation"}),c);return ou(s,du),s})}(t,N(c,function(e,t){return T(s,function(e){return t===e})}),u,Nr(n));var l,f,d,m=0<o.length?ro.positions(o,n):[],g=0<m.length?(f=a,d=[],E((l=e).grid.columns,function(e){Pn(l,e).map(function(e){return e.element}).forall(f)&&d.push(e)}),N(d,function(e){var t=Rn(l,function(t){return t.column===e});return F(t,function(e){return f(e.element)})})):[];!function(e,t,n,r){pu(e,t,function(e,t){var o,i,u,a,c,s=(o=t.col,i=t.x-e.left,u=n.top-e.top,a=r,c=Ee.fromTag("div"),Vt(c,{position:"absolute",left:i-3.5+"px",top:u+"px",height:a+"px",width:"7px"}),Dt(c,{"data-column":o,role:"presentation"}),c);return ou(s,mu),s})}(t,N(m,function(e,t){return T(g,function(e){return t===e})}),u,zr(n))}(n=_n(t),e,t,Pr(n),Br(n))},vu=function(e,t){var n=Ct(e.parent(),"."+fu);R(n,t)},bu=function(e){vu(e,function(e){Ht(e,"display","none")})},yu=function(e){vu(e,function(e){Ht(e,"display","block")})},xu=lu("resizer-bar-dragging"),wu=function(e,t){return e.fire("newrow",{node:t})},Cu=function(e,t){return e.fire("newcell",{node:t})},Su=function(e,t,n){e.fire("TableModified",q(q({},n),{table:t}))},ku={structure:!1,style:!0},Ou={structure:!0,style:!1},_u={"border-collapse":"collapse",width:"100%"},Tu={border:"1"},Eu="preservetable",Au=function(e){return e.getParam("table_sizing_mode","auto")},Ru=function(e){return e.getParam("table_responsive_width")},Nu=function(e){return e.getParam("table_default_attributes",Tu,"object")},Bu=function(e){return e.getParam("table_default_styles",function(e){if(Fu(e)){var t=e.getBody().offsetWidth;return q(q({},_u),{width:t+"px"})}return zu(e)?ze(_u,function(e,t){return"width"!==t}):_u}(e),"object")},Du=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Pu=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Mu=function(e){return e.getParam("table_advtab",!0,"boolean")},Iu=function(e){return e.getParam("table_style_by_css",!1,"boolean")},Lu=function(e){return"relative"===Au(e)||!0===Ru(e)},Fu=function(e){return"fixed"===Au(e)||!1===Ru(e)},zu=function(e){return"responsive"===Au(e)},Hu=function(e){var t="section",n=e.getParam("table_header_type",t,"string");return _(["section","cells","sectionCells","auto"],n)?n:t},Vu=function(e){var t=e.getParam("table_column_resizing",Eu,"string");return P(["preservetable","resizetable"],function(e){return e===t}).getOr(Eu)},ju=function(e){return"preservetable"===Vu(e)},Uu=function(e){return"resizetable"===Vu(e)},Wu=function(e){var t=e.getParam("table_clone_elements");return h(t)?m.some(t.split(/[ ,]/)):Array.isArray(t)?m.some(t):m.none()},qu=function(e,t){if(Lu(e)){var n=si(e,t.dom).filter(li).getOrThunk(function(){return ji(t)});return zo(n,t)}return Fu(e)?Fo(Rr(t),t):Lo(t)},Gu=function(e){It(e,"width")},$u=function(e,t){var n,r,o;r=qu(e,t),o=wo(n=t),Fi(n,m.some(o),m.none(),r),Gu(n)},Xu=function(e,t){!function(e,t){var n=Rr(e)+"px";Fi(e,m.some(n),m.none(),t),Gu(e)}(t,qu(e,t))},Ku=function(e){qt(e,"width");var t=rn(e),n=0<t.length?t:nn(e);R(n,function(e){qt(e,"width"),Gu(e)}),Gu(e)},Yu="bar-",Ju=function(e){return"false"!==Pt(e,"data-mce-resize")},Qu=function(n){var o,i,u=m.none(),a=m.none(),c=m.none(),s=function(e){return"TABLE"===e.nodeName},l=function(e){return qu(n,e)},f=function(){return(ju(n)?Ei:Ti)()};return n.on("init",function(){var o,i,s,d,g=(i=Ju,(o=n).inline?function(e,n,r){return{parent:t(n),view:t(e),origin:t(Vr(0,0)),isResizable:r}}(ri(o),function(){var e=Ee.fromTag("div");return Vt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),qn(bt(Ee.fromDom(document)),e),e}(),i):Ai(Ee.fromDom(o.getDoc()),i));c=m.some(g),d=n.getParam("object_resizing",!0),(h(d)?"table"===d:d)&&n.getParam("table_resize_bars",!0,"boolean")&&((s=function(t,n,o){var i=to,u=ro,a=function(t){var n=function(){var e,t=qi({drag:Wi(["xDelta","yDelta","target"])}),n=m.none(),r={mutate:function(t,n){e.trigger.drag(t,n)},events:(e=qi({drag:Wi(["xDelta","yDelta"])})).registry};return r.events.drag.bind(function(e){n.each(function(n){t.trigger.drag(e.xDelta,e.yDelta,n)})}),{assign:function(e){n=m.some(e)},get:function(){return n},mutate:r.mutate,events:t.registry}}(),o=function(t,n){return void 0===n&&(n={}),function(t,n,r){var o,i,u=!1,a=qi({start:Wi([]),stop:Wi([])}),c=function(){var t,n=(t=qi({move:Wi(["info"])}),{onEvent:e,reset:e,events:t.registry}),r=function(){var e=m.none(),t=qi({move:Wi(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){var o,i,u;(o=r,i=n,u=e.map(function(e){return o.compare(e,i)}),e=m.some(i),u).each(function(e){t.trigger.move(e)})})},reset:function(){e=m.none()},events:t.registry}}(),o=n;return{on:function(){o.reset(),o=r},off:function(){o.reset(),o=n},isOn:function(){return o===r},onEvent:function(e,t){o.onEvent(e,t)},events:r.events}}(),s=function(){d.stop(),c.isOn()&&(c.off(),a.trigger.stop())},l=(o=s,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==i&&clearTimeout(i),i=setTimeout(function(){o.apply(null,e),i=null},200)}});c.events.move.bind(function(e){n.mutate(t,e.info)});var f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u&&e.apply(null,t)}},d=n.sink(Ji({forceDrop:s,drop:f(s),move:f(function(e){l.cancel(),c.onEvent(e,n)}),delayDrop:f(l.throttle)}),r);return{element:d.element,go:function(e){d.start(e),c.on(),a.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){d.destroy()},events:a.registry}}(t,void 0!==n.mode?n.mode:cu,n)}(n,{}),i=m.none(),u=function(e,t){return m.from(Pt(e,t))};n.events.drag.bind(function(e){u(e.target,"data-row").each(function(t){var n=Yt(e.target,"top");Ht(e.target,"top",n+e.yDelta+"px")}),u(e.target,"data-column").each(function(t){var n=Yt(e.target,"left");Ht(e.target,"left",n+e.xDelta+"px")})});var a=function(e,t){return Yt(e,t)-Gt(e,"data-initial-"+t,0)};o.events.stop.bind(function(){n.get().each(function(e){i.each(function(n){u(e,"data-row").each(function(t){var r=a(e,"top");It(e,"data-initial-top"),d.trigger.adjustHeight(n,r,parseInt(t,10))}),u(e,"data-column").each(function(t){var r=a(e,"left");It(e,"data-initial-left"),d.trigger.adjustWidth(n,r,parseInt(t,10))}),hu(t,n)})})});var c=function(e,r){d.trigger.startAdjust(),n.assign(e),Bt(e,"data-initial-"+r,Yt(e,r)),ou(e,xu),Ht(e,"opacity","0.2"),o.go(t.parent())},s=tu(t.parent(),"mousedown",function(e){iu(e.target,du)&&c(e.target,"top"),iu(e.target,mu)&&c(e.target,"left")}),l=function(e){return Ne(e,t.view())},f=tu(t.view(),"mouseover",function(e){(function(e){return Rt(e,"table",l).filter(function(e){return Rt(e,"[contenteditable]",l).exists(su)})})(e.target).fold(function(){vt(e.target)&&gu(t)},function(e){i=m.some(e),hu(t,e)})}),d=qi({adjustHeight:Wi(["table","delta","row"]),adjustWidth:Wi(["table","delta","column"]),startAdjust:Wi([])});return{destroy:function(){s.unbind(),f.unbind(),o.destroy(),gu(t)},refresh:function(e){hu(t,e)},on:o.on,off:o.off,hideBars:r(bu,t),showBars:r(yu,t),events:d.registry}}(t),c=qi({beforeResize:Wi(["table","type"]),afterResize:Wi(["table","type"]),startDrag:Wi([])});return a.events.adjustHeight.bind(function(e){var t=e.table;c.trigger.beforeResize(t,"row"),function(e,t,n,r){var o,i,u,a=_n(e),c=Do(a,e,r,yo,function(e){return e.getOrThunk(Qt)}),s=A(c,function(e,r){return n===r?Math.max(t+e,Qt()):e}),l=(o=s,i=Nn(a),A(i,function(e){var t=yi(e.row,e.row+e.rowspan,o);return{element:e.element,height:t,rowspan:e.rowspan}})),f=(u=s,A(a.all,function(e,t){return{element:e.element,height:u[t]}}));R(f,function(e){go(e.element,e.height)}),R(l,function(e){go(e.element,e.height)});var d=B(s,function(e,t){return e+t},0);go(e,d)}(t,i.delta(e.delta,t),e.row,i),c.trigger.afterResize(t,"row")}),a.events.startAdjust.bind(function(e){c.trigger.startDrag()}),a.events.adjustWidth.bind(function(e){var t=e.table;c.trigger.beforeResize(t,"col");var r=u.delta(e.delta,t),i=o(t);wi(t,r,e.column,n,i),c.trigger.afterResize(t,"col")}),{on:a.on,off:a.off,hideBars:a.hideBars,showBars:a.showBars,destroy:a.destroy,events:c.registry}}(g,f(),l)).on(),s.events.startDrag.bind(function(e){u=m.some(n.selection.getRng())}),s.events.beforeResize.bind(function(e){var t,r,o,i,u=e.table.dom;t=n,o=oi(r=u),i=ii(u),t.fire("ObjectResizeStart",{target:r,width:o,height:i,origin:Yu+e.type})}),s.events.afterResize.bind(function(e){var t,r,o,i,a=e.table,c=a.dom;ci(a),u.each(function(e){n.selection.setRng(e),n.focus()}),t=n,o=oi(r=c),i=ii(c),t.fire("ObjectResized",{target:r,width:o,height:i,origin:Yu+e.type}),n.undoManager.add()}),a=m.some(s))}),n.on("ObjectResizeStart",function(e){var t,r=e.target;s(r)&&(t=Ee.fromDom(r),R(n.dom.select(".mce-clonedresizable"),function(e){n.dom.addClass(e,"mce-"+Vu(n)+"-columns")}),!Hi(t)&&Fu(n)?Xu(n,t):!zi(t)&&Lu(n)&&$u(n,t),Vi(t)&&ne(e.origin,Yu)&&$u(n,t),o=e.width,i=zu(n)?"":si(n,r).getOr(""))}),n.on("ObjectResized",function(e){var t,r,u=e.target;s(u)&&(t=Ee.fromDom(u),ne(r=e.origin,"corner-")&&function(e,t,r){var u,a,c,s,d,m,g=re(t,"e");""===i&&$u(n,e),r!==o&&""!==i?(Ht(e,"width",i),u=f(),a=l(e),c=ju(n)||g?Ui(e).columns-1:0,wi(e,r-o,c,u,a)):li(i)&&(s=parseFloat(i.replace("%","")),Ht(e,"width",r*s/o+"%")),/^(\d+(\.\d+)?)px$/.test(i)&&(m=_n(d=e),Dn(m)||R(nn(d),function(e){var t=jt(e,"width");Ht(e,"width",t),It(e,"width")}))}(t,r,e.width),ci(t),Su(n,t.dom,ku))}),n.on("SwitchMode",function(){a.each(function(e){n.mode.isReadOnly()?e.hideBars():e.showBars()})}),{lazyResize:function(){return a},lazyWire:function(){return c.getOr(Ai(Ee.fromDom(n.getBody()),Ju))},destroy:function(){a.each(function(e){e.destroy()}),c.each(function(e){n.inline&&Yn(e.parent())})}}},Zu=function(e,t){return{element:e,offset:t}},ea=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind(function(t){return ea(e,t,n).orThunk(function(){return m.some(t)})}):m.none()},ta=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},na=function(e,t){var n=ea(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return Zu(n,ta(e,n));var r=e.property().children(n);return 0<r.length?na(e,r[r.length-1]):Zu(n,ta(e,n))},ra=na,oa=rr(),ia=function(e,t){1===$t(e,"colspan")&&po(e).bind(function(e){return function(e,t){return m.from(io.exec(e)).bind(function(e){var n,r=Number(e[1]),o=e[2];return n=o,T(t,function(e){return T(oo[e],function(e){return n===e})})?m.some({value:r,unit:o}):m.none()})}(e,["fixed","relative","empty"])}).each(function(n){var r=n.value/2;xo(e,r,n.unit),xo(t,r,n.unit)})},ua=function(e,t,n,r){n===r?It(e,t):Bt(e,t,n)},aa=function(e,t,n){U(wt(e,t)).fold(function(){return Wn(e,n)},function(e){return Un(e,n)})},ca=function(e,t){var n=[],r=[],o=function(e){return A(e,function(e){e.isNew&&n.push(e.element);var t=e.element;return Kn(t),R(e.cells,function(e){e.isNew&&r.push(e.element),ua(e.element,"colspan",e.colspan,1),ua(e.element,"rowspan",e.rowspan,1),qn(t,e.element)}),t})},i=function(e){return L(e,function(e){return A(e.cells,function(e){return ua(e.element,"span",e.colspan,1),e.element})})},u=function(t,n){var r,u,a,c=(a=Et(r=e,u=n).getOrThunk(function(){var e=Ee.fromTag(u,it(r).dom);return"thead"===u?aa(r,"caption,colgroup",e):"colgroup"===u?aa(r,"caption",e):qn(r,e),e}),Kn(a),a),s=("colgroup"===n?i:o)(t);Xn(c,s)},a=function(t,n){0<t.length?u(t,n):Et(e,n).each(Yn)},c=[],s=[],l=[],f=[];return R(t,function(e){switch(e.section){case"thead":c.push(e);break;case"tbody":s.push(e);break;case"tfoot":l.push(e);break;case"colgroup":f.push(e)}}),a(f,"colgroup"),a(c,"thead"),a(s,"tbody"),a(l,"tfoot"),{newRows:n,newCells:r}},sa=function(e,t){if(0===e.length)return 0;var n=e[0];return M(e,function(e){return!t(n.element,e.element)}).fold(function(){return e.length},function(e){return e})},la=function(e,t,n){var r,o=[];Dn(e)&&(r=A(Bn(e),function(e){return Xe(e.element,n,!1)}),o.push(Ke(r,"colgroup")));for(var i=0;i<e.grid.rows;i++){for(var u=[],a=0;a<e.grid.columns;a++){var c=En(e,i,a).map(function(e){return Xe(e.element,n,e.isLocked)}).getOrThunk(function(){return Xe(t.gap(),!0,!1)});u.push(c)}var s=Ke(u,e.all[i].section);o.push(s)}return o},fa=function(e,t){return function(e,t){return A(e,function(e){var n=W(e.details,function(e){return at(e.element).map(function(e){var t=at(e).isNone();return Xe(e,t,!1)})}).getOrThunk(function(){return Xe(t.row(),!0,!1)});return{element:n.element,cells:e.details,section:e.section,isNew:n.isNew}})}(function(e,t){var n=A(e,function(e){return A(e.cells,c)});return A(e,function(r,o){return{details:L(r.cells,function(r,i){if(!1!==n[o][i])return[];var u=function(e,t,n,r){var o,i=e[t].cells.slice(n),u=sa(i,r),a=(o=n,A(e,function(e){return hn(e,o)}).slice(t));return{colspan:u,rowspan:sa(a,r)}}(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var u=t;u<t+o;u++)n[i][u]=!0}(o,i,u.rowspan,u.colspan),[{element:r.element,rowspan:u.rowspan,colspan:u.colspan,isNew:r.isNew}]}),section:r.section}})}(e,Ne),t)},da=function(e,t){return W(e.all,function(e){return P(e.cells,function(e){return Ne(t,e.element)})})},ma=function(e,t,n){var r=A(t.selection,function(t){return tn(t).bind(function(t){return da(e,t)}).filter(n)}),o=_r(r);return Tr(0<o.length,o)},ga=function(e,t,n,r,o){return function(i,u,a,c,s,l){var f=_n(u);return t(f,a).map(function(t){var n=la(f,c,!1),r=e(n,t,Ne,o(c)),i=Cn(r.grid);return{info:t,grid:fa(r.grid,c),cursor:r.cursor,lockedColumns:i}}).bind(function(e){var t=ca(u,e.grid),o=m.from(s).getOrThunk(function(){return Lo(u)}),a=m.from(l).getOrThunk(Ei);return n(u,e.grid,e.info,o,a),r(u),hu(i,u),It(u,xn),0<e.lockedColumns.length&&Bt(u,xn,e.lockedColumns.join(",")),m.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},pa=function(e,t){return tn(t.element).bind(function(t){return da(e,t)})},ha=function(e,t){return ma(e,t,s).map(function(e){return{cells:e,generators:t.generators,clipboard:t.clipboard}})},va=function(e,t){return ma(e,t,s)},ba=function(e,t){return pa(e,t).filter(function(e){return!e.isLocked})},ya=function(e,t){return ma(e,t,function(e){return!e.isLocked})},xa=function(e,t){return F(t,function(t){return da(e,t).exists(function(e){return!e.isLocked})})},wa=function(e,t){return t.mergable.filter(function(t){return xa(e,t.cells)})},Ca=function(e,t){return t.unmergable.filter(function(t){return xa(e,t)})},Sa=function(e,t,n,r){for(var o=yn(e).rows,i=!0,u=0;u<o.length;u++)for(var a=0;a<bn(o[0]);a++){var c=o[u],s=hn(c,a),l=n(s.element,t);!0===l&&!1===i?mn(c,a,Xe(r(),!0,s.isLocked)):!0===l&&(i=!1)}return e},ka=function(e){return{is:function(t){return e===t},isValue:s,isError:c,getOr:t(e),getOrThunk:t(e),getOrDie:t(e),or:function(t){return ka(e)},orThunk:function(t){return ka(e)},fold:function(t,n){return n(e)},map:function(t){return ka(t(e))},mapError:function(t){return ka(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return m.some(e)}}},Oa=function(t){return{is:c,isValue:c,isError:s,getOr:n,getOrThunk:function(e){return e()},getOrDie:function(){return e=String(t),function(){throw new Error(e)}();var e},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return Oa(t)},mapError:function(e){return Oa(e(t))},each:e,bind:function(e){return Oa(t)},exists:c,forall:s,toOptional:m.none}},_a={value:ka,error:Oa,fromOption:function(e,t){return e.fold(function(){return Oa(t)},ka)}},Ta=function(e,t){return{rowDelta:0,colDelta:bn(e[0])-bn(t[0])}},Ea=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Aa=function(e,t,n,r){var o="colgroup"===t.section?n.col:n.cell;return E(e,function(e){return Xe(o(),!0,r(e))})},Ra=function(e,t,n,r){return e.concat(E(t,function(){var t=e[e.length-1],o=Aa(t.cells.length,t,n,function(e){return Ue(r,e.toString())});return gn(t,o)}))},Na=function(e,t,n,r){return A(e,function(e){var o=Aa(t,e,n,c);return fn(e,r,o)})},Ba=function(e,t,r){var o=t.colDelta<0?Na:n,i=t.rowDelta<0?Ra:n,u=Cn(e),a=bn(e[0]),c=T(u,function(e){return e===a-1}),l=o(e,Math.abs(t.colDelta),r,c?a-1:a),f=Cn(l);return i(l,Math.abs(t.rowDelta),r,z(f,s))},Da=function(e,t,n){return N(n,function(n){return n>=e.column&&n<=bn(t[0])+e.column})},Pa=function(e,t,n,r,o){var i,u,a,c;i=t,a=o,c=r.cell,0<(u=e)&&u<i[0].cells.length&&R(i,function(e){var t=e.cells[u];a(t.element,e.cells[u-1].element)&&mn(e,u,Xe(c(),!0,t.isLocked))});var s=Ea(n,t),l=Ba(n,s,r),f=Ea(t,l),d=Ba(t,f,r);return A(d,function(t,n){return fn(t,e,l[n].cells)})},Ma=function(e,t,n,r,o){!function(e,t,n,r){var o,i,u=yn(e).rows;0<t&&t<u.length&&(i=n,o=D(u[t-1].cells,function(e,t){return T(e,function(e){return i(e.element,t.element)})?e:e.concat([t])},[]),R(o,function(e){for(var o=m.none(),i=t;i<u.length;i++)for(var a=0;a<bn(u[0]);a++)!function(t){var a=u[i],c=hn(a,t);n(c.element,e.element)&&(o.isNone()&&(o=m.some(r())),o.each(function(e){mn(a,t,Xe(e,!0,c.isLocked))}))}(a)}))}(t,e,o,r.cell);var i,u,a=Cn(t),c=Ta(t,n),l=q(q({},c),{colDelta:c.colDelta-a.length}),f=Ba(t,l,r),d=yn(f),g=d.cols,p=d.rows,h=Cn(f),v=Ta(n,t),b=q(q({},v),{colDelta:v.colDelta+h.length}),y=(i=r,u=h,A(n,function(e){return D(u,function(t,n){var r=Aa(1,e,i,s)[0];return dn(t,n,r)},e)})),x=Ba(y,b,r);return g.concat(p.slice(0,e)).concat(x).concat(p.slice(e,p.length))},Ia=function(e,t,n,r,o){var i=yn(e),u=i.rows,a=i.cols,c=u.slice(0,t),s=u.slice(t),l=pn(u[n],function(e,n){return 0<t&&t<u.length&&r(vn(u[t-1],n),vn(u[t],n))?hn(u[t],n):Xe(o(e.element,r),!0,e.isLocked)});return a.concat(c).concat([l]).concat(s)},La=function(e,t,n,r,o){return A(e,function(e){var i=0<t&&t<bn(e)&&r(vn(e,t-1),vn(e,t)),u=function(e,t,n,r,o,i,u){if("colgroup"!==n&&r)return hn(e,t);var a=hn(e,o);return Xe(u(a.element,i),!0,!1)}(e,t,e.section,i,n,r,o);return dn(e,t,u)})},Fa=function(e,t,n,r){return A(e,function(e){return pn(e,function(e){return o=e,T(t,function(e){return n(o.element,e.element)})?Xe(r(e.element,n),!0,e.isLocked):e;var o})})},za=function(e,t,n,r){return void 0!==vn(e[t],n)&&0<t&&r(vn(e[t-1],n),vn(e[t],n))},Ha=function(e,t,n){return 0<t&&n(vn(e,t-1),vn(e,t))},Va=function(e,t,n,r){var o=yn(e).rows,i=L(o,function(r,o){return za(e,o,t,n)||Ha(r,t,n)?[]:[hn(r,t)]});return Fa(e,i,n,r)},ja=function(e,t,n,r){var o=yn(e).rows,i=o[t],u=L(i.cells,function(e,r){return za(o,t,r,n)||Ha(i,r,n)?[]:[e]});return Fa(e,u,n,r)},Ua=function(e){return D(e,function(e,t){return T(e,function(e){return e.column===t.column})?e:e.concat([t])},[]).sort(function(e,t){return e.column-t.column})},Wa=function(e){return{element:e,colspan:Gt(e,"colspan",1),rowspan:Gt(e,"rowspan",1)}},qa=function(e){return Mt(e,"scope").map(function(e){return e.substr(0,3)})},Ga=function(e,t){void 0===t&&(t=Wa);var n=Po(m.none()),r=function(n){return function(t){switch(Ye(t.element)){case"col":return e.col(t);default:return e.cell(t)}}(t(n))},o=function(e){var t=r(e);return n.get().isNone()&&n.set(m.some(t)),i=m.some({item:e,replacement:t}),t},i=m.none();return{getOrInit:function(e,t){return i.fold(function(){return o(e)},function(n){return t(e,n.item)?n.replacement:o(e)})},cursor:n.get}},$a=function(e,t){return function(n){var r=Po(m.none()),o=[],i=function(i){var u=n.replace(i,t,{scope:e});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(m.some(u)),u};return{replaceOrInit:function(e,t){return"col"===Ye(e)?e:(n=e,r=t,P(o,function(e){return r(e.item,n)}).fold(function(){return i(e)},function(n){return t(e,n.item)?n.sub:i(e)}));var n,r},cursor:r.get}}},Xa=function(e){var n=Po(m.none());return{unmerge:function(t){n.get().isNone()&&n.set(m.some(t));var r=qa(t);return r.each(function(e){return Bt(t,"scope",e)}),function(){var n=e.cell({element:t,colspan:1,rowspan:1});return qt(n,"width"),qt(t,"width"),r.each(function(e){return Bt(n,"scope",e)}),n}},merge:function(e){return qt(e[0],"width"),function(){var t=_r(A(e,qa));if(0===t.length)return m.none();var n=t[0],r=["row","col"];return T(t,function(e){return e!==n&&_(r,e)})?m.none():m.from(n)}().fold(function(){return It(e[0],"scope")},function(t){return Bt(e[0],"scope",t+"group")}),t(e[0])},cursor:n.get}},Ka=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ya=rr(),Ja=function(e){return t=e,n=Ya.property().name(t),_(Ka,n);var t,n},Qa=function(e){return t=e,n=Ya.property().name(t),_(["ol","ul"],n);var t,n},Za=function(e){0===nn(e).length&&Yn(e)},ec=function(e,t){return{grid:e,cursor:t}},tc=function(e,t,n){var r=yn(e).rows;return nc(r,t,n).orThunk(function(){return nc(r,0,0)})},nc=function(e,t,n){return m.from(e[t]).bind(function(e){return m.from(e.cells[n]).bind(function(e){return m.from(e.element)})})},rc=function(e,t,n){var r=yn(e).rows;return ec(e,nc(r,t,n))},oc=function(e){return D(e,function(e,t){return T(e,function(e){return e.row===t.row})?e:e.concat([t])},[]).sort(function(e,t){return e.row-t.row})},ic=function(e,t,n){var r,o=(r=n.section,cn(e,function(){return r})),i=Tn(o);return la(i,t,!0)},uc=function(e,t){var n=N(e,t);return 0===n.length?m.some("td"):n.length===e.length?m.some("th"):m.none()},ac=function(e,t,n,r){var o=Tn(t),i=r.getWidths(o,r);xi(o,i,r)},cc=function(e,t,n,r,o){var i=Tn(t),u=r.getWidths(i,r),a=r.pixelWidth(),c=o.calcRedestributedWidths(u,a,n.pixelDelta,r.isRelative),s=c.delta;xi(i,c.newSizes,r),r.adjustTableWidth(s)},sc=function(e,t){return T(t,function(e){return 0===e.column&&e.isLocked})},lc=function(e,t){return T(t,function(t){return t.column+t.colspan>=e.grid.columns&&t.isLocked})},fc=function(e,t){var n=Br(e),r=Ua(t);return D(r,function(e,t){return e+n[t.column].map(Nr).getOr(0)},0)},dc=function(e){return function(t,n){return va(t,n).filter(function(n){return!(e?sc:lc)(t,n)}).map(function(e){return{details:e,pixelDelta:fc(t,e)}})}},mc=function(e){return function(t,n){return ha(t,n).filter(function(n){return!(e?sc:lc)(t,n.cells)})}},gc=ga(function(e,t,n,r){var o=t[0].row,i=oc(t),u=B(i,function(e,t){return{grid:Ia(e.grid,o,t.row+e.delta,n,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid;return rc(u,o,t[0].column)},va,e,e,Ga),pc=ga(function(e,t,n,r){var o=oc(t),i=o[o.length-1],u=i.row+i.rowspan,a=B(o,function(e,t){return Ia(e,u,t.row,n,r.getOrInit)},e);return rc(a,u,t[0].column)},va,e,e,Ga),hc=ga(function(e,t,n,r){var o=t.details,i=Ua(o),u=i[0].column,a=B(i,function(e,t){return{grid:La(e.grid,u,t.column+e.delta,n,r.getOrInit),delta:e.delta+1}},{grid:e,delta:0}).grid;return rc(a,o[0].row,u)},dc(!0),cc,e,Ga),vc=ga(function(e,t,n,r){var o=t.details,i=o[o.length-1],u=i.column+i.colspan,a=Ua(o),c=B(a,function(e,t){return La(e,u,t.column,n,r.getOrInit)},e);return rc(c,o[0].row,u)},dc(!1),cc,e,Ga),bc=ga(function(e,t,n,r){var o,i,u=Ua(t.details),a=(o=e,i=A(u,function(e){return e.column}),L(o,function(e){var t=B(i,function(e,t){return 0<=t&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e},e.cells);return 0<t.length?[Ke(t,e.section)]:[]})),c=tc(a,u[0].row,u[0].column);return ec(a,c)},function(e,t){return ya(e,t).map(function(t){return{details:t,pixelDelta:-fc(e,t)}})},cc,Za,Ga),yc=ga(function(e,t,n,r){var o,i,u,a,c=oc(t),s=(o=c[0].row,i=c[c.length-1].row,(u=yn(e)).cols.concat((a=u.rows).slice(0,o)).concat(a.slice(i+1))),l=tc(s,t[0].row,t[0].column);return ec(s,l)},va,e,Za,Ga),xc=(ga(function(e,t,n,r){var o=Va(e,t.column,n,r.replaceOrInit);return rc(o,t.row,t.column)},ba,e,e,$a("row","th")),ga(function(e,t,n,r){var o=Ua(t),i=D(o,function(e,t){return Va(e,t.column,n,r.replaceOrInit)},e);return rc(i,t[0].row,t[0].column)},ya,e,e,$a("row","th"))),wc=(ga(function(e,t,n,r){var o=Va(e,t.column,n,r.replaceOrInit);return rc(o,t.row,t.column)},ba,e,e,$a(null,"td")),ga(function(e,t,n,r){var o=Ua(t),i=D(o,function(e,t){return Va(e,t.column,n,r.replaceOrInit)},e);return rc(i,t[0].row,t[0].column)},ya,e,e,$a(null,"td"))),Cc=(ga(function(e,t,n,r){var o=ja(e,t.row,n,r.replaceOrInit);return rc(o,t.row,t.column)},pa,e,e,$a("col","th")),ga(function(e,t,n,r){var o=oc(t),i=D(o,function(e,t){return ja(e,t.row,n,r.replaceOrInit)},e);return rc(i,t[0].row,t[0].column)},va,e,e,$a("col","th")),ga(function(e,t,n,r){var o=ja(e,t.row,n,r.replaceOrInit);return rc(o,t.row,t.column)},pa,e,e,$a(null,"td")),ga(function(e,t,n,r){var o=oc(t),i=D(o,function(e,t){return ja(e,t.row,n,r.replaceOrInit)},e);return rc(i,t[0].row,t[0].column)},va,e,e,$a(null,"td")),ga(function(e,t,n,r){var o=t.cells;!function(e){var t,n=function(e){return"br"===Ye(e)},r=0===(t=L(e,function(e){var t=ft(e);return F(t,function(e){return n(e)||tt(e)&&0===Zn(e).trim().length})?[]:t.concat(function(e){return Wo(e).bind(function(t){var r=lt(t).map(function(e){return!!Ja(e)||!!function(e){return t=e,_(["br","img","hr","input"],Ya.property().name(t));var t}(e)&&"img"!==Ye(e)}).getOr(!1);return at(t).map(function(o){return!0===r||"li"===Ye(i=o)||_t(i,Qa).isSome()||n(t)||Ja(o)&&!Ne(e,o)?[]:[Ee.fromTag("br")];var i})}).getOr([])}(e))})).length?[Ee.fromTag("br")]:t;Kn(e[0]),Xn(e[0],r)}(o);var i=function(e,t,n){var r=yn(e).rows;if(0===r.length)return e;for(var o=t.startRow;o<=t.finishRow;o++)for(var i=t.startCol;i<=t.finishCol;i++){var u=r[o],a=hn(u,i).isLocked;mn(u,i,Xe(n(),!1,a))}return e}(e,t.bounds,r.merge(o));return ec(i,m.from(o[0]))},wa,ac,e,Xa)),Sc=ga(function(e,t,n,r){var o=B(t,function(e,t){return Sa(e,t,n,r.unmerge(t))},e);return ec(o,m.from(t[0]))},Ca,ac,e,Xa),kc=ga(function(e,t,n,o){var i,u,a=(i=t.generators,u=_n(t.clipboard),la(u,i,!0));return function(e,t,n,o,i){var u,a,c,l,f,d=Cn(t),m=(u=e,a=d,c=bn(t[0]),l=E(c-u.column,function(e){return e+u.column}),f=P(l,function(e){return F(a,function(t){return t!==e})}).getOr(c-1),q(q({},u),{column:f})),g=Da(m,n,d);return function(e,t,n){if(e.row>=t.length||e.column>bn(t[0]))return _a.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),o=r[0].cells.slice(e.column),i=bn(n[0]);return _a.value({rowDelta:r.length-n.length,colDelta:o.length-i})}(m,t,n).map(function(e){var u=q(q({},e),{colDelta:e.colDelta-g.length}),a=Ba(t,u,o),c=Cn(a),l=Da(m,n,c);return function(e,t,n,o,i,u){for(var a,c,l,f,d,m=e.row,g=e.column,p=m+n.length,h=g+bn(n[0])+u.length,v=z(u,s),b=m;b<p;b++)for(var y,x,w,C=0,S=g;S<h;S++)v[S]?C++:(f=void 0,f=r(i,hn((a=t)[c=b],l=S).element),d=a[c],1<a.length&&1<bn(d)&&(0<l&&f(vn(d,l-1))||l<d.cells.length-1&&f(vn(d,l+1))||0<c&&f(vn(a[c-1],l))||c<a.length-1&&f(vn(a[c+1],l)))&&Sa(t,vn(t[b],S),i,o.cell),x=(y=hn(n[b-m],S-g-C)).element,w=o.replace(x),mn(t[b],S,Xe(w,!0,y.isLocked)));return t}(m,a,n,o,i,l)})}({row:t.row,column:t.column},e,a,t.generators,n).fold(function(){return ec(e,m.some(t.element))},function(e){var n=tc(e,t.row,t.column);return ec(e,n)})},function(e,t){return tn(t.element).bind(function(n){return da(e,n).map(function(e){return q(q({},e),{generators:t.generators,clipboard:t.clipboard})})})},ac,e,Ga),Oc=ga(function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].column,u=ic(t.clipboard,t.generators,o[t.cells[0].row]),a=Pa(i,e,u,t.generators,n),c=tc(a,t.cells[0].row,t.cells[0].column);return ec(a,c)},mc(!0),e,e,Ga),_c=ga(function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,u=ic(t.clipboard,t.generators,o[t.cells[0].row]),a=Pa(i,e,u,t.generators,n),c=tc(a,t.cells[0].row,t.cells[0].column);return ec(a,c)},mc(!1),e,e,Ga),Tc=ga(function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].row,u=ic(t.clipboard,t.generators,o[i]),a=Ma(i,e,u,t.generators,n),c=tc(a,t.cells[0].row,t.cells[0].column);return ec(a,c)},ha,e,e,Ga),Ec=ga(function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,u=ic(t.clipboard,t.generators,o[t.cells[0].row]),a=Ma(i,e,u,t.generators,n),c=tc(a,t.cells[0].row,t.cells[0].column);return ec(a,c)},ha,e,e,Ga),Ac=function(e,t){var n=_n(e);return va(n,t).bind(function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=I(A(n.all,function(e){return N(e.cells,function(e){return e.column>=r&&e.column<o})}));return uc(i,function(e){return"th"===Ye(e.element)})}).getOr("")},Rc=function(e){return ni(e.parentNode)},Nc=function(e,t){var n="thead"===Rc(t),r=!T(t.cells,function(e){return"th"!==ni(e)});return n||r?m.some({thead:n,ths:r}):m.none()},Bc=function(e,t){return"thead"===(n=Nc(0,t).fold(function(){return Rc(t)},function(e){return"thead"}))?"header":"tfoot"===n?"footer":"body";var n},Dc=function(e,t,n){var r,o,i=e.getParent(t,"table"),u=t.parentNode,a=ni(u);n!==a&&((r=e.select(n,i)[0])||(r=e.create(n),o=i.firstChild,"thead"===n?U(wt(Ee.fromDom(i),"caption,colgroup")).fold(function(){return i.insertBefore(r,o)},function(t){return e.insertAfter(r,t.dom)}):i.appendChild(r)),"tbody"===n&&"thead"===a&&r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t),u.hasChildNodes()||e.remove(u))},Pc=function(e,t,n,r){var o=e.dom,i=function(e,t,n){if(x(n)&&ni(t)!==n){var r=e.dom.rename(t,n);return Cu(e,r),r}return t}(e,t,n);return function(e){return void 0===e}(r)||o.setAttrib(i,"scope",r),i},Mc=function(e,t,n,r){return R(t,function(t){return Pc(e,t,n,r)})},Ic=function(e,t,n){var r,o,i,u=e.dom;"header"===n?(o="auto"===(r=Hu(e))?(i=on(Ee.fromDom(t.cells[0])).map(un).getOr([]),W(i,function(e){return Nc(0,e.dom)}).map(function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"}).getOr("section")):r,Mc(e,t.cells,"section"===o?"td":"th","col"),Dc(u,t,"cells"===o?"tbody":"thead")):(Mc(e,t.cells,"td",null),Dc(u,t,"footer"===n?"tfoot":"tbody"))},Lc=function(e){return function(t){var n,r=Ye(t),o="col"===r||"colgroup"===r?on(n=t).bind(function(e){return pr(e,mi.firstSelectedSelector)}).fold(function(){return n},function(e){return e[0]}):t;return Rt(o,e)}},Fc=Lc("th,td"),zc=Lc("th,td,caption"),Hc=function(e,t){return Fc(e).map(function(e){return di(t)}).getOr([])},Vc=function(e,t){var n,r,o,i=Fc(e);return r=i.bind(function(e){return on(e)}).map(un),o=function(e,n){return N(n,function(n){return T(ti(n.dom.cells),function(n){return"1"===Pt(n,t)||Ne(n,e)})})},((n=i).isSome()&&r.isSome()?m.some(o(n.getOrDie(),r.getOrDie())):m.none()).getOr([])},jc=function(t,n,r){var o=function(e){return"table"===Ye(ri(e))},i=Wu(t),u=Uu(t)?e:ia,a=function(e,n,r,o,u){return function(a,c){ci(a);var s=o(),l=Ee.fromDom(t.getDoc()),f=Zo(r,l,i),d=qu(t,a),g=(Uu(t)?Ti:Ei)();return n(a)?e(s,a,c,f,d,g).bind(function(e){return R(e.newRows,function(e){wu(t,e.dom)}),R(e.newCells,function(e){Cu(t,e.dom)}),e.cursor.map(function(e){var n=ra(oa,e),r=t.dom.createRng();return r.setStart(n.element.dom,n.offset),r.setEnd(n.element.dom,n.offset),{rng:r,effect:u}})}):m.none()}},c=a(yc,function(e){return!1===o(t)||1<Ui(e).rows},e,n,Ou),l=a(bc,function(e){return!1===o(t)||1<Ui(e).columns},e,n,Ou),f=a(gc,s,e,n,Ou),d=a(pc,s,e,n,Ou),g=a(hc,s,u,n,Ou),p=a(vc,s,u,n,Ou),h=a(Cc,s,e,n,Ou),v=a(Sc,s,e,n,Ou),b=a(Oc,s,e,n,Ou),y=a(_c,s,e,n,Ou),x=a(Tc,s,e,n,Ou),w=a(Ec,s,e,n,Ou),C=a(kc,s,e,n,Ou),S=function(e,t){return je(e,"type").filter(function(e){return _(t,e)})};return{deleteRow:c,deleteColumn:l,insertRowsBefore:f,insertRowsAfter:d,insertColumnsBefore:g,insertColumnsAfter:p,mergeCells:h,unmergeCells:v,pasteColsBefore:b,pasteColsAfter:y,pasteRowsBefore:x,pasteRowsAfter:w,pasteCells:C,setTableCellType:function(e,t){return S(t,["td","th"]).each(function(t){var n=A(Hc(fi(e),r),function(e){return e.dom});Mc(e,n,t,null)})},setTableRowType:function(e,t){return S(t,["header","body","footer"]).each(function(t){A(Vc(fi(e),mi.selected),function(n){return Ic(e,n.dom,t)})})},makeColumnsHeader:a(xc,s,e,n,Ou),unmakeColumnsHeader:a(wc,s,e,n,Ou),getTableRowType:function(e){var t=Vc(fi(e),mi.selected);if(0<t.length){var n=A(t,function(e){return Bc(0,e.dom)}),r=_(n,"header"),o=_(n,"footer");if(r||o){var i=_(n,"body");return!r||i||o?r||i||!o?"":"footer":"header"}return"body"}},getTableCellType:function(e){return uc(Hc(fi(e),r),function(e){return"th"===Ye(e)}).getOr("")},getTableColType:Ac}},Uc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Wc=function(e,t,n,r){return E(e,function(e){return function(e,t,n,r){for(var o=Ee.fromTag("tr"),i=0;i<e;i++){var u=Ee.fromTag(r<t||i<n?"th":"td");i<n&&Bt(u,"scope","row"),r<t&&Bt(u,"scope","col"),qn(u,Ee.fromTag("br")),qn(o,u)}return o}(t,n,r,e)})},qc=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},Gc=function(e,t,n,o,i){var u=Bu(e),a={styles:u,attributes:Nu(e),colGroups:e.getParam("table_use_colgroups",!1,"boolean")};return e.undoManager.ignore(function(){var r=function(e,t,n,r,o,i){void 0===i&&(i=Uc);var u=Ee.fromTag("table"),a="cells"!==o;Vt(u,i.styles),Dt(u,i.attributes),i.colGroups&&qn(u,function(e){var t=Ee.fromTag("colgroup");return E(e,function(){return qn(t,Ee.fromTag("col"))}),t}(t));var c,s,l=Math.min(e,n);a&&0<n&&(c=Ee.fromTag("thead"),qn(u,c),s=Wc(n,t,"sectionCells"===o?l:0,r),Xn(c,s));var f=Ee.fromTag("tbody");qn(u,f);var d=Wc(a?e-l:e,t,a?0:n,r);return Xn(f,d),u}(n,t,i,o,Hu(e),a);Bt(r,"data-mce-id","__mce");var u,c,s,l=(u=r,c=Ee.fromTag("div"),s=Ee.fromDom(u.dom.cloneNode(!0)),qn(c,s),c.dom.innerHTML);e.insertContent(l),e.addVisual()}),At(ri(e),'table[data-mce-id="__mce"]').map(function(t){var n,o,i;return Fu(e)?Xu(e,t):zu(e)?Ku(t):(Lu(e)||h(n=u.width)&&-1!==n.indexOf("%"))&&$u(e,t),ci(t),It(t,"data-mce-id"),o=e,R(Ct(t,"tr"),function(e){wu(o,e.dom),R(Ct(e,"th,td"),function(e){Cu(o,e.dom)})}),i=e,At(t,"td,th").each(r(qc,i)),t.dom}).getOr(null)},$c=function(e,t,n,r,o){void 0===r&&(r={});var i=function(e){return C(e)&&0<e};return i(t)&&i(n)?Gc(e,n,t,r.headerColumns||0,r.headerRows||0):(console.error(o),null)},Xc=function(e){return function(){return e().fold(function(){return[]},function(e){return A(e,function(e){return e.dom})})}},Kc=function(e){return function(t){var n=0<t.length?m.some(ti(t)):m.none();e(n)}},Yc=function(e,t,n){var r=Gt(e,t,1);1===n||r<=1?It(e,t):Bt(e,t,Math.min(n,r))},Jc=tinymce.util.Tools.resolve("tinymce.util.Tools"),Qc=function(e,t,n){return function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(void 0,e.select("td,th",t))},Zc=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},es=function(e,t){Jc.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},ts=function(e,t){return(t||[]).concat(A(e,function(e){var t=e.text||e.title;return We(e,"menu")?{text:t,items:ts(e.menu)}:{text:t,value:e.value}}))},ns=function(e){return function(t){return ne(t,"rgb")?e.toHex(t):t}},rs=function(e,t){var n=Ee.fromDom(t);return{borderwidth:Wt(n,"border-width").getOr(""),borderstyle:Wt(n,"border-style").getOr(""),bordercolor:Wt(n,"border-color").map(ns(e)).getOr(""),backgroundcolor:Wt(n,"background-color").map(ns(e)).getOr("")}},os=function(e){var t=e[0],n=e.slice(1);return R(n,function(e){R(Pe(t),function(n){Ie(e,function(e,r){var o=t[n];""!==o&&n===r&&o!==e&&(t[n]="")})})}),t},is=function(e){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},us=function(e,t,n,r){return P(e,function(e){return n.formatter.matchNode(r,t+e)}).getOr("")},as=r(us,["left","center","right"],"align"),cs=r(us,["top","middle","bottom"],"valign"),ss=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],ls=function(e){return ss.concat((0<(t=ts(e.getParam("table_cell_class_list",[],"array"))).length?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()).toArray());var t},fs=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,o){e&&!o||r.setAttrib(n,t,o)},setStyle:function(t,o){e&&!o||r.setStyle(n,t,o)},setFormat:function(r,o){e&&!o||(""===o?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:o},n))}}}},ds={normal:fs(!1),ifTruthy:fs(!0)},ms=function(e){return on(e[0]).map(function(t){var n=_n(t),r=Nn(n),o=N(r,function(t){return T(e,function(e){return Ne(t.element,e)})});return A(o,function(e){return{element:e.element.dom,column:Pn(n,e.column).map(function(e){return e.element.dom})}})})},gs=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact(function(){(function(e,t,n,r){var o,i,u=1===t.length,a=ze(r,function(e,t){return n[t]!==e});0<Ve(a)&&1<=t.length&&(o=on(t[0]),ms(t).each(function(t){R(t,function(t){var n,o,i,a,c,s,l,f,d=Pc(e,t.element,r.celltype),m=u?ds.normal(e,d):ds.ifTruthy(e,d);o=t.column.map(function(t){return u?ds.normal(e,t):ds.ifTruthy(e,t)}).getOr(m),(n=m).setAttrib("scope",(i=r).scope),n.setAttrib("class",i.class),n.setStyle("height",ai(i.height)),o.setStyle("width",ai(i.width)),Du(e)&&((a=m).setFormat("tablecellbackgroundcolor",(c=r).backgroundcolor),a.setFormat("tablecellbordercolor",c.bordercolor),a.setFormat("tablecellborderstyle",c.borderstyle),a.setFormat("tablecellborderwidth",ai(c.borderwidth))),u&&(es(e,d),s=e,l=d,Jc.each("top middle bottom".split(" "),function(e){s.formatter.remove("valign"+e,{},l)})),r.halign&&Zc(e,d,r.halign),r.valign&&(f=r.valign)&&e.formatter.apply("valign"+f,{},d)})}),i=0<Ve(ze(a,function(e,t){return"scope"!==t&&"celltype"!==t})),o.each(function(t){return Su(e,t.dom,{structure:Ue(a,"celltype"),style:i})}))})(e,t,n,o),e.focus()})},ps=function(e,t){var n,o,i,u=Hc(fi(e),t);0!==u.length&&(n=function(e,t){var n=ms(t).map(function(t){return A(t,function(t){return n=e,r=t.element,o=Du(e),i=n.dom,u=t.column.getOr(r),q({width:(a=function(e,t){return i.getStyle(e,t)||i.getAttrib(e,t)})(u,"width"),height:a(r,"height"),scope:i.getAttrib(r,"scope"),celltype:ni(r),class:i.getAttrib(r,"class",""),halign:as(n,r),valign:cs(n,r)},o?rs(i,r):{});var n,r,o,i,u,a})});return os(n.getOrDie())}(e,u),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:ls(e)},is("cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:ls(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Du(e)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:r(gs,e,u,n)}))},hs=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],vs=function(e){return hs.concat((0<(t=ts(e.getParam("table_row_class_list",[],"array"))).length?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()).toArray());var t},bs=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact(function(){(function(e,t,n,r){var o,i,u=1===t.length,a=ze(r,function(e,t){return n[t]!==e});0<Ve(a)&&(R(t,function(t){r.type!==ni(t.parentNode)&&Ic(e,t,r.type);var o,i,a,c,s=u?ds.normal(e,t):ds.ifTruthy(e,t);(o=s).setAttrib("class",(i=r).class),o.setStyle("height",ai(i.height)),Pu(e)&&((a=s).setStyle("background-color",(c=r).backgroundcolor),a.setStyle("border-color",c.bordercolor),a.setStyle("border-style",c.borderstyle)),r.align!==n.align&&(es(e,t),Zc(e,t,r.align))}),o=Ue(a,"type"),i=!o||1<Ve(a),on(Ee.fromDom(t[0])).each(function(t){return Su(e,t.dom,{structure:o,style:i})}))})(e,t,n,o),e.focus()})},ys=function(e){var t,n,o,i,u=Vc(fi(e),mi.selected);0!==u.length&&(t=A(u,function(t){return n=e,r=t.dom,o=Pu(e),q({height:(i=n.dom).getStyle(r,"height")||i.getAttrib(r,"height"),class:i.getAttrib(r,"class",""),type:Bc(0,r),align:as(n,r)},o?rs(i,r):{});var n,r,o,i}),n=os(t),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:vs(e)},is("row")]},i={type:"panel",items:[{type:"grid",columns:2,items:vs(e)}]},e.windowManager.open({title:"Row Properties",size:"normal",body:Pu(e)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:r(bs,e,A(u,function(e){return e.dom}),n)}))},xs=tinymce.util.Tools.resolve("tinymce.Env"),ws=function(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)h(n)?e.setStyle(t,n,r):e.setStyle(t,n);else if(t.children)for(var o=0;o<t.children.length;o++)ws(e,t.children[o],n,r)},Cs=function(e,t,n,r){var o,i=e.dom,u=r.getData(),a=ze(u,function(e,t){return n[t]!==e});r.close(),""===u.class&&delete u.class,e.undoManager.transact(function(){var n,r,c,s;t||(n=parseInt(u.cols,10)||1,r=parseInt(u.rows,10)||1,t=Gc(e,n,r,0,0)),0<Ve(a)&&(function(e,t,n){var r,o=e.dom,i={},u={};if(i.class=n.class,u.height=ai(n.height),o.getAttrib(t,"width")&&!Iu(e)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=ai(n.width),Iu(e)?(u["border-width"]=ai(n.border),u["border-spacing"]=ai(n.cellspacing)):(i.border=n.border,i.cellpadding=n.cellpadding,i.cellspacing=n.cellspacing),Iu(e)&&t.children)for(var a=0;a<t.children.length;a++)ws(o,t.children[a],{"border-width":ai(n.border),padding:ai(n.cellpadding)}),Mu(e)&&ws(o,t.children[a],{"border-color":n.bordercolor});Mu(e)&&(u["background-color"]=n.backgroundcolor,u["border-color"]=n.bordercolor,u["border-style"]=n.borderstyle),i.style=o.serializeStyle(q(q({},Bu(e)),u)),o.setAttribs(t,q(q({},Nu(e)),i))}(e,t,u),(o=i.select("caption",t)[0])&&!u.caption&&i.remove(o),!o&&u.caption&&((o=i.create("caption")).innerHTML=xs.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(o,t.firstChild)),""===u.align?es(e,t):Zc(e,t,u.align)),e.focus(),e.addVisual(),0<Ve(a)&&(s=!(c=Ue(a,"caption"))||1<Ve(a),Su(e,t,{structure:c,style:s}))})},Ss=function(e,t){var n,o,i,u,a,c,s,l,f=e.dom,d=function(e,t){var n,r,o,i,u=Bu(e),a=Nu(e),c=t?(n=e.dom,{borderstyle:je(u,"border-style").getOr(""),bordercolor:ns(n)(je(u,"border-color").getOr("")),backgroundcolor:ns(n)(je(u,"background-color").getOr(""))}):{};return q(q(q(q(q(q({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),u),a),c),(i=u["border-width"],Iu(e)&&i?{border:i}:je(a,"border").fold(function(){return{}},function(e){return{border:e}}))),(r=je(u,"border-spacing").or(je(a,"cellspacing")).fold(function(){return{}},function(e){return{cellspacing:e}}),o=je(u,"border-padding").or(je(a,"cellpadding")).fold(function(){return{}},function(e){return{cellpadding:e}}),q(q({},r),o)))}(e,Mu(e));!1===t?(n=f.getParent(e.selection.getStart(),"table"))?(i=n,u=Mu(o=e),d=q({width:(l=o.dom).getStyle(i,"width")||l.getAttrib(i,"width"),height:l.getStyle(i,"height")||l.getAttrib(i,"height"),cellspacing:l.getStyle(i,"border-spacing")||l.getAttrib(i,"cellspacing"),cellpadding:l.getAttrib(i,"cellpadding")||Qc(o.dom,i,"padding"),border:(a=l,c=i,s=Wt(Ee.fromDom(c),"border-width"),Iu(o)&&s.isSome()?s.getOr(""):a.getAttrib(c,"border")||Qc(o.dom,c,"border-width")||Qc(o.dom,c,"border")),caption:!!l.select("caption",i)[0],class:l.getAttrib(i,"class",""),align:as(o,i)},u?rs(l,i):{})):Mu(e)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""):(d.cols="1",d.rows="1",Mu(e)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""));var m=ts(e.getParam("table_class_list",[],"array"));0<m.length&&d.class&&(d.class=d.class.replace(/\s*mce\-item\-table\s*/g,""));var g,p,h,v,b={type:"grid",columns:2,items:(g=m,p=t?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],h=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<g.length?[{type:"listbox",name:"class",label:"Class",items:g}]:[],p.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(h).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},y=Mu(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[b]},is("table")]}:{type:"panel",items:[b]};e.windowManager.open({title:"Table Properties",size:"normal",body:y,onSubmit:r(Cs,e,n,d),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d})},ks=function(e){return zc(fi(e))},Os=function(e){return Fc(fi(e))},_s=function(t,n,o,i,u){var c=ui(t),s=function(e){return on(e,c)},l=function(e){return function(n){t.selection.setRng(n.rng),t.focus(),o.clear(e),ci(e),Su(t,e.dom,n.effect)}},f=function(e){return Os(t).each(function(t){s(t).each(function(n){var r=pi(i,n,t);e(n,r).each(l(n))})})},d=function(){return Os(t).map(function(n){return s(n).bind(function(r){return function(e,t,n){var r=_n(e);return va(r,t).bind(function(e){var t=la(r,n,!1),o=yn(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),i=L(o,function(e){var t=N(e.cells,function(e){return!e.isLocked});return 0<t.length?[q(q({},e),{cells:t})]:[]}),u=fa(i,n);return Tr(0<u.length,u)}).map(function(e){return A(e,function(e){var t=kr(e.element);return R(e.cells,function(e){var n=Or(e.element);ua(n,"colspan",e.colspan,1),ua(n,"rowspan",e.rowspan,1),qn(t,n)}),t})})}(r,pi(i,r,n),Zo(e,Ee.fromDom(t.getDoc()),m.none()))})})},g=function(){return Os(t).map(function(e){return s(e).bind(function(t){return function(e,t){var n=_n(e);return ya(n,t).map(function(e){var t,r,o=e[e.length-1],i=e[0].column,u=o.column+o.colspan;return G(function(e,t,n){if(Dn(e)){var r=N(Bn(e),function(e){return e.column>=t&&e.column<n}),o=A(r,function(e){var r=Or(e.element);return Yc(r,"span",n-t),r}),i=Ee.fromTag("colgroup");return Xn(i,o),[i]}return[]}(n,i,u),(t=i,r=u,A(n.all,function(e){var n=N(e.cells,function(e){return e.column>=t&&e.column<r}),o=A(n,function(e){var n=Or(e.element);return Yc(n,"colspan",r-t),n}),i=Ee.fromTag("tr");return Xn(i,o),i})))})}(t,pi(i,t,e))})})},p=function(e,n){return n().each(function(n){var r=A(n,Or);Os(t).each(function(n){return s(n).each(function(n){var o,u,a=ei(Ee.fromDom(t.getDoc())),c=(o=r,u=a,{selection:di(i),clipboard:o,generators:u});e(n,c).each(l(n))})})})};Ie({mceTableSplitCells:function(){return f(n.unmergeCells)},mceTableMergeCells:function(){return f(n.mergeCells)},mceTableInsertRowBefore:function(){return f(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return f(n.insertRowsAfter)},mceTableInsertColBefore:function(){return f(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return f(n.insertColumnsAfter)},mceTableDeleteCol:function(){return f(n.deleteColumn)},mceTableDeleteRow:function(){return f(n.deleteRow)},mceTableCutCol:function(e){return g().each(function(e){u.setColumns(e),f(n.deleteColumn)})},mceTableCutRow:function(e){return d().each(function(e){u.setRows(e),f(n.deleteRow)})},mceTableCopyCol:function(e){return g().each(function(e){return u.setColumns(e)})},mceTableCopyRow:function(e){return d().each(function(e){return u.setRows(e)})},mceTablePasteColBefore:function(e){return p(n.pasteColsBefore,u.getColumns)},mceTablePasteColAfter:function(e){return p(n.pasteColsAfter,u.getColumns)},mceTablePasteRowBefore:function(e){return p(n.pasteRowsBefore,u.getRows)},mceTablePasteRowAfter:function(e){return p(n.pasteRowsAfter,u.getRows)},mceTableDelete:function(){return ks(t).each(function(e){on(e,c).filter(a(c)).each(function(e){var n,r=Ee.fromText("");Un(e,r),Yn(e),t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):((n=t.dom.createRng()).setStart(r.dom,0),n.setEnd(r.dom,0),t.selection.setRng(n),t.nodeChanged())})})},mceTableSizingMode:function(e,n){return r=n,ks(t).each(function(e){zu(t)||Fu(t)||Lu(t)||on(e,c).each(function(e){"relative"!==r||zi(e)?"fixed"!==r||Hi(e)?"responsive"!==r||Vi(e)||Ku(e):Xu(t,e):$u(t,e),ci(e),Su(t,e.dom,Ou)})});var r}},function(e,n){return t.addCommand(n,e)});var b=function(e,t){t.each(function(t){Su(e,t.dom,Ou)})};Ie({mceTableCellType:function(e,r){var o=on(fi(t),c);n.setTableCellType(t,r),b(t,o)},mceTableRowType:function(e,r){var o=on(fi(t),c);n.setTableRowType(t,r),b(t,o)}},function(e,n){return t.addCommand(n,e)}),t.addCommand("mceTableColType",function(e,t){return je(t,"type").each(function(e){return f("th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader)})}),Ie({mceTableProps:r(Ss,t,!1),mceTableRowProps:r(ys,t),mceTableCellProps:r(ps,t,i)},function(e,n){return t.addCommand(n,function(){return e()})}),t.addCommand("mceInsertTable",function(e,n){v(n)&&0<Pe(n).length?$c(t,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Ss(t,!0)}),t.addCommand("mceTableApplyCellStyle",function(e,n){var r,o,u=function(e){return"tablecell"+e.toLowerCase().replace("-","")};!v(n)||0!==(r=Hc(fi(t),i)).length&&(function(e){for(var t in e)if(Me.call(e,t))return!1;return!0}(o=ze(n,function(e,n){return t.formatter.has(u(n))&&h(e)}))||(Ie(o,function(e,n){R(r,function(r){ds.normal(t,r.dom).setFormat(u(n),e)})}),s(r[0]).each(function(e){return Su(t,e.dom,ku)})))})},Ts={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Es=hr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),As=q(q({},Es),{none:function(e){return void 0===e&&(e=void 0),Es.none(e)}}),Rs=function(e,t){return on(e,t).bind(function(t){var n=nn(t);return M(n,function(t){return Ne(e,t)}).map(function(e){return{index:e,all:n}})})},Ns=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Bs=hr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ds={before:Bs.before,on:Bs.on,after:Bs.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(n,n,n)}},Ps=hr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ms={domRange:Ps.domRange,relative:Ps.relative,exact:Ps.exact,exactFromRange:function(e){return Ps.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=e.match({domRange:function(e){return Ee.fromDom(e.startContainer)},relative:function(e,t){return Ds.getStart(e)},exact:function(e,t,n,r){return e}});return Ee.fromDom(ut(t).dom.defaultView)},range:Ns},Is=function(e,t,n){var r,o,i=e.document.createRange();return r=i,t.fold(function(e){r.setStartBefore(e.dom)},function(e,t){r.setStart(e.dom,t)},function(e){r.setStartAfter(e.dom)}),o=i,n.fold(function(e){o.setEndBefore(e.dom)},function(e,t){o.setEnd(e.dom,t)},function(e){o.setEndAfter(e.dom)}),i},Ls=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},Fs=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},zs=hr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Hs=function(e,t,n){return t(Ee.fromDom(n.startContainer),n.startOffset,Ee.fromDom(n.endContainer),n.endOffset)},Vs=function(e,n){var r,o,i,u=(r=e,n.match({domRange:function(e){return{ltr:t(e),rtl:m.none}},relative:function(e,t){return{ltr:X(function(){return Is(r,e,t)}),rtl:X(function(){return m.some(Is(r,t,e))})}},exact:function(e,t,n,o){return{ltr:X(function(){return Ls(r,e,t,n,o)}),rtl:X(function(){return m.some(Ls(r,n,o,e,t))})}}}));return(i=(o=u).ltr()).collapsed?o.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return zs.rtl(Ee.fromDom(e.endContainer),e.endOffset,Ee.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Hs(0,zs.ltr,i)}):Hs(0,zs.ltr,i)},js=function(e,t){return Vs(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,n),i}})},Us=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Ws=function(e,t,n,r){return tt(t)?function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects();return W(i,function(e){return Us(e,n,r)?m.some(e):m.none()}).map(function(o){return function(e,t,n,r,o){var i=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},u=Zn(t).length,a=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n<=a.bottom){if(n<a.top||i<c)return u-1;i=c}}return 0}(function(e){return i(e).getBoundingClientRect()},n,r,o.right,u);return i(a)}(e,t,n,r,o)})}(e,t,n,r):(i=t,u=n,a=r,c=(o=e).dom.createRange(),s=ft(i),W(s,function(e){return c.selectNode(e.dom),Us(c.getBoundingClientRect(),u,a)?Ws(o,e,u,a):m.none()}));var o,i,u,a,c,s},qs=function(e,t){return t-e.left<e.right-t},Gs=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},$s=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=qs(o,n);return(!0===i?Uo:Wo)(t).map(function(t){return Gs(e,t,i)})},Xs=function(e,t,n){var r=t.dom.getBoundingClientRect(),o=qs(r,n);return m.some(Gs(e,t,o))},Ks=document.caretPositionFromPoint?function(e,t,n){return m.from(e.dom.caretPositionFromPoint(t,n)).bind(function(t){if(null===t.offsetNode)return m.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),m.some(n)})}:document.caretRangeFromPoint?function(e,t,n){return m.from(e.dom.caretRangeFromPoint(t,n))}:function(e,t,n){return Ee.fromPoint(e,t,n).bind(function(r){var o=function(){return n=e,i=t,(0===ft(o=r).length?Xs:$s)(n,o,i);var n,o,i};return 0===ft(r).length?o():function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Ws(e,t,u,a)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))}(e,r,t,n).orThunk(o)})},Ys=function(e,t){var n=Ye(e);return"input"===n?Ds.after(e):_(["br","img"],n)?0===t?Ds.before(e):Ds.after(e):Ds.on(e,t)},Js=function(e,t){var n=e.fold(Ds.before,Ys,Ds.after),r=t.fold(Ds.before,Ys,Ds.after);return Ms.relative(n,r)},Qs=function(e,t,n,r){var o=Ys(e,t),i=Ys(n,r);return Ms.relative(o,i)},Zs=function(e){return m.from(e.getSelection())},el=function(e,t){Zs(e).each(function(e){e.removeAllRanges(),e.addRange(t)})},tl=function(e,t,n,r,o){var i=Ls(e,t,n,r,o);el(e,i)},nl=function(e,t){return Vs(e,t).match({ltr:function(t,n,r,o){tl(e,t,n,r,o)},rtl:function(t,n,r,o){Zs(e).each(function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,r.dom,o);else if(i.extend)try{a=r,c=o,(u=i).collapse(t.dom,n),u.extend(a.dom,c)}catch(d){tl(e,r,o,t,n)}else tl(e,r,o,t,n);var u,a,c})}})},rl=function(e,t,n,r,o){var i=Qs(t,n,r,o);nl(e,i)},ol=function(e,t,n){var r=Js(t,n);nl(e,r)},il=function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return m.some(Ns(Ee.fromDom(t.startContainer),t.startOffset,Ee.fromDom(n.endContainer),n.endOffset))}return m.none()},ul=function(e){if(null===e.anchorNode||null===e.focusNode)return il(e);var t=Ee.fromDom(e.anchorNode),n=Ee.fromDom(e.focusNode);return function(e,t,n,r){var o,i,u,a,c,s=(i=t,u=n,a=r,(c=it(o=e).dom.createRange()).setStart(o.dom,i),c.setEnd(u.dom,a),c),l=Ne(e,n)&&t===r;return s.collapsed&&!l}(t,e.anchorOffset,n,e.focusOffset)?m.some(Ns(t,e.anchorOffset,n,e.focusOffset)):il(e)},al=function(e){return Zs(e).filter(function(e){return 0<e.rangeCount}).bind(ul).map(function(e){return Ms.exact(e.start,e.soffset,e.finish,e.foffset)})},cl=tinymce.util.Tools.resolve("tinymce.util.VK"),sl=function(e,t,n,r){return dl(e,t,Rs(o=n,void 0).fold(function(){return As.none(o)},function(e){return e.index+1<e.all.length?As.middle(o,e.all[e.index+1]):As.last(o)}),r);var o},ll=function(e,t,n,r){return dl(e,t,Rs(o=n,void 0).fold(function(){return As.none()},function(e){return 0<=e.index-1?As.middle(o,e.all[e.index-1]):As.first(o)}),r);var o},fl=function(e,t){return function(e){var t=Ms.getWin(e).dom,n=function(e,n,r,o){return Ls(t,e,n,r,o)},r=e.match({domRange:function(e){var t=Ee.fromDom(e.startContainer),n=Ee.fromDom(e.endContainer);return Qs(t,e.startOffset,n,e.endOffset)},relative:Js,exact:Qs});return Vs(t,r).match({ltr:n,rtl:n})}(Ms.exact(t,0,t,0))},dl=function(e,t,n,r){return n.fold(m.none,m.none,function(e,t){return Uo(t).map(function(e){return fl(0,e)})},function(n){return on(n,t).bind(function(t){var o,i=gi(n);return e.undoManager.transact(function(){r.insertRowsAfter(t,i)}),o=Ct(t,"tr"),U(o).bind(function(e){return At(e,"td,th").map(function(e){return fl(0,e)})})})})},ml=["table","li","dl"],gl=function(e,t){return{selection:e,kill:t}},pl=function(e,t,n,r){return{start:Ds.on(e,t),finish:Ds.on(n,r)}},hl=function(e,t){var n=js(e,t);return Ns(Ee.fromDom(n.startContainer),n.startOffset,Ee.fromDom(n.endContainer),n.endOffset)},vl=pl,bl=function(e,t,n,r,o){return Ne(n,r)?m.none():dr(n,r,t).bind(function(t){var r=t.boxes.getOr([]);return 0<r.length?(o(e,r,t.start,t.finish),m.some(gl(m.some(vl(n,0,n,Ho(n))),!0))):m.none()})},yl=function(e,t){return{item:e,mode:t}},xl=function(e,t,n,r){return void 0===r&&(r=wl),e.property().parent(t).map(function(e){return yl(e,r)})},wl=function(e,t,n,r){return void 0===r&&(r=Cl),n.sibling(e,t).map(function(e){return yl(e,r)})},Cl=function(e,t,n,r){void 0===r&&(r=Cl);var o=e.property().children(t);return n.first(o).map(function(e){return yl(e,r)})},Sl=[{current:xl,next:wl,fallback:m.none()},{current:wl,next:Cl,fallback:m.some(xl)},{current:Cl,next:Cl,fallback:m.some(wl)}],kl=function(e,t,n,r,o){return void 0===o&&(o=Sl),P(o,function(e){return e.current===n}).bind(function(n){return n.current(e,t,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return kl(e,t,n,r)})})})},Ol=function(e,t,n,r,o,i){return kl(e,t,r,o).bind(function(t){return i(t.item)?m.none():n(t.item)?m.some(t.item):Ol(e,t.item,n,t.mode,o,i)})},_l=function(e){return function(t){return 0===e.property().children(t).length}},Tl=function(e,t,n,r){return Ol(e,t,n,wl,{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return 0<e.length?m.some(e[e.length-1]):m.none()}},r)},El=function(e,t,n,r){return Ol(e,t,n,wl,{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return 0<e.length?m.some(e[0]):m.none()}},r)},Al=rr(),Rl=function(e,t){return Tl(n=Al,e,_l(n),t);var n},Nl=function(e,t){return El(n=Al,e,_l(n),t);var n},Bl=hr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Dl=function(e){return Rt(e,"tr")},Pl=q(q({},Bl),{verify:function(e,t,n,r,o,i,u){return Rt(r,"td,th",u).bind(function(n){return Rt(t,"td,th",u).map(function(t){return Ne(n,t)?Ne(r,n)&&Ho(n)===o?i(t):Bl.none("in same cell"):lr(Dl,[n,t]).fold(function(){return o=n,u=(r=e).getRect(t),(a=r.getRect(o)).right>u.left&&a.left<u.right?Bl.success():i(t);var r,o,u,a},function(e){return i(t)})})}).getOr(Bl.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)}}),Ml=function(e){return"br"===Ye(e)},Il=function(e,t,n){return t(e,n).bind(function(e){return tt(e)&&0===Zn(e).trim().length?Il(e,t,n):m.some(e)})},Ll=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},Fl=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},zl=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},Hl=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},Vl=function(e,t){return m.some(e.getRect(t))},jl=function(e,t,n){return et(t)?Vl(e,t).map(Hl):tt(t)?(r=e,o=t,(0<=(i=n)&&i<Ho(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):m.none()).map(Hl)):m.none();var r,o,i},Ul=function(e,t){return et(t)?Vl(e,t).map(Hl):tt(t)?e.getRangedRect(t,0,t,Ho(t)).map(Hl):m.none()},Wl=hr([{none:[]},{retry:["caret"]}]),ql=function(e,t,n){return St(function(e,t){return t(e)},_t,t,Ja,void 0).fold(c,function(t){return Ul(e,t).exists(function(e){return(t=n).left<(r=e).left||Math.abs(r.right-t.left)<1||t.left>r.right;var t,r})})},Gl={point:function(e){return e.bottom},adjuster:function(e,t,n,r,o){var i=Ll(o,5);return Math.abs(n.bottom-r.bottom)<1||n.top>o.bottom?Wl.retry(i):n.top===o.bottom?Wl.retry(Ll(o,1)):ql(e,t,o)?Wl.retry(zl(i,5,0)):Wl.none()},move:Ll,gather:Nl},$l=function(e,t,n,r,o){return 0===o?m.some(r):(a=e,c=r.left,s=t.point(r),a.elementFromPoint(c,s).filter(function(e){return"table"===Ye(e)}).isSome()?(u=o-1,$l(e,i=t,n,i.move(r,5),u)):e.situsFromPoint(r.left,t.point(r)).bind(function(i){return i.start.fold(m.none,function(i){return Ul(e,i).bind(function(u){return t.adjuster(e,i,u,n,r).fold(m.none,function(r){return $l(e,t,n,r,o-1)})}).orThunk(function(){return m.some(r)})},m.none)}));var i,u,a,c,s},Xl=function(e,t,n){var r,o,i,u=e.move(n,5),a=$l(t,e,n,u,100).getOr(u);return i=t,((r=e).point(o=a)>i.getInnerHeight()?m.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?m.some(-r.point(o)):m.none()).fold(function(){return t.situsFromPoint(a.left,e.point(a))},function(n){return t.scrollBy(0,n),t.situsFromPoint(a.left,e.point(a)-n)})},Kl={tryUp:r(Xl,{point:function(e){return e.top},adjuster:function(e,t,n,r,o){var i=Fl(o,5);return Math.abs(n.top-r.top)<1||n.bottom<o.top?Wl.retry(i):n.bottom===o.top?Wl.retry(Fl(o,1)):ql(e,t,o)?Wl.retry(zl(i,5,0)):Wl.none()},move:Fl,gather:Rl}),tryDown:r(Xl,Gl),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:t(5)},Yl=function(e,t,n,r,o,i){return 0===i?m.none():Zl(e,t,n,r,o).bind(function(u){var a=e.fromSitus(u),c=Pl.verify(e,n,r,a.finish,a.foffset,o.failure,t);return Pl.cata(c,function(){return m.none()},function(){return m.some(u)},function(u){return Ne(n,u)&&0===r?Jl(e,n,r,Fl,o):Yl(e,t,u,0,o,i-1)},function(u){return Ne(n,u)&&r===Ho(u)?Jl(e,n,r,Ll,o):Yl(e,t,u,Ho(u),o,i-1)})})},Jl=function(e,t,n,r,o){return jl(e,t,n).bind(function(t){return Ql(e,o,r(t,Kl.getJumpSize()))})},Ql=function(e,t,n){var r=_e().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):m.none()},Zl=function(e,t,n,r,o){return jl(e,n,r).bind(function(t){return Ql(e,o,t)})},ef=function(e,t,n,o,i){return Rt(o,"td,th",t).bind(function(o){return Rt(o,"table",t).bind(function(u){return function(e,t){return _t(e,function(e){return at(e).exists(function(e){return Ne(e,t)})},void 0).isSome()}(i,u)?function(e,t,n){return e.getSelection().bind(function(o){return function(e,t,n,o){var i,u,a;return(Ml(t)?(i=e,u=t,(a=o).traverse(u).orThunk(function(){return Il(u,a.gather,i)}).map(a.relative)):function(e,t,n,o){return dt(i=t,u=n).filter(Ml).orThunk(function(){return dt(i,u-1).filter(Ml)}).bind(function(t){return o.traverse(t).fold(function(){return Il(t,o.gather,e).map(o.relative)},function(e){return at(t=e).bind(function(e){var n=ft(e);return function(e,t){return M(e,r(Ne,t))}(n,t).map(function(r){return{parent:e,children:n,element:t,index:r}})}).map(function(e){return Ds.on(e.parent,e.index)});var t})});var i,u}(e,t,n,o)).map(function(e){return{start:e,finish:e}})}(t,o.finish,o.foffset,n).fold(function(){return m.some(Zu(o.finish,o.foffset))},function(r){var i=e.fromSitus(r),u=Pl.verify(e,o.finish,o.foffset,i.finish,i.foffset,n.failure,t);return Pl.cata(u,function(e){return m.none()},function(){return m.none()},function(e){return m.some(Zu(e,0))},function(e){return m.some(Zu(e,Ho(e)))})})})}(a=e,c=t,s=n).bind(function(e){return Yl(a,c,e.element,e.offset,s,20).map(a.fromSitus)}).bind(function(e){return Rt(e.finish,"td,th",t).map(function(t){return{start:o,finish:t,range:e}})}):m.none();var a,c,s})})},tf=function(e,t,n,r,o,i){return _e().browser.isIE()?m.none():i(r,t).orThunk(function(){return ef(e,t,n,r,o).map(function(e){var t=e.range;return gl(m.some(vl(t.start,t.soffset,t.finish,t.foffset)),!0)})})},nf=function(e,t){return Rt(e,"tr",t).bind(function(e){return Rt(e,"table",t).bind(function(n){var r=Ct(n,"tr");return Ne(e,r[0])?Tl(Al,n,function(e){return Wo(e).isSome()},t).map(function(e){var t=Ho(e);return gl(m.some(vl(e,t,e,t)),!0)}):m.none()})})},rf=function(e,t){return Rt(e,"tr",t).bind(function(e){return Rt(e,"table",t).bind(function(n){var r=Ct(n,"tr");return Ne(e,r[r.length-1])?El(Al,n,function(e){return Uo(e).isSome()},t).map(function(e){return gl(m.some(vl(e,0,e,0)),!0)}):m.none()})})},of=function(e,t,n,r,o,i,u){return ef(e,n,r,o,i).bind(function(e){return bl(t,n,e.start,e.finish,u)})},uf=function(e,t){return Rt(e,"td,th",t)},af=function(e,t,n,r){var o,i=(o=Po(m.none()),{clear:function(){return o.set(m.none())},set:function(e){return o.set(m.some(e))},isSet:function(){return o.get().isSome()},on:function(e){return o.get().each(e)}}),u=i.clear,a=function(o){i.on(function(i){r.clearBeforeUpdate(t),uf(o.target,n).each(function(o){dr(i,o,n).each(function(n){var u=n.boxes.getOr([]);(1<u.length||1===u.length&&!Ne(i,o))&&(r.selectRange(t,u,n.start,n.finish),e.selectContents(o))})})})};return{clearstate:u,mousedown:function(e){r.clear(t),uf(e.target,n).each(i.set)},mouseover:function(e){a(e)},mouseup:function(e){a(e),u()}}},cf={traverse:lt,gather:Nl,relative:Ds.before,otherRetry:Kl.tryDown,ieRetry:Kl.ieTryDown,failure:Pl.failedDown},sf={traverse:st,gather:Rl,relative:Ds.before,otherRetry:Kl.tryUp,ieRetry:Kl.ieTryUp,failure:Pl.failedUp},lf=function(e){return function(t){return t===e}},ff=lf(38),df=lf(40),mf=function(e){return 37<=e&&e<=40},gf={isBackward:lf(37),isForward:lf(39)},pf={isBackward:lf(39),isForward:lf(37)},hf=function(e){return{elementFromPoint:function(t,n){return Ee.fromPoint(Ee.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Ms.exact(t,n,r,o);return function(e,t){var n,r,o;return 0<(o=0<(r=(n=js(e,t)).getClientRects()).length?r[0]:n.getBoundingClientRect()).width||0<o.height?m.some(o).map(Fs):m.none()}(e,i)},getSelection:function(){return al(e).map(function(t){return hl(e,t)})},fromSitus:function(t){var n=Ms.relative(t.start,t.finish);return hl(e,n)},situsFromPoint:function(t,n){return function(e,t,n){return r=t,o=n,i=Ee.fromDom(e.document),Ks(i,r,o).map(function(e){return Ns(Ee.fromDom(e.startContainer),e.startOffset,Ee.fromDom(e.endContainer),e.endOffset)});var r,o,i}(e,t,n).map(function(e){return pl(e.start,e.soffset,e.finish,e.foffset)})},clearSelection:function(){Zs(e).each(function(e){return e.removeAllRanges()})},collapseSelection:function(t){void 0===t&&(t=!1),al(e).each(function(n){return n.fold(function(e){return e.collapse(t)},function(n,r){var o=t?n:r;ol(e,o,o)},function(n,r,o,i){var u=t?n:o,a=t?r:i;rl(e,u,a,u,a)})})},setSelection:function(t){rl(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){ol(e,t,n)},selectContents:function(t){!function(e,t){var n,r,o=(n=t,function(e,t){e.selectNodeContents(t.dom)}(r=e.document.createRange(),n),r);el(e,o)}(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,o;return(t=Ee.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop,Vr(r,o)).top},scrollBy:function(t,n){var r,o,i,u;r=t,o=n,(u=(void 0!==(i=Ee.fromDom(e.document))?i.dom:document).defaultView)&&u.scrollBy(r,o)}}},vf=function(e,t){return{rows:e,cols:t}},bf=function(e){return!1===iu(Ee.fromDom(e.target),"ephox-snooker-resizer-bar")};function yf(t,n,o){var i=function(e,n,r){var o=function(t){It(t,e.selected),It(t,e.firstSelected),It(t,e.lastSelected)},i=function(t){Bt(t,e.selected,"1")},u=function(e){a(e),t.fire("TableSelectionClear")},a=function(t){var n=Ct(t,e.selectedSelector);R(n,o)};return{clearBeforeUpdate:a,clear:u,selectRange:function(t,r,o,a){u(t),R(r,i),Bt(o,e.firstSelected,"1"),Bt(a,e.lastSelected,"1"),n(r,o,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}(mi,function(n,r,i){o.targets().each(function(o){on(r).each(function(u){var a=Wu(t),c=Zo(e,Ee.fromDom(t.getDoc()),a),s=function(e,t,n){var r=_n(e);return va(r,t).map(function(e){var t,o,i,u,a,c,s,l,f,d=la(r,n,!1);return{upOrLeftCells:(t=e,o=n,i=d.slice(0,t[t.length-1].row+1),u=fa(i,o),L(u,function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return A(n,function(e){return e.element})})),downOrRightCells:(c=e,s=n,l=(a=d).slice(c[0].row+c[0].rowspan-1,a.length),f=fa(l,s),L(f,function(e){var t=e.cells.slice(c[0].column+c[0].colspan-1,e.cells.length);return A(t,function(e){return e.element})}))}})}(u,o,c);t.fire("TableSelectionChange",{cells:n,start:r,finish:i,otherCells:s})})})});return t.on("init",function(o){var u,a,c,s,l,f,d=t.getWin(),g=ri(t),p=ui(t),h=(u=hf(d),{clearstate:(a=af(u,g,p,i)).clearstate,mousedown:a.mousedown,mouseover:a.mouseover,mouseup:a.mouseup}),v=function(e,t,n,o){var i=hf(e),u=function(){return o.clear(t),m.none()};return{keydown:function(e,a,c,s,l,f){var d=e.raw,g=d.which,p=!0===d.shiftKey;return mr(t,o.selectedSelector).fold(function(){return df(g)&&p?r(of,i,t,n,cf,s,a,o.selectRange):ff(g)&&p?r(of,i,t,n,sf,s,a,o.selectRange):df(g)?r(tf,i,n,cf,s,a,rf):ff(g)?r(tf,i,n,sf,s,a,nf):m.none},function(e){var n=function(n){return function(){return W(n,function(n){return r=t,function(e,t,n,r,o){return i=o,P(e,function(e){return Ae(e,i)}).bind(function(e){return function(e,t,n){return on(e).bind(function(r){var o,i,u,a=Vn(r);return i=t,u=n,An(o=a,e,Ne).bind(function(e){return En(o,(0<i?e.row+e.rowspan-1:e.row)+i,(0<u?e.column+e.colspan-1:e.column)+u).map(function(e){return e.element})})})}(e,t,n).bind(function(e){return n=r,Tt(t=e,"table").bind(function(e){return At(e,n).bind(function(e){return dr(e,t).bind(function(e){return e.boxes.map(function(t){return{boxes:t,start:e.start,finish:e.finish}})})})});var t,n})});var i}(e,n.rows,n.cols,(i=o).firstSelectedSelector,i.lastSelectedSelector).map(function(e){return i.clearBeforeUpdate(r),i.selectRange(r,e.boxes,e.start,e.finish),e.boxes});var r,i}).fold(function(){return gr(t,o.firstSelectedSelector,o.lastSelectedSelector).map(function(e){var n=df(g)||f.isForward(g)?Ds.after:Ds.before;return i.setRelativeSelection(Ds.on(e.first,0),n(e.table)),o.clear(t),gl(m.none(),!0)})},function(e){return m.some(gl(m.none(),!0))})}};return df(g)&&p?n([vf(1,0)]):ff(g)&&p?n([vf(-1,0)]):f.isBackward(g)&&p?n([vf(0,-1),vf(-1,0)]):f.isForward(g)&&p?n([vf(0,1),vf(1,0)]):mf(g)&&0==p?u:m.none})()},keyup:function(e,r,i,u,a){return mr(t,o.selectedSelector).fold(function(){var c,s,l,f,d,g,p,h=e.raw;return 0!=(!0===h.shiftKey)&&mf(h.which)?(c=t,s=n,f=i,g=a,p=o.selectRange,Ne(l=r,d=u)&&f===g?m.none():Rt(l,"td,th",s).bind(function(e){return Rt(d,"td,th",s).bind(function(t){return bl(c,s,e,t,p)})})):m.none()},m.none)}}}(d,g,p,i),b=(c=g,s=p,l=i,f=hf(d),function(e,t){l.clearBeforeUpdate(c),dr(e,t,s).each(function(e){var n=e.boxes.getOr([]);l.selectRange(c,n,e.start,e.finish),f.selectContents(t),f.collapseSelection()})});t.on("TableSelectorChange",function(e){return b(e.start,e.finish)});var y,x,w=function(e,n){!0===e.raw.shiftKey&&(n.kill&&e.kill(),n.selection.each(function(e){var n=Ms.relative(e.start,e.finish),r=js(d,n);t.selection.setRng(r)}))},C=function(e){return 0===e.button},S=(y=Po(Ee.fromDom(g)),x=Po(0),{touchEnd:function(e){var t,n,r=Ee.fromDom(e.target);"td"!==Ye(r)&&"th"!==Ye(r)||(t=y.get(),n=x.get(),Ne(t,r)&&e.timeStamp-n<300&&(e.preventDefault(),b(r,r))),y.set(r),x.set(e.timeStamp)}});t.on("dragstart",function(e){h.clearstate()}),t.on("mousedown",function(e){C(e)&&bf(e)&&h.mousedown(nu(e))}),t.on("mouseover",function(e){var t;(void 0===(t=e).buttons||xs.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&bf(e)&&h.mouseover(nu(e))}),t.on("mouseup",function(e){C(e)&&bf(e)&&h.mouseup(nu(e))}),t.on("touchend",S.touchEnd),t.on("keyup",function(e){var n,r,o,i=nu(e);i.raw.shiftKey&&mf(i.raw.which)&&(n=t.selection.getRng(),r=Ee.fromDom(n.startContainer),o=Ee.fromDom(n.endContainer),v.keyup(i,r,n.startOffset,o,n.endOffset).each(function(e){w(i,e)}))}),t.on("keydown",function(e){var r=nu(e);n().each(function(e){return e.hideBars()});var o=t.selection.getRng(),i=Ee.fromDom(o.startContainer),u=Ee.fromDom(o.endContainer),a=Mr(gf,pf)(Ee.fromDom(t.selection.getStart()));v.keydown(r,i,o.startOffset,u,o.endOffset,a).each(function(e){w(r,e)}),n().each(function(e){return e.showBars()})}),t.on("NodeChange",function(){var n=t.selection,r=Ee.fromDom(n.getStart()),o=Ee.fromDom(n.getEnd());lr(on,[r,o]).fold(function(){return i.clear(g)},e)})}),{clear:i.clear}}Cr.add("table",function(e){var t,n,r,o,i,u,a,c,s,l,f,d,g,p,h,v,b,y,x,w,C=(t=function(){return ri(e)},n=function(){return zc(fi(e))},r=mi.selectedSelector,{get:function(){return pr(t(),r).fold(function(){return n().map(wr).getOrThunk(yr)},function(e){return xr(e)})}}),S=(o=e,i=C,u=Po(m.none()),a=Po([]),c=m.none(),s=ot("caption"),l=function(e){return c.forall(function(t){return!t[e]})},f=function(){return zc(fi(o)).bind(function(e){return on(e).map(function(t){return s(e)?gi(e):pi(i,t,e)})})},d=function(e){return on(e.element).map(function(t){var n=_n(t),r=va(n,e).getOr([]),o=D(r,function(e,t){return t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:wa(n,e).isSome(),unmergeable:Ca(n,e).isSome(),locked:o}})},p=function(e,t){var n=function(){return u.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})};return n(),a.set(a.get().concat([n])),function(){a.set(N(a.get(),function(e){return e!==n}))}},h=function(e){return c.exists(function(t){return t.locked[e]})},o.on("NodeChange ExecCommand TableSelectorChange",g=function(){u.set(X(f)()),c=u.get().bind(d),R(a.get(),function(e){return e()})}),{onSetupTable:function(e){return p(e,function(e){return!1})},onSetupCellOrRow:function(e){return p(e,function(e){return s(e.element)})},onSetupColumn:function(e){return function(t){return p(t,function(t){return s(t.element)||h(e)})}},onSetupPasteable:function(e){return function(t){return p(t,function(t){return s(t.element)||e().isNone()})}},onSetupPasteableColumn:function(e,t){return function(n){return p(n,function(n){return s(n.element)||e().isNone()||h(t)})}},onSetupMergeable:function(e){return p(e,function(e){return l("mergeable")})},onSetupUnmergeable:function(e){return p(e,function(e){return l("unmergeable")})},resetTargets:g,targets:function(){return u.get()}}),k=Qu(e),O=yf(e,k.lazyResize,S),T=jc(e,k.lazyWire,C),E=(v=Po(m.none()),b=Po(m.none()),y=function(e){e.set(m.none())},{getRows:v.get,setRows:function(e){v.set(e),y(b)},clearRows:function(){return y(v)},getColumns:b.get,setColumns:function(e){b.set(e),y(v)},clearColumns:function(){return y(b)}});return _s(e,T,O,C,E),function(e,t,n){var r=ui(e);Ie({mceTableRowType:function(){return t.getTableRowType(e)},mceTableCellType:function(){return t.getTableCellType(e)},mceTableColType:function(){return Fc(fi(e)).bind(function(e){return on(e,r).map(function(r){var o=pi(n,r,e);return t.getTableColType(r,o)})}).getOr("")}},function(t,n){return e.addQueryValueHandler(n,t)})}(e,T,C),hi(e,C,T,O),function(e,t,n){var r=function(t){return function(){return e.execCommand(t)}},o=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},i={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},u={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onLast")}),e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",i),e.ui.registry.addMenuItem("deletetable",u),e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(function(){return""},function(e){return"caption"===Ye(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}(e,S,E),function(e,t,n){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(n.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(e,S,E),0<(w=(x=e).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&x.ui.registry.addContextToolbar("table",{predicate:function(e){return x.dom.is(e,"table")&&x.getBody().contains(e)},items:w,scope:"node",position:"node"}),e.on("PreInit",function(){e.serializer.addTempAttr(mi.firstSelected),e.serializer.addTempAttr(mi.lastSelected),e.formatter.register(Ts)}),e.getParam("table_tab_navigation",!0,"boolean")&&e.on("keydown",function(t){var n,r,o,i,u,a,c;r=e,o=T,(n=t).keyCode===cl.TAB&&(i=ri(r),u=function(e){var t=Ye(e);return Ne(e,i)||_(ml,t)},(a=r.selection.getRng()).collapsed&&(c=Ee.fromDom(a.startContainer),tn(c,u).each(function(e){n.preventDefault(),(n.shiftKey?ll:sl)(r,u,e,o).each(function(e){r.selection.setRng(e)})})))}),e.on("remove",function(){k.destroy()}),function(e,t,n,r){return{insertTable:(o=e,function(e,t,n){void 0===n&&(n={});var r=$c(o,t,e,n,"Invalid values for insertTable - rows and columns values are required to insert a table.");return o.undoManager.add(),r}),setClipboardRows:Kc(t.setRows),getClipboardRows:Xc(t.getRows),setClipboardCols:Kc(t.setColumns),getClipboardCols:Xc(t.getColumns),resizeHandler:n,selectionTargets:r};var o}(e,E,k,S)})}();